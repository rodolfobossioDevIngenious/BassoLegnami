/*! For license information please see p-6a7ea7d0.entry.js.LICENSE.txt */
import{r as registerInstance,h,H as Host,c as createEvent,a as getElement}from"./p-ee0b9025.js";import{e as eventBus}from"./p-93cac3a6.js";import{a as WorkflowPersistenceBehavior,A as ActivityTraits}from"./p-c74b54ba.js";import{E as EventTypes}from"./p-d88cb309.js";import"./p-f1ec68ec.js";import{N as _baseAssignValue,P as keys_1,O as isObject_1,Q as _isPrototype,I as isArrayLike_1,R as _arrayLikeKeys,S as _root,T as _getSymbols,U as _overArg,V as stubArray_1,b as _arrayPush,W as _baseGetAllKeys,X as _Uint8Array,Y as _Symbol,H as isObjectLike_1,Z as _getTag,g as _baseUnary,$ as _nodeUtil,e as _copyArray,a0 as isBuffer_1,a1 as _Stack,a2 as _arrayEach,i as isArray_1,a3 as _getAllKeys,a4 as _hasPath,a5 as isTypedArray_1,a6 as isArguments_1,a7 as _baseKeys,l as _baseIteratee,a8 as isFunction_1,a9 as _baseForOwn,aa as constant_1,ab as each,ac as filter_1,ad as map_1,ae as reduce_1,af as size_1,ag as values_1,k as _baseRest,_ as _isIterateeCall,A as eq_1,ah as _baseFor,ai as _castFunction,y as isSymbol_1,z as identity_1,aj as _baseGetTag,ak as _baseGet,v as _castPath,al as hasIn_1,am as toFinite_1,an as toString_1,ao as find_1,ap as forEach_1,m as last_1,aq as sortBy_1}from"./p-a3b5bd35.js";import{f as getInboundConnections,i as getOutboundConnections,r as removeActivity,j as findActivity,k as addConnection,l as getChildActivities,n as removeConnection,d as clip$1,e as durationToString}from"./p-971980b1.js";import"./p-82db2ff5.js";import"./p-949334ec.js";import{a as createCommonjsModule,b as commonjsRequire,d as getAugmentedNamespace,c as commonjsGlobal}from"./p-80de33dc.js";import{g as _assignValue,u as union_1,i as isArrayLikeObject_1,e as _baseSet,b as _flatRest,f as flatten_1,z as zipObject_1}from"./p-6c6facd9.js";import{a as state}from"./p-e77aabd2.js";import{A as ActivityIcon}from"./p-8ddc23be.js";import{W as WorkflowDesignerMode,L as LayoutDirection}from"./p-79414d9f.js";import{t as toastNotificationService}from"./p-8675edd4.js";import{h as hooks}from"./p-f931e145.js";let ElsaCopyButton=class{constructor(t){registerInstance(this,t),this.onCopyClick=async t=>{t.stopPropagation(),await navigator.clipboard.writeText(this.value),await eventBus.emit(EventTypes.ClipboardCopied,this,void 0,"Data copied to clipboard.")}}render(){return h(Host,{class:"elsa-align-text-top elsa-inline-block"},h("button",{type:"button",class:"hover:elsa-text-blue-500 focus:elsa-text-green-600 elsa-pl-0.5",onClick:this.onCopyClick},h("svg",{xmlns:"http://www.w3.org/2000/svg",class:"elsa-h-4 elsa-w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},h("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"}))))}};var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&!(getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(t){return"string"==typeof t&&REGEX.test(t)}for(var byteToHex=[],i=0;i<256;++i)byteToHex.push((i+256).toString(16).substr(1));function stringify(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(byteToHex[t[e+0]]+byteToHex[t[e+1]]+byteToHex[t[e+2]]+byteToHex[t[e+3]]+"-"+byteToHex[t[e+4]]+byteToHex[t[e+5]]+"-"+byteToHex[t[e+6]]+byteToHex[t[e+7]]+"-"+byteToHex[t[e+8]]+byteToHex[t[e+9]]+"-"+byteToHex[t[e+10]]+byteToHex[t[e+11]]+byteToHex[t[e+12]]+byteToHex[t[e+13]]+byteToHex[t[e+14]]+byteToHex[t[e+15]]).toLowerCase();if(!validate(n))throw TypeError("Stringified UUID is invalid");return n}function v4(t,e,n){var r=(t=t||{}).random||(t.rng||rng)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return stringify(r)}var noop$6={value:()=>{}};function dispatch$1(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Dispatch$1(r)}function Dispatch$1(t){this._=t}function parseTypenames$3(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function get$4(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function set$5(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=noop$6,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Dispatch$1.prototype=dispatch$1.prototype={constructor:Dispatch$1,on:function(t,e){var n,r=this._,i=parseTypenames$3(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)r[n]=set$5(r[n],t.name,e);else if(null==e)for(n in r)r[n]=set$5(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=get$4(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Dispatch$1(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var xhtml$1="http://www.w3.org/1999/xhtml";const namespaces$1={svg:"http://www.w3.org/2000/svg",xhtml:xhtml$1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace$1(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),namespaces$1.hasOwnProperty(e)?{space:namespaces$1[e],local:t}:t}function creatorInherit$1(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===xhtml$1&&e.documentElement.namespaceURI===xhtml$1?e.createElement(t):e.createElementNS(n,t)}}function creatorFixed$1(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function creator$1(t){var e=namespace$1(t);return(e.local?creatorFixed$1:creatorInherit$1)(e)}function none$3(){}function selector$1(t){return null==t?none$3:function(){return this.querySelector(t)}}function selection_select$1(t){"function"!=typeof t&&(t=selector$1(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],l=a.length,c=r[i]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=t.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new Selection$4(r,this._parents)}function array$7(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function empty$3(){return[]}function selectorAll$1(t){return null==t?empty$3:function(){return this.querySelectorAll(t)}}function arrayAll(t){return function(){return array$7(t.apply(this,arguments))}}function selection_selectAll$1(t){t="function"==typeof t?arrayAll(t):selectorAll$1(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(t.call(s,s.__data__,c,a)),i.push(s));return new Selection$4(r,i)}function matcher$1(t){return function(){return this.matches(t)}}function childMatcher(t){return function(e){return e.matches(t)}}var find$3=Array.prototype.find;function childFind(t){return function(){return find$3.call(this.children,t)}}function childFirst(){return this.firstElementChild}function selection_selectChild(t){return this.select(null==t?childFirst:childFind("function"==typeof t?t:childMatcher(t)))}var filter$2=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(t){return function(){return filter$2.call(this.children,t)}}function selection_selectChildren(t){return this.selectAll(null==t?children:childrenFilter("function"==typeof t?t:childMatcher(t)))}function selection_filter$1(t){"function"!=typeof t&&(t=matcher$1(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Selection$4(r,this._parents)}function sparse$1(t){return new Array(t.length)}function selection_enter$1(){return new Selection$4(this._enter||this._groups.map(sparse$1),this._parents)}function EnterNode$1(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function constant$h(t){return function(){return t}}function bindIndex$1(t,e,n,r,i,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new EnterNode$1(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function bindKey$2(t,e,n,r,i,o,s){var a,l,c,u=new Map,h=e.length,d=o.length,f=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(f[a]=c=s.call(l,l.__data__,a,e)+"",u.has(c)?i[a]=l:u.set(c,l));for(a=0;a<d;++a)c=s.call(t,o[a],a,o)+"",(l=u.get(c))?(r[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new EnterNode$1(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u.get(f[a])===l&&(i[a]=l)}function datum(t){return t.__data__}function selection_data$1(t,e){if(!arguments.length)return Array.from(this,datum);var n=e?bindKey$2:bindIndex$1,r=this._parents,i=this._groups;"function"!=typeof t&&(t=constant$h(t));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],h=i[c],d=h.length,f=arraylike(t.call(u,u&&u.__data__,c,r)),p=f.length,g=a[c]=new Array(p),m=s[c]=new Array(p),A=l[c]=new Array(d);n(u,h,g,m,A,f,e);for(var y,v,b=0,x=0;b<p;++b)if(y=g[b]){for(b>=x&&(x=b+1);!(v=m[x])&&++x<p;);y._next=v||null}}return(s=new Selection$4(s,r))._enter=a,s._exit=l,s}function arraylike(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function selection_exit$1(){return new Selection$4(this._exit||this._groups.map(sparse$1),this._parents)}function selection_join$1(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i}function selection_merge$1(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=Math.min(i,r.length),s=new Array(i),a=0;a<o;++a)for(var l,c=n[a],u=r[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;a<i;++a)s[a]=n[a];return new Selection$4(s,this._parents)}function selection_order$1(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this}function selection_sort$1(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=ascending$4);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new Selection$4(i,this._parents).order()}function ascending$4(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function selection_call$1(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function selection_nodes$1(){return Array.from(this)}function selection_node$1(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function selection_size$1(){let t=0;for(const e of this)++t;return t}function selection_empty$1(){return!this.node()}function selection_each$1(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this}function attrRemove$3(t){return function(){this.removeAttribute(t)}}function attrRemoveNS$3(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant$3(t,e){return function(){this.setAttribute(t,e)}}function attrConstantNS$3(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function attrFunction$3(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function attrFunctionNS$3(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function selection_attr$1(t,e){var n=namespace$1(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?attrRemoveNS$3:attrRemove$3:"function"==typeof e?n.local?attrFunctionNS$3:attrFunction$3:n.local?attrConstantNS$3:attrConstant$3)(n,e))}function defaultView$1(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function styleRemove$3(t){return function(){this.style.removeProperty(t)}}function styleConstant$3(t,e,n){return function(){this.style.setProperty(t,e,n)}}function styleFunction$3(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function selection_style$1(t,e,n){return arguments.length>1?this.each((null==e?styleRemove$3:"function"==typeof e?styleFunction$3:styleConstant$3)(t,e,null==n?"":n)):styleValue$1(this.node(),t)}function styleValue$1(t,e){return t.style.getPropertyValue(e)||defaultView$1(t).getComputedStyle(t,null).getPropertyValue(e)}function propertyRemove$1(t){return function(){delete this[t]}}function propertyConstant$1(t,e){return function(){this[t]=e}}function propertyFunction$1(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function selection_property$1(t,e){return arguments.length>1?this.each((null==e?propertyRemove$1:"function"==typeof e?propertyFunction$1:propertyConstant$1)(t,e)):this.node()[t]}function classArray$1(t){return t.trim().split(/^|\s+/)}function classList$1(t){return t.classList||new ClassList$1(t)}function ClassList$1(t){this._node=t,this._names=classArray$1(t.getAttribute("class")||"")}function classedAdd$1(t,e){for(var n=classList$1(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function classedRemove$1(t,e){for(var n=classList$1(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function classedTrue$1(t){return function(){classedAdd$1(this,t)}}function classedFalse$1(t){return function(){classedRemove$1(this,t)}}function classedFunction$1(t,e){return function(){(e.apply(this,arguments)?classedAdd$1:classedRemove$1)(this,t)}}function selection_classed$1(t,e){var n=classArray$1(t+"");if(arguments.length<2){for(var r=classList$1(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?classedFunction$1:e?classedTrue$1:classedFalse$1)(n,e))}function textRemove$1(){this.textContent=""}function textConstant$3(t){return function(){this.textContent=t}}function textFunction$3(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function selection_text$1(t){return arguments.length?this.each(null==t?textRemove$1:("function"==typeof t?textFunction$3:textConstant$3)(t)):this.node().textContent}function htmlRemove$1(){this.innerHTML=""}function htmlConstant$1(t){return function(){this.innerHTML=t}}function htmlFunction$1(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function selection_html$1(t){return arguments.length?this.each(null==t?htmlRemove$1:("function"==typeof t?htmlFunction$1:htmlConstant$1)(t)):this.node().innerHTML}function raise$1(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise$1(){return this.each(raise$1)}function lower$1(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower$1(){return this.each(lower$1)}function selection_append$1(t){var e="function"==typeof t?t:creator$1(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))}function constantNull$1(){return null}function selection_insert$1(t,e){var n="function"==typeof t?t:creator$1(t),r=null==e?constantNull$1:"function"==typeof e?e:selector$1(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))}function remove$3(){var t=this.parentNode;t&&t.removeChild(this)}function selection_remove$1(){return this.each(remove$3)}function selection_cloneShallow$1(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_cloneDeep$1(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_clone$1(t){return this.select(t?selection_cloneDeep$1:selection_cloneShallow$1)}function selection_datum$1(t){return arguments.length?this.property("__data__",t):this.node().__data__}function contextListener$1(t){return function(e){t.call(this,e,this.__data__)}}function parseTypenames$2(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function onRemove$1(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function onAdd$1(t,e,n){return function(){var r,i=this.__on,o=contextListener$1(e);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function selection_on$1(t,e,n){var r,i,o=parseTypenames$2(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?onAdd$1:onRemove$1,r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value}function dispatchEvent$1(t,e,n){var r=defaultView$1(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dispatchConstant$1(t,e){return function(){return dispatchEvent$1(this,t,e)}}function dispatchFunction$1(t,e){return function(){return dispatchEvent$1(this,t,e.apply(this,arguments))}}function selection_dispatch$1(t,e){return this.each(("function"==typeof e?dispatchFunction$1:dispatchConstant$1)(t,e))}function*selection_iterator(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}EnterNode$1.prototype={constructor:EnterNode$1,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},ClassList$1.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var root$3=[null];function Selection$4(t,e){this._groups=t,this._parents=e}function selection$2(){return new Selection$4([[document.documentElement]],root$3)}function selection_selection(){return this}function select$1(t){return"string"==typeof t?new Selection$4([[document.querySelector(t)]],[document.documentElement]):new Selection$4([[t]],root$3)}function sourceEvent$1(t){let e;for(;e=t.sourceEvent;)t=e;return t}function pointer(t,e){if(t=sourceEvent$1(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function selectAll$1(t){return"string"==typeof t?new Selection$4([document.querySelectorAll(t)],[document.documentElement]):new Selection$4([array$7(t)],root$3)}Selection$4.prototype=selection$2.prototype={constructor:Selection$4,select:selection_select$1,selectAll:selection_selectAll$1,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter$1,data:selection_data$1,enter:selection_enter$1,exit:selection_exit$1,join:selection_join$1,merge:selection_merge$1,selection:selection_selection,order:selection_order$1,sort:selection_sort$1,call:selection_call$1,nodes:selection_nodes$1,node:selection_node$1,size:selection_size$1,empty:selection_empty$1,each:selection_each$1,attr:selection_attr$1,style:selection_style$1,property:selection_property$1,classed:selection_classed$1,text:selection_text$1,html:selection_html$1,raise:selection_raise$1,lower:selection_lower$1,append:selection_append$1,insert:selection_insert$1,remove:selection_remove$1,clone:selection_clone$1,datum:selection_datum$1,on:selection_on$1,dispatch:selection_dispatch$1,[Symbol.iterator]:selection_iterator};const nonpassivecapture={capture:!0,passive:!1};function noevent$4(t){t.preventDefault(),t.stopImmediatePropagation()}function dragDisable$1(t){var e=t.document.documentElement,n=select$1(t).on("dragstart.drag",noevent$4,nonpassivecapture);"onselectstart"in e?n.on("selectstart.drag",noevent$4,nonpassivecapture):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function yesdrag$1(t,e){var n=t.document.documentElement,r=select$1(t).on("dragstart.drag",null);e&&(r.on("click.drag",noevent$4,nonpassivecapture),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function define$1(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function extend$1(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Color$2(){}var darker$1=.7,brighter$1=1/darker$1,reI$1="\\s*([+-]?\\d+)\\s*",reN$1="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP$1="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex$1=/^#([0-9a-f]{3,8})$/,reRgbInteger$1=new RegExp("^rgb\\("+[reI$1,reI$1,reI$1]+"\\)$"),reRgbPercent$1=new RegExp("^rgb\\("+[reP$1,reP$1,reP$1]+"\\)$"),reRgbaInteger$1=new RegExp("^rgba\\("+[reI$1,reI$1,reI$1,reN$1]+"\\)$"),reRgbaPercent$1=new RegExp("^rgba\\("+[reP$1,reP$1,reP$1,reN$1]+"\\)$"),reHslPercent$1=new RegExp("^hsl\\("+[reN$1,reP$1,reP$1]+"\\)$"),reHslaPercent$1=new RegExp("^hsla\\("+[reN$1,reP$1,reP$1,reN$1]+"\\)$"),named$1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex$1(){return this.rgb().formatHex()}function color_formatHsl$1(){return hslConvert$1(this).formatHsl()}function color_formatRgb$1(){return this.rgb().formatRgb()}function color$1(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=reHex$1.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?rgbn$1(e):3===n?new Rgb$1(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?rgba$1(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?rgba$1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=reRgbInteger$1.exec(t))?new Rgb$1(e[1],e[2],e[3],1):(e=reRgbPercent$1.exec(t))?new Rgb$1(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=reRgbaInteger$1.exec(t))?rgba$1(e[1],e[2],e[3],e[4]):(e=reRgbaPercent$1.exec(t))?rgba$1(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=reHslPercent$1.exec(t))?hsla$1(e[1],e[2]/100,e[3]/100,1):(e=reHslaPercent$1.exec(t))?hsla$1(e[1],e[2]/100,e[3]/100,e[4]):named$1.hasOwnProperty(t)?rgbn$1(named$1[t]):"transparent"===t?new Rgb$1(NaN,NaN,NaN,0):null}function rgbn$1(t){return new Rgb$1(t>>16&255,t>>8&255,255&t,1)}function rgba$1(t,e,n,r){return r<=0&&(t=e=n=NaN),new Rgb$1(t,e,n,r)}function rgbConvert$1(t){return t instanceof Color$2||(t=color$1(t)),t?new Rgb$1((t=t.rgb()).r,t.g,t.b,t.opacity):new Rgb$1}function rgb$1(t,e,n,r){return 1===arguments.length?rgbConvert$1(t):new Rgb$1(t,e,n,null==r?1:r)}function Rgb$1(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function rgb_formatHex$1(){return"#"+hex$1(this.r)+hex$1(this.g)+hex$1(this.b)}function rgb_formatRgb$1(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function hex$1(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function hsla$1(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Hsl$1(t,e,n,r)}function hslConvert$1(t){if(t instanceof Hsl$1)return new Hsl$1(t.h,t.s,t.l,t.opacity);if(t instanceof Color$2||(t=color$1(t)),!t)return new Hsl$1;if(t instanceof Hsl$1)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Hsl$1(s,a,l,t.opacity)}function hsl$3(t,e,n,r){return 1===arguments.length?hslConvert$1(t):new Hsl$1(t,e,n,null==r?1:r)}function Hsl$1(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function hsl2rgb$1(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}define$1(Color$2,color$1,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:color_formatHex$1,formatHex:color_formatHex$1,formatHsl:color_formatHsl$1,formatRgb:color_formatRgb$1,toString:color_formatRgb$1}),define$1(Rgb$1,rgb$1,extend$1(Color$2,{brighter:function(t){return t=null==t?brighter$1:Math.pow(brighter$1,t),new Rgb$1(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?darker$1:Math.pow(darker$1,t),new Rgb$1(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex$1,formatHex:rgb_formatHex$1,formatRgb:rgb_formatRgb$1,toString:rgb_formatRgb$1})),define$1(Hsl$1,hsl$3,extend$1(Color$2,{brighter:function(t){return t=null==t?brighter$1:Math.pow(brighter$1,t),new Hsl$1(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?darker$1:Math.pow(darker$1,t),new Hsl$1(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Rgb$1(hsl2rgb$1(t>=240?t-240:t+120,i,r),hsl2rgb$1(t,i,r),hsl2rgb$1(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const constant$g=t=>()=>t;function linear$3(t,e){return function(n){return t+n*e}}function exponential$2(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function gamma$1(t){return 1==(t=+t)?nogamma$1:function(e,n){return n-e?exponential$2(e,n,t):constant$g(isNaN(e)?n:e)}}function nogamma$1(t,e){var n=e-t;return n?linear$3(t,n):constant$g(isNaN(t)?e:t)}const interpolateRgb$1=function t(e){var n=gamma$1(e);function r(t,e){var r=n((t=rgb$1(t)).r,(e=rgb$1(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=nogamma$1(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function interpolateNumber$1(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var reA$1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB$1=new RegExp(reA$1.source,"g");function zero$1(t){return function(){return t}}function one$1(t){return function(e){return t(e)+""}}function interpolateString$1(t,e){var n,r,i,o=reA$1.lastIndex=reB$1.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=reA$1.exec(t))&&(r=reB$1.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:interpolateNumber$1(n,r)})),o=reB$1.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?one$1(l[0].x):zero$1(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}var degrees$2=180/Math.PI,identity$c={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},svgNode$1;function decompose$1(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*degrees$2,skewX:Math.atan(l)*degrees$2,scaleX:s,scaleY:a}}function parseCss$1(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?identity$c:decompose$1(e.a,e.b,e.c,e.d,e.e,e.f)}function parseSvg$1(t){return null==t?identity$c:(svgNode$1||(svgNode$1=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode$1.setAttribute("transform",t),(t=svgNode$1.transform.baseVal.consolidate())?decompose$1((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):identity$c)}function interpolateTransform$1(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:interpolateNumber$1(t,i)},{i:l-2,x:interpolateNumber$1(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:interpolateNumber$1(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:interpolateNumber$1(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,l),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:interpolateNumber$1(t,n)},{i:a-2,x:interpolateNumber$1(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var interpolateTransformCss$1=interpolateTransform$1(parseCss$1,"px, ","px)","deg)"),interpolateTransformSvg$1=interpolateTransform$1(parseSvg$1,", ",")",")"),epsilon2$3=1e-12;function cosh$1(t){return((t=Math.exp(t))+1/t)/2}function sinh$1(t){return((t=Math.exp(t))-1/t)/2}function tanh$1(t){return((t=Math.exp(2*t))-1)/(t+1)}const interpolateZoom$1=function t(e,n,r){function i(t,i){var o,s,a=t[0],l=t[1],c=t[2],u=i[2],h=i[0]-a,d=i[1]-l,f=h*h+d*d;if(f<epsilon2$3)s=Math.log(u/c)/e,o=function(t){return[a+t*h,l+t*d,c*Math.exp(e*t*s)]};else{var p=Math.sqrt(f),g=(u*u-c*c+r*f)/(2*c*n*p),m=(u*u-c*c-r*f)/(2*u*n*p),A=Math.log(Math.sqrt(g*g+1)-g),y=Math.log(Math.sqrt(m*m+1)-m);s=(y-A)/e,o=function(t){var r=t*s,i=cosh$1(A),o=c/(n*p)*(i*tanh$1(e*r+A)-sinh$1(A));return[a+o*h,l+o*d,c*i/cosh$1(e*r+A)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);var frame$1=0,timeout$3=0,interval$2=0,pokeDelay$1=1e3,taskHead$1,taskTail$1,clockLast$1=0,clockNow$1=0,clockSkew$1=0,clock$1="object"==typeof performance&&performance.now?performance:Date,setFrame$1="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now$3(){return clockNow$1||(setFrame$1(clearNow$1),clockNow$1=clock$1.now()+clockSkew$1)}function clearNow$1(){clockNow$1=0}function Timer$1(){this._call=this._time=this._next=null}function timer$1(t,e,n){var r=new Timer$1;return r.restart(t,e,n),r}function timerFlush$1(){now$3(),++frame$1;for(var t,e=taskHead$1;e;)(t=clockNow$1-e._time)>=0&&e._call.call(void 0,t),e=e._next;--frame$1}function wake$1(){clockNow$1=(clockLast$1=clock$1.now())+clockSkew$1,frame$1=timeout$3=0;try{timerFlush$1()}finally{frame$1=0,nap$1(),clockNow$1=0}}function poke$1(){var t=clock$1.now(),e=t-clockLast$1;e>pokeDelay$1&&(clockSkew$1-=e,clockLast$1=t)}function nap$1(){for(var t,e,n=taskHead$1,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:taskHead$1=e);taskTail$1=t,sleep$1(r)}function sleep$1(t){frame$1||(timeout$3&&(timeout$3=clearTimeout(timeout$3)),t-clockNow$1>24?(t<1/0&&(timeout$3=setTimeout(wake$1,t-clock$1.now()-clockSkew$1)),interval$2&&(interval$2=clearInterval(interval$2))):(interval$2||(clockLast$1=clock$1.now(),interval$2=setInterval(poke$1,pokeDelay$1)),frame$1=1,setFrame$1(wake$1)))}function timeout$2(t,e,n){var r=new Timer$1;return r.restart((n=>{r.stop(),t(n+e)}),e=null==e?0:+e,n),r}Timer$1.prototype=timer$1.prototype={constructor:Timer$1,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?now$3():+n)+(null==e?0:+e),this._next||taskTail$1===this||(taskTail$1?taskTail$1._next=this:taskHead$1=this,taskTail$1=this),this._call=t,this._time=n,sleep$1()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep$1())}};var emptyOn$1=dispatch$1("start","end","cancel","interrupt"),emptyTween$1=[],CREATED$1=0,SCHEDULED$1=1,STARTING$1=2,STARTED$1=3,RUNNING$1=4,ENDING$1=5,ENDED$1=6;function schedule$1(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};create$3(t,n,{name:e,index:r,group:i,on:emptyOn$1,tween:emptyTween$1,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:CREATED$1})}function init$1(t,e){var n=get$3(t,e);if(n.state>CREATED$1)throw new Error("too late; already scheduled");return n}function set$4(t,e){var n=get$3(t,e);if(n.state>STARTED$1)throw new Error("too late; already running");return n}function get$3(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function create$3(t,e,n){var r,i=t.__transition;function o(l){var c,u,h,d;if(n.state!==SCHEDULED$1)return a();for(c in i)if((d=i[c]).name===n.name){if(d.state===STARTED$1)return timeout$2(o);d.state===RUNNING$1?(d.state=ENDED$1,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<e&&(d.state=ENDED$1,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(timeout$2((function(){n.state===STARTED$1&&(n.state=RUNNING$1,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=STARTING$1,n.on.call("start",t,t.__data__,n.index,n.group),n.state===STARTING$1){for(n.state=STARTED$1,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=ENDING$1,1),o=-1,s=r.length;++o<s;)r[o].call(t,i);n.state===ENDING$1&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=ENDED$1,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=timer$1((function(t){n.state=SCHEDULED$1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}function interrupt$1(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>STARTING$1&&n.state<ENDING$1,n.state=ENDED$1,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}}function selection_interrupt$1(t){return this.each((function(){interrupt$1(this,t)}))}function tweenRemove$1(t,e){var n,r;return function(){var i=set$4(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function tweenFunction$1(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=set$4(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function transition_tween$1(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=get$3(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?tweenRemove$1:tweenFunction$1)(n,t,e))}function tweenValue$1(t,e,n){var r=t._id;return t.each((function(){var t=set$4(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return get$3(t,r).value[e]}}function interpolate$2(t,e){var n;return("number"==typeof e?interpolateNumber$1:e instanceof color$1?interpolateRgb$1:(n=color$1(e))?(e=n,interpolateRgb$1):interpolateString$1)(t,e)}function attrRemove$2(t){return function(){this.removeAttribute(t)}}function attrRemoveNS$2(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant$2(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function attrConstantNS$2(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function attrFunction$2(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttribute(t)}}function attrFunctionNS$2(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function transition_attr$1(t,e){var n=namespace$1(t),r="transform"===n?interpolateTransformSvg$1:interpolate$2;return this.attrTween(t,"function"==typeof e?(n.local?attrFunctionNS$2:attrFunction$2)(n,r,tweenValue$1(this,"attr."+t,e)):null==e?(n.local?attrRemoveNS$2:attrRemove$2)(n):(n.local?attrConstantNS$2:attrConstant$2)(n,r,e))}function attrInterpolate$1(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function attrInterpolateNS$1(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function attrTweenNS$1(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&attrInterpolateNS$1(t,i)),n}return i._value=e,i}function attrTween$1(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&attrInterpolate$1(t,i)),n}return i._value=e,i}function transition_attrTween$1(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=namespace$1(t);return this.tween(n,(r.local?attrTweenNS$1:attrTween$1)(r,e))}function delayFunction$1(t,e){return function(){init$1(this,t).delay=+e.apply(this,arguments)}}function delayConstant$1(t,e){return e=+e,function(){init$1(this,t).delay=e}}function transition_delay$1(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?delayFunction$1:delayConstant$1)(e,t)):get$3(this.node(),e).delay}function durationFunction$1(t,e){return function(){set$4(this,t).duration=+e.apply(this,arguments)}}function durationConstant$1(t,e){return e=+e,function(){set$4(this,t).duration=e}}function transition_duration$1(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?durationFunction$1:durationConstant$1)(e,t)):get$3(this.node(),e).duration}function easeConstant$1(t,e){if("function"!=typeof e)throw new Error;return function(){set$4(this,t).ease=e}}function transition_ease$1(t){var e=this._id;return arguments.length?this.each(easeConstant$1(e,t)):get$3(this.node(),e).ease}function easeVarying(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;set$4(this,t).ease=n}}function transition_easeVarying(t){if("function"!=typeof t)throw new Error;return this.each(easeVarying(this._id,t))}function transition_filter$1(t){"function"!=typeof t&&(t=matcher$1(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Transition$1(r,this._parents,this._name,this._id)}function transition_merge$1(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),s=0;s<i;++s)for(var a,l=e[s],c=n[s],u=l.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=l[d]||c[d])&&(h[d]=a);for(;s<r;++s)o[s]=e[s];return new Transition$1(o,this._parents,this._name,this._id)}function start$1(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}function onFunction$1(t,e,n){var r,i,o=start$1(e)?init$1:set$4;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}function transition_on$1(t,e){var n=this._id;return arguments.length<2?get$3(this.node(),n).on.on(t):this.each(onFunction$1(n,t,e))}function removeFunction$1(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function transition_remove$1(){return this.on("end.remove",removeFunction$1(this._id))}function transition_select$1(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=selector$1(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,c=r[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,schedule$1(h[d],e,n,d,h,get$3(a,n)));return new Transition$1(o,this._parents,e,n)}function transition_selectAll$1(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=selectorAll$1(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,c=r[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=t.call(l,l.__data__,h,c),p=get$3(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&schedule$1(d,e,n,g,f,p);o.push(f),s.push(l)}return new Transition$1(o,s,e,n)}var Selection$3=selection$2.prototype.constructor;function transition_selection$1(){return new Selection$3(this._groups,this._parents)}function styleNull$1(t,e){var n,r,i;return function(){var o=styleValue$1(this,t),s=(this.style.removeProperty(t),styleValue$1(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function styleRemove$2(t){return function(){this.style.removeProperty(t)}}function styleConstant$2(t,e,n){var r,i,o=n+"";return function(){var s=styleValue$1(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}function styleFunction$2(t,e,n){var r,i,o;return function(){var s=styleValue$1(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=styleValue$1(this,t)),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a))}}function styleMaybeRemove$1(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var l=set$4(this,t),c=l.on,u=null==l.value[s]?o||(o=styleRemove$2(e)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}function transition_style$1(t,e,n){var r="transform"==(t+="")?interpolateTransformCss$1:interpolate$2;return null==e?this.styleTween(t,styleNull$1(t,r)).on("end.style."+t,styleRemove$2(t)):"function"==typeof e?this.styleTween(t,styleFunction$2(t,r,tweenValue$1(this,"style."+t,e))).each(styleMaybeRemove$1(this._id,t)):this.styleTween(t,styleConstant$2(t,r,e),n).on("end.style."+t,null)}function styleInterpolate$1(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function styleTween$1(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&styleInterpolate$1(t,o,n)),r}return o._value=e,o}function transition_styleTween$1(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,styleTween$1(t,e,null==n?"":n))}function textConstant$2(t){return function(){this.textContent=t}}function textFunction$2(t){return function(){var e=t(this);this.textContent=null==e?"":e}}function transition_text$1(t){return this.tween("text","function"==typeof t?textFunction$2(tweenValue$1(this,"text",t)):textConstant$2(null==t?"":t+""))}function textInterpolate$1(t){return function(e){this.textContent=t.call(this,e)}}function textTween$1(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&textInterpolate$1(r)),e}return r._value=t,r}function transition_textTween$1(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,textTween$1(t))}function transition_transition$1(){for(var t=this._name,e=this._id,n=newId$1(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=get$3(s,e);schedule$1(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Transition$1(r,this._parents,t,n)}function transition_end$1(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=set$4(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===i&&o()}))}var id$1=0;function Transition$1(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function newId$1(){return++id$1}var selection_prototype$1=selection$2.prototype;function cubicInOut$1(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Transition$1.prototype={constructor:Transition$1,select:transition_select$1,selectAll:transition_selectAll$1,selectChild:selection_prototype$1.selectChild,selectChildren:selection_prototype$1.selectChildren,filter:transition_filter$1,merge:transition_merge$1,selection:transition_selection$1,transition:transition_transition$1,call:selection_prototype$1.call,nodes:selection_prototype$1.nodes,node:selection_prototype$1.node,size:selection_prototype$1.size,empty:selection_prototype$1.empty,each:selection_prototype$1.each,on:transition_on$1,attr:transition_attr$1,attrTween:transition_attrTween$1,style:transition_style$1,styleTween:transition_styleTween$1,text:transition_text$1,textTween:transition_textTween$1,remove:transition_remove$1,tween:transition_tween$1,delay:transition_delay$1,duration:transition_duration$1,ease:transition_ease$1,easeVarying:transition_easeVarying,end:transition_end$1,[Symbol.iterator]:selection_prototype$1[Symbol.iterator]};var defaultTiming$1={time:null,delay:0,duration:250,ease:cubicInOut$1};function inherit$2(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function selection_transition$1(t){var e,n;t instanceof Transition$1?(e=t._id,t=t._name):(e=newId$1(),(n=defaultTiming$1).time=now$3(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&schedule$1(s,t,e,c,a,n||inherit$2(s,e));return new Transition$1(r,this._parents,t,e)}selection$2.prototype.interrupt=selection_interrupt$1,selection$2.prototype.transition=selection_transition$1;const constant$f=t=>()=>t;function ZoomEvent$1(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Transform$2(t,e,n){this.k=t,this.x=e,this.y=n}Transform$2.prototype={constructor:Transform$2,scale:function(t){return 1===t?this:new Transform$2(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Transform$2(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity$b=new Transform$2(1,0,0);function nopropagation$3(t){t.stopImmediatePropagation()}function noevent$3(t){t.preventDefault(),t.stopImmediatePropagation()}function defaultFilter$3(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function defaultExtent$2(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function defaultTransform$1(){return this.__zoom||identity$b}function defaultWheelDelta$1(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function defaultTouchable$3(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain$1(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function zoom$1(){var t,e,n,r=defaultFilter$3,i=defaultExtent$2,o=defaultConstrain$1,s=defaultWheelDelta$1,a=defaultTouchable$3,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,h=interpolateZoom$1,d=dispatch$1("start","zoom","end"),f=500,p=0,g=10;function m(t){t.property("__zoom",defaultTransform$1).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",_).filter(a).on("touchstart.zoom",P).on("touchmove.zoom",S).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function A(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new Transform$2(e,t.x,t.y)}function y(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new Transform$2(t.k,r,i)}function v(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n,r){t.on("start.zoom",(function(){x(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,s=x(t,o).event(r),a=i.apply(t,o),l=null==n?v(a):"function"==typeof n?n.apply(t,o):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=t.__zoom,d="function"==typeof e?e.apply(t,o):e,f=h(u.invert(l).concat(c/u.k),d.invert(l).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=f(t),n=c/e[2];t=new Transform$2(n,l[0]-e[0]*n,l[1]-e[1]*n)}s.zoom(null,t)}}))}function x(t,e,n){return!n&&t.__zooming||new w(t,e)}function w(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function C(t,...e){if(r.apply(this,arguments)){var n=x(this,e).event(t),i=this.__zoom,a=Math.max(l[0],Math.min(l[1],i.k*Math.pow(2,s.apply(this,arguments)))),u=pointer(t);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=i.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(i.k===a)return;n.mouse=[u,i.invert(u)],interrupt$1(this),n.start()}noevent$3(t),n.wheel=setTimeout(h,150),n.zoom("mouse",o(y(A(i,a),n.mouse[0],n.mouse[1]),n.extent,c))}function h(){n.wheel=null,n.end()}}function $(t,...e){if(!n&&r.apply(this,arguments)){var i=t.currentTarget,s=x(this,e,!0).event(t),a=select$1(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",f,!0),l=pointer(t,i),u=t.clientX,h=t.clientY;dragDisable$1(t.view),nopropagation$3(t),s.mouse=[l,this.__zoom.invert(l)],interrupt$1(this),s.start()}function d(t){if(noevent$3(t),!s.moved){var e=t.clientX-u,n=t.clientY-h;s.moved=e*e+n*n>p}s.event(t).zoom("mouse",o(y(s.that.__zoom,s.mouse[0]=pointer(t,i),s.mouse[1]),s.extent,c))}function f(t){a.on("mousemove.zoom mouseup.zoom",null),yesdrag$1(t.view,s.moved),noevent$3(t),s.event(t).end()}}function _(t,...e){if(r.apply(this,arguments)){var n=this.__zoom,s=pointer(t.changedTouches?t.changedTouches[0]:t,this),a=n.invert(s),l=n.k*(t.shiftKey?.5:2),h=o(y(A(n,l),s,a),i.apply(this,e),c);noevent$3(t),u>0?select$1(this).transition().duration(u).call(b,h,s,t):select$1(this).call(m.transform,h,s,t)}}function P(n,...i){if(r.apply(this,arguments)){var o,s,a,l,c=n.touches,u=c.length,h=x(this,i,n.changedTouches.length===u).event(n);for(nopropagation$3(n),s=0;s<u;++s)l=[l=pointer(a=c[s],this),this.__zoom.invert(l),a.identifier],h.touch0?h.touch1||h.touch0[2]===l[2]||(h.touch1=l,h.taps=0):(h.touch0=l,o=!0,h.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(h.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),f)),interrupt$1(this),h.start())}}function S(t,...e){if(this.__zooming){var n,r,i,s,a=x(this,e).event(t),l=t.changedTouches,u=l.length;for(noevent$3(t),n=0;n<u;++n)i=pointer(r=l[n],this),a.touch0&&a.touch0[2]===r.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===r.identifier&&(a.touch1[0]=i);if(r=a.that.__zoom,a.touch1){var h=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],g=(g=f[0]-h[0])*g+(g=f[1]-h[1])*g,m=(m=p[0]-d[0])*m+(m=p[1]-d[1])*m;r=A(r,Math.sqrt(g/m)),i=[(h[0]+f[0])/2,(h[1]+f[1])/2],s=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(y(r,i,s),a.extent,c))}}function M(t,...r){if(this.__zooming){var i,o,s=x(this,r).event(t),a=t.changedTouches,l=a.length;for(nopropagation$3(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),f),i=0;i<l;++i)o=a[i],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=pointer(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<g)){var c=select$1(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return m.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",defaultTransform$1),t!==i?b(t,e,n,r):i.interrupt().each((function(){x(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,n,r){m.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n,r)},m.scaleTo=function(t,e,n,r){m.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,s=null==n?v(t):"function"==typeof n?n.apply(this,arguments):n,a=r.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return o(y(A(r,l),s,a),t,c)}),n,r)},m.translateBy=function(t,e,n,r){m.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}),null,r)},m.translateTo=function(t,e,n,r,s){m.transform(t,(function(){var t=i.apply(this,arguments),s=this.__zoom,a=null==r?v(t):"function"==typeof r?r.apply(this,arguments):r;return o(identity$b.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),r,s)},w.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=select$1(this.that).datum();d.call(t,this.that,new ZoomEvent$1(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:d}),e)}},m.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:constant$f(+t),m):s},m.filter=function(t){return arguments.length?(r="function"==typeof t?t:constant$f(!!t),m):r},m.touchable=function(t){return arguments.length?(a="function"==typeof t?t:constant$f(!!t),m):a},m.extent=function(t){return arguments.length?(i="function"==typeof t?t:constant$f([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):i},m.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],m):[l[0],l[1]]},m.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(t){return arguments.length?(o=t,m):o},m.duration=function(t){return arguments.length?(u=+t,m):u},m.interpolate=function(t){return arguments.length?(h=t,m):h},m.on=function(){var t=d.on.apply(d,arguments);return t===d?m:t},m.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,m):Math.sqrt(p)},m.tapDistance=function(t){return arguments.length?(g=+t,m):g},m}function copyObject$1(t,e,n,r){var i=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],l=r?r(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),i?_baseAssignValue(n,a,l):_assignValue(n,a,l)}return n}var _copyObject=copyObject$1;function baseAssign$1(t,e){return t&&_copyObject(e,keys_1(e),t)}var _baseAssign=baseAssign$1;function nativeKeysIn$1(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}var _nativeKeysIn=nativeKeysIn$1,objectProto$y=Object.prototype,hasOwnProperty$u=objectProto$y.hasOwnProperty;function baseKeysIn$1(t){if(!isObject_1(t))return _nativeKeysIn(t);var e=_isPrototype(t),n=[];for(var r in t)("constructor"!=r||!e&&hasOwnProperty$u.call(t,r))&&n.push(r);return n}var _baseKeysIn=baseKeysIn$1;function keysIn$1(t){return isArrayLike_1(t)?_arrayLikeKeys(t,!0):_baseKeysIn(t)}var keysIn_1=keysIn$1;function baseAssignIn$1(t,e){return t&&_copyObject(e,keysIn_1(e),t)}var _baseAssignIn=baseAssignIn$1,_cloneBuffer=createCommonjsModule((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n?_root.Buffer:void 0,o=i?i.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=o?o(n):new t.constructor(n);return t.copy(r),r}}));function copySymbols$1(t,e){return _copyObject(t,_getSymbols(t),e)}var _copySymbols=copySymbols$1,getPrototype$1=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype$1,nativeGetSymbols$2=Object.getOwnPropertySymbols,getSymbolsIn$1=nativeGetSymbols$2?function(t){for(var e=[];t;)_arrayPush(e,_getSymbols(t)),t=_getPrototype(t);return e}:stubArray_1,_getSymbolsIn=getSymbolsIn$1;function copySymbolsIn$1(t,e){return _copyObject(t,_getSymbolsIn(t),e)}var _copySymbolsIn=copySymbolsIn$1;function getAllKeysIn$1(t){return _baseGetAllKeys(t,keysIn_1,_getSymbolsIn)}var _getAllKeysIn=getAllKeysIn$1,objectProto$x=Object.prototype,hasOwnProperty$t=objectProto$x.hasOwnProperty;function initCloneArray$1(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&hasOwnProperty$t.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var _initCloneArray=initCloneArray$1;function cloneArrayBuffer$1(t){var e=new t.constructor(t.byteLength);return new _Uint8Array(e).set(new _Uint8Array(t)),e}var _cloneArrayBuffer=cloneArrayBuffer$1;function cloneDataView$1(t,e){var n=e?_cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var _cloneDataView=cloneDataView$1,reFlags$2=/\w*$/;function cloneRegExp$1(t){var e=new t.constructor(t.source,reFlags$2.exec(t));return e.lastIndex=t.lastIndex,e}var _cloneRegExp=cloneRegExp$1,symbolProto$3=_Symbol?_Symbol.prototype:void 0,symbolValueOf$2=symbolProto$3?symbolProto$3.valueOf:void 0;function cloneSymbol$1(t){return symbolValueOf$2?Object(symbolValueOf$2.call(t)):{}}var _cloneSymbol=cloneSymbol$1;function cloneTypedArray$1(t,e){var n=e?_cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var _cloneTypedArray=cloneTypedArray$1,boolTag$6="[object Boolean]",dateTag$6="[object Date]",mapTag$d="[object Map]",numberTag$6="[object Number]",regexpTag$6="[object RegExp]",setTag$d="[object Set]",stringTag$6="[object String]",symbolTag$5="[object Symbol]",arrayBufferTag$6="[object ArrayBuffer]",dataViewTag$6="[object DataView]",float32Tag$4="[object Float32Array]",float64Tag$4="[object Float64Array]",int8Tag$4="[object Int8Array]",int16Tag$4="[object Int16Array]",int32Tag$4="[object Int32Array]",uint8Tag$4="[object Uint8Array]",uint8ClampedTag$4="[object Uint8ClampedArray]",uint16Tag$4="[object Uint16Array]",uint32Tag$4="[object Uint32Array]";function initCloneByTag$1(t,e,n){var r=t.constructor;switch(e){case arrayBufferTag$6:return _cloneArrayBuffer(t);case boolTag$6:case dateTag$6:return new r(+t);case dataViewTag$6:return _cloneDataView(t,n);case float32Tag$4:case float64Tag$4:case int8Tag$4:case int16Tag$4:case int32Tag$4:case uint8Tag$4:case uint8ClampedTag$4:case uint16Tag$4:case uint32Tag$4:return _cloneTypedArray(t,n);case mapTag$d:return new r;case numberTag$6:case stringTag$6:return new r(t);case regexpTag$6:return _cloneRegExp(t);case setTag$d:return new r;case symbolTag$5:return _cloneSymbol(t)}}var _initCloneByTag=initCloneByTag$1,objectCreate$1=Object.create,baseCreate$1=function(){function t(){}return function(e){if(!isObject_1(e))return{};if(objectCreate$1)return objectCreate$1(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),_baseCreate=baseCreate$1;function initCloneObject$1(t){return"function"!=typeof t.constructor||_isPrototype(t)?{}:_baseCreate(_getPrototype(t))}var _initCloneObject=initCloneObject$1,mapTag$c="[object Map]";function baseIsMap$1(t){return isObjectLike_1(t)&&_getTag(t)==mapTag$c}var _baseIsMap=baseIsMap$1,nodeIsMap$1=_nodeUtil&&_nodeUtil.isMap,isMap$1=nodeIsMap$1?_baseUnary(nodeIsMap$1):_baseIsMap,isMap_1=isMap$1,setTag$c="[object Set]";function baseIsSet$1(t){return isObjectLike_1(t)&&_getTag(t)==setTag$c}var _baseIsSet=baseIsSet$1,nodeIsSet$1=_nodeUtil&&_nodeUtil.isSet,isSet$1=nodeIsSet$1?_baseUnary(nodeIsSet$1):_baseIsSet,isSet_1=isSet$1,CLONE_DEEP_FLAG$9=1,CLONE_FLAT_FLAG$2=2,CLONE_SYMBOLS_FLAG$8=4,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",boolTag$5="[object Boolean]",dateTag$5="[object Date]",errorTag$4="[object Error]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",mapTag$b="[object Map]",numberTag$5="[object Number]",objectTag$6="[object Object]",regexpTag$5="[object RegExp]",setTag$b="[object Set]",stringTag$5="[object String]",symbolTag$4="[object Symbol]",weakMapTag$4="[object WeakMap]",arrayBufferTag$5="[object ArrayBuffer]",dataViewTag$5="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",cloneableTags$1={};function baseClone$1(t,e,n,r,i,o){var s,a=e&CLONE_DEEP_FLAG$9,l=e&CLONE_FLAT_FLAG$2,c=e&CLONE_SYMBOLS_FLAG$8;if(n&&(s=i?n(t,r,i,o):n(t)),void 0!==s)return s;if(!isObject_1(t))return t;var u=isArray_1(t);if(u){if(s=_initCloneArray(t),!a)return _copyArray(t,s)}else{var h=_getTag(t),d=h==funcTag$3||h==genTag$2;if(isBuffer_1(t))return _cloneBuffer(t,a);if(h==objectTag$6||h==argsTag$4||d&&!i){if(s=l||d?{}:_initCloneObject(t),!a)return l?_copySymbolsIn(t,_baseAssignIn(s,t)):_copySymbols(t,_baseAssign(s,t))}else{if(!cloneableTags$1[h])return i?t:{};s=_initCloneByTag(t,h,a)}}o||(o=new _Stack);var f=o.get(t);if(f)return f;o.set(t,s),isSet_1(t)?t.forEach((function(r){s.add(baseClone$1(r,e,n,r,t,o))})):isMap_1(t)&&t.forEach((function(r,i){s.set(i,baseClone$1(r,e,n,i,t,o))}));var p=u?void 0:(c?l?_getAllKeysIn:_getAllKeys:l?keysIn_1:keys_1)(t);return _arrayEach(p||t,(function(r,i){p&&(r=t[i=r]),_assignValue(s,i,baseClone$1(r,e,n,i,t,o))})),s}cloneableTags$1[argsTag$4]=cloneableTags$1[arrayTag$3]=cloneableTags$1[arrayBufferTag$5]=cloneableTags$1[dataViewTag$5]=cloneableTags$1[boolTag$5]=cloneableTags$1[dateTag$5]=cloneableTags$1[float32Tag$3]=cloneableTags$1[float64Tag$3]=cloneableTags$1[int8Tag$3]=cloneableTags$1[int16Tag$3]=cloneableTags$1[int32Tag$3]=cloneableTags$1[mapTag$b]=cloneableTags$1[numberTag$5]=cloneableTags$1[objectTag$6]=cloneableTags$1[regexpTag$5]=cloneableTags$1[setTag$b]=cloneableTags$1[stringTag$5]=cloneableTags$1[symbolTag$4]=cloneableTags$1[uint8Tag$3]=cloneableTags$1[uint8ClampedTag$3]=cloneableTags$1[uint16Tag$3]=cloneableTags$1[uint32Tag$3]=!0,cloneableTags$1[errorTag$4]=cloneableTags$1[funcTag$3]=cloneableTags$1[weakMapTag$4]=!1;var _baseClone=baseClone$1,CLONE_SYMBOLS_FLAG$7=4;function clone$1(t){return _baseClone(t,CLONE_SYMBOLS_FLAG$7)}var clone_1=clone$1,objectProto$w=Object.prototype,hasOwnProperty$s=objectProto$w.hasOwnProperty;function baseHas$1(t,e){return null!=t&&hasOwnProperty$s.call(t,e)}var _baseHas=baseHas$1;function has$1(t,e){return null!=t&&_hasPath(t,e,_baseHas)}var has_1=has$1,mapTag$a="[object Map]",setTag$a="[object Set]",objectProto$v=Object.prototype,hasOwnProperty$r=objectProto$v.hasOwnProperty;function isEmpty$1(t){if(null==t)return!0;if(isArrayLike_1(t)&&(isArray_1(t)||"string"==typeof t||"function"==typeof t.splice||isBuffer_1(t)||isTypedArray_1(t)||isArguments_1(t)))return!t.length;var e=_getTag(t);if(e==mapTag$a||e==setTag$a)return!t.size;if(_isPrototype(t))return!_baseKeys(t).length;for(var n in t)if(hasOwnProperty$r.call(t,n))return!1;return!0}var isEmpty_1=isEmpty$1;function isUndefined$1(t){return void 0===t}var isUndefined_1=isUndefined$1;function transform$4(t,e,n){var r=isArray_1(t),i=r||isBuffer_1(t)||isTypedArray_1(t);if(e=_baseIteratee(e),null==n){var o=t&&t.constructor;n=i?r?new o:[]:isObject_1(t)&&isFunction_1(o)?_baseCreate(_getPrototype(t)):{}}return(i?_arrayEach:_baseForOwn)(t,(function(t,r,i){return e(n,t,r,i)})),n}var transform_1$1=transform$4,lodash$4;if("function"==typeof commonjsRequire)try{lodash$4={clone:clone_1,constant:constant_1,each,filter:filter_1,has:has_1,isArray:isArray_1,isEmpty:isEmpty_1,isFunction:isFunction_1,isUndefined:isUndefined_1,keys:keys_1,map:map_1,reduce:reduce_1,size:size_1,transform:transform_1$1,union:union_1,values:values_1}}catch(t){}lodash$4||(lodash$4=window._);var lodash_1$2=lodash$4,graph=Graph$9,DEFAULT_EDGE_NAME="\0",GRAPH_NODE="\0",EDGE_KEY_DELIM="";function Graph$9(t){this._isDirected=!lodash_1$2.has(t,"directed")||t.directed,this._isMultigraph=!!lodash_1$2.has(t,"multigraph")&&t.multigraph,this._isCompound=!!lodash_1$2.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=lodash_1$2.constant(void 0),this._defaultEdgeLabelFn=lodash_1$2.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[GRAPH_NODE]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function incrementOrInitEntry(t,e){t[e]?t[e]++:t[e]=1}function decrementOrRemoveEntry(t,e){--t[e]||delete t[e]}function edgeArgsToId(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var s=i;i=o,o=s}return i+EDGE_KEY_DELIM+o+EDGE_KEY_DELIM+(lodash_1$2.isUndefined(r)?DEFAULT_EDGE_NAME:r)}function edgeArgsToObj(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var s=i;i=o,o=s}var a={v:i,w:o};return r&&(a.name=r),a}function edgeObjToId(t,e){return edgeArgsToId(t,e.v,e.w,e.name)}Graph$9.prototype._nodeCount=0,Graph$9.prototype._edgeCount=0,Graph$9.prototype.isDirected=function(){return this._isDirected},Graph$9.prototype.isMultigraph=function(){return this._isMultigraph},Graph$9.prototype.isCompound=function(){return this._isCompound},Graph$9.prototype.setGraph=function(t){return this._label=t,this},Graph$9.prototype.graph=function(){return this._label},Graph$9.prototype.setDefaultNodeLabel=function(t){return lodash_1$2.isFunction(t)||(t=lodash_1$2.constant(t)),this._defaultNodeLabelFn=t,this},Graph$9.prototype.nodeCount=function(){return this._nodeCount},Graph$9.prototype.nodes=function(){return lodash_1$2.keys(this._nodes)},Graph$9.prototype.sources=function(){var t=this;return lodash_1$2.filter(this.nodes(),(function(e){return lodash_1$2.isEmpty(t._in[e])}))},Graph$9.prototype.sinks=function(){var t=this;return lodash_1$2.filter(this.nodes(),(function(e){return lodash_1$2.isEmpty(t._out[e])}))},Graph$9.prototype.setNodes=function(t,e){var n=arguments,r=this;return lodash_1$2.each(t,(function(t){n.length>1?r.setNode(t,e):r.setNode(t)})),this},Graph$9.prototype.setNode=function(t,e){return lodash_1$2.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=GRAPH_NODE,this._children[t]={},this._children[GRAPH_NODE][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},Graph$9.prototype.node=function(t){return this._nodes[t]},Graph$9.prototype.hasNode=function(t){return lodash_1$2.has(this._nodes,t)},Graph$9.prototype.removeNode=function(t){var e=this;if(lodash_1$2.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],lodash_1$2.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),lodash_1$2.each(lodash_1$2.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],lodash_1$2.each(lodash_1$2.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},Graph$9.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(lodash_1$2.isUndefined(e))e=GRAPH_NODE;else{for(var n=e+="";!lodash_1$2.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},Graph$9.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},Graph$9.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==GRAPH_NODE)return e}},Graph$9.prototype.children=function(t){if(lodash_1$2.isUndefined(t)&&(t=GRAPH_NODE),this._isCompound){var e=this._children[t];if(e)return lodash_1$2.keys(e)}else{if(t===GRAPH_NODE)return this.nodes();if(this.hasNode(t))return[]}},Graph$9.prototype.predecessors=function(t){var e=this._preds[t];if(e)return lodash_1$2.keys(e)},Graph$9.prototype.successors=function(t){var e=this._sucs[t];if(e)return lodash_1$2.keys(e)},Graph$9.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return lodash_1$2.union(e,this.successors(t))},Graph$9.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},Graph$9.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;lodash_1$2.each(this._nodes,(function(n,r){t(r)&&e.setNode(r,n)})),lodash_1$2.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var r={};function i(t){var o=n.parent(t);return void 0===o||e.hasNode(o)?(r[t]=o,o):o in r?r[o]:i(o)}return this._isCompound&&lodash_1$2.each(e.nodes(),(function(t){e.setParent(t,i(t))})),e},Graph$9.prototype.setDefaultEdgeLabel=function(t){return lodash_1$2.isFunction(t)||(t=lodash_1$2.constant(t)),this._defaultEdgeLabelFn=t,this},Graph$9.prototype.edgeCount=function(){return this._edgeCount},Graph$9.prototype.edges=function(){return lodash_1$2.values(this._edgeObjs)},Graph$9.prototype.setPath=function(t,e){var n=this,r=arguments;return lodash_1$2.reduce(t,(function(t,i){return r.length>1?n.setEdge(t,i,e):n.setEdge(t,i),i})),this},Graph$9.prototype.setEdge=function(){var t,e,n,r,i=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(t=o.v,e=o.w,n=o.name,2===arguments.length&&(r=arguments[1],i=!0)):(t=o,e=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),t=""+t,e=""+e,lodash_1$2.isUndefined(n)||(n=""+n);var s=edgeArgsToId(this._isDirected,t,e,n);if(lodash_1$2.has(this._edgeLabels,s))return i&&(this._edgeLabels[s]=r),this;if(!lodash_1$2.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[s]=i?r:this._defaultEdgeLabelFn(t,e,n);var a=edgeArgsToObj(this._isDirected,t,e,n);return t=a.v,e=a.w,Object.freeze(a),this._edgeObjs[s]=a,incrementOrInitEntry(this._preds[e],t),incrementOrInitEntry(this._sucs[t],e),this._in[e][s]=a,this._out[t][s]=a,this._edgeCount++,this},Graph$9.prototype.edge=function(t,e,n){var r=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,t,e,n);return this._edgeLabels[r]},Graph$9.prototype.hasEdge=function(t,e,n){var r=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,t,e,n);return lodash_1$2.has(this._edgeLabels,r)},Graph$9.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,t,e,n),i=this._edgeObjs[r];return i&&(t=i.v,e=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],decrementOrRemoveEntry(this._preds[e],t),decrementOrRemoveEntry(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},Graph$9.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var r=lodash_1$2.values(n);return e?lodash_1$2.filter(r,(function(t){return t.v===e})):r}},Graph$9.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var r=lodash_1$2.values(n);return e?lodash_1$2.filter(r,(function(t){return t.w===e})):r}},Graph$9.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))};var version$4="2.1.8",lib={Graph:graph,version:version$4},json$2={write,read};function write(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:writeNodes(t),edges:writeEdges(t)};return lodash_1$2.isUndefined(t.graph())||(e.value=lodash_1$2.clone(t.graph())),e}function writeNodes(t){return lodash_1$2.map(t.nodes(),(function(e){var n=t.node(e),r=t.parent(e),i={v:e};return lodash_1$2.isUndefined(n)||(i.value=n),lodash_1$2.isUndefined(r)||(i.parent=r),i}))}function writeEdges(t){return lodash_1$2.map(t.edges(),(function(e){var n=t.edge(e),r={v:e.v,w:e.w};return lodash_1$2.isUndefined(e.name)||(r.name=e.name),lodash_1$2.isUndefined(n)||(r.value=n),r}))}function read(t){var e=new graph(t.options).setGraph(t.value);return lodash_1$2.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),lodash_1$2.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}var components_1=components;function components(t){var e,n={},r=[];function i(r){lodash_1$2.has(n,r)||(n[r]=!0,e.push(r),lodash_1$2.each(t.successors(r),i),lodash_1$2.each(t.predecessors(r),i))}return lodash_1$2.each(t.nodes(),(function(t){e=[],i(t),e.length&&r.push(e)})),r}var priorityQueue=PriorityQueue$1;function PriorityQueue$1(){this._arr=[],this._keyIndices={}}PriorityQueue$1.prototype.size=function(){return this._arr.length},PriorityQueue$1.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},PriorityQueue$1.prototype.has=function(t){return lodash_1$2.has(this._keyIndices,t)},PriorityQueue$1.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},PriorityQueue$1.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},PriorityQueue$1.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!lodash_1$2.has(n,t)){var r=this._arr,i=r.length;return n[t]=i,r.push({key:t,priority:e}),this._decrease(i),!0}return!1},PriorityQueue$1.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},PriorityQueue$1.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},PriorityQueue$1.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},PriorityQueue$1.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},PriorityQueue$1.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],o=n[e];n[t]=o,n[e]=i,r[o.key]=t,r[i.key]=e};var dijkstra_1=dijkstra,DEFAULT_WEIGHT_FUNC$1=lodash_1$2.constant(1);function dijkstra(t,e,n,r){return runDijkstra(t,String(e),n||DEFAULT_WEIGHT_FUNC$1,r||function(e){return t.outEdges(e)})}function runDijkstra(t,e,n,r){var i,o,s={},a=new priorityQueue,l=function(t){var e=t.v!==i?t.v:t.w,r=s[e],l=n(t),c=o.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+l);c<r.distance&&(r.distance=c,r.predecessor=i,a.decrease(e,c))};for(t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:n},a.add(t,n)}));a.size()>0&&(i=a.removeMin(),(o=s[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(l);return s}var dijkstraAll_1=dijkstraAll;function dijkstraAll(t,e,n){return lodash_1$2.transform(t.nodes(),(function(r,i){r[i]=dijkstra_1(t,i,e,n)}),{})}var tarjan_1=tarjan;function tarjan(t){var e=0,n=[],r={},i=[];function o(s){var a=r[s]={onStack:!0,lowlink:e,index:e++};if(n.push(s),t.successors(s).forEach((function(t){lodash_1$2.has(r,t)?r[t].onStack&&(a.lowlink=Math.min(a.lowlink,r[t].index)):(o(t),a.lowlink=Math.min(a.lowlink,r[t].lowlink))})),a.lowlink===a.index){var l,c=[];do{l=n.pop(),r[l].onStack=!1,c.push(l)}while(s!==l);i.push(c)}}return t.nodes().forEach((function(t){lodash_1$2.has(r,t)||o(t)})),i}var findCycles_1=findCycles;function findCycles(t){return lodash_1$2.filter(tarjan_1(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))}var floydWarshall_1=floydWarshall,DEFAULT_WEIGHT_FUNC=lodash_1$2.constant(1);function floydWarshall(t,e,n){return runFloydWarshall(t,e||DEFAULT_WEIGHT_FUNC,n||function(e){return t.outEdges(e)})}function runFloydWarshall(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,o=e(n);r[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=e[n],i=o[n],s=o[t].distance+r.distance;s<i.distance&&(i.distance=s,i.predecessor=r.predecessor)}))}))})),r}var topsort_1=topsort;function topsort(t){var e={},n={},r=[];if(lodash_1$2.each(t.sinks(),(function i(o){if(lodash_1$2.has(n,o))throw new CycleException;lodash_1$2.has(e,o)||(n[o]=!0,e[o]=!0,lodash_1$2.each(t.predecessors(o),i),delete n[o],r.push(o))})),lodash_1$2.size(e)!==t.nodeCount())throw new CycleException;return r}function CycleException(){}topsort.CycleException=CycleException,CycleException.prototype=new Error;var isAcyclic_1=isAcyclic;function isAcyclic(t){try{topsort_1(t)}catch(t){if(t instanceof topsort_1.CycleException)return!1;throw t}return!0}var dfs_1=dfs$1;function dfs$1(t,e,n){lodash_1$2.isArray(e)||(e=[e]);var r=(t.isDirected()?t.successors:t.neighbors).bind(t),i=[],o={};return lodash_1$2.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);doDfs(t,e,"post"===n,o,r,i)})),i}function doDfs(t,e,n,r,i,o){lodash_1$2.has(r,e)||(r[e]=!0,n||o.push(e),lodash_1$2.each(i(e),(function(e){doDfs(t,e,n,r,i,o)})),n&&o.push(e))}var postorder_1=postorder$2;function postorder$2(t,e){return dfs_1(t,e,"post")}var preorder_1=preorder$1;function preorder$1(t,e){return dfs_1(t,e,"pre")}var prim_1=prim;function prim(t,e){var n,r=new graph,i={},o=new priorityQueue;function s(t){var r=t.v===n?t.w:t.v,s=o.priority(r);if(void 0!==s){var a=e(t);a<s&&(i[r]=n,o.decrease(r,a))}}if(0===t.nodeCount())return r;lodash_1$2.each(t.nodes(),(function(t){o.add(t,Number.POSITIVE_INFINITY),r.setNode(t)})),o.decrease(t.nodes()[0],0);for(var a=!1;o.size()>0;){if(n=o.removeMin(),lodash_1$2.has(i,n))r.setEdge(n,i[n]);else{if(a)throw new Error("Input graph is not connected: "+t);a=!0}t.nodeEdges(n).forEach(s)}return r}var alg={components:components_1,dijkstra:dijkstra_1,dijkstraAll:dijkstraAll_1,findCycles:findCycles_1,floydWarshall:floydWarshall_1,isAcyclic:isAcyclic_1,postorder:postorder_1,preorder:preorder_1,prim:prim_1,tarjan:tarjan_1,topsort:topsort_1},graphlib$2={Graph:lib.Graph,json:json$2,alg,version:lib.version},graphlib$1;if("function"==typeof commonjsRequire)try{graphlib$1=graphlib$2}catch(t){}graphlib$1||(graphlib$1=window.graphlib);var graphlib_1$1=graphlib$1,graphlib;if("function"==typeof commonjsRequire)try{graphlib=graphlib$2}catch(t){}graphlib||(graphlib=window.graphlib);var graphlib_1=graphlib,CLONE_DEEP_FLAG$8=1,CLONE_SYMBOLS_FLAG$6=4;function cloneDeep$1(t){return _baseClone(t,CLONE_DEEP_FLAG$8|CLONE_SYMBOLS_FLAG$6)}var cloneDeep_1=cloneDeep$1,objectProto$u=Object.prototype,hasOwnProperty$q=objectProto$u.hasOwnProperty,defaults$4=_baseRest((function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&_isIterateeCall(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],s=keysIn_1(o),a=-1,l=s.length;++a<l;){var c=s[a],u=t[c];(void 0===u||eq_1(u,objectProto$u[c])&&!hasOwnProperty$q.call(t,c))&&(t[c]=o[c])}return t})),defaults_1=defaults$4;function forIn$1(t,e){return null==t?t:_baseFor(t,_castFunction(e),keysIn_1)}var forIn_1=forIn$1;function mapValues$1(t,e){var n={};return e=_baseIteratee(e),_baseForOwn(t,(function(t,r,i){_baseAssignValue(n,r,e(t,r,i))})),n}var mapValues_1=mapValues$1;function baseExtremum$1(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],s=e(o);if(null!=s&&(void 0===a?s==s&&!isSymbol_1(s):n(s,a)))var a=s,l=o}return l}var _baseExtremum=baseExtremum$1;function baseGt$1(t,e){return t>e}var _baseGt=baseGt$1;function max$4(t){return t&&t.length?_baseExtremum(t,identity_1,_baseGt):void 0}var max_1=max$4;function assignMergeValue$1(t,e,n){(void 0!==n&&!eq_1(t[e],n)||void 0===n&&!(e in t))&&_baseAssignValue(t,e,n)}var _assignMergeValue=assignMergeValue$1,objectTag$5="[object Object]",funcProto$3=Function.prototype,objectProto$t=Object.prototype,funcToString$3=funcProto$3.toString,hasOwnProperty$p=objectProto$t.hasOwnProperty,objectCtorString$1=funcToString$3.call(Object);function isPlainObject$1(t){if(!isObjectLike_1(t)||_baseGetTag(t)!=objectTag$5)return!1;var e=_getPrototype(t);if(null===e)return!0;var n=hasOwnProperty$p.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&funcToString$3.call(n)==objectCtorString$1}var isPlainObject_1=isPlainObject$1;function safeGet$1(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var _safeGet=safeGet$1;function toPlainObject$1(t){return _copyObject(t,keysIn_1(t))}var toPlainObject_1=toPlainObject$1;function baseMergeDeep$1(t,e,n,r,i,o,s){var a=_safeGet(t,n),l=_safeGet(e,n),c=s.get(l);if(c)_assignMergeValue(t,n,c);else{var u=o?o(a,l,n+"",t,e,s):void 0,h=void 0===u;if(h){var d=isArray_1(l),f=!d&&isBuffer_1(l),p=!d&&!f&&isTypedArray_1(l);u=l,d||f||p?isArray_1(a)?u=a:isArrayLikeObject_1(a)?u=_copyArray(a):f?(h=!1,u=_cloneBuffer(l,!0)):p?(h=!1,u=_cloneTypedArray(l,!0)):u=[]:isPlainObject_1(l)||isArguments_1(l)?(u=a,isArguments_1(a)?u=toPlainObject_1(a):isObject_1(a)&&!isFunction_1(a)||(u=_initCloneObject(l))):h=!1}h&&(s.set(l,u),i(u,l,r,o,s),s.delete(l)),_assignMergeValue(t,n,u)}}var _baseMergeDeep=baseMergeDeep$1;function baseMerge$1(t,e,n,r,i){t!==e&&_baseFor(e,(function(o,s){if(i||(i=new _Stack),isObject_1(o))_baseMergeDeep(t,e,s,n,baseMerge$1,r,i);else{var a=r?r(_safeGet(t,s),o,s+"",t,e,i):void 0;void 0===a&&(a=o),_assignMergeValue(t,s,a)}}),keysIn_1)}var _baseMerge=baseMerge$1;function createAssigner$1(t){return _baseRest((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&_isIterateeCall(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,o)}return e}))}var _createAssigner=createAssigner$1,merge$2=_createAssigner((function(t,e,n){_baseMerge(t,e,n)})),merge_1=merge$2;function baseLt$1(t,e){return t<e}var _baseLt=baseLt$1;function min$3(t){return t&&t.length?_baseExtremum(t,identity_1,_baseLt):void 0}var min_1=min$3;function minBy$1(t,e){return t&&t.length?_baseExtremum(t,_baseIteratee(e),_baseLt):void 0}var minBy_1=minBy$1,now$2=function(){return _root.Date.now()},now_1=now$2;function basePickBy$1(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=_baseGet(t,s);n(a,s)&&_baseSet(o,_castPath(s,t),a)}return o}var _basePickBy=basePickBy$1;function basePick$1(t,e){return _basePickBy(t,e,(function(e,n){return hasIn_1(t,n)}))}var _basePick=basePick$1,pick$1=_flatRest((function(t,e){return null==t?{}:_basePick(t,e)})),pick_1=pick$1,nativeCeil$4=Math.ceil,nativeMax$h=Math.max;function baseRange$1(t,e,n,r){for(var i=-1,o=nativeMax$h(nativeCeil$4((e-t)/(n||1)),0),s=Array(o);o--;)s[r?o:++i]=t,t+=n;return s}var _baseRange=baseRange$1;function createRange$1(t){return function(e,n,r){return r&&"number"!=typeof r&&_isIterateeCall(e,n,r)&&(n=r=void 0),e=toFinite_1(e),void 0===n?(n=e,e=0):n=toFinite_1(n),r=void 0===r?e<n?1:-1:toFinite_1(r),_baseRange(e,n,r,t)}}var _createRange=createRange$1,range$2=_createRange(),range_1=range$2,idCounter$2=0;function uniqueId$2(t){var e=++idCounter$2;return toString_1(t)+e}var uniqueId_1=uniqueId$2,lodash$3;if("function"==typeof commonjsRequire)try{lodash$3={cloneDeep:cloneDeep_1,constant:constant_1,defaults:defaults_1,each,filter:filter_1,find:find_1,flatten:flatten_1,forEach:forEach_1,forIn:forIn_1,has:has_1,isUndefined:isUndefined_1,last:last_1,map:map_1,mapValues:mapValues_1,max:max_1,merge:merge_1,min:min_1,minBy:minBy_1,now:now_1,pick:pick_1,range:range_1,reduce:reduce_1,sortBy:sortBy_1,uniqueId:uniqueId_1,values:values_1,zipObject:zipObject_1}}catch(t){}lodash$3||(lodash$3=window._);var lodash_1$1=lodash$3,list=List;function List(){var t={};t._next=t._prev=t,this._sentinel=t}function unlink(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function filterOutLinks(t,e){if("_next"!==t&&"_prev"!==t)return e}List.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return unlink(e),e},List.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&unlink(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},List.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,filterOutLinks)),n=n._prev;return"["+t.join(", ")+"]"};var Graph$8=graphlib_1.Graph,greedyFas=greedyFAS,DEFAULT_WEIGHT_FN=lodash_1$1.constant(1);function greedyFAS(t,e){if(t.nodeCount()<=1)return[];var n=buildState(t,e||DEFAULT_WEIGHT_FN),r=doGreedyFAS(n.graph,n.buckets,n.zeroIdx);return lodash_1$1.flatten(lodash_1$1.map(r,(function(e){return t.outEdges(e.v,e.w)})),!0)}function doGreedyFAS(t,e,n){for(var r,i=[],o=e[e.length-1],s=e[0];t.nodeCount();){for(;r=s.dequeue();)removeNode(t,e,n,r);for(;r=o.dequeue();)removeNode(t,e,n,r);if(t.nodeCount())for(var a=e.length-2;a>0;--a)if(r=e[a].dequeue()){i=i.concat(removeNode(t,e,n,r,!0));break}}return i}function removeNode(t,e,n,r,i){var o=i?[]:void 0;return lodash_1$1.forEach(t.inEdges(r.v),(function(r){var s=t.edge(r),a=t.node(r.v);i&&o.push({v:r.v,w:r.w}),a.out-=s,assignBucket(e,n,a)})),lodash_1$1.forEach(t.outEdges(r.v),(function(r){var i=t.edge(r),o=t.node(r.w);o.in-=i,assignBucket(e,n,o)})),t.removeNode(r.v),o}function buildState(t,e){var n=new Graph$8,r=0,i=0;lodash_1$1.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),lodash_1$1.forEach(t.edges(),(function(t){var o=n.edge(t.v,t.w)||0,s=e(t);n.setEdge(t.v,t.w,o+s),i=Math.max(i,n.node(t.v).out+=s),r=Math.max(r,n.node(t.w).in+=s)}));var o=lodash_1$1.range(i+r+3).map((function(){return new list})),s=r+1;return lodash_1$1.forEach(n.nodes(),(function(t){assignBucket(o,s,n.node(t))})),{graph:n,buckets:o,zeroIdx:s}}function assignBucket(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}var acyclic={run:run$2,undo:undo$2};function run$2(t){var e="greedy"===t.graph().acyclicer?greedyFas(t,function(t){return function(e){return t.edge(e).weight}}(t)):dfsFAS(t);lodash_1$1.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,lodash_1$1.uniqueId("rev"))}))}function dfsFAS(t){var e=[],n={},r={};return lodash_1$1.forEach(t.nodes(),(function i(o){lodash_1$1.has(r,o)||(r[o]=!0,n[o]=!0,lodash_1$1.forEach(t.outEdges(o),(function(t){lodash_1$1.has(n,t.w)?e.push(t):i(t.w)})),delete n[o])})),e}function undo$2(t){lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,r)}}))}var Graph$7=graphlib_1.Graph,util$9={addDummyNode,simplify:simplify$1,asNonCompoundGraph,successorWeights,predecessorWeights,intersectRect:intersectRect$1,buildLayerMatrix,normalizeRanks:normalizeRanks$1,removeEmptyRanks:removeEmptyRanks$1,addBorderNode:addBorderNode$1,maxRank,partition:partition$2,time:time$1,notime};function addDummyNode(t,e,n,r){var i;do{i=lodash_1$1.uniqueId(r)}while(t.hasNode(i));return n.dummy=e,t.setNode(i,n),i}function simplify$1(t){var e=(new Graph$7).setGraph(t.graph());return lodash_1$1.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),lodash_1$1.forEach(t.edges(),(function(n){var r=e.edge(n.v,n.w)||{weight:0,minlen:1},i=t.edge(n);e.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})})),e}function asNonCompoundGraph(t){var e=new Graph$7({multigraph:t.isMultigraph()}).setGraph(t.graph());return lodash_1$1.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),lodash_1$1.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e}function successorWeights(t){var e=lodash_1$1.map(t.nodes(),(function(e){var n={};return lodash_1$1.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return lodash_1$1.zipObject(t.nodes(),e)}function predecessorWeights(t){var e=lodash_1$1.map(t.nodes(),(function(e){var n={};return lodash_1$1.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return lodash_1$1.zipObject(t.nodes(),e)}function intersectRect$1(t,e){var n,r,i=t.x,o=t.y,s=e.x-i,a=e.y-o,l=t.width/2,c=t.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(a)*l>Math.abs(s)*c?(a<0&&(c=-c),n=c*s/a,r=c):(s<0&&(l=-l),n=l,r=l*a/s),{x:i+n,y:o+r}}function buildLayerMatrix(t){var e=lodash_1$1.map(lodash_1$1.range(maxRank(t)+1),(function(){return[]}));return lodash_1$1.forEach(t.nodes(),(function(n){var r=t.node(n),i=r.rank;lodash_1$1.isUndefined(i)||(e[i][r.order]=n)})),e}function normalizeRanks$1(t){var e=lodash_1$1.min(lodash_1$1.map(t.nodes(),(function(e){return t.node(e).rank})));lodash_1$1.forEach(t.nodes(),(function(n){var r=t.node(n);lodash_1$1.has(r,"rank")&&(r.rank-=e)}))}function removeEmptyRanks$1(t){var e=lodash_1$1.min(lodash_1$1.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];lodash_1$1.forEach(t.nodes(),(function(r){var i=t.node(r).rank-e;n[i]||(n[i]=[]),n[i].push(r)}));var r=0,i=t.graph().nodeRankFactor;lodash_1$1.forEach(n,(function(e,n){lodash_1$1.isUndefined(e)&&n%i!=0?--r:r&&lodash_1$1.forEach(e,(function(e){t.node(e).rank+=r}))}))}function addBorderNode$1(t,e,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),addDummyNode(t,"border",i,e)}function maxRank(t){return lodash_1$1.max(lodash_1$1.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!lodash_1$1.isUndefined(n))return n})))}function partition$2(t,e){var n={lhs:[],rhs:[]};return lodash_1$1.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n}function time$1(t,e){var n=lodash_1$1.now();try{return e()}finally{console.log(t+" time: "+(lodash_1$1.now()-n)+"ms")}}function notime(t,e){return e()}var normalize$3={run:run$1,undo:undo$1};function run$1(t){t.graph().dummyChains=[],lodash_1$1.forEach(t.edges(),(function(e){normalizeEdge(t,e)}))}function normalizeEdge(t,e){var n=e.v,r=t.node(n).rank,i=e.w,o=t.node(i).rank,s=e.name,a=t.edge(e),l=a.labelRank;if(o!==r+1){var c,u,h;for(t.removeEdge(e),h=0,++r;r<o;++h,++r)a.points=[],c=util$9.addDummyNode(t,"edge",u={width:0,height:0,edgeLabel:a,edgeObj:e,rank:r},"_d"),r===l&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),t.setEdge(n,c,{weight:a.weight},s),0===h&&t.graph().dummyChains.push(c),n=c;t.setEdge(n,i,{weight:a.weight},s)}}function undo$1(t){lodash_1$1.forEach(t.graph().dummyChains,(function(e){var n,r=t.node(e),i=r.edgeLabel;for(t.setEdge(r.edgeObj,i);r.dummy;)n=t.successors(e)[0],t.removeNode(e),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),r=t.node(e=n)}))}var util$8={longestPath:longestPath$1,slack:slack$2};function longestPath$1(t){var e={};lodash_1$1.forEach(t.sources(),(function n(r){var i=t.node(r);if(lodash_1$1.has(e,r))return i.rank;e[r]=!0;var o=lodash_1$1.min(lodash_1$1.map(t.outEdges(r),(function(e){return n(e.w)-t.edge(e).minlen})));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),i.rank=o}))}function slack$2(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}var Graph$6=graphlib_1.Graph,slack$1=util$8.slack,feasibleTree_1=feasibleTree;function feasibleTree(t){var e,n,r=new Graph$6({directed:!1}),i=t.nodes()[0],o=t.nodeCount();for(r.setNode(i,{});tightTree(r,t)<o;)e=findMinSlackEdge(r,t),n=r.hasNode(e.v)?slack$1(t,e):-slack$1(t,e),shiftRanks(r,t,n);return r}function tightTree(t,e){return lodash_1$1.forEach(t.nodes(),(function n(r){lodash_1$1.forEach(e.nodeEdges(r),(function(i){var o=i.v,s=r===o?i.w:o;t.hasNode(s)||slack$1(e,i)||(t.setNode(s,{}),t.setEdge(r,s,{}),n(s))}))})),t.nodeCount()}function findMinSlackEdge(t,e){return lodash_1$1.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return slack$1(e,n)}))}function shiftRanks(t,e,n){lodash_1$1.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}var slack=util$8.slack,initRank=util$8.longestPath,preorder=graphlib_1.alg.preorder,postorder$1=graphlib_1.alg.postorder,simplify=util$9.simplify,networkSimplex_1=networkSimplex;function networkSimplex(t){t=simplify(t),initRank(t);var e,n=feasibleTree_1(t);for(initLowLimValues(n),initCutValues(n,t);e=leaveEdge(n);)exchangeEdges(n,t,e,enterEdge(n,t,e))}function initCutValues(t,e){var n=postorder$1(t,t.nodes());n=n.slice(0,n.length-1),lodash_1$1.forEach(n,(function(n){assignCutValue(t,e,n)}))}function assignCutValue(t,e,n){var r=t.node(n);t.edge(n,r.parent).cutvalue=calcCutValue(t,e,n)}function calcCutValue(t,e,n){var r=t.node(n).parent,i=!0,o=e.edge(n,r),s=0;return o||(i=!1,o=e.edge(r,n)),s=o.weight,lodash_1$1.forEach(e.nodeEdges(n),(function(o){var a=o.v===n,l=a?o.w:o.v;if(l!==r){var c=a===i,u=e.edge(o).weight;if(s+=c?u:-u,isTreeEdge(t,n,l)){var h=t.edge(n,l).cutvalue;s+=c?-h:h}}})),s}function initLowLimValues(t,e){arguments.length<2&&(e=t.nodes()[0]),dfsAssignLowLim(t,{},1,e)}function dfsAssignLowLim(t,e,n,r,i){var o=n,s=t.node(r);return e[r]=!0,lodash_1$1.forEach(t.neighbors(r),(function(i){lodash_1$1.has(e,i)||(n=dfsAssignLowLim(t,e,n,i,r))})),s.low=o,s.lim=n++,i?s.parent=i:delete s.parent,n}function leaveEdge(t){return lodash_1$1.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function enterEdge(t,e,n){var r=n.v,i=n.w;e.hasEdge(r,i)||(r=n.w,i=n.v);var o=t.node(r),s=t.node(i),a=o,l=!1;o.lim>s.lim&&(a=s,l=!0);var c=lodash_1$1.filter(e.edges(),(function(e){return l===isDescendant(t,t.node(e.v),a)&&l!==isDescendant(t,t.node(e.w),a)}));return lodash_1$1.minBy(c,(function(t){return slack(e,t)}))}function exchangeEdges(t,e,n,r){t.removeEdge(n.v,n.w),t.setEdge(r.v,r.w,{}),initLowLimValues(t),initCutValues(t,e),updateRanks(t,e)}function updateRanks(t,e){var n=lodash_1$1.find(t.nodes(),(function(t){return!e.node(t).parent})),r=preorder(t,n);r=r.slice(1),lodash_1$1.forEach(r,(function(n){var r=t.node(n).parent,i=e.edge(n,r),o=!1;i||(i=e.edge(r,n),o=!0),e.node(n).rank=e.node(r).rank+(o?i.minlen:-i.minlen)}))}function isTreeEdge(t,e,n){return t.hasEdge(e,n)}function isDescendant(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}networkSimplex.initLowLimValues=initLowLimValues,networkSimplex.initCutValues=initCutValues,networkSimplex.calcCutValue=calcCutValue,networkSimplex.leaveEdge=leaveEdge,networkSimplex.enterEdge=enterEdge,networkSimplex.exchangeEdges=exchangeEdges;var longestPath=util$8.longestPath,rank_1=rank;function rank(t){switch(t.graph().ranker){case"network-simplex":default:networkSimplexRanker(t);break;case"tight-tree":tightTreeRanker(t);break;case"longest-path":longestPathRanker(t)}}var longestPathRanker=longestPath;function tightTreeRanker(t){longestPath(t),feasibleTree_1(t)}function networkSimplexRanker(t){networkSimplex_1(t)}var parentDummyChains_1=parentDummyChains;function parentDummyChains(t){var e=postorder(t);lodash_1$1.forEach(t.graph().dummyChains,(function(n){for(var r=t.node(n),i=r.edgeObj,o=findPath(t,e,i.v,i.w),s=o.path,a=o.lca,l=0,c=s[l],u=!0;n!==i.w;){if(r=t.node(n),u){for(;(c=s[l])!==a&&t.node(c).maxRank<r.rank;)l++;c===a&&(u=!1)}if(!u){for(;l<s.length-1&&t.node(c=s[l+1]).minRank<=r.rank;)l++;c=s[l]}t.setParent(n,c),n=t.successors(n)[0]}}))}function findPath(t,e,n,r){var i,o,s=[],a=[],l=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);i=n;do{i=t.parent(i),s.push(i)}while(i&&(e[i].low>l||c>e[i].lim));for(o=i,i=r;(i=t.parent(i))!==o;)a.push(i);return{path:s.concat(a.reverse()),lca:o}}function postorder(t){var e={},n=0;return lodash_1$1.forEach(t.children(),(function r(i){var o=n;lodash_1$1.forEach(t.children(i),r),e[i]={low:o,lim:n++}})),e}var nestingGraph={run,cleanup};function run(t){var e=util$9.addDummyNode(t,"root",{},"_root"),n=treeDepths(t),r=lodash_1$1.max(lodash_1$1.values(n))-1,i=2*r+1;t.graph().nestingRoot=e,lodash_1$1.forEach(t.edges(),(function(e){t.edge(e).minlen*=i}));var o=sumWeights(t)+1;lodash_1$1.forEach(t.children(),(function(s){dfs(t,e,i,o,r,n,s)})),t.graph().nodeRankFactor=i}function dfs(t,e,n,r,i,o,s){var a=t.children(s);if(a.length){var l=util$9.addBorderNode(t,"_bt"),c=util$9.addBorderNode(t,"_bb"),u=t.node(s);t.setParent(l,s),u.borderTop=l,t.setParent(c,s),u.borderBottom=c,lodash_1$1.forEach(a,(function(a){dfs(t,e,n,r,i,o,a);var u=t.node(a),h=u.borderTop?u.borderTop:a,d=u.borderBottom?u.borderBottom:a,f=u.borderTop?r:2*r,p=h!==d?1:i-o[s]+1;t.setEdge(l,h,{weight:f,minlen:p,nestingEdge:!0}),t.setEdge(d,c,{weight:f,minlen:p,nestingEdge:!0})})),t.parent(s)||t.setEdge(e,l,{weight:0,minlen:i+o[s]})}else s!==e&&t.setEdge(e,s,{weight:0,minlen:n})}function treeDepths(t){var e={};function n(r,i){var o=t.children(r);o&&o.length&&lodash_1$1.forEach(o,(function(t){n(t,i+1)})),e[r]=i}return lodash_1$1.forEach(t.children(),(function(t){n(t,1)})),e}function sumWeights(t){return lodash_1$1.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}function cleanup(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,lodash_1$1.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}var addBorderSegments_1=addBorderSegments;function addBorderSegments(t){lodash_1$1.forEach(t.children(),(function e(n){var r=t.children(n),i=t.node(n);if(r.length&&lodash_1$1.forEach(r,e),lodash_1$1.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,s=i.maxRank+1;o<s;++o)addBorderNode(t,"borderLeft","_bl",n,i,o),addBorderNode(t,"borderRight","_br",n,i,o)}}))}function addBorderNode(t,e,n,r,i,o){var s=i[e][o-1],a=util$9.addDummyNode(t,"border",{width:0,height:0,rank:o,borderType:e},n);i[e][o]=a,t.setParent(a,r),s&&t.setEdge(s,a,{weight:1})}var coordinateSystem={adjust,undo};function adjust(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||swapWidthHeight(t)}function undo(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||reverseY(t),"lr"!==e&&"rl"!==e||(swapXY(t),swapWidthHeight(t))}function swapWidthHeight(t){lodash_1$1.forEach(t.nodes(),(function(e){swapWidthHeightOne(t.node(e))})),lodash_1$1.forEach(t.edges(),(function(e){swapWidthHeightOne(t.edge(e))}))}function swapWidthHeightOne(t){var e=t.width;t.width=t.height,t.height=e}function reverseY(t){lodash_1$1.forEach(t.nodes(),(function(e){reverseYOne(t.node(e))})),lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);lodash_1$1.forEach(n.points,reverseYOne),lodash_1$1.has(n,"y")&&reverseYOne(n)}))}function reverseYOne(t){t.y=-t.y}function swapXY(t){lodash_1$1.forEach(t.nodes(),(function(e){swapXYOne(t.node(e))})),lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);lodash_1$1.forEach(n.points,swapXYOne),lodash_1$1.has(n,"x")&&swapXYOne(n)}))}function swapXYOne(t){var e=t.x;t.x=t.y,t.y=e}var initOrder_1=initOrder;function initOrder(t){var e={},n=lodash_1$1.filter(t.nodes(),(function(e){return!t.children(e).length})),r=lodash_1$1.max(lodash_1$1.map(n,(function(e){return t.node(e).rank}))),i=lodash_1$1.map(lodash_1$1.range(r+1),(function(){return[]})),o=lodash_1$1.sortBy(n,(function(e){return t.node(e).rank}));return lodash_1$1.forEach(o,(function n(r){if(!lodash_1$1.has(e,r)){e[r]=!0;var o=t.node(r);i[o.rank].push(r),lodash_1$1.forEach(t.successors(r),n)}})),i}var crossCount_1=crossCount;function crossCount(t,e){for(var n=0,r=1;r<e.length;++r)n+=twoLayerCrossCount(t,e[r-1],e[r]);return n}function twoLayerCrossCount(t,e,n){for(var r=lodash_1$1.zipObject(n,lodash_1$1.map(n,(function(t,e){return e}))),i=lodash_1$1.flatten(lodash_1$1.map(e,(function(e){return lodash_1$1.sortBy(lodash_1$1.map(t.outEdges(e),(function(e){return{pos:r[e.w],weight:t.edge(e).weight}})),"pos")})),!0),o=1;o<n.length;)o<<=1;var s=2*o-1;o-=1;var a=lodash_1$1.map(new Array(s),(function(){return 0})),l=0;return lodash_1$1.forEach(i.forEach((function(t){var e=t.pos+o;a[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=a[e+1]),a[e=e-1>>1]+=t.weight;l+=t.weight*n}))),l}var barycenter_1=barycenter;function barycenter(t,e){return lodash_1$1.map(e,(function(e){var n=t.inEdges(e);if(n.length){var r=lodash_1$1.reduce(n,(function(e,n){var r=t.edge(n),i=t.node(n.v);return{sum:e.sum+r.weight*i.order,weight:e.weight+r.weight}}),{sum:0,weight:0});return{v:e,barycenter:r.sum/r.weight,weight:r.weight}}return{v:e}}))}var resolveConflicts_1=resolveConflicts;function resolveConflicts(t,e){var n={};return lodash_1$1.forEach(t,(function(t,e){var r=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};lodash_1$1.isUndefined(t.barycenter)||(r.barycenter=t.barycenter,r.weight=t.weight)})),lodash_1$1.forEach(e.edges(),(function(t){var e=n[t.v],r=n[t.w];lodash_1$1.isUndefined(e)||lodash_1$1.isUndefined(r)||(r.indegree++,e.out.push(n[t.w]))})),doResolveConflicts(lodash_1$1.filter(n,(function(t){return!t.indegree})))}function doResolveConflicts(t){var e=[];function n(t){return function(e){e.merged||(lodash_1$1.isUndefined(e.barycenter)||lodash_1$1.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&mergeEntries(t,e)}}function r(e){return function(n){n.in.push(e),0==--n.indegree&&t.push(n)}}for(;t.length;){var i=t.pop();e.push(i),lodash_1$1.forEach(i.in.reverse(),n(i)),lodash_1$1.forEach(i.out,r(i))}return lodash_1$1.map(lodash_1$1.filter(e,(function(t){return!t.merged})),(function(t){return lodash_1$1.pick(t,["vs","i","barycenter","weight"])}))}function mergeEntries(t,e){var n=0,r=0;t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=n/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0}var sort_1=sort;function sort(t,e){var n=util$9.partition(t,(function(t){return lodash_1$1.has(t,"barycenter")})),r=n.lhs,i=lodash_1$1.sortBy(n.rhs,(function(t){return-t.i})),o=[],s=0,a=0,l=0;r.sort(compareWithBias(!!e)),l=consumeUnsortable(o,i,l),lodash_1$1.forEach(r,(function(t){l+=t.vs.length,o.push(t.vs),s+=t.barycenter*t.weight,a+=t.weight,l=consumeUnsortable(o,i,l)}));var c={vs:lodash_1$1.flatten(o,!0)};return a&&(c.barycenter=s/a,c.weight=a),c}function consumeUnsortable(t,e,n){for(var r;e.length&&(r=lodash_1$1.last(e)).i<=n;)e.pop(),t.push(r.vs),n++;return n}function compareWithBias(t){return function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:t?n.i-e.i:e.i-n.i}}var sortSubgraph_1=sortSubgraph;function sortSubgraph(t,e,n,r){var i=t.children(e),o=t.node(e),s=o?o.borderLeft:void 0,a=o?o.borderRight:void 0,l={};s&&(i=lodash_1$1.filter(i,(function(t){return t!==s&&t!==a})));var c=barycenter_1(t,i);lodash_1$1.forEach(c,(function(e){if(t.children(e.v).length){var i=sortSubgraph(t,e.v,n,r);l[e.v]=i,lodash_1$1.has(i,"barycenter")&&mergeBarycenters(e,i)}}));var u=resolveConflicts_1(c,n);expandSubgraphs(u,l);var h=sort_1(u,r);if(s&&(h.vs=lodash_1$1.flatten([s,h.vs,a],!0),t.predecessors(s).length)){var d=t.node(t.predecessors(s)[0]),f=t.node(t.predecessors(a)[0]);lodash_1$1.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+d.order+f.order)/(h.weight+2),h.weight+=2}return h}function expandSubgraphs(t,e){lodash_1$1.forEach(t,(function(t){t.vs=lodash_1$1.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}function mergeBarycenters(t,e){lodash_1$1.isUndefined(t.barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight)}var Graph$5=graphlib_1.Graph,buildLayerGraph_1=buildLayerGraph;function buildLayerGraph(t,e,n){var r=createRootNode(t),i=new Graph$5({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((function(e){return t.node(e)}));return lodash_1$1.forEach(t.nodes(),(function(o){var s=t.node(o),a=t.parent(o);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(i.setNode(o),i.setParent(o,a||r),lodash_1$1.forEach(t[n](o),(function(e){var n=e.v===o?e.w:e.v,r=i.edge(n,o),s=lodash_1$1.isUndefined(r)?0:r.weight;i.setEdge(n,o,{weight:t.edge(e).weight+s})})),lodash_1$1.has(s,"minRank")&&i.setNode(o,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))})),i}function createRootNode(t){for(var e;t.hasNode(e=lodash_1$1.uniqueId("_root")););return e}var addSubgraphConstraints_1=addSubgraphConstraints;function addSubgraphConstraints(t,e,n){var r,i={};lodash_1$1.forEach(n,(function(n){for(var o,s,a=t.parent(n);a;){if((o=t.parent(a))?(s=i[o],i[o]=a):(s=r,r=a),s&&s!==a)return void e.setEdge(s,a);a=o}}))}var Graph$4=graphlib_1.Graph,order_1=order;function order(t){var e=util$9.maxRank(t),n=buildLayerGraphs(t,lodash_1$1.range(1,e+1),"inEdges"),r=buildLayerGraphs(t,lodash_1$1.range(e-1,-1,-1),"outEdges"),i=initOrder_1(t);assignOrder(t,i);for(var o,s=Number.POSITIVE_INFINITY,a=0,l=0;l<4;++a,++l){sweepLayerGraphs(a%2?n:r,a%4>=2),i=util$9.buildLayerMatrix(t);var c=crossCount_1(t,i);c<s&&(l=0,o=lodash_1$1.cloneDeep(i),s=c)}assignOrder(t,o)}function buildLayerGraphs(t,e,n){return lodash_1$1.map(e,(function(e){return buildLayerGraph_1(t,e,n)}))}function sweepLayerGraphs(t,e){var n=new Graph$4;lodash_1$1.forEach(t,(function(t){var r=t.graph().root,i=sortSubgraph_1(t,r,n,e);lodash_1$1.forEach(i.vs,(function(e,n){t.node(e).order=n})),addSubgraphConstraints_1(t,n,i.vs)}))}function assignOrder(t,e){lodash_1$1.forEach(e,(function(e){lodash_1$1.forEach(e,(function(e,n){t.node(e).order=n}))}))}var Graph$3=graphlib_1.Graph,bk={positionX:positionX$1,findType1Conflicts,findType2Conflicts,addConflict,hasConflict,verticalAlignment,horizontalCompaction,alignCoordinates,findSmallestWidthAlignment,balance};function findType1Conflicts(t,e){var n={};return lodash_1$1.reduce(e,(function(e,r){var i=0,o=0,s=e.length,a=lodash_1$1.last(r);return lodash_1$1.forEach(r,(function(e,l){var c=findOtherInnerSegmentNode(t,e),u=c?t.node(c).order:s;(c||e===a)&&(lodash_1$1.forEach(r.slice(o,l+1),(function(e){lodash_1$1.forEach(t.predecessors(e),(function(r){var o=t.node(r),s=o.order;!(s<i||u<s)||o.dummy&&t.node(e).dummy||addConflict(n,r,e)}))})),o=l+1,i=u)})),r})),n}function findType2Conflicts(t,e){var n={};function r(e,r,i,o,s){var a;lodash_1$1.forEach(lodash_1$1.range(r,i),(function(r){t.node(a=e[r]).dummy&&lodash_1$1.forEach(t.predecessors(a),(function(e){var r=t.node(e);r.dummy&&(r.order<o||r.order>s)&&addConflict(n,e,a)}))}))}return lodash_1$1.reduce(e,(function(e,n){var i,o=-1,s=0;return lodash_1$1.forEach(n,(function(a,l){if("border"===t.node(a).dummy){var c=t.predecessors(a);c.length&&(i=t.node(c[0]).order,r(n,s,l,o,i),s=l,o=i)}r(n,s,n.length,i,e.length)})),n})),n}function findOtherInnerSegmentNode(t,e){if(t.node(e).dummy)return lodash_1$1.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}function addConflict(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function hasConflict(t,e,n){if(e>n){var r=e;e=n,n=r}return lodash_1$1.has(t[e],n)}function verticalAlignment(t,e,n,r){var i={},o={},s={};return lodash_1$1.forEach(e,(function(t){lodash_1$1.forEach(t,(function(t,e){i[t]=t,o[t]=t,s[t]=e}))})),lodash_1$1.forEach(e,(function(t){var e=-1;lodash_1$1.forEach(t,(function(t){var a=r(t);if(a.length)for(var l=((a=lodash_1$1.sortBy(a,(function(t){return s[t]}))).length-1)/2,c=Math.floor(l),u=Math.ceil(l);c<=u;++c){var h=a[c];o[t]===t&&e<s[h]&&!hasConflict(n,t,h)&&(o[h]=t,o[t]=i[t]=i[h],e=s[h])}}))})),{root:i,align:o}}function horizontalCompaction(t,e,n,r,i){var o={},s=buildBlockGraph(t,e,n,i),a=i?"borderLeft":"borderRight";function l(t,e){for(var n=s.nodes(),r=n.pop(),i={};r;)i[r]?t(r):(i[r]=!0,n.push(r),n=n.concat(e(r))),r=n.pop()}return l((function(t){o[t]=s.inEdges(t).reduce((function(t,e){return Math.max(t,o[e.v]+s.edge(e))}),0)}),s.predecessors.bind(s)),l((function(e){var n=s.outEdges(e).reduce((function(t,e){return Math.min(t,o[e.w]-s.edge(e))}),Number.POSITIVE_INFINITY),r=t.node(e);n!==Number.POSITIVE_INFINITY&&r.borderType!==a&&(o[e]=Math.max(o[e],n))}),s.successors.bind(s)),lodash_1$1.forEach(r,(function(t){o[t]=o[n[t]]})),o}function buildBlockGraph(t,e,n,r){var i=new Graph$3,o=t.graph(),s=sep(o.nodesep,o.edgesep,r);return lodash_1$1.forEach(e,(function(e){var r;lodash_1$1.forEach(e,(function(e){var o=n[e];if(i.setNode(o),r){var a=n[r],l=i.edge(a,o);i.setEdge(a,o,Math.max(s(t,e,r),l||0))}r=e}))})),i}function findSmallestWidthAlignment(t,e){return lodash_1$1.minBy(lodash_1$1.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return lodash_1$1.forIn(e,(function(e,i){var o=width(t,i)/2;n=Math.max(e+o,n),r=Math.min(e-o,r)})),n-r}))}function alignCoordinates(t,e){var n=lodash_1$1.values(e),r=lodash_1$1.min(n),i=lodash_1$1.max(n);lodash_1$1.forEach(["u","d"],(function(n){lodash_1$1.forEach(["l","r"],(function(o){var s,a=n+o,l=t[a];if(l!==e){var c=lodash_1$1.values(l);(s="l"===o?r-lodash_1$1.min(c):i-lodash_1$1.max(c))&&(t[a]=lodash_1$1.mapValues(l,(function(t){return t+s})))}}))}))}function balance(t,e){return lodash_1$1.mapValues(t.ul,(function(n,r){if(e)return t[e.toLowerCase()][r];var i=lodash_1$1.sortBy(lodash_1$1.map(t,r));return(i[1]+i[2])/2}))}function positionX$1(t){var e,n=util$9.buildLayerMatrix(t),r=lodash_1$1.merge(findType1Conflicts(t,n),findType2Conflicts(t,n)),i={};lodash_1$1.forEach(["u","d"],(function(o){e="u"===o?n:lodash_1$1.values(n).reverse(),lodash_1$1.forEach(["l","r"],(function(n){"r"===n&&(e=lodash_1$1.map(e,(function(t){return lodash_1$1.values(t).reverse()})));var s=("u"===o?t.predecessors:t.successors).bind(t),a=verticalAlignment(t,e,r,s),l=horizontalCompaction(t,e,a.root,a.align,"r"===n);"r"===n&&(l=lodash_1$1.mapValues(l,(function(t){return-t}))),i[o+n]=l}))}));var o=findSmallestWidthAlignment(t,i);return alignCoordinates(i,o),balance(i,t.graph().align)}function sep(t,e,n){return function(r,i,o){var s,a=r.node(i),l=r.node(o),c=0;if(c+=a.width/2,lodash_1$1.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":s=-a.width/2;break;case"r":s=a.width/2}if(s&&(c+=n?s:-s),s=0,c+=(a.dummy?e:t)/2,c+=(l.dummy?e:t)/2,c+=l.width/2,lodash_1$1.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=l.width/2;break;case"r":s=-l.width/2}return s&&(c+=n?s:-s),s=0,c}}function width(t,e){return t.node(e).width}var positionX=bk.positionX,position_1=position;function position(t){positionY(t=util$9.asNonCompoundGraph(t)),lodash_1$1.forEach(positionX(t),(function(e,n){t.node(n).x=e}))}function positionY(t){var e=util$9.buildLayerMatrix(t),n=t.graph().ranksep,r=0;lodash_1$1.forEach(e,(function(e){var i=lodash_1$1.max(lodash_1$1.map(e,(function(e){return t.node(e).height})));lodash_1$1.forEach(e,(function(e){t.node(e).y=r+i/2})),r+=i+n}))}var normalizeRanks=util$9.normalizeRanks,removeEmptyRanks=util$9.removeEmptyRanks,util$7=util$9,Graph$2=graphlib_1.Graph,layout_1=layout$1;function layout$1(t,e){var n=e&&e.debugTiming?util$7.time:util$7.notime;n("layout",(function(){var e=n("  buildLayoutGraph",(function(){return buildLayoutGraph(t)}));n("  runLayout",(function(){runLayout(e,n)})),n("  updateInputGraph",(function(){updateInputGraph(t,e)}))}))}function runLayout(t,e){e("    makeSpaceForEdgeLabels",(function(){makeSpaceForEdgeLabels(t)})),e("    removeSelfEdges",(function(){removeSelfEdges(t)})),e("    acyclic",(function(){acyclic.run(t)})),e("    nestingGraph.run",(function(){nestingGraph.run(t)})),e("    rank",(function(){rank_1(util$7.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){injectEdgeLabelProxies(t)})),e("    removeEmptyRanks",(function(){removeEmptyRanks(t)})),e("    nestingGraph.cleanup",(function(){nestingGraph.cleanup(t)})),e("    normalizeRanks",(function(){normalizeRanks(t)})),e("    assignRankMinMax",(function(){assignRankMinMax(t)})),e("    removeEdgeLabelProxies",(function(){removeEdgeLabelProxies(t)})),e("    normalize.run",(function(){normalize$3.run(t)})),e("    parentDummyChains",(function(){parentDummyChains_1(t)})),e("    addBorderSegments",(function(){addBorderSegments_1(t)})),e("    order",(function(){order_1(t)})),e("    insertSelfEdges",(function(){insertSelfEdges(t)})),e("    adjustCoordinateSystem",(function(){coordinateSystem.adjust(t)})),e("    position",(function(){position_1(t)})),e("    positionSelfEdges",(function(){positionSelfEdges(t)})),e("    removeBorderNodes",(function(){removeBorderNodes(t)})),e("    normalize.undo",(function(){normalize$3.undo(t)})),e("    fixupEdgeLabelCoords",(function(){fixupEdgeLabelCoords(t)})),e("    undoCoordinateSystem",(function(){coordinateSystem.undo(t)})),e("    translateGraph",(function(){translateGraph(t)})),e("    assignNodeIntersects",(function(){assignNodeIntersects(t)})),e("    reversePoints",(function(){reversePointsForReversedEdges(t)})),e("    acyclic.undo",(function(){acyclic.undo(t)}))}function updateInputGraph(t,e){lodash_1$1.forEach(t.nodes(),(function(n){var r=t.node(n),i=e.node(n);r&&(r.x=i.x,r.y=i.y,e.children(n).length&&(r.width=i.width,r.height=i.height))})),lodash_1$1.forEach(t.edges(),(function(n){var r=t.edge(n),i=e.edge(n);r.points=i.points,lodash_1$1.has(i,"x")&&(r.x=i.x,r.y=i.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}var graphNumAttrs=["nodesep","edgesep","ranksep","marginx","marginy"],graphDefaults={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},graphAttrs=["acyclicer","ranker","rankdir","align"],nodeNumAttrs=["width","height"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"];function buildLayoutGraph(t){var e=new Graph$2({multigraph:!0,compound:!0}),n=canonicalize(t.graph());return e.setGraph(lodash_1$1.merge({},graphDefaults,selectNumberAttrs(n,graphNumAttrs),lodash_1$1.pick(n,graphAttrs))),lodash_1$1.forEach(t.nodes(),(function(n){var r=canonicalize(t.node(n));e.setNode(n,lodash_1$1.defaults(selectNumberAttrs(r,nodeNumAttrs),nodeDefaults)),e.setParent(n,t.parent(n))})),lodash_1$1.forEach(t.edges(),(function(n){var r=canonicalize(t.edge(n));e.setEdge(n,lodash_1$1.merge({},edgeDefaults,selectNumberAttrs(r,edgeNumAttrs),lodash_1$1.pick(r,edgeAttrs)))})),e}function makeSpaceForEdgeLabels(t){var e=t.graph();e.ranksep/=2,lodash_1$1.forEach(t.edges(),(function(n){var r=t.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}function injectEdgeLabelProxies(t){lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i=t.node(e.w);util$7.addDummyNode(t,"edge-proxy",{rank:(i.rank-r.rank)/2+r.rank,e},"_ep")}}))}function assignRankMinMax(t){var e=0;lodash_1$1.forEach(t.nodes(),(function(n){var r=t.node(n);r.borderTop&&(r.minRank=t.node(r.borderTop).rank,r.maxRank=t.node(r.borderBottom).rank,e=lodash_1$1.max(e,r.maxRank))})),t.graph().maxRank=e}function removeEdgeLabelProxies(t){lodash_1$1.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}function translateGraph(t){var e=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,o=t.graph(),s=o.marginx||0,a=o.marginy||0;function l(t){var o=t.x,s=t.y,a=t.width,l=t.height;e=Math.min(e,o-a/2),n=Math.max(n,o+a/2),r=Math.min(r,s-l/2),i=Math.max(i,s+l/2)}lodash_1$1.forEach(t.nodes(),(function(e){l(t.node(e))})),lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);lodash_1$1.has(n,"x")&&l(n)})),e-=s,r-=a,lodash_1$1.forEach(t.nodes(),(function(n){var i=t.node(n);i.x-=e,i.y-=r})),lodash_1$1.forEach(t.edges(),(function(n){var i=t.edge(n);lodash_1$1.forEach(i.points,(function(t){t.x-=e,t.y-=r})),lodash_1$1.has(i,"x")&&(i.x-=e),lodash_1$1.has(i,"y")&&(i.y-=r)})),o.width=n-e+s,o.height=i-r+a}function assignNodeIntersects(t){lodash_1$1.forEach(t.edges(),(function(e){var n,r,i=t.edge(e),o=t.node(e.v),s=t.node(e.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=s,r=o),i.points.unshift(util$7.intersectRect(o,n)),i.points.push(util$7.intersectRect(s,r))}))}function fixupEdgeLabelCoords(t){lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);if(lodash_1$1.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}function reversePointsForReversedEdges(t){lodash_1$1.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}function removeBorderNodes(t){lodash_1$1.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),r=t.node(n.borderTop),i=t.node(n.borderBottom),o=t.node(lodash_1$1.last(n.borderLeft)),s=t.node(lodash_1$1.last(n.borderRight));n.width=Math.abs(s.x-o.x),n.height=Math.abs(i.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}})),lodash_1$1.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}function removeSelfEdges(t){lodash_1$1.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e,label:t.edge(e)}),t.removeEdge(e)}}))}function insertSelfEdges(t){var e=util$7.buildLayerMatrix(t);lodash_1$1.forEach(e,(function(e){var n=0;lodash_1$1.forEach(e,(function(e,r){var i=t.node(e);i.order=r+n,lodash_1$1.forEach(i.selfEdges,(function(e){util$7.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:i.rank,order:r+ ++n,e:e.e,label:e.label},"_se")})),delete i.selfEdges}))}))}function positionSelfEdges(t){lodash_1$1.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var r=t.node(n.e.v),i=r.x+r.width/2,o=r.y,s=n.x-i,a=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{x:i+s,y:o},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],n.label.x=n.x,n.label.y=n.y}}))}function selectNumberAttrs(t,e){return lodash_1$1.mapValues(lodash_1$1.pick(t,e),Number)}function canonicalize(t){var e={};return lodash_1$1.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}var Graph$1=graphlib_1.Graph,debug={debugOrdering};function debugOrdering(t){var e=util$9.buildLayerMatrix(t),n=new Graph$1({compound:!0,multigraph:!0}).setGraph({});return lodash_1$1.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),lodash_1$1.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),lodash_1$1.forEach(e,(function(t,e){n.setNode("layer"+e,{rank:"same"}),lodash_1$1.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}var version$3="0.8.5",dagre$1={graphlib:graphlib_1,layout:layout_1,debug,util:{time:util$9.time,notime:util$9.notime},version:version$3},dagre;if("function"==typeof commonjsRequire)try{dagre=dagre$1}catch(t){}dagre||(dagre=window.dagre);var dagre_1=dagre,intersectNode_1=intersectNode;function intersectNode(t,e){return t.intersect(e)}var intersectEllipse_1=intersectEllipse;function intersectEllipse(t,e,n,r){var i=t.x,o=t.y,s=i-r.x,a=o-r.y,l=Math.sqrt(e*e*a*a+n*n*s*s),c=Math.abs(e*n*s/l);r.x<i&&(c=-c);var u=Math.abs(e*n*a/l);return r.y<o&&(u=-u),{x:i+c,y:o+u}}var intersectCircle_1=intersectCircle;function intersectCircle(t,e,n){return intersectEllipse_1(t,e,e,n)}var intersectLine_1=intersectLine;function intersectLine(t,e,n,r){var i,o,s,a,l,c,u,h,d,f,p,g,m;if(f=(i=e.y-t.y)*r.x+(s=t.x-e.x)*r.y+(l=e.x*t.y-t.x*e.y),!(0!==(d=i*n.x+s*n.y+l)&&0!==f&&sameSign(d,f)||(h=(o=r.y-n.y)*e.x+(a=n.x-r.x)*e.y+(c=r.x*n.y-n.x*r.y),0!==(u=o*t.x+a*t.y+c)&&0!==h&&sameSign(u,h)||0==(p=i*a-o*s))))return g=Math.abs(p/2),{x:(m=s*c-a*l)<0?(m-g)/p:(m+g)/p,y:(m=o*l-i*c)<0?(m-g)/p:(m+g)/p}}function sameSign(t,e){return t*e>0}var intersectPolygon_1=intersectPolygon;function intersectPolygon(t,e,n){var r=t.x,i=t.y,o=[],s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;e.forEach((function(t){s=Math.min(s,t.x),a=Math.min(a,t.y)}));for(var l=r-t.width/2-s,c=i-t.height/2-a,u=0;u<e.length;u++){var h=e[u],d=e[u<e.length-1?u+1:0],f=intersectLine_1(t,n,{x:l+h.x,y:c+h.y},{x:l+d.x,y:c+d.y});f&&o.push(f)}return o.length?(o.length>1&&o.sort((function(t,e){var r=t.x-n.x,i=t.y-n.y,o=Math.sqrt(r*r+i*i),s=e.x-n.x,a=e.y-n.y,l=Math.sqrt(s*s+a*a);return o<l?-1:o===l?0:1})),o[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",t),t)}var intersectRect_1=intersectRect;function intersectRect(t,e){var n,r,i=t.x,o=t.y,s=e.x-i,a=e.y-o,l=t.width/2,c=t.height/2;return Math.abs(a)*l>Math.abs(s)*c?(a<0&&(c=-c),n=0===a?0:c*s/a,r=c):(s<0&&(l=-l),n=l,r=0===s?0:l*a/s),{x:i+n,y:o+r}}var intersect$1={node:intersectNode_1,circle:intersectCircle_1,ellipse:intersectEllipse_1,polygon:intersectPolygon_1,rect:intersectRect_1},lodash$2;if("function"==typeof commonjsRequire)try{lodash$2={defaults:defaults_1,each,isFunction:isFunction_1,isPlainObject:isPlainObject_1,pick:pick_1,has:has_1,range:range_1,uniqueId:uniqueId_1}}catch(t){}lodash$2||(lodash$2=window._);var lodash_1=lodash$2,version$2="5.16.0";function ascending$3(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function bisector(t){return 1===t.length&&(t=ascendingComparator(t)),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}function ascendingComparator(t){return function(e,n){return ascending$3(t(e),n)}}var ascendingBisect=bisector(ascending$3),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left;function pairs(t,e){null==e&&(e=pair);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return o}function pair(t,e){return[t,e]}function cross$3(t,e,n){var r,i,o,s,a=t.length,l=e.length,c=new Array(a*l);for(null==n&&(n=pair),r=o=0;r<a;++r)for(s=t[r],i=0;i<l;++i,++o)c[o]=n(s,e[i]);return c}function descending$2(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function number$6(t){return null===t?NaN:+t}function variance(t,e){var n,r,i=t.length,o=0,s=-1,a=0,l=0;if(null==e)for(;++s<i;)isNaN(n=number$6(t[s]))||(l+=(r=n-a)*(n-(a+=r/++o)));else for(;++s<i;)isNaN(n=number$6(e(t[s],s,t)))||(l+=(r=n-a)*(n-(a+=r/++o)));if(o>1)return l/(o-1)}function deviation(t,e){var n=variance(t,e);return n?Math.sqrt(n):n}function extent$1(t,e){var n,r,i,o=t.length,s=-1;if(null==e){for(;++s<o;)if(null!=(n=t[s])&&n>=n)for(r=i=n;++s<o;)null!=(n=t[s])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++s<o;)if(null!=(n=e(t[s],s,t))&&n>=n)for(r=i=n;++s<o;)null!=(n=e(t[s],s,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]}var array$6=Array.prototype,slice$7=array$6.slice,map$4=array$6.map;function constant$e(t){return function(){return t}}function identity$a(t){return t}function sequence(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}var e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function ticks(t,e,n){var r,i,o,s,a=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=tickIncrement(t,e,n))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),o=new Array(i=Math.ceil(e-t+1));++a<i;)o[a]=(t+a)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),o=new Array(i=Math.ceil(t-e+1));++a<i;)o[a]=(t-a)/s;return r&&o.reverse(),o}function tickIncrement(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=e10?10:o>=e5?5:o>=e2?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=e10?10:o>=e5?5:o>=e2?2:1)}function tickStep(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=e10?i*=10:o>=e5?i*=5:o>=e2&&(i*=2),e<t?-i:i}function thresholdSturges(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function histogram(){var t=identity$a,e=extent$1,n=thresholdSturges;function r(r){var i,o,s=r.length,a=new Array(s);for(i=0;i<s;++i)a[i]=t(r[i],i,r);var l=e(a),c=l[0],u=l[1],h=n(a,c,u);Array.isArray(h)||(h=tickStep(c,u,h),h=sequence(Math.ceil(c/h)*h,u,h));for(var d=h.length;h[0]<=c;)h.shift(),--d;for(;h[d-1]>u;)h.pop(),--d;var f,p=new Array(d+1);for(i=0;i<=d;++i)(f=p[i]=[]).x0=i>0?h[i-1]:c,f.x1=i<d?h[i]:u;for(i=0;i<s;++i)c<=(o=a[i])&&o<=u&&p[bisectRight(h,o,0,d)].push(r[i]);return p}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:constant$e(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:constant$e([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?constant$e(slice$7.call(t)):constant$e(t),r):n},r}function threshold$1(t,e,n){if(null==n&&(n=number$6),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t);return s+(+n(t[o+1],o+1,t)-s)*(i-o)}}function freedmanDiaconis(t,e,n){return t=map$4.call(t,number$6).sort(ascending$3),Math.ceil((n-e)/(2*(threshold$1(t,.75)-threshold$1(t,.25))*Math.pow(t.length,-1/3)))}function scott(t,e,n){return Math.ceil((n-e)/(3.5*deviation(t)*Math.pow(t.length,-1/3)))}function max$3(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&n>r&&(r=n);return r}function mean$1(t,e){var n,r=t.length,i=r,o=-1,s=0;if(null==e)for(;++o<r;)isNaN(n=number$6(t[o]))?--i:s+=n;else for(;++o<r;)isNaN(n=number$6(e(t[o],o,t)))?--i:s+=n;if(i)return s/i}function median(t,e){var n,r=t.length,i=-1,o=[];if(null==e)for(;++i<r;)isNaN(n=number$6(t[i]))||o.push(n);else for(;++i<r;)isNaN(n=number$6(e(t[i],i,t)))||o.push(n);return threshold$1(o.sort(ascending$3),.5)}function merge$1(t){for(var e,n,r,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(n=new Array(s);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--s]=r[e];return n}function min$2(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&r>n&&(r=n);return r}function permute(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r}function scan(t,e){if(n=t.length){var n,r,i=0,o=0,s=t[o];for(null==e&&(e=ascending$3);++i<n;)(e(r=t[i],s)<0||0!==e(s,s))&&(s=r,o=i);return 0===e(s,s)?o:void 0}}function shuffle$2(t,e,n){for(var r,i,o=(null==n?t.length:n)-(e=null==e?0:+e);o;)i=Math.random()*o--|0,r=t[o+e],t[o+e]=t[i+e],t[i+e]=r;return t}function sum$3(t,e){var n,r=t.length,i=-1,o=0;if(null==e)for(;++i<r;)(n=+t[i])&&(o+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(o+=n);return o}function transpose(t){if(!(i=t.length))return[];for(var e=-1,n=min$2(t,length$3),r=new Array(n);++e<n;)for(var i,o=-1,s=r[e]=new Array(i);++o<i;)s[o]=t[o][e];return r}function length$3(t){return t.length}function zip$1(){return transpose(arguments)}var slice$6=Array.prototype.slice;function identity$9(t){return t}var top$3=1,right$3=2,bottom$3=3,left$3=4,epsilon$4=1e-6;function translateX(t){return"translate("+(t+.5)+",0)"}function translateY(t){return"translate(0,"+(t+.5)+")"}function number$5(t){return function(e){return+t(e)}}function center$2(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function entering(){return!this.__axis}function axis(t,e){var n=[],r=null,i=null,o=6,s=6,a=3,l=t===top$3||t===left$3?-1:1,c=t===left$3||t===right$3?"x":"y",u=t===top$3||t===bottom$3?translateX:translateY;function h(h){var d=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,f=null==i?e.tickFormat?e.tickFormat.apply(e,n):identity$9:i,p=Math.max(o,0)+a,g=e.range(),m=+g[0]+.5,A=+g[g.length-1]+.5,y=(e.bandwidth?center$2:number$5)(e.copy()),v=h.selection?h.selection():h,b=v.selectAll(".domain").data([null]),x=v.selectAll(".tick").data(d,e).order(),w=x.exit(),C=x.enter().append("g").attr("class","tick"),$=x.select("line"),_=x.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(C),$=$.merge(C.append("line").attr("stroke","currentColor").attr(c+"2",l*o)),_=_.merge(C.append("text").attr("fill","currentColor").attr(c,l*p).attr("dy",t===top$3?"0em":t===bottom$3?"0.71em":"0.32em")),h!==v&&(b=b.transition(h),x=x.transition(h),$=$.transition(h),_=_.transition(h),w=w.transition(h).attr("opacity",epsilon$4).attr("transform",(function(t){return isFinite(t=y(t))?u(t):this.getAttribute("transform")})),C.attr("opacity",epsilon$4).attr("transform",(function(t){var e=this.parentNode.__axis;return u(e&&isFinite(e=e(t))?e:y(t))}))),w.remove(),b.attr("d",t===left$3||t==right$3?s?"M"+l*s+","+m+"H0.5V"+A+"H"+l*s:"M0.5,"+m+"V"+A:s?"M"+m+","+l*s+"V0.5H"+A+"V"+l*s:"M"+m+",0.5H"+A),x.attr("opacity",1).attr("transform",(function(t){return u(y(t))})),$.attr(c+"2",l*o),_.attr(c,l*p).text(f),v.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===right$3?"start":t===left$3?"end":"middle"),v.each((function(){this.__axis=y}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=slice$6.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:slice$6.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:slice$6.call(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(i=t,h):i},h.tickSize=function(t){return arguments.length?(o=s=+t,h):o},h.tickSizeInner=function(t){return arguments.length?(o=+t,h):o},h.tickSizeOuter=function(t){return arguments.length?(s=+t,h):s},h.tickPadding=function(t){return arguments.length?(a=+t,h):a},h}function axisTop(t){return axis(top$3,t)}function axisRight(t){return axis(right$3,t)}function axisBottom(t){return axis(bottom$3,t)}function axisLeft(t){return axis(left$3,t)}var noop$5={value:function(){}};function dispatch(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Dispatch(r)}function Dispatch(t){this._=t}function parseTypenames$1(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function get$2(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function set$3(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=noop$5,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(t,e){var n,r=this._,i=parseTypenames$1(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)r[n]=set$3(r[n],t.name,e);else if(null==e)for(n in r)r[n]=set$3(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=get$2(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Dispatch(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),namespaces.hasOwnProperty(e)?{space:namespaces[e],local:t}:t}function creatorInherit(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===xhtml&&e.documentElement.namespaceURI===xhtml?e.createElement(t):e.createElementNS(n,t)}}function creatorFixed(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function creator(t){var e=namespace(t);return(e.local?creatorFixed:creatorInherit)(e)}function none$2(){}function selector(t){return null==t?none$2:function(){return this.querySelector(t)}}function selection_select(t){"function"!=typeof t&&(t=selector(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],l=a.length,c=r[i]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=t.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new Selection$2(r,this._parents)}function empty$2(){return[]}function selectorAll(t){return null==t?empty$2:function(){return this.querySelectorAll(t)}}function selection_selectAll(t){"function"!=typeof t&&(t=selectorAll(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(r.push(t.call(s,s.__data__,c,a)),i.push(s));return new Selection$2(r,i)}function matcher(t){return function(){return this.matches(t)}}function selection_filter(t){"function"!=typeof t&&(t=matcher(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Selection$2(r,this._parents)}function sparse(t){return new Array(t.length)}function selection_enter(){return new Selection$2(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function constant$d(t){return function(){return t}}EnterNode.prototype={constructor:EnterNode,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var keyPrefix$1="$";function bindIndex(t,e,n,r,i,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new EnterNode(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function bindKey$1(t,e,n,r,i,o,s){var a,l,c,u={},h=e.length,d=o.length,f=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(f[a]=c=keyPrefix$1+s.call(l,l.__data__,a,e),c in u?i[a]=l:u[c]=l);for(a=0;a<d;++a)(l=u[c=keyPrefix$1+s.call(t,o[a],a,o)])?(r[a]=l,l.__data__=o[a],u[c]=null):n[a]=new EnterNode(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&u[f[a]]===l&&(i[a]=l)}function selection_data(t,e){if(!t)return f=new Array(this.size()),c=-1,this.each((function(t){f[++c]=t})),f;var n=e?bindKey$1:bindIndex,r=this._parents,i=this._groups;"function"!=typeof t&&(t=constant$d(t));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],h=i[c],d=h.length,f=t.call(u,u&&u.__data__,c,r),p=f.length,g=a[c]=new Array(p),m=s[c]=new Array(p);n(u,h,g,m,l[c]=new Array(d),f,e);for(var A,y,v=0,b=0;v<p;++v)if(A=g[v]){for(v>=b&&(b=v+1);!(y=m[b])&&++b<p;);A._next=y||null}}return(s=new Selection$2(s,r))._enter=a,s._exit=l,s}function selection_exit(){return new Selection$2(this._exit||this._groups.map(sparse),this._parents)}function selection_join(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i}function selection_merge(t){for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),s=0;s<i;++s)for(var a,l=e[s],c=n[s],u=l.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=l[d]||c[d])&&(h[d]=a);for(;s<r;++s)o[s]=e[s];return new Selection$2(o,this._parents)}function selection_order(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this}function selection_sort(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=ascending$2);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,c=i[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(e)}return new Selection$2(i,this._parents).order()}function ascending$2(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function selection_call(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function selection_nodes(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t}function selection_node(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function selection_size(){var t=0;return this.each((function(){++t})),t}function selection_empty(){return!this.node()}function selection_each(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this}function attrRemove$1(t){return function(){this.removeAttribute(t)}}function attrRemoveNS$1(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant$1(t,e){return function(){this.setAttribute(t,e)}}function attrConstantNS$1(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function attrFunction$1(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function attrFunctionNS$1(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function selection_attr(t,e){var n=namespace(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?attrRemoveNS$1:attrRemove$1:"function"==typeof e?n.local?attrFunctionNS$1:attrFunction$1:n.local?attrConstantNS$1:attrConstant$1)(n,e))}function defaultView(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function styleRemove$1(t){return function(){this.style.removeProperty(t)}}function styleConstant$1(t,e,n){return function(){this.style.setProperty(t,e,n)}}function styleFunction$1(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function selection_style(t,e,n){return arguments.length>1?this.each((null==e?styleRemove$1:"function"==typeof e?styleFunction$1:styleConstant$1)(t,e,null==n?"":n)):styleValue(this.node(),t)}function styleValue(t,e){return t.style.getPropertyValue(e)||defaultView(t).getComputedStyle(t,null).getPropertyValue(e)}function propertyRemove(t){return function(){delete this[t]}}function propertyConstant(t,e){return function(){this[t]=e}}function propertyFunction(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function selection_property(t,e){return arguments.length>1?this.each((null==e?propertyRemove:"function"==typeof e?propertyFunction:propertyConstant)(t,e)):this.node()[t]}function classArray(t){return t.trim().split(/^|\s+/)}function classList(t){return t.classList||new ClassList(t)}function ClassList(t){this._node=t,this._names=classArray(t.getAttribute("class")||"")}function classedAdd(t,e){for(var n=classList(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function classedRemove(t,e){for(var n=classList(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function classedTrue(t){return function(){classedAdd(this,t)}}function classedFalse(t){return function(){classedRemove(this,t)}}function classedFunction(t,e){return function(){(e.apply(this,arguments)?classedAdd:classedRemove)(this,t)}}function selection_classed(t,e){var n=classArray(t+"");if(arguments.length<2){for(var r=classList(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?classedFunction:e?classedTrue:classedFalse)(n,e))}function textRemove(){this.textContent=""}function textConstant$1(t){return function(){this.textContent=t}}function textFunction$1(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function selection_text(t){return arguments.length?this.each(null==t?textRemove:("function"==typeof t?textFunction$1:textConstant$1)(t)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(t){return function(){this.innerHTML=t}}function htmlFunction(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function selection_html(t){return arguments.length?this.each(null==t?htmlRemove:("function"==typeof t?htmlFunction:htmlConstant)(t)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(t){var e="function"==typeof t?t:creator(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))}function constantNull(){return null}function selection_insert(t,e){var n="function"==typeof t?t:creator(t),r=null==e?constantNull:"function"==typeof e?e:selector(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))}function remove$2(){var t=this.parentNode;t&&t.removeChild(this)}function selection_remove(){return this.each(remove$2)}function selection_cloneShallow(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_cloneDeep(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_clone(t){return this.select(t?selection_cloneDeep:selection_cloneShallow)}function selection_datum(t){return arguments.length?this.property("__data__",t):this.node().__data__}ClassList.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var filterEvents={},event=null;if("undefined"!=typeof document){var element=document.documentElement;"onmouseenter"in element||(filterEvents={mouseenter:"mouseover",mouseleave:"mouseout"})}function filterContextListener(t,e,n){return t=contextListener(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function contextListener(t,e,n){return function(r){var i=event;event=r;try{t.call(this,this.__data__,e,n)}finally{event=i}}}function parseTypenames(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function onRemove(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function onAdd(t,e,n){var r=filterEvents.hasOwnProperty(t.type)?filterContextListener:contextListener;return function(i,o,s){var a,l=this.__on,c=r(e,o,s);if(l)for(var u=0,h=l.length;u<h;++u)if((a=l[u]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=c,a.capture=n),void(a.value=e);this.addEventListener(t.type,c,n),a={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(a):this.__on=[a]}}function selection_on(t,e,n){var r,i,o=parseTypenames(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?onAdd:onRemove,null==n&&(n=!1),r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(r=0,l=a[c];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value}function customEvent(t,e,n,r){var i=event;t.sourceEvent=event,event=t;try{return e.apply(n,r)}finally{event=i}}function dispatchEvent(t,e,n){var r=defaultView(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function dispatchConstant(t,e){return function(){return dispatchEvent(this,t,e)}}function dispatchFunction(t,e){return function(){return dispatchEvent(this,t,e.apply(this,arguments))}}function selection_dispatch(t,e){return this.each(("function"==typeof e?dispatchFunction:dispatchConstant)(t,e))}var root$2=[null];function Selection$2(t,e){this._groups=t,this._parents=e}function selection$1(){return new Selection$2([[document.documentElement]],root$2)}function select(t){return"string"==typeof t?new Selection$2([[document.querySelector(t)]],[document.documentElement]):new Selection$2([[t]],root$2)}function create$2(t){return select(creator(t).call(document.documentElement))}Selection$2.prototype=selection$1.prototype={constructor:Selection$2,select:selection_select,selectAll:selection_selectAll,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch};var nextId=0;function local$1(){return new Local}function Local(){this._="@"+(++nextId).toString(36)}function sourceEvent(){for(var t,e=event;t=e.sourceEvent;)e=t;return e}function point$6(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function mouse(t){var e=sourceEvent();return e.changedTouches&&(e=e.changedTouches[0]),point$6(t,e)}function selectAll(t){return"string"==typeof t?new Selection$2([document.querySelectorAll(t)],[document.documentElement]):new Selection$2([null==t?[]:t],root$2)}function touch(t,e,n){arguments.length<3&&(n=e,e=sourceEvent().changedTouches);for(var r,i=0,o=e?e.length:0;i<o;++i)if((r=e[i]).identifier===n)return point$6(t,r);return null}function touches(t,e){null==e&&(e=sourceEvent().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=point$6(t,e[n]);return i}function nopropagation$2(){event.stopImmediatePropagation()}function noevent$2(){event.preventDefault(),event.stopImmediatePropagation()}function dragDisable(t){var e=t.document.documentElement,n=select(t).on("dragstart.drag",noevent$2,!0);"onselectstart"in e?n.on("selectstart.drag",noevent$2,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function yesdrag(t,e){var n=t.document.documentElement,r=select(t).on("dragstart.drag",null);e&&(r.on("click.drag",noevent$2,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function constant$c(t){return function(){return t}}function DragEvent(t,e,n,r,i,o,s,a,l,c){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=s,this.dx=a,this.dy=l,this._=c}function defaultFilter$2(){return!event.ctrlKey&&!event.button}function defaultContainer(){return this.parentNode}function defaultSubject(t){return null==t?{x:event.x,y:event.y}:t}function defaultTouchable$2(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var t,e,n,r,i=defaultFilter$2,o=defaultContainer,s=defaultSubject,a=defaultTouchable$2,l={},c=dispatch("start","drag","end"),u=0,h=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",m).on("touchmove.drag",A).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!r&&i.apply(this,arguments)){var s=v("mouse",o.apply(this,arguments),mouse,this,arguments);s&&(select(event.view).on("mousemove.drag",p,!0).on("mouseup.drag",g,!0),dragDisable(event.view),nopropagation$2(),n=!1,t=event.clientX,e=event.clientY,s("start"))}}function p(){if(noevent$2(),!n){var r=event.clientX-t,i=event.clientY-e;n=r*r+i*i>h}l.mouse("drag")}function g(){select(event.view).on("mousemove.drag mouseup.drag",null),yesdrag(event.view,n),noevent$2(),l.mouse("end")}function m(){if(i.apply(this,arguments)){var t,e,n=event.changedTouches,r=o.apply(this,arguments),s=n.length;for(t=0;t<s;++t)(e=v(n[t].identifier,r,touch,this,arguments))&&(nopropagation$2(),e("start"))}}function A(){var t,e,n=event.changedTouches,r=n.length;for(t=0;t<r;++t)(e=l[n[t].identifier])&&(noevent$2(),e("drag"))}function y(){var t,e,n=event.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(e=l[n[t].identifier])&&(nopropagation$2(),e("end"))}function v(t,e,n,r,i){var o,a,h,f=n(e,t),p=c.copy();if(customEvent(new DragEvent(d,"beforestart",o,t,u,f[0],f[1],0,0,p),(function(){return null!=(event.subject=o=s.apply(r,i))&&(a=o.x-f[0]||0,h=o.y-f[1]||0,!0)})))return function s(c){var g,m=f;switch(c){case"start":l[t]=s,g=u++;break;case"end":delete l[t],--u;case"drag":f=n(e,t),g=u}customEvent(new DragEvent(d,c,o,t,g,f[0]+a,f[1]+h,f[0]-m[0],f[1]-m[1],p),p.apply,p,[c,r,i])}}return d.filter=function(t){return arguments.length?(i="function"==typeof t?t:constant$c(!!t),d):i},d.container=function(t){return arguments.length?(o="function"==typeof t?t:constant$c(t),d):o},d.subject=function(t){return arguments.length?(s="function"==typeof t?t:constant$c(t),d):s},d.touchable=function(t){return arguments.length?(a="function"==typeof t?t:constant$c(!!t),d):a},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d}function define(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function extend(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Color$1(){}Local.prototype=local$1.prototype={constructor:Local,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}},DragEvent.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=reHex.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?rgbn(e):3===n?new Rgb(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?rgba(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?rgba(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=reRgbInteger.exec(t))?new Rgb(e[1],e[2],e[3],1):(e=reRgbPercent.exec(t))?new Rgb(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=reRgbaInteger.exec(t))?rgba(e[1],e[2],e[3],e[4]):(e=reRgbaPercent.exec(t))?rgba(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=reHslPercent.exec(t))?hsla(e[1],e[2]/100,e[3]/100,1):(e=reHslaPercent.exec(t))?hsla(e[1],e[2]/100,e[3]/100,e[4]):named.hasOwnProperty(t)?rgbn(named[t]):"transparent"===t?new Rgb(NaN,NaN,NaN,0):null}function rgbn(t){return new Rgb(t>>16&255,t>>8&255,255&t,1)}function rgba(t,e,n,r){return r<=0&&(t=e=n=NaN),new Rgb(t,e,n,r)}function rgbConvert(t){return t instanceof Color$1||(t=color(t)),t?new Rgb((t=t.rgb()).r,t.g,t.b,t.opacity):new Rgb}function rgb(t,e,n,r){return 1===arguments.length?rgbConvert(t):new Rgb(t,e,n,null==r?1:r)}function Rgb(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function rgb_formatHex(){return"#"+hex(this.r)+hex(this.g)+hex(this.b)}function rgb_formatRgb(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function hex(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function hsla(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Hsl(t,e,n,r)}function hslConvert(t){if(t instanceof Hsl)return new Hsl(t.h,t.s,t.l,t.opacity);if(t instanceof Color$1||(t=color(t)),!t)return new Hsl;if(t instanceof Hsl)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Hsl(s,a,l,t.opacity)}function hsl$2(t,e,n,r){return 1===arguments.length?hslConvert(t):new Hsl(t,e,n,null==r?1:r)}function Hsl(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function hsl2rgb(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}define(Color$1,color,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb}),define(Rgb,rgb,extend(Color$1,{brighter:function(t){return t=null==t?brighter:Math.pow(brighter,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?darker:Math.pow(darker,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),define(Hsl,hsl$2,extend(Color$1,{brighter:function(t){return t=null==t?brighter:Math.pow(brighter,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?darker:Math.pow(darker,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Rgb(hsl2rgb(t>=240?t-240:t+120,i,r),hsl2rgb(t,i,r),hsl2rgb(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var deg2rad=Math.PI/180,rad2deg=180/Math.PI,K=18,Xn=.96422,Yn=1,Zn=.82521,t0$1=4/29,t1$1=6/29,t2=3*t1$1*t1$1,t3=t1$1*t1$1*t1$1;function labConvert(t){if(t instanceof Lab)return new Lab(t.l,t.a,t.b,t.opacity);if(t instanceof Hcl)return hcl2lab(t);t instanceof Rgb||(t=rgbConvert(t));var e,n,r=rgb2lrgb(t.r),i=rgb2lrgb(t.g),o=rgb2lrgb(t.b),s=xyz2lab((.2225045*r+.7168786*i+.0606169*o)/Yn);return r===i&&i===o?e=n=s:(e=xyz2lab((.4360747*r+.3850649*i+.1430804*o)/Xn),n=xyz2lab((.0139322*r+.0971045*i+.7141733*o)/Zn)),new Lab(116*s-16,500*(e-s),200*(s-n),t.opacity)}function gray(t,e){return new Lab(t,0,0,null==e?1:e)}function lab$1(t,e,n,r){return 1===arguments.length?labConvert(t):new Lab(t,e,n,null==r?1:r)}function Lab(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function xyz2lab(t){return t>t3?Math.pow(t,1/3):t/t2+t0$1}function lab2xyz(t){return t>t1$1?t*t*t:t2*(t-t0$1)}function lrgb2rgb(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function rgb2lrgb(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function hclConvert(t){if(t instanceof Hcl)return new Hcl(t.h,t.c,t.l,t.opacity);if(t instanceof Lab||(t=labConvert(t)),0===t.a&&0===t.b)return new Hcl(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*rad2deg;return new Hcl(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function lch(t,e,n,r){return 1===arguments.length?hclConvert(t):new Hcl(n,e,t,null==r?1:r)}function hcl$2(t,e,n,r){return 1===arguments.length?hclConvert(t):new Hcl(t,e,n,null==r?1:r)}function Hcl(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function hcl2lab(t){if(isNaN(t.h))return new Lab(t.l,0,0,t.opacity);var e=t.h*deg2rad;return new Lab(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}define(Lab,lab$1,extend(Color$1,{brighter:function(t){return new Lab(this.l+K*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Lab(this.l-K*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Rgb(lrgb2rgb(3.1338561*(e=Xn*lab2xyz(e))-1.6168667*(t=Yn*lab2xyz(t))-.4906146*(n=Zn*lab2xyz(n))),lrgb2rgb(-.9787684*e+1.9161415*t+.033454*n),lrgb2rgb(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),define(Hcl,hcl$2,extend(Color$1,{brighter:function(t){return new Hcl(this.h,this.c,this.l+K*(null==t?1:t),this.opacity)},darker:function(t){return new Hcl(this.h,this.c,this.l-K*(null==t?1:t),this.opacity)},rgb:function(){return hcl2lab(this).rgb()}}));var A$1=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A$1;function cubehelixConvert(t){if(t instanceof Cubehelix)return new Cubehelix(t.h,t.s,t.l,t.opacity);t instanceof Rgb||(t=rgbConvert(t));var e=t.g/255,n=t.b/255,r=(BC_DA*n+ED*(t.r/255)-EB*e)/(BC_DA+ED-EB),i=n-r,o=(E*(e-r)-C*i)/D,s=Math.sqrt(o*o+i*i)/(E*r*(1-r)),a=s?Math.atan2(o,i)*rad2deg-120:NaN;return new Cubehelix(a<0?a+360:a,s,r,t.opacity)}function cubehelix$3(t,e,n,r){return 1===arguments.length?cubehelixConvert(t):new Cubehelix(t,e,n,null==r?1:r)}function Cubehelix(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function basis$1(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}function basis$2(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1];return basis$1((n-r/e)*e,r>0?t[r-1]:2*i-o,i,o,r<e-1?t[r+2]:2*o-i)}}function basisClosed$1(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e);return basis$1((n-r/e)*e,t[(r+e-1)%e],t[r%e],t[(r+1)%e],t[(r+2)%e])}}function constant$b(t){return function(){return t}}function linear$2(t,e){return function(n){return t+n*e}}function exponential$1(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function hue$1(t,e){var n=e-t;return n?linear$2(t,n>180||n<-180?n-360*Math.round(n/360):n):constant$b(isNaN(t)?e:t)}function gamma(t){return 1==(t=+t)?nogamma:function(e,n){return n-e?exponential$1(e,n,t):constant$b(isNaN(e)?n:e)}}function nogamma(t,e){var n=e-t;return n?linear$2(t,n):constant$b(isNaN(t)?e:t)}define(Cubehelix,cubehelix$3,extend(Color$1,{brighter:function(t){return t=null==t?brighter:Math.pow(brighter,t),new Cubehelix(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?darker:Math.pow(darker,t),new Cubehelix(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*deg2rad,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Rgb(255*(e+n*(A$1*r+B*i)),255*(e+n*(C*r+D*i)),255*(e+n*(E*r)),this.opacity)}}));const interpolateRgb=function t(e){var n=gamma(e);function r(t,e){var r=n((t=rgb(t)).r,(e=rgb(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=nogamma(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function rgbSpline(t){return function(e){var n,r,i=e.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=rgb(e[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=t(o),s=t(s),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=s(t),r.b=a(t),r+""}}}var rgbBasis=rgbSpline(basis$2),rgbBasisClosed=rgbSpline(basisClosed$1);function numberArray(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function isNumberArray(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function array$5(t,e){return(isNumberArray(e)?numberArray:genericArray)(t,e)}function genericArray(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=interpolateValue(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}function date$2(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function interpolateNumber(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function object$5(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=interpolateValue(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(t){return function(){return t}}function one(t){return function(e){return t(e)+""}}function interpolateString(t,e){var n,r,i,o=reA.lastIndex=reB.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=reA.exec(t))&&(r=reB.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:interpolateNumber(n,r)})),o=reB.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?one(l[0].x):zero(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}function interpolateValue(t,e){var n,r=typeof e;return null==e||"boolean"===r?constant$b(e):("number"===r?interpolateNumber:"string"===r?(n=color(e))?(e=n,interpolateRgb):interpolateString:e instanceof color?interpolateRgb:e instanceof Date?date$2:isNumberArray(e)?numberArray:Array.isArray(e)?genericArray:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?object$5:interpolateNumber)(t,e)}function discrete(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function hue(t,e){var n=hue$1(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function interpolateRound(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var degrees$1=180/Math.PI,identity$8={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},cssNode,cssRoot,cssView,svgNode;function decompose(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*degrees$1,skewX:Math.atan(l)*degrees$1,scaleX:s,scaleY:a}}function parseCss(t){return"none"===t?identity$8:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=t,t=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),decompose(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function parseSvg(t){return null==t?identity$8:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",t),(t=svgNode.transform.baseVal.consolidate())?decompose((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):identity$8)}function interpolateTransform(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:interpolateNumber(t,i)},{i:l-2,x:interpolateNumber(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:interpolateNumber(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:interpolateNumber(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,l),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:interpolateNumber(t,n)},{i:a-2,x:interpolateNumber(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),rho=Math.SQRT2,rho2=2,rho4=4,epsilon2$2=1e-12;function cosh(t){return((t=Math.exp(t))+1/t)/2}function sinh(t){return((t=Math.exp(t))-1/t)/2}function tanh(t){return((t=Math.exp(2*t))-1)/(t+1)}function interpolateZoom(t,e){var n,r,i=t[0],o=t[1],s=t[2],a=e[2],l=e[0]-i,c=e[1]-o,u=l*l+c*c;if(u<epsilon2$2)r=Math.log(a/s)/rho,n=function(t){return[i+t*l,o+t*c,s*Math.exp(rho*t*r)]};else{var h=Math.sqrt(u),d=(a*a-s*s+rho4*u)/(2*s*rho2*h),f=(a*a-s*s-rho4*u)/(2*a*rho2*h),p=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(f*f+1)-f);r=(g-p)/rho,n=function(t){var e=t*r,n=cosh(p),a=s/(rho2*h)*(n*tanh(rho*e+p)-sinh(p));return[i+a*l,o+a*c,s*n/cosh(rho*e+p)]}}return n.duration=1e3*r,n}function hsl(t){return function(e,n){var r=t((e=hsl$2(e)).h,(n=hsl$2(n)).h),i=nogamma(e.s,n.s),o=nogamma(e.l,n.l),s=nogamma(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=s(t),e+""}}}const hsl$1=hsl(hue$1);var hslLong=hsl(nogamma);function lab(t,e){var n=nogamma((t=lab$1(t)).l,(e=lab$1(e)).l),r=nogamma(t.a,e.a),i=nogamma(t.b,e.b),o=nogamma(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function hcl(t){return function(e,n){var r=t((e=hcl$2(e)).h,(n=hcl$2(n)).h),i=nogamma(e.c,n.c),o=nogamma(e.l,n.l),s=nogamma(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=s(t),e+""}}}const hcl$1=hcl(hue$1);var hclLong=hcl(nogamma);function cubehelix$1(t){return function e(n){function r(e,r){var i=t((e=cubehelix$3(e)).h,(r=cubehelix$3(r)).h),o=nogamma(e.s,r.s),s=nogamma(e.l,r.l),a=nogamma(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,r.gamma=e,r}(1)}const cubehelix$2=cubehelix$1(hue$1);var cubehelixLong=cubehelix$1(nogamma);function piecewise(t,e){for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function quantize$1(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var frame=0,timeout$1=0,interval$1=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now$1(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(t,e,n){var r=new Timer;return r.restart(t,e,n),r}function timerFlush(){now$1(),++frame;for(var t,e=taskHead;e;)(t=clockNow-e._time)>=0&&e._call.call(null,t),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var t=clock.now(),e=t-clockLast;e>pokeDelay&&(clockSkew-=e,clockLast=t)}function nap(){for(var t,e,n=taskHead,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:taskHead=e);taskTail=t,sleep(r)}function sleep(t){frame||(timeout$1&&(timeout$1=clearTimeout(timeout$1)),t-clockNow>24?(t<1/0&&(timeout$1=setTimeout(wake,t-clock.now()-clockSkew)),interval$1&&(interval$1=clearInterval(interval$1))):(interval$1||(clockLast=clock.now(),interval$1=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}function timeout(t,e,n){var r=new Timer;return r.restart((function(n){r.stop(),t(n+e)}),e=null==e?0:+e,n),r}function interval(t,e,n){var r=new Timer,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?now$1():+n,r.restart((function o(s){s+=i,r.restart(o,i+=e,n),t(s)}),e,n),r)}Timer.prototype=timer.prototype={constructor:Timer,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?now$1():+n)+(null==e?0:+e),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=t,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};create$1(t,n,{name:e,index:r,group:i,on:emptyOn,tween:emptyTween,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:CREATED})}function init(t,e){var n=get$1(t,e);if(n.state>CREATED)throw new Error("too late; already scheduled");return n}function set$2(t,e){var n=get$1(t,e);if(n.state>STARTED)throw new Error("too late; already running");return n}function get$1(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function create$1(t,e,n){var r,i=t.__transition;function o(l){var c,u,h,d;if(n.state!==SCHEDULED)return a();for(c in i)if((d=i[c]).name===n.name){if(d.state===STARTED)return timeout(o);d.state===RUNNING?(d.state=ENDED,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[c]):+c<e&&(d.state=ENDED,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[c])}if(timeout((function(){n.state===STARTED&&(n.state=RUNNING,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=STARTING,n.on.call("start",t,t.__data__,n.index,n.group),n.state===STARTING){for(n.state=STARTED,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=ENDING,1),o=-1,s=r.length;++o<s;)r[o].call(t,i);n.state===ENDING&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=ENDED,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=timer((function(t){n.state=SCHEDULED,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}function interrupt(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>STARTING&&n.state<ENDING,n.state=ENDED,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}}function selection_interrupt(t){return this.each((function(){interrupt(this,t)}))}function tweenRemove(t,e){var n,r;return function(){var i=set$2(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function tweenFunction(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=set$2(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}o.tween=i}}function transition_tween(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=get$1(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?tweenRemove:tweenFunction)(n,t,e))}function tweenValue(t,e,n){var r=t._id;return t.each((function(){var t=set$2(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return get$1(t,r).value[e]}}function interpolate$1(t,e){var n;return("number"==typeof e?interpolateNumber:e instanceof color?interpolateRgb:(n=color(e))?(e=n,interpolateRgb):interpolateString)(t,e)}function attrRemove(t){return function(){this.removeAttribute(t)}}function attrRemoveNS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function attrConstantNS(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function attrFunction(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttribute(t)}}function attrFunctionNS(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function transition_attr(t,e){var n=namespace(t),r="transform"===n?interpolateTransformSvg:interpolate$1;return this.attrTween(t,"function"==typeof e?(n.local?attrFunctionNS:attrFunction)(n,r,tweenValue(this,"attr."+t,e)):null==e?(n.local?attrRemoveNS:attrRemove)(n):(n.local?attrConstantNS:attrConstant)(n,r,e))}function attrInterpolate(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function attrInterpolateNS(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function attrTweenNS(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&attrInterpolateNS(t,i)),n}return i._value=e,i}function attrTween(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&attrInterpolate(t,i)),n}return i._value=e,i}function transition_attrTween(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=namespace(t);return this.tween(n,(r.local?attrTweenNS:attrTween)(r,e))}function delayFunction(t,e){return function(){init(this,t).delay=+e.apply(this,arguments)}}function delayConstant(t,e){return e=+e,function(){init(this,t).delay=e}}function transition_delay(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?delayFunction:delayConstant)(e,t)):get$1(this.node(),e).delay}function durationFunction(t,e){return function(){set$2(this,t).duration=+e.apply(this,arguments)}}function durationConstant(t,e){return e=+e,function(){set$2(this,t).duration=e}}function transition_duration(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?durationFunction:durationConstant)(e,t)):get$1(this.node(),e).duration}function easeConstant(t,e){if("function"!=typeof e)throw new Error;return function(){set$2(this,t).ease=e}}function transition_ease(t){var e=this._id;return arguments.length?this.each(easeConstant(e,t)):get$1(this.node(),e).ease}function transition_filter(t){"function"!=typeof t&&(t=matcher(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Transition(r,this._parents,this._name,this._id)}function transition_merge(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),s=0;s<i;++s)for(var a,l=e[s],c=n[s],u=l.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=l[d]||c[d])&&(h[d]=a);for(;s<r;++s)o[s]=e[s];return new Transition(o,this._parents,this._name,this._id)}function start(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}function onFunction(t,e,n){var r,i,o=start(e)?init:set$2;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}function transition_on(t,e){var n=this._id;return arguments.length<2?get$1(this.node(),n).on.on(t):this.each(onFunction(n,t,e))}function removeFunction(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=selector(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,c=r[s],u=c.length,h=o[s]=new Array(u),d=0;d<u;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),h[d]=l,schedule(h[d],e,n,d,h,get$1(a,n)));return new Transition(o,this._parents,e,n)}function transition_selectAll(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=selectorAll(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,c=r[a],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=t.call(l,l.__data__,h,c),p=get$1(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&schedule(d,e,n,g,f,p);o.push(f),s.push(l)}return new Transition(o,s,e,n)}var Selection$1=selection$1.prototype.constructor;function transition_selection(){return new Selection$1(this._groups,this._parents)}function styleNull(t,e){var n,r,i;return function(){var o=styleValue(this,t),s=(this.style.removeProperty(t),styleValue(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function styleRemove(t){return function(){this.style.removeProperty(t)}}function styleConstant(t,e,n){var r,i,o=n+"";return function(){var s=styleValue(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}function styleFunction(t,e,n){var r,i,o;return function(){var s=styleValue(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=styleValue(this,t)),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a))}}function styleMaybeRemove(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var l=set$2(this,t),c=l.on,u=null==l.value[s]?o||(o=styleRemove(e)):void 0;c===n&&i===u||(r=(n=c).copy()).on(a,i=u),l.on=r}}function transition_style(t,e,n){var r="transform"==(t+="")?interpolateTransformCss:interpolate$1;return null==e?this.styleTween(t,styleNull(t,r)).on("end.style."+t,styleRemove(t)):"function"==typeof e?this.styleTween(t,styleFunction(t,r,tweenValue(this,"style."+t,e))).each(styleMaybeRemove(this._id,t)):this.styleTween(t,styleConstant(t,r,e),n).on("end.style."+t,null)}function styleInterpolate(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function styleTween(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&styleInterpolate(t,o,n)),r}return o._value=e,o}function transition_styleTween(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,styleTween(t,e,null==n?"":n))}function textConstant(t){return function(){this.textContent=t}}function textFunction(t){return function(){var e=t(this);this.textContent=null==e?"":e}}function transition_text(t){return this.tween("text","function"==typeof t?textFunction(tweenValue(this,"text",t)):textConstant(null==t?"":t+""))}function textInterpolate(t){return function(e){this.textContent=t.call(this,e)}}function textTween(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&textInterpolate(r)),e}return r._value=t,r}function transition_textTween(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,textTween(t))}function transition_transition(){for(var t=this._name,e=this._id,n=newId(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=get$1(s,e);schedule(s,t,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Transition(r,this._parents,t,n)}function transition_end(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=set$2(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e}))}))}var id=0;function Transition(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function transition(t){return selection$1().transition(t)}function newId(){return++id}var selection_prototype=selection$1.prototype;function linear$1(t){return+t}function quadIn(t){return t*t}function quadOut(t){return t*(2-t)}function quadInOut(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function cubicIn(t){return t*t*t}function cubicOut(t){return--t*t*t+1}function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Transition.prototype=transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,end:transition_end};var exponent$1=3,polyIn=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(exponent$1),polyOut=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(exponent$1),polyInOut=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(exponent$1),pi$4=Math.PI,halfPi$3=pi$4/2;function sinIn(t){return 1==+t?1:1-Math.cos(t*halfPi$3)}function sinOut(t){return Math.sin(t*halfPi$3)}function sinInOut(t){return(1-Math.cos(pi$4*t))/2}function tpmt(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function expIn(t){return tpmt(1-+t)}function expOut(t){return 1-tpmt(t)}function expInOut(t){return((t*=2)<=1?tpmt(1-t):2-tpmt(t-1))/2}function circleIn(t){return 1-Math.sqrt(1-t*t)}function circleOut(t){return Math.sqrt(1- --t*t)}function circleInOut(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var b1=4/11,b2=6/11,b3=8/11,b4=3/4,b5=9/11,b6=10/11,b7=15/16,b8=21/22,b9=63/64,b0=1/b1/b1;function bounceIn(t){return 1-bounceOut(1-t)}function bounceOut(t){return(t=+t)<b1?b0*t*t:t<b3?b0*(t-=b2)*t+b4:t<b6?b0*(t-=b5)*t+b7:b0*(t-=b8)*t+b9}function bounceInOut(t){return((t*=2)<=1?1-bounceOut(1-t):bounceOut(t-1)+1)/2}var overshoot=1.70158,backIn=function t(e){function n(t){return(t=+t)*t*(e*(t-1)+t)}return e=+e,n.overshoot=t,n}(overshoot),backOut=function t(e){function n(t){return--t*t*((t+1)*e+t)+1}return e=+e,n.overshoot=t,n}(overshoot),backInOut=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(overshoot),tau$4=2*Math.PI,amplitude=1,period=.3,elasticIn=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=tau$4);function i(t){return e*tpmt(- --t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*tau$4)},i.period=function(n){return t(e,n)},i}(amplitude,period),elasticOut=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=tau$4);function i(t){return 1-e*tpmt(t=+t)*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*tau$4)},i.period=function(n){return t(e,n)},i}(amplitude,period),elasticInOut=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=tau$4);function i(t){return((t=2*t-1)<0?e*tpmt(-t)*Math.sin((r-t)/n):2-e*tpmt(t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*tau$4)},i.period=function(n){return t(e,n)},i}(amplitude,period),defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit$1(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return defaultTiming.time=now$1(),defaultTiming;return n}function selection_transition(t){var e,n;t instanceof Transition?(e=t._id,t=t._name):(e=newId(),(n=defaultTiming).time=now$1(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,c=0;c<l;++c)(s=a[c])&&schedule(s,t,e,c,a,n||inherit$1(s,e));return new Transition(r,this._parents,t,e)}selection$1.prototype.interrupt=selection_interrupt,selection$1.prototype.transition=selection_transition;var root$1=[null];function active(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>SCHEDULED&&n.name===e)return new Transition([[t]],root$1,e,+r);return null}function constant$a(t){return function(){return t}}function BrushEvent(t,e,n){this.target=t,this.type=e,this.selection=n}function nopropagation$1(){event.stopImmediatePropagation()}function noevent$1(){event.preventDefault(),event.stopImmediatePropagation()}var MODE_DRAG={name:"drag"},MODE_SPACE={name:"space"},MODE_HANDLE={name:"handle"},MODE_CENTER={name:"center"};function number1(t){return[+t[0],+t[1]]}function number2(t){return[number1(t[0]),number1(t[1])]}function toucher(t){return function(e){return touch(e,event.touches,t)}}var X={name:"x",handles:["w","e"].map(type),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},XY={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(type),input:function(t){return null==t?null:number2(t)},output:function(t){return t}},cursors={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},flipX$1={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},flipY$1={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},signsX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},signsY={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function type(t){return{type:t}}function defaultFilter$1(){return!event.ctrlKey&&!event.button}function defaultExtent$1(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function defaultTouchable$1(){return navigator.maxTouchPoints||"ontouchstart"in this}function local(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function empty$1(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function brushSelection(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function brushX(){return brush$1(X)}function brushY(){return brush$1(Y)}function brush(){return brush$1(XY)}function brush$1(t){var e,n=defaultExtent$1,r=defaultFilter$1,i=defaultTouchable$1,o=!0,s=dispatch("start","brush","end"),a=6;function l(e){var n=e.property("__brush",g).selectAll(".overlay").data([type("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",cursors.overlay).merge(n).each((function(){var t=local(this).extent;select(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([type("selection")]).enter().append("rect").attr("class","selection").attr("cursor",cursors.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return cursors[t.type]})),e.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(i).on("touchstart.brush",d).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t=select(this),e=local(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-a/2:e[0][0]-a/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-a/2:e[0][1]-a/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+a:a})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+a:a}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new h(t,e,n):r}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function d(){if((!e||event.touches)&&r.apply(this,arguments)){var n,i,s,a,l,h,d,f,p,g,m,A=this,y=event.target.__data__.type,v="selection"===(o&&event.metaKey?y="overlay":y)?MODE_DRAG:o&&event.altKey?MODE_CENTER:MODE_HANDLE,b=t===Y?null:signsX[y],x=t===X?null:signsY[y],w=local(A),C=w.extent,$=w.selection,_=C[0][0],P=C[0][1],S=C[1][0],M=C[1][1],E=0,T=0,k=b&&x&&o&&event.shiftKey,O=event.touches?toucher(event.changedTouches[0].identifier):mouse,N=O(A),R=N,L=u(A,arguments,!0).beforestart();"overlay"===y?($&&(p=!0),w.selection=$=[[n=t===Y?_:N[0],s=t===X?P:N[1]],[l=t===Y?S:n,d=t===X?M:s]]):(n=$[0][0],s=$[0][1],l=$[1][0],d=$[1][1]),i=n,a=s,h=l,f=d;var D=select(A).attr("pointer-events","none"),j=D.selectAll(".overlay").attr("cursor",cursors[y]);if(event.touches)L.moved=F,L.ended=z;else{var I=select(event.view).on("mousemove.brush",F,!0).on("mouseup.brush",z,!0);o&&I.on("keydown.brush",G,!0).on("keyup.brush",V,!0),dragDisable(event.view)}nopropagation$1(),interrupt(A),c.call(A),L.start()}function F(){var t=O(A);!k||g||m||(Math.abs(t[0]-R[0])>Math.abs(t[1]-R[1])?m=!0:g=!0),R=t,p=!0,noevent$1(),B()}function B(){var t;switch(E=R[0]-N[0],T=R[1]-N[1],v){case MODE_SPACE:case MODE_DRAG:b&&(E=Math.max(_-n,Math.min(S-l,E)),i=n+E,h=l+E),x&&(T=Math.max(P-s,Math.min(M-d,T)),a=s+T,f=d+T);break;case MODE_HANDLE:b<0?(E=Math.max(_-n,Math.min(S-n,E)),i=n+E,h=l):b>0&&(E=Math.max(_-l,Math.min(S-l,E)),i=n,h=l+E),x<0?(T=Math.max(P-s,Math.min(M-s,T)),a=s+T,f=d):x>0&&(T=Math.max(P-d,Math.min(M-d,T)),a=s,f=d+T);break;case MODE_CENTER:b&&(i=Math.max(_,Math.min(S,n-E*b)),h=Math.max(_,Math.min(S,l+E*b))),x&&(a=Math.max(P,Math.min(M,s-T*x)),f=Math.max(P,Math.min(M,d+T*x)))}h<i&&(b*=-1,t=n,n=l,l=t,t=i,i=h,h=t,y in flipX$1&&j.attr("cursor",cursors[y=flipX$1[y]])),f<a&&(x*=-1,t=s,s=d,d=t,t=a,a=f,f=t,y in flipY$1&&j.attr("cursor",cursors[y=flipY$1[y]])),w.selection&&($=w.selection),g&&(i=$[0][0],h=$[1][0]),m&&(a=$[0][1],f=$[1][1]),$[0][0]===i&&$[0][1]===a&&$[1][0]===h&&$[1][1]===f||(w.selection=[[i,a],[h,f]],c.call(A),L.brush())}function z(){if(nopropagation$1(),event.touches){if(event.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else yesdrag(event.view,p),I.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);D.attr("pointer-events","all"),j.attr("cursor",cursors.overlay),w.selection&&($=w.selection),empty$1($)&&(w.selection=null,c.call(A)),L.end()}function G(){switch(event.keyCode){case 16:k=b&&x;break;case 18:v===MODE_HANDLE&&(b&&(l=h-E*b,n=i+E*b),x&&(d=f-T*x,s=a+T*x),v=MODE_CENTER,B());break;case 32:v!==MODE_HANDLE&&v!==MODE_CENTER||(b<0?l=h-E:b>0&&(n=i-E),x<0?d=f-T:x>0&&(s=a-T),v=MODE_SPACE,j.attr("cursor",cursors.selection),B());break;default:return}noevent$1()}function V(){switch(event.keyCode){case 16:k&&(g=m=k=!1,B());break;case 18:v===MODE_CENTER&&(b<0?l=h:b>0&&(n=i),x<0?d=f:x>0&&(s=a),v=MODE_HANDLE,B());break;case 32:v===MODE_SPACE&&(event.altKey?(b&&(l=h-E*b,n=i+E*b),x&&(d=f-T*x,s=a+T*x),v=MODE_CENTER):(b<0?l=h:b>0&&(n=i),x<0?d=f:x>0&&(s=a),v=MODE_HANDLE),j.attr("cursor",cursors[y]),B());break;default:return}noevent$1()}}function f(){u(this,arguments).moved()}function p(){u(this,arguments).ended()}function g(){var e=this.__brush||{selection:null};return e.extent=number2(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.selection?e.on("start.brush",(function(){u(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){u(this,arguments).end()})).tween("brush",(function(){var e=this,r=e.__brush,i=u(e,arguments),o=r.selection,s=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),a=interpolateValue(o,s);function l(t){r.selection=1===t&&null===s?null:a(t),c.call(e),i.brush()}return null!==o&&null!==s?l:l(1)})):e.each((function(){var e=this,r=arguments,i=e.__brush,o=t.input("function"==typeof n?n.apply(e,r):n,i.extent),s=u(e,r).beforestart();interrupt(e),i.selection=null===o?null:o,c.call(e),s.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){customEvent(new BrushEvent(l,e,t.output(this.state.selection)),s.apply,s,[e,this.that,this.args])}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:constant$a(number2(t)),l):n},l.filter=function(t){return arguments.length?(r="function"==typeof t?t:constant$a(!!t),l):r},l.touchable=function(t){return arguments.length?(i="function"==typeof t?t:constant$a(!!t),l):i},l.handleSize=function(t){return arguments.length?(a=+t,l):a},l.keyModifiers=function(t){return arguments.length?(o=!!t,l):o},l.on=function(){var t=s.on.apply(s,arguments);return t===s?l:t},l}var cos$2=Math.cos,sin$2=Math.sin,pi$3=Math.PI,halfPi$2=pi$3/2,tau$3=2*pi$3,max$2=Math.max;function compareValue(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}function chord(){var t=0,e=null,n=null,r=null;function i(i){var o,s,a,l,c,u,h=i.length,d=[],f=sequence(h),p=[],g=[],m=g.groups=new Array(h),A=new Array(h*h);for(o=0,c=-1;++c<h;){for(s=0,u=-1;++u<h;)s+=i[c][u];d.push(s),p.push(sequence(h)),o+=s}for(e&&f.sort((function(t,n){return e(d[t],d[n])})),n&&p.forEach((function(t,e){t.sort((function(t,r){return n(i[e][t],i[e][r])}))})),l=(o=max$2(0,tau$3-t*h)/o)?t:tau$3/h,s=0,c=-1;++c<h;){for(a=s,u=-1;++u<h;){var y=f[c],v=p[y][u],b=i[y][v],x=s,w=s+=b*o;A[v*h+y]={index:y,subindex:v,startAngle:x,endAngle:w,value:b}}m[y]={index:y,startAngle:a,endAngle:s,value:d[y]},s+=l}for(c=-1;++c<h;)for(u=c-1;++u<h;){var C=A[u*h+c],$=A[c*h+u];(C.value||$.value)&&g.push(C.value<$.value?{source:$,target:C}:{source:C,target:$})}return r?g.sort(r):g}return i.padAngle=function(e){return arguments.length?(t=max$2(0,e),i):t},i.sortGroups=function(t){return arguments.length?(e=t,i):e},i.sortSubgroups=function(t){return arguments.length?(n=t,i):n},i.sortChords=function(t){return arguments.length?(null==t?r=null:(r=compareValue(t))._=t,i):r&&r._},i}var slice$5=Array.prototype.slice;function constant$9(t){return function(){return t}}var pi$2=Math.PI,tau$2=2*pi$2,epsilon$3=1e-6,tauEpsilon=tau$2-epsilon$3;function Path$2(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path$4(){return new Path$2}function defaultSource$1(t){return t.source}function defaultTarget(t){return t.target}function defaultRadius$1(t){return t.radius}function defaultStartAngle(t){return t.startAngle}function defaultEndAngle(t){return t.endAngle}function ribbon(){var t=defaultSource$1,e=defaultTarget,n=defaultRadius$1,r=defaultStartAngle,i=defaultEndAngle,o=null;function s(){var s,a=slice$5.call(arguments),l=t.apply(this,a),c=e.apply(this,a),u=+n.apply(this,(a[0]=l,a)),h=r.apply(this,a)-halfPi$2,d=i.apply(this,a)-halfPi$2,f=u*cos$2(h),p=u*sin$2(h),g=+n.apply(this,(a[0]=c,a)),m=r.apply(this,a)-halfPi$2,A=i.apply(this,a)-halfPi$2;if(o||(o=s=path$4()),o.moveTo(f,p),o.arc(0,0,u,h,d),h===m&&d===A||(o.quadraticCurveTo(0,0,g*cos$2(m),g*sin$2(m)),o.arc(0,0,g,m,A)),o.quadraticCurveTo(0,0,f,p),o.closePath(),s)return o=null,s+""||null}return s.radius=function(t){return arguments.length?(n="function"==typeof t?t:constant$9(+t),s):n},s.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:constant$9(+t),s):r},s.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:constant$9(+t),s):i},s.source=function(e){return arguments.length?(t=e,s):t},s.target=function(t){return arguments.length?(e=t,s):e},s.context=function(t){return arguments.length?(o=null==t?null:t,s):o},s}Path$2.prototype=path$4.prototype={constructor:Path$2,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){var o=this._x1,s=this._y1,a=(n=+n)-(t=+t),l=(r=+r)-(e=+e),c=o-t,u=s-e,h=c*c+u*u;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>epsilon$3)if(Math.abs(u*a-l*c)>epsilon$3&&i){var d=n-o,f=r-s,p=a*a+l*l,g=d*d+f*f,m=Math.sqrt(p),A=Math.sqrt(h),y=i*Math.tan((pi$2-Math.acos((p+h-g)/(2*m*A)))/2),v=y/A,b=y/m;Math.abs(v-1)>epsilon$3&&(this._+="L"+(t+v*c)+","+(e+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*d>c*f)+","+(this._x1=t+b*a)+","+(this._y1=e+b*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),l=t+s,c=e+a,u=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>epsilon$3||Math.abs(this._y1-c)>epsilon$3)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%tau$2+tau$2),h>tauEpsilon?this._+="A"+n+","+n+",0,1,"+u+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>epsilon$3&&(this._+="A"+n+","+n+",0,"+ +(h>=pi$2)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var prefix$1="$";function Map$2(){}function map$3(t,e){var n=new Map$2;if(t instanceof Map$2)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var s in t)n.set(s,t[s]);return n}function nest(){var t,e,n,r=[],i=[];function o(n,i,s,a){if(i>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var l,c,u,h=-1,d=n.length,f=r[i++],p=map$3(),g=s();++h<d;)(u=p.get(l=f(c=n[h])+""))?u.push(c):p.set(l,[c]);return p.each((function(t,e){a(g,e,o(t,i,s,a))})),g}function s(t,n){if(++n>r.length)return t;var o,a=i[n-1];return null!=e&&n>=r.length?o=t.entries():(o=[],t.each((function(t,e){o.push({key:e,values:s(t,n)})}))),null!=a?o.sort((function(t,e){return a(t.key,e.key)})):o}return n={object:function(t){return o(t,0,createObject,setObject)},map:function(t){return o(t,0,createMap,setMap)},entries:function(t){return s(o(t,0,createMap,setMap),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}}function createObject(){return{}}function setObject(t,e,n){t[e]=n}function createMap(){return map$3()}function setMap(t,e,n){t.set(e,n)}function Set$2(){}Map$2.prototype=map$3.prototype={constructor:Map$2,has:function(t){return prefix$1+t in this},get:function(t){return this[prefix$1+t]},set:function(t,e){return this[prefix$1+t]=e,this},remove:function(t){var e=prefix$1+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===prefix$1&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===prefix$1&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===prefix$1&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===prefix$1&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===prefix$1&&++t;return t},empty:function(){for(var t in this)if(t[0]===prefix$1)return!1;return!0},each:function(t){for(var e in this)e[0]===prefix$1&&t(this[e],e.slice(1),this)}};var proto=map$3.prototype;function set$1(t,e){var n=new Set$2;if(t instanceof Set$2)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}function keys$1(t){var e=[];for(var n in t)e.push(n);return e}function values$1(t){var e=[];for(var n in t)e.push(t[n]);return e}function entries(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e}Set$2.prototype=set$1.prototype={constructor:Set$2,has:proto.has,add:function(t){return this[prefix$1+(t+="")]=t,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};var array$4=Array.prototype,slice$4=array$4.slice;function ascending$1(t,e){return t-e}function area$3(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}function constant$8(t){return function(){return t}}function contains$3(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=ringContains(t,e[r]))return n;return 0}function ringContains(t,e){for(var n=e[0],r=e[1],i=-1,o=0,s=t.length,a=s-1;o<s;a=o++){var l=t[o],c=l[0],u=l[1],h=t[a],d=h[0],f=h[1];if(segmentContains(l,h,e))return 0;u>r!=f>r&&n<(d-c)*(r-u)/(f-u)+c&&(i=-i)}return i}function segmentContains(t,e,n){var r;return collinear(t,e,n)&&within(t[r=+(t[0]===e[0])],n[r],e[r])}function collinear(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}function within(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function noop$4(){}var cases=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function contours(){var t=1,e=1,n=thresholdSturges,r=a;function i(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(ascending$1);else{var r=extent$1(t),i=r[0],s=r[1];e=tickStep(i,s,e),e=sequence(Math.floor(i/e)*e,Math.floor(s/e)*e,e)}return e.map((function(e){return o(t,e)}))}function o(n,i){var o=[],a=[];return function(n,r,i){var o,a,l,c,u,h=new Array,d=new Array;for(o=a=-1,cases[(l=n[0]>=r)<<1].forEach(f);++o<t-1;)cases[l|(l=n[o+1]>=r)<<1].forEach(f);for(cases[l<<0].forEach(f);++a<e-1;){for(o=-1,cases[(l=n[a*t+t]>=r)<<1|(c=n[a*t]>=r)<<2].forEach(f);++o<t-1;)u=c,cases[l|(l=n[a*t+t+o+1]>=r)<<1|(c=n[a*t+o+1]>=r)<<2|u<<3].forEach(f);cases[l|c<<3].forEach(f)}for(o=-1,cases[(c=n[a*t]>=r)<<2].forEach(f);++o<t-1;)u=c,cases[(c=n[a*t+o+1]>=r)<<2|u<<3].forEach(f);function f(t){var e,n,r=[t[0][0]+o,t[0][1]+a],l=[t[1][0]+o,t[1][1]+a],c=s(r),u=s(l);(e=d[c])?(n=h[u])?(delete d[e.end],delete h[n.start],e===n?(e.ring.push(l),i(e.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(l),d[e.end=u]=e):(e=h[u])?(n=d[c])?(delete h[e.start],delete d[n.end],e===n?(e.ring.push(l),i(e.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(r),h[e.start=c]=e):h[c]=d[u]={start:c,end:u,ring:[r,l]}}cases[c<<3].forEach(f)}(n,i,(function(t){r(t,n,i),area$3(t)>0?o.push([t]):a.push(t)})),a.forEach((function(t){for(var e,n=0,r=o.length;n<r;++n)if(-1!==contains$3((e=o[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:o}}function s(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((function(n){var o,s=n[0],a=n[1],l=0|s,c=0|a,u=r[c*t+l];s>0&&s<t&&l===s&&(n[0]=s+(i-(o=r[c*t+l-1]))/(u-o)-.5),a>0&&a<e&&c===a&&(n[1]=a+(i-(o=r[(c-1)*t+l]))/(u-o)-.5)}))}return i.contour=o,i.size=function(n){if(!arguments.length)return[t,e];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>0&&o>0))throw new Error("invalid size");return t=r,e=o,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?constant$8(slice$4.call(t)):constant$8(t),i):n},i.smooth=function(t){return arguments.length?(r=t?a:noop$4,i):r===a},i}function blurX(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),s=0;s<i;++s)for(var a=0,l=0;a<r+n;++a)a<r&&(l+=t.data[a+s*r]),a>=n&&(a>=o&&(l-=t.data[a-o+s*r]),e.data[a-n+s*r]=l/Math.min(a+1,r-1+o-a,o))}function blurY(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),s=0;s<r;++s)for(var a=0,l=0;a<i+n;++a)a<i&&(l+=t.data[s+a*r]),a>=n&&(a>=o&&(l-=t.data[s+(a-o)*r]),e.data[s+(a-n)*r]=l/Math.min(a+1,i-1+o-a,o))}function defaultX$1(t){return t[0]}function defaultY$1(t){return t[1]}function defaultWeight(){return 1}function density(){var t=defaultX$1,e=defaultY$1,n=defaultWeight,r=960,i=500,o=20,s=2,a=3*o,l=r+2*a>>s,c=i+2*a>>s,u=constant$8(20);function h(r){var i=new Float32Array(l*c),h=new Float32Array(l*c);r.forEach((function(r,o,u){var h=+t(r,o,u)+a>>s,d=+e(r,o,u)+a>>s,f=+n(r,o,u);h>=0&&h<l&&d>=0&&d<c&&(i[h+d*l]+=f)})),blurX({width:l,height:c,data:i},{width:l,height:c,data:h},o>>s),blurY({width:l,height:c,data:h},{width:l,height:c,data:i},o>>s),blurX({width:l,height:c,data:i},{width:l,height:c,data:h},o>>s),blurY({width:l,height:c,data:h},{width:l,height:c,data:i},o>>s),blurX({width:l,height:c,data:i},{width:l,height:c,data:h},o>>s),blurY({width:l,height:c,data:h},{width:l,height:c,data:i},o>>s);var f=u(i);if(!Array.isArray(f)){var p=max$3(i);f=tickStep(0,p,f),(f=sequence(0,Math.floor(p/f)*f,f)).shift()}return contours().thresholds(f).size([l,c])(i).map(d)}function d(t){return t.value*=Math.pow(2,-2*s),t.coordinates.forEach(f),t}function f(t){t.forEach(p)}function p(t){t.forEach(g)}function g(t){t[0]=t[0]*Math.pow(2,s)-a,t[1]=t[1]*Math.pow(2,s)-a}function m(){return l=r+2*(a=3*o)>>s,c=i+2*a>>s,h}return h.x=function(e){return arguments.length?(t="function"==typeof e?e:constant$8(+e),h):t},h.y=function(t){return arguments.length?(e="function"==typeof t?t:constant$8(+t),h):e},h.weight=function(t){return arguments.length?(n="function"==typeof t?t:constant$8(+t),h):n},h.size=function(t){if(!arguments.length)return[r,i];var e=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error("invalid size");return r=e,i=n,m()},h.cellSize=function(t){if(!arguments.length)return 1<<s;if(!((t=+t)>=1))throw new Error("invalid cell size");return s=Math.floor(Math.log(t)/Math.LN2),m()},h.thresholds=function(t){return arguments.length?(u="function"==typeof t?t:Array.isArray(t)?constant$8(slice$4.call(t)):constant$8(t),h):u},h.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),m()},h}var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function customConverter(t,e){var n=objectConverter(t);return function(r,i){return e(n(r),i,t)}}function inferColumns(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function pad$2(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function formatYear$1(t){return t<0?"-"+pad$2(-t,6):t>9999?"+"+pad$2(t,6):pad$2(t,4)}function formatDate(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":formatYear$1(t.getUTCFullYear())+"-"+pad$2(t.getUTCMonth()+1,2)+"-"+pad$2(t.getUTCDate(),2)+(i?"T"+pad$2(e,2)+":"+pad$2(n,2)+":"+pad$2(r,2)+"."+pad$2(i,3)+"Z":r?"T"+pad$2(e,2)+":"+pad$2(n,2)+":"+pad$2(r,2)+"Z":n||e?"T"+pad$2(e,2)+":"+pad$2(n,2)+"Z":"")}function dsvFormat(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,s=0,a=0,l=o<=0,c=!1;function u(){if(l)return EOF;if(c)return c=!1,EOL;var e,r,i=s;if(t.charCodeAt(i)===QUOTE){for(;s++<o&&t.charCodeAt(s)!==QUOTE||t.charCodeAt(++s)===QUOTE;);return(e=s)>=o?l=!0:(r=t.charCodeAt(s++))===NEWLINE?c=!0:r===RETURN&&(c=!0,t.charCodeAt(s)===NEWLINE&&++s),t.slice(i+1,e-1).replace(/""/g,'"')}for(;s<o;){if((r=t.charCodeAt(e=s++))===NEWLINE)c=!0;else if(r===RETURN)c=!0,t.charCodeAt(s)===NEWLINE&&++s;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===NEWLINE&&--o,t.charCodeAt(o-1)===RETURN&&--o;(r=u())!==EOF;){for(var h=[];r!==EOL&&r!==EOF;)h.push(r),r=u();e&&null==(h=e(h,a++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return s(e[t])})).join(t)}))}function o(e){return e.map(s).join(t)}function s(t){return null==t?"":t instanceof Date?formatDate(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?customConverter(t,e):objectConverter(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=inferColumns(e)),[n.map(s).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=inferColumns(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:s}}var csv$1=dsvFormat(","),csvParse=csv$1.parse,csvParseRows=csv$1.parseRows,csvFormat=csv$1.format,csvFormatBody=csv$1.formatBody,csvFormatRows=csv$1.formatRows,csvFormatRow=csv$1.formatRow,csvFormatValue=csv$1.formatValue,tsv$1=dsvFormat("\t"),tsvParse=tsv$1.parse,tsvParseRows=tsv$1.parseRows,tsvFormat=tsv$1.format,tsvFormatBody=tsv$1.formatBody,tsvFormatRows=tsv$1.formatRows,tsvFormatRow=tsv$1.formatRow,tsvFormatValue=tsv$1.formatValue;function autoType(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;fixtz&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t}var fixtz=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function responseBlob(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function blob(t,e){return fetch(t,e).then(responseBlob)}function responseArrayBuffer(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function buffer(t,e){return fetch(t,e).then(responseArrayBuffer)}function responseText(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function text$3(t,e){return fetch(t,e).then(responseText)}function dsvParse(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),text$3(e,n).then((function(e){return t(e,r)}))}}function dsv(t,e,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var i=dsvFormat(t);return text$3(e,n).then((function(t){return i.parse(t,r)}))}var csv=dsvParse(csvParse),tsv=dsvParse(tsvParse);function image(t,e){return new Promise((function(n,r){var i=new Image;for(var o in e)i[o]=e[o];i.onerror=r,i.onload=function(){n(i)},i.src=t}))}function responseJson(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function json$1(t,e){return fetch(t,e).then(responseJson)}function parser(t){return function(e,n){return text$3(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}const xml=parser("application/xml");var html$2=parser("text/html"),svg=parser("image/svg+xml");function center$1(t,e){var n;function r(){var r,i,o=n.length,s=0,a=0;for(r=0;r<o;++r)s+=(i=n[r]).x,a+=i.y;for(s=s/o-t,a=a/o-e,r=0;r<o;++r)(i=n[r]).x-=s,i.y-=a}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r}function constant$7(t){return function(){return t}}function jiggle(){return 1e-6*(Math.random()-.5)}function tree_add(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return add$2(this.cover(e,n),e,n,t)}function add$2(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,s,a,l,c,u,h,d,f=t._root,p={data:r},g=t._x0,m=t._y0,A=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((c=e>=(o=(g+A)/2))?g=o:A=o,(u=n>=(s=(m+y)/2))?m=s:y=s,i=f,!(f=f[h=u<<1|c]))return i[h]=p,t;if(a=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===a&&n===l)return p.next=f,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+A)/2))?g=o:A=o,(u=n>=(s=(m+y)/2))?m=s:y=s}while((h=u<<1|c)==(d=(l>=s)<<1|a>=o));return i[d]=f,i[h]=p,t}function addAll(t){var e,n,r,i,o=t.length,s=new Array(o),a=new Array(o),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(s[n]=r,a[n]=i,r<l&&(l=r),r>u&&(u=r),i<c&&(c=i),i>h&&(h=i));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<o;++n)add$2(this,s[n],a[n],t[n]);return this}function tree_cover(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var s,a,l=i-n,c=this._root;n>t||t>=i||r>e||e>=o;)switch(a=(e<r)<<1|t<n,(s=new Array(4))[a]=c,c=s,l*=2,a){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function tree_data(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t}function tree_extent(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function tree_find(t,e,n){var r,i,o,s,a,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new Quad(g,u,h,d,f)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(g=l.node)||(i=l.x0)>d||(o=l.y0)>f||(s=l.x1)<u||(a=l.y1)<h))if(g.length){var m=(i+s)/2,A=(o+a)/2;p.push(new Quad(g[3],m,A,s,a),new Quad(g[2],i,A,m,a),new Quad(g[1],m,o,s,A),new Quad(g[0],i,o,m,A)),(c=(e>=A)<<1|t>=m)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var y=t-+this._x.call(null,g.data),v=e-+this._y.call(null,g.data),b=y*y+v*v;if(b<n){var x=Math.sqrt(n=b);u=t-x,h=e-x,d=t+x,f=e+x,r=g.data}}return r}function tree_remove(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,r,i,o,s,a,l,c,u,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,A=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+m)/2))?p=a:m=a,(u=s>=(l=(g+A)/2))?g=l:A=l,e=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)}function removeAll(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function tree_root(){return this._root}function tree_size(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t}function tree_visit(t){var e,n,r,i,o,s,a=[],l=this._root;for(l&&a.push(new Quad(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,s=e.y1)&&l.length){var c=(r+o)/2,u=(i+s)/2;(n=l[3])&&a.push(new Quad(n,c,u,o,s)),(n=l[2])&&a.push(new Quad(n,r,u,c,s)),(n=l[1])&&a.push(new Quad(n,c,i,o,u)),(n=l[0])&&a.push(new Quad(n,r,i,c,u))}return this}function tree_visitAfter(t){var e,n=[],r=[];for(this._root&&n.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,s=e.x0,a=e.y0,l=e.x1,c=e.y1,u=(s+l)/2,h=(a+c)/2;(o=i[0])&&n.push(new Quad(o,s,a,u,h)),(o=i[1])&&n.push(new Quad(o,u,a,l,h)),(o=i[2])&&n.push(new Quad(o,s,h,u,c)),(o=i[3])&&n.push(new Quad(o,u,h,l,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this}function defaultX(t){return t[0]}function tree_x(t){return arguments.length?(this._x=t,this):this._x}function defaultY(t){return t[1]}function tree_y(t){return arguments.length?(this._y=t,this):this._y}function quadtree(t,e,n){var r=new Quadtree(null==e?defaultX:e,null==n?defaultY:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Quadtree(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function leaf_copy(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var treeProto=quadtree.prototype=Quadtree.prototype;function x$4(t){return t.x+t.vx}function y$4(t){return t.y+t.vy}function collide(t){var e,n,r=1,i=1;function o(){for(var t,o,a,l,c,u,h,d=e.length,f=0;f<i;++f)for(o=quadtree(e,x$4,y$4).visitAfter(s),t=0;t<d;++t)h=(u=n[(a=e[t]).index])*u,l=a.x+a.vx,c=a.y+a.vy,o.visit(p);function p(t,e,n,i,o){var s=t.data,d=t.r,f=u+d;if(!s)return e>l+f||i<l-f||n>c+f||o<c-f;if(s.index>a.index){var p=l-s.x-s.vx,g=c-s.y-s.vy,m=p*p+g*g;m<f*f&&(0===p&&(m+=(p=jiggle())*p),0===g&&(m+=(g=jiggle())*g),m=(f-(m=Math.sqrt(m)))/m*r,a.vx+=(p*=m)*(f=(d*=d)/(h+d)),a.vy+=(g*=m)*f,s.vx-=p*(f=1-f),s.vy-=g*f)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function a(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)n[(i=e[r]).index]=+t(i,r,e)}}return"function"!=typeof t&&(t=constant$7(null==t?1:+t)),o.initialize=function(t){e=t,a()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:constant$7(+e),a(),o):t},o}function index$4(t){return t.index}function find$2(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function link$2(t){var e,n,r,i,o,s=index$4,a=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},l=constant$7(30),c=1;function u(r){for(var i=0,s=t.length;i<c;++i)for(var a,l,u,h,d,f,p,g=0;g<s;++g)h=(u=(a=t[g]).target).x+u.vx-(l=a.source).x-l.vx||jiggle(),d=u.y+u.vy-l.y-l.vy||jiggle(),d*=f=((f=Math.sqrt(h*h+d*d))-n[g])/f*r*e[g],u.vx-=(h*=f)*(p=o[g]),u.vy-=d*p,l.vx+=h*(p=1-p),l.vy+=d*p}function h(){if(r){var a,l,c=r.length,u=t.length,h=map$3(r,s);for(a=0,i=new Array(c);a<u;++a)(l=t[a]).index=a,"object"!=typeof l.source&&(l.source=find$2(h,l.source)),"object"!=typeof l.target&&(l.target=find$2(h,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(a=0,o=new Array(u);a<u;++a)o[a]=i[(l=t[a]).source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(u),d(),n=new Array(u),f()}}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+a(t[n],n,t)}function f(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),u.initialize=function(t){r=t,h()},u.links=function(e){return arguments.length?(t=e,h(),u):t},u.id=function(t){return arguments.length?(s=t,u):s},u.iterations=function(t){return arguments.length?(c=+t,u):c},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:constant$7(+t),d(),u):a},u.distance=function(t){return arguments.length?(l="function"==typeof t?t:constant$7(+t),f(),u):l},u}function x$3(t){return t.x}function y$3(t){return t.y}treeProto.copy=function(){var t,e,n=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=leaf_copy(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=leaf_copy(e));return n},treeProto.add=tree_add,treeProto.addAll=addAll,treeProto.cover=tree_cover,treeProto.data=tree_data,treeProto.extent=tree_extent,treeProto.find=tree_find,treeProto.remove=tree_remove,treeProto.removeAll=removeAll,treeProto.root=tree_root,treeProto.size=tree_size,treeProto.visit=tree_visit,treeProto.visitAfter=tree_visitAfter,treeProto.x=tree_x,treeProto.y=tree_y;var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));function simulation(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=map$3(),l=timer(u),c=dispatch("tick","end");function u(){h(),c.call("tick",e),n<r&&(l.stop(),c.call("end",e))}function h(r){var l,c,u=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,a.each((function(t){t(n)})),l=0;l<u;++l)null==(c=t[l]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function d(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=initialRadius*Math.sqrt(n),o=n*initialAngle;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function f(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),d(),e={tick:h,restart:function(){return l.restart(u),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.each(f),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},force:function(t,n){return arguments.length>1?(null==n?a.remove(t):a.set(t,f(n)),e):a.get(t)},find:function(e,n,r){var i,o,s,a,l,c=0,u=t.length;for(null==r?r=1/0:r*=r,c=0;c<u;++c)(s=(i=e-(a=t[c]).x)*i+(o=n-a.y)*o)<r&&(l=a,r=s);return l},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}function manyBody(){var t,e,n,r,i=constant$7(-30),o=1,s=1/0,a=.81;function l(r){var i,o=t.length,s=quadtree(t,x$3,y$3).visitAfter(u);for(n=r,i=0;i<o;++i)e=t[i],s.visit(h)}function c(){if(t){var e,n,o=t.length;for(r=new Array(o),e=0;e<o;++e)r[(n=t[e]).index]=+i(n,e,t)}}function u(t){var e,n,i,o,s,a=0,l=0;if(t.length){for(i=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,l+=n,i+=n*e.x,o+=n*e.y);t.x=i/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=r[e.data.index]}while(e=e.next)}t.value=a}function h(t,i,l,c){if(!t.value)return!0;var u=t.x-e.x,h=t.y-e.y,d=c-i,f=u*u+h*h;if(d*d/a<f)return f<s&&(0===u&&(f+=(u=jiggle())*u),0===h&&(f+=(h=jiggle())*h),f<o&&(f=Math.sqrt(o*f)),e.vx+=u*t.value*n/f,e.vy+=h*t.value*n/f),!0;if(!(t.length||f>=s)){(t.data!==e||t.next)&&(0===u&&(f+=(u=jiggle())*u),0===h&&(f+=(h=jiggle())*h),f<o&&(f=Math.sqrt(o*f)));do{t.data!==e&&(e.vx+=u*(d=r[t.data.index]*n/f),e.vy+=h*d)}while(t=t.next)}}return l.initialize=function(e){t=e,c()},l.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$7(+t),c(),l):i},l.distanceMin=function(t){return arguments.length?(o=t*t,l):Math.sqrt(o)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(a=t*t,l):Math.sqrt(a)},l}function radial$1(t,e,n){var r,i,o,s=constant$7(.1);function a(t){for(var s=0,a=r.length;s<a;++s){var l=r[s],c=l.x-e||1e-6,u=l.y-n||1e-6,h=Math.sqrt(c*c+u*u),d=(o[s]-h)*i[s]*t/h;l.vx+=c*d,l.vy+=u*d}}function l(){if(r){var e,n=r.length;for(i=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(r[e],e,r),i[e]=isNaN(o[e])?0:+s(r[e],e,r)}}return"function"!=typeof t&&(t=constant$7(+t)),null==e&&(e=0),null==n&&(n=0),a.initialize=function(t){r=t,l()},a.strength=function(t){return arguments.length?(s="function"==typeof t?t:constant$7(+t),l(),a):s},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:constant$7(+e),l(),a):t},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(t){return arguments.length?(n=+t,a):n},a}function x$2(t){var e,n,r,i=constant$7(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=constant$7(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$7(+t),s(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:constant$7(+e),s(),o):t},o}function y$2(t){var e,n,r,i=constant$7(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=constant$7(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$7(+t),s(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:constant$7(+e),s(),o):t},o}function formatDecimal(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function formatDecimalParts(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function exponent(t){return(t=formatDecimalParts(Math.abs(t)))?t[1]:NaN}function formatGroup(t,e){return function(n,r){for(var i=n.length,o=[],s=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}function formatNumerals(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i,prefixExponent;function formatSpecifier(t){if(!(e=re.exec(t)))throw new Error("invalid format: "+t);var e;return new FormatSpecifier({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function FormatSpecifier(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function formatTrim(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}function formatPrefixAuto(t,e){var n=formatDecimalParts(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+formatDecimalParts(t,Math.max(0,e+o-1))[0]}function formatRounded(t,e){var n=formatDecimalParts(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const formatTypes={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:formatDecimal,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return formatRounded(100*t,e)},r:formatRounded,s:formatPrefixAuto,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function identity$7(t){return t}var map$2=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],locale$1,format$1,formatPrefix;function formatLocale$1(t){var e=void 0===t.grouping||void 0===t.thousands?identity$7:formatGroup(map$2.call(t.grouping,Number),t.thousands+""),n=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",i=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?identity$7:formatNumerals(map$2.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",a=void 0===t.minus?"-":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function c(t){var c=(t=formatSpecifier(t)).fill,u=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,A=t.trim,y=t.type;"n"===y?(g=!0,y="g"):formatTypes[y]||(void 0===m&&(m=12),A=!0,y="g"),(f||"0"===c&&"="===u)&&(f=!0,c="0",u="=");var v="$"===d?n:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===d?r:/[%p]/.test(y)?s:"",x=formatTypes[y],w=/[defgprs%]/.test(y);function C(t){var n,r,s,d=v,C=b;if("c"===y)C=x(t)+C,t="";else{var $=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:x(Math.abs(t),m),A&&(t=formatTrim(t)),$&&0==+t&&"+"!==h&&($=!1),d=($?"("===h?h:a:"-"===h||"("===h?"":h)+d,C=("s"===y?prefixes[8+prefixExponent/3]:"")+C+($&&"("===h?")":""),w)for(n=-1,r=t.length;++n<r;)if(48>(s=t.charCodeAt(n))||s>57){C=(46===s?i+t.slice(n+1):t.slice(n))+C,t=t.slice(0,n);break}}g&&!f&&(t=e(t,1/0));var _=d.length+t.length+C.length,P=_<p?new Array(p-_+1).join(c):"";switch(g&&f&&(t=e(P+t,P.length?p-C.length:1/0),P=""),u){case"<":t=d+t+C+P;break;case"=":t=d+P+t+C;break;case"^":t=P.slice(0,_=P.length>>1)+d+t+C+P.slice(_);break;default:t=P+d+t+C}return o(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),C.toString=function(){return t+""},C}return{format:c,formatPrefix:function(t,e){var n=c(((t=formatSpecifier(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(exponent(e)/3))),i=Math.pow(10,-r),o=prefixes[8+r/3];return function(t){return n(i*t)+o}}}}function defaultLocale$1(t){return locale$1=formatLocale$1(t),format$1=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed(t){return Math.max(0,-exponent(Math.abs(t)))}function precisionPrefix(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent(e)/3)))-exponent(Math.abs(t)))}function precisionRound(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,exponent(e)-exponent(t))+1}function adder(){return new Adder}function Adder(){this.reset()}defaultLocale$1({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Adder.prototype={constructor:Adder,reset:function(){this.s=this.t=0},add:function(t){add$1(temp,t,this.t),add$1(this,temp.s,this.s),this.s?this.t+=temp.t:this.s=temp.t},valueOf:function(){return this.s}};var temp=new Adder;function add$1(t,e,n){var r=t.s=e+n,i=r-e;t.t=e-(r-i)+(n-i)}var epsilon$2=1e-6,epsilon2$1=1e-12,pi$1=Math.PI,halfPi$1=pi$1/2,quarterPi=pi$1/4,tau$1=2*pi$1,degrees=180/pi$1,radians=pi$1/180,abs$2=Math.abs,atan=Math.atan,atan2$1=Math.atan2,cos$1=Math.cos,ceil$1=Math.ceil,exp=Math.exp,log$1=Math.log,pow$1=Math.pow,sin$1=Math.sin,sign$1=Math.sign||function(t){return t>0?1:t<0?-1:0},sqrt$2=Math.sqrt,tan=Math.tan;function acos$1(t){return t>1?0:t<-1?pi$1:Math.acos(t)}function asin$1(t){return t>1?halfPi$1:t<-1?-halfPi$1:Math.asin(t)}function haversin(t){return(t=sin$1(t/2))*t}function noop$3(){}function streamGeometry(t,e){t&&streamGeometryType.hasOwnProperty(t.type)&&streamGeometryType[t.type](t,e)}var streamObjectType={Feature:function(t,e){streamGeometry(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)streamGeometry(n[r].geometry,e)}},streamGeometryType={Sphere:function(t,e){e.sphere()},Point:function(t,e){e.point((t=t.coordinates)[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)e.point((t=n[r])[0],t[1],t[2])},LineString:function(t,e){streamLine(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)streamLine(n[r],e,0)},Polygon:function(t,e){streamPolygon(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)streamPolygon(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)streamGeometry(n[r],e)}};function streamLine(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)e.point((r=t[i])[0],r[1],r[2]);e.lineEnd()}function streamPolygon(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)streamLine(t[n],e,1);e.polygonEnd()}function geoStream(t,e){t&&streamObjectType.hasOwnProperty(t.type)?streamObjectType[t.type](t,e):streamGeometry(t,e)}var areaRingSum$1=adder(),areaSum$1=adder(),lambda00$2,phi00$2,lambda0$2,cosPhi0$1,sinPhi0$1,areaStream$1={point:noop$3,lineStart:noop$3,lineEnd:noop$3,polygonStart:function(){areaRingSum$1.reset(),areaStream$1.lineStart=areaRingStart$1,areaStream$1.lineEnd=areaRingEnd$1},polygonEnd:function(){var t=+areaRingSum$1;areaSum$1.add(t<0?tau$1+t:t),this.lineStart=this.lineEnd=this.point=noop$3},sphere:function(){areaSum$1.add(tau$1)}};function areaRingStart$1(){areaStream$1.point=areaPointFirst$1}function areaRingEnd$1(){areaPoint$1(lambda00$2,phi00$2)}function areaPointFirst$1(t,e){areaStream$1.point=areaPoint$1,lambda00$2=t,phi00$2=e,lambda0$2=t*=radians,cosPhi0$1=cos$1(e=(e*=radians)/2+quarterPi),sinPhi0$1=sin$1(e)}function areaPoint$1(t,e){var n=(t*=radians)-lambda0$2,r=n>=0?1:-1,i=r*n,o=cos$1(e=(e*=radians)/2+quarterPi),s=sin$1(e),a=sinPhi0$1*s,l=cosPhi0$1*o+a*cos$1(i),c=a*r*sin$1(i);areaRingSum$1.add(atan2$1(c,l)),lambda0$2=t,cosPhi0$1=o,sinPhi0$1=s}function area$2(t){return areaSum$1.reset(),geoStream(t,areaStream$1),2*areaSum$1}function spherical(t){return[atan2$1(t[1],t[0]),asin$1(t[2])]}function cartesian(t){var e=t[0],n=t[1],r=cos$1(n);return[r*cos$1(e),r*sin$1(e),sin$1(n)]}function cartesianDot(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function cartesianCross(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function cartesianAddInPlace(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function cartesianScale(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function cartesianNormalizeInPlace(t){var e=sqrt$2(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var lambda0$1,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,deltaSum=adder(),ranges,range$1,boundsStream$1={point:boundsPoint$1,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream$1.point=boundsRingPoint,boundsStream$1.lineStart=boundsRingStart,boundsStream$1.lineEnd=boundsRingEnd,deltaSum.reset(),areaStream$1.polygonStart()},polygonEnd:function(){areaStream$1.polygonEnd(),boundsStream$1.point=boundsPoint$1,boundsStream$1.lineStart=boundsLineStart,boundsStream$1.lineEnd=boundsLineEnd,areaRingSum$1<0?(lambda0$1=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon$2?phi1=90:deltaSum<-epsilon$2&&(phi0=-90),range$1[0]=lambda0$1,range$1[1]=lambda1},sphere:function(){lambda0$1=-(lambda1=180),phi0=-(phi1=90)}},W0,W1,X0$1,Y0$1,Z0$1,X1$1,Y1$1,Z1$1,X2$1,Y2$1,Z2$1,lambda00,phi00,x0$4,y0$4,z0;function boundsPoint$1(t,e){ranges.push(range$1=[lambda0$1=t,lambda1=t]),e<phi0&&(phi0=e),e>phi1&&(phi1=e)}function linePoint(t,e){var n=cartesian([t*radians,e*radians]);if(p0){var r=cartesianCross(p0,n),i=cartesianCross([r[1],-r[0],0],r);cartesianNormalizeInPlace(i),i=spherical(i);var o,s=t-lambda2,a=s>0?1:-1,l=i[0]*degrees*a,c=abs$2(s)>180;c^(a*lambda2<l&&l<a*t)?(o=i[1]*degrees)>phi1&&(phi1=o):c^(a*lambda2<(l=(l+360)%360-180)&&l<a*t)?(o=-i[1]*degrees)<phi0&&(phi0=o):(e<phi0&&(phi0=e),e>phi1&&(phi1=e)),c?t<lambda2?angle$1(lambda0$1,t)>angle$1(lambda0$1,lambda1)&&(lambda1=t):angle$1(t,lambda1)>angle$1(lambda0$1,lambda1)&&(lambda0$1=t):lambda1>=lambda0$1?(t<lambda0$1&&(lambda0$1=t),t>lambda1&&(lambda1=t)):t>lambda2?angle$1(lambda0$1,t)>angle$1(lambda0$1,lambda1)&&(lambda1=t):angle$1(t,lambda1)>angle$1(lambda0$1,lambda1)&&(lambda0$1=t)}else ranges.push(range$1=[lambda0$1=t,lambda1=t]);e<phi0&&(phi0=e),e>phi1&&(phi1=e),p0=n,lambda2=t}function boundsLineStart(){boundsStream$1.point=linePoint}function boundsLineEnd(){range$1[0]=lambda0$1,range$1[1]=lambda1,boundsStream$1.point=boundsPoint$1,p0=null}function boundsRingPoint(t,e){if(p0){var n=t-lambda2;deltaSum.add(abs$2(n)>180?n+(n>0?360:-360):n)}else lambda00$1=t,phi00$1=e;areaStream$1.point(t,e),linePoint(t,e)}function boundsRingStart(){areaStream$1.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream$1.lineEnd(),abs$2(deltaSum)>epsilon$2&&(lambda0$1=-(lambda1=180)),range$1[0]=lambda0$1,range$1[1]=lambda1,p0=null}function angle$1(t,e){return(e-=t)<0?e+360:e}function rangeCompare(t,e){return t[0]-e[0]}function rangeContains(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function bounds(t){var e,n,r,i,o,s,a;if(phi1=lambda1=-(lambda0$1=phi0=1/0),ranges=[],geoStream(t,boundsStream$1),n=ranges.length){for(ranges.sort(rangeCompare),e=1,o=[r=ranges[0]];e<n;++e)rangeContains(r,(i=ranges[e])[0])||rangeContains(r,i[1])?(angle$1(r[0],i[1])>angle$1(r[0],r[1])&&(r[1]=i[1]),angle$1(i[0],r[1])>angle$1(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)(a=angle$1(r[1],(i=o[e])[0]))>s&&(s=a,lambda0$1=i[0],lambda1=r[1])}return ranges=range$1=null,lambda0$1===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0$1,phi0],[lambda1,phi1]]}var centroidStream$1={sphere:noop$3,point:centroidPoint$1,lineStart:centroidLineStart$1,lineEnd:centroidLineEnd$1,polygonStart:function(){centroidStream$1.lineStart=centroidRingStart$1,centroidStream$1.lineEnd=centroidRingEnd$1},polygonEnd:function(){centroidStream$1.lineStart=centroidLineStart$1,centroidStream$1.lineEnd=centroidLineEnd$1}};function centroidPoint$1(t,e){t*=radians;var n=cos$1(e*=radians);centroidPointCartesian(n*cos$1(t),n*sin$1(t),sin$1(e))}function centroidPointCartesian(t,e,n){++W0,X0$1+=(t-X0$1)/W0,Y0$1+=(e-Y0$1)/W0,Z0$1+=(n-Z0$1)/W0}function centroidLineStart$1(){centroidStream$1.point=centroidLinePointFirst}function centroidLinePointFirst(t,e){t*=radians;var n=cos$1(e*=radians);x0$4=n*cos$1(t),y0$4=n*sin$1(t),z0=sin$1(e),centroidStream$1.point=centroidLinePoint,centroidPointCartesian(x0$4,y0$4,z0)}function centroidLinePoint(t,e){t*=radians;var n=cos$1(e*=radians),r=n*cos$1(t),i=n*sin$1(t),o=sin$1(e),s=atan2$1(sqrt$2((s=y0$4*o-z0*i)*s+(s=z0*r-x0$4*o)*s+(s=x0$4*i-y0$4*r)*s),x0$4*r+y0$4*i+z0*o);W1+=s,X1$1+=s*(x0$4+(x0$4=r)),Y1$1+=s*(y0$4+(y0$4=i)),Z1$1+=s*(z0+(z0=o)),centroidPointCartesian(x0$4,y0$4,z0)}function centroidLineEnd$1(){centroidStream$1.point=centroidPoint$1}function centroidRingStart$1(){centroidStream$1.point=centroidRingPointFirst}function centroidRingEnd$1(){centroidRingPoint(lambda00,phi00),centroidStream$1.point=centroidPoint$1}function centroidRingPointFirst(t,e){lambda00=t,phi00=e,t*=radians,e*=radians,centroidStream$1.point=centroidRingPoint;var n=cos$1(e);x0$4=n*cos$1(t),y0$4=n*sin$1(t),z0=sin$1(e),centroidPointCartesian(x0$4,y0$4,z0)}function centroidRingPoint(t,e){t*=radians;var n=cos$1(e*=radians),r=n*cos$1(t),i=n*sin$1(t),o=sin$1(e),s=y0$4*o-z0*i,a=z0*r-x0$4*o,l=x0$4*i-y0$4*r,c=sqrt$2(s*s+a*a+l*l),u=asin$1(c),h=c&&-u/c;X2$1+=h*s,Y2$1+=h*a,Z2$1+=h*l,W1+=u,X1$1+=u*(x0$4+(x0$4=r)),Y1$1+=u*(y0$4+(y0$4=i)),Z1$1+=u*(z0+(z0=o)),centroidPointCartesian(x0$4,y0$4,z0)}function centroid$1(t){W0=W1=X0$1=Y0$1=Z0$1=X1$1=Y1$1=Z1$1=X2$1=Y2$1=Z2$1=0,geoStream(t,centroidStream$1);var e=X2$1,n=Y2$1,r=Z2$1,i=e*e+n*n+r*r;return i<epsilon2$1&&(e=X1$1,n=Y1$1,r=Z1$1,W1<epsilon$2&&(e=X0$1,n=Y0$1,r=Z0$1),(i=e*e+n*n+r*r)<epsilon2$1)?[NaN,NaN]:[atan2$1(n,e)*degrees,asin$1(r/sqrt$2(i))*degrees]}function constant$6(t){return function(){return t}}function compose(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function rotationIdentity(t,e){return[abs$2(t)>pi$1?t+Math.round(-t/tau$1)*tau$1:t,e]}function rotateRadians(t,e,n){return(t%=tau$1)?e||n?compose(rotationLambda(t),rotationPhiGamma(e,n)):rotationLambda(t):e||n?rotationPhiGamma(e,n):rotationIdentity}function forwardRotationLambda(t){return function(e,n){return[(e+=t)>pi$1?e-tau$1:e<-pi$1?e+tau$1:e,n]}}function rotationLambda(t){var e=forwardRotationLambda(t);return e.invert=forwardRotationLambda(-t),e}function rotationPhiGamma(t,e){var n=cos$1(t),r=sin$1(t),i=cos$1(e),o=sin$1(e);function s(t,e){var s=cos$1(e),a=cos$1(t)*s,l=sin$1(t)*s,c=sin$1(e),u=c*n+a*r;return[atan2$1(l*i-u*o,a*n-c*r),asin$1(u*i+l*o)]}return s.invert=function(t,e){var s=cos$1(e),a=cos$1(t)*s,l=sin$1(t)*s,c=sin$1(e),u=c*i-l*o;return[atan2$1(l*i+c*o,a*n+u*r),asin$1(u*n-a*r)]},s}function rotation(t){function e(e){return(e=t(e[0]*radians,e[1]*radians))[0]*=degrees,e[1]*=degrees,e}return t=rotateRadians(t[0]*radians,t[1]*radians,t.length>2?t[2]*radians:0),e.invert=function(e){return(e=t.invert(e[0]*radians,e[1]*radians))[0]*=degrees,e[1]*=degrees,e},e}function circleStream(t,e,n,r,i,o){if(n){var s=cos$1(e),a=sin$1(e),l=r*n;null==i?(i=e+r*tau$1,o=e-l/2):(i=circleRadius(s,i),o=circleRadius(s,o),(r>0?i<o:i>o)&&(i+=r*tau$1));for(var c,u=i;r>0?u>o:u<o;u-=l)c=spherical([s,-a*cos$1(u),-a*sin$1(u)]),t.point(c[0],c[1])}}function circleRadius(t,e){(e=cartesian(e))[0]-=t,cartesianNormalizeInPlace(e);var n=acos$1(-e[1]);return((-e[2]<0?-n:n)+tau$1-epsilon$2)%tau$1}function circle$4(){var t,e,n=constant$6([0,0]),r=constant$6(90),i=constant$6(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=degrees,n[1]*=degrees}};function s(){var s=n.apply(this,arguments),a=r.apply(this,arguments)*radians,l=i.apply(this,arguments)*radians;return t=[],e=rotateRadians(-s[0]*radians,-s[1]*radians,0).invert,circleStream(o,a,l,1),s={type:"Polygon",coordinates:[t]},t=e=null,s}return s.center=function(t){return arguments.length?(n="function"==typeof t?t:constant$6([+t[0],+t[1]]),s):n},s.radius=function(t){return arguments.length?(r="function"==typeof t?t:constant$6(+t),s):r},s.precision=function(t){return arguments.length?(i="function"==typeof t?t:constant$6(+t),s):i},s}function clipBuffer(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:noop$3,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function pointEqual(t,e){return abs$2(t[0]-e[0])<epsilon$2&&abs$2(t[1]-e[1])<epsilon$2}function Intersection(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function clipRejoin(t,e,n,r,i){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(pointEqual(r,s)){if(!r[2]&&!s[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}s[0]+=2*epsilon$2}a.push(n=new Intersection(r,t,null,!0)),l.push(n.o=new Intersection(r,null,n,!1)),a.push(n=new Intersection(s,t,null,!1)),l.push(n.o=new Intersection(s,null,n,!0))}})),a.length){for(l.sort(e),link$1(a),link$1(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var c,u,h=a[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,s=c.length;o<s;++o)i.point((u=c[o])[0],u[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(o=(c=d.p.z).length-1;o>=0;--o)i.point((u=c[o])[0],u[1]);else r(d.x,d.p.x,-1,i);d=d.p}c=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function link$1(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}rotationIdentity.invert=rotationIdentity;var sum$2=adder();function longitude(t){return abs$2(t[0])<=pi$1?t[0]:sign$1(t[0])*((abs$2(t[0])+pi$1)%tau$1-pi$1)}function polygonContains(t,e){var n=longitude(e),r=e[1],i=sin$1(r),o=[sin$1(n),-cos$1(n),0],s=0,a=0;sum$2.reset(),1===i?r=halfPi$1+epsilon$2:-1===i&&(r=-halfPi$1-epsilon$2);for(var l=0,c=t.length;l<c;++l)if(h=(u=t[l]).length)for(var u,h,d=u[h-1],f=longitude(d),p=d[1]/2+quarterPi,g=sin$1(p),m=cos$1(p),A=0;A<h;++A,f=v,g=x,m=w,d=y){var y=u[A],v=longitude(y),b=y[1]/2+quarterPi,x=sin$1(b),w=cos$1(b),C=v-f,$=C>=0?1:-1,_=$*C,P=_>pi$1,S=g*x;if(sum$2.add(atan2$1(S*$*sin$1(_),m*w+S*cos$1(_))),s+=P?C+$*tau$1:C,P^f>=n^v>=n){var M=cartesianCross(cartesian(d),cartesian(y));cartesianNormalizeInPlace(M);var E=cartesianCross(o,M);cartesianNormalizeInPlace(E);var T=(P^C>=0?-1:1)*asin$1(E[2]);(r>T||r===T&&(M[0]||M[1]))&&(a+=P^C>=0?1:-1)}}return(s<-epsilon$2||s<epsilon$2&&sum$2<-epsilon$2)^1&a}function clip(t,e,n,r){return function(i){var o,s,a,l=e(i),c=clipBuffer(),u=e(c),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=A,d.lineStart=y,d.lineEnd=v,s=[],o=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,s=merge$1(s);var t=polygonContains(o,r);s.length?(h||(i.polygonStart(),h=!0),clipRejoin(s,compareIntersection,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),s=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){l.point(t,e)}function g(){d.point=p,l.lineStart()}function m(){d.point=f,l.lineEnd()}function A(t,e){a.push([t,e]),u.point(t,e)}function y(){u.lineStart(),a=[]}function v(){A(a[0][0],a[0][1]),u.lineEnd();var t,e,n,r,l=u.clean(),d=c.result(),f=d.length;if(a.pop(),o.push(a),a=null,f)if(1&l){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&l&&d.push(d.pop().concat(d.shift())),s.push(d.filter(validSegment))}return d}}function validSegment(t){return t.length>1}function compareIntersection(t,e){return((t=t.x)[0]<0?t[1]-halfPi$1-epsilon$2:halfPi$1-t[1])-((e=e.x)[0]<0?e[1]-halfPi$1-epsilon$2:halfPi$1-e[1])}const clipAntimeridian=clip((function(){return!0}),clipAntimeridianLine,clipAntimeridianInterpolate,[-pi$1,-halfPi$1]);function clipAntimeridianLine(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?pi$1:-pi$1,l=abs$2(o-n);abs$2(l-pi$1)<epsilon$2?(t.point(n,r=(r+s)/2>0?halfPi$1:-halfPi$1),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),e=0):i!==a&&l>=pi$1&&(abs$2(n-i)<epsilon$2&&(n-=i*epsilon$2),abs$2(o-a)<epsilon$2&&(o-=a*epsilon$2),r=clipAntimeridianIntersect(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=o,r=s),i=a},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}function clipAntimeridianIntersect(t,e,n,r){var i,o,s=sin$1(t-n);return abs$2(s)>epsilon$2?atan((sin$1(e)*(o=cos$1(r))*sin$1(n)-sin$1(r)*(i=cos$1(e))*sin$1(t))/(i*o*s)):(e+r)/2}function clipAntimeridianInterpolate(t,e,n,r){var i;if(null==t)r.point(-pi$1,i=n*halfPi$1),r.point(0,i),r.point(pi$1,i),r.point(pi$1,0),r.point(pi$1,-i),r.point(0,-i),r.point(-pi$1,-i),r.point(-pi$1,0),r.point(-pi$1,i);else if(abs$2(t[0]-e[0])>epsilon$2){var o=t[0]<e[0]?pi$1:-pi$1;r.point(-o,i=n*o/2),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}function clipCircle(t){var e=cos$1(t),n=6*radians,r=e>0,i=abs$2(e)>epsilon$2;function o(t,n){return cos$1(t)*cos$1(n)>e}function s(t,n,r){var i=[1,0,0],o=cartesianCross(cartesian(t),cartesian(n)),s=cartesianDot(o,o),a=o[0],l=s-a*a;if(!l)return!r&&t;var c=e*s/l,u=-e*a/l,h=cartesianCross(i,o),d=cartesianScale(i,c);cartesianAddInPlace(d,cartesianScale(o,u));var f=h,p=cartesianDot(d,f),g=cartesianDot(f,f),m=p*p-g*(cartesianDot(d,d)-1);if(!(m<0)){var A=sqrt$2(m),y=cartesianScale(f,(-p-A)/g);if(cartesianAddInPlace(y,d),y=spherical(y),!r)return y;var v,b=t[0],x=n[0],w=t[1],C=n[1];x<b&&(v=b,b=x,x=v);var $=x-b,_=abs$2($-pi$1)<epsilon$2;if(!_&&C<w&&(v=w,w=C,C=v),_||$<epsilon$2?_?w+C>0^y[1]<(abs$2(y[0]-b)<epsilon$2?w:C):w<=y[1]&&y[1]<=C:$>pi$1^(b<=y[0]&&y[0]<=x)){var P=cartesianScale(f,(-p+A)/g);return cartesianAddInPlace(P,d),[y,spherical(P)]}}}function a(e,n){var i=r?t:pi$1-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return clip(o,(function(t){var e,n,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(h,d){var f,p=[h,d],g=o(h,d),m=r?g?0:a(h,d):g?a(h+(h<0?pi$1:-pi$1),d):0;if(!e&&(c=l=g)&&t.lineStart(),g!==l&&(!(f=s(e,p))||pointEqual(e,f)||pointEqual(p,f))&&(p[2]=1),g!==l)u=0,g?(t.lineStart(),f=s(p,e),t.point(f[0],f[1])):(f=s(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var A;m&n||!(A=s(p,e,!0))||(u=0,r?(t.lineStart(),t.point(A[0][0],A[0][1]),t.point(A[1][0],A[1][1]),t.lineEnd()):(t.point(A[1][0],A[1][1]),t.lineEnd(),t.lineStart(),t.point(A[0][0],A[0][1],3)))}!g||e&&pointEqual(e,p)||t.point(p[0],p[1]),e=p,l=g,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return u|(c&&l)<<1}}}),(function(e,r,i,o){circleStream(o,t,n,i,e,r)}),r?[0,-t]:[-pi$1,t-pi$1])}function clipLine(t,e,n,r,i,o){var s,a=t[0],l=t[1],c=0,u=1,h=e[0]-a,d=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<c)return;s<u&&(u=s)}else if(h>0){if(s>u)return;s>c&&(c=s)}if(s=i-a,h||!(s<0)){if(s/=h,h<0){if(s>u)return;s>c&&(c=s)}else if(h>0){if(s<c)return;s<u&&(u=s)}if(s=r-l,d||!(s>0)){if(s/=d,d<0){if(s<c)return;s<u&&(u=s)}else if(d>0){if(s>u)return;s>c&&(c=s)}if(s=o-l,d||!(s<0)){if(s/=d,d<0){if(s>u)return;s>c&&(c=s)}else if(d>0){if(s<c)return;s<u&&(u=s)}return c>0&&(t[0]=a+c*h,t[1]=l+c*d),u<1&&(e[0]=a+u*h,e[1]=l+u*d),!0}}}}}var clipMax=1e9,clipMin=-clipMax;function clipRectangle(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,c){var u=0,h=0;if(null==i||(u=s(i,a))!==(h=s(o,a))||l(i,o)<0^a>0)do{c.point(0===u||3===u?t:n,u>1?r:e)}while((u=(u+a+4)%4)!==h);else c.point(o[0],o[1])}function s(r,i){return abs$2(r[0]-t)<epsilon$2?i>0?0:3:abs$2(r[0]-n)<epsilon$2?i>0?2:1:abs$2(r[1]-e)<epsilon$2?i>0?1:0:i>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var l,c,u,h,d,f,p,g,m,A,y,v=s,b=clipBuffer(),x={point:w,lineStart:function(){x.point=C,c&&c.push(u=[]),A=!0,m=!1,p=g=NaN},lineEnd:function(){l&&(C(h,d),f&&m&&b.rejoin(),l.push(b.result())),x.point=w,m&&v.lineEnd()},polygonStart:function(){v=b,l=[],c=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,s,a=c[n],l=1,u=a.length,h=a[0],d=h[0],f=h[1];l<u;++l)o=d,s=f,d=(h=a[l])[0],f=h[1],s<=r?f>r&&(d-o)*(r-s)>(f-s)*(t-o)&&++e:f<=r&&(d-o)*(r-s)<(f-s)*(t-o)&&--e;return e}(),n=y&&e,i=(l=merge$1(l)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&clipRejoin(l,a,e,o,s),s.polygonEnd()),v=s,l=c=u=null}};function w(t,e){i(t,e)&&v.point(t,e)}function C(o,s){var a=i(o,s);if(c&&u.push([o,s]),A)h=o,d=s,f=a,A=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&m)v.point(o,s);else{var l=[p=Math.max(clipMin,Math.min(clipMax,p)),g=Math.max(clipMin,Math.min(clipMax,g))],b=[o=Math.max(clipMin,Math.min(clipMax,o)),s=Math.max(clipMin,Math.min(clipMax,s))];clipLine(l,b,t,e,n,r)?(m||(v.lineStart(),v.point(l[0],l[1])),v.point(b[0],b[1]),a||v.lineEnd(),y=!1):a&&(v.lineStart(),v.point(o,s),y=!1)}p=o,g=s,m=a}return x}}function extent(){var t,e,n,r=0,i=0,o=960,s=500;return n={stream:function(n){return t&&e===n?t:t=clipRectangle(r,i,o,s)(e=n)},extent:function(a){return arguments.length?(r=+a[0][0],i=+a[0][1],o=+a[1][0],s=+a[1][1],t=e=null,n):[[r,i],[o,s]]}}}var lengthSum$1=adder(),lambda0,sinPhi0,cosPhi0,lengthStream$1={sphere:noop$3,point:noop$3,lineStart:lengthLineStart,lineEnd:noop$3,polygonStart:noop$3,polygonEnd:noop$3};function lengthLineStart(){lengthStream$1.point=lengthPointFirst$1,lengthStream$1.lineEnd=lengthLineEnd}function lengthLineEnd(){lengthStream$1.point=lengthStream$1.lineEnd=noop$3}function lengthPointFirst$1(t,e){lambda0=t*=radians,sinPhi0=sin$1(e*=radians),cosPhi0=cos$1(e),lengthStream$1.point=lengthPoint$1}function lengthPoint$1(t,e){t*=radians;var n=sin$1(e*=radians),r=cos$1(e),i=abs$2(t-lambda0),o=cos$1(i),s=r*sin$1(i),a=cosPhi0*n-sinPhi0*r*o,l=sinPhi0*n+cosPhi0*r*o;lengthSum$1.add(atan2$1(sqrt$2(s*s+a*a),l)),lambda0=t,sinPhi0=n,cosPhi0=r}function length$2(t){return lengthSum$1.reset(),geoStream(t,lengthStream$1),+lengthSum$1}var coordinates=[null,null],object$4={type:"LineString",coordinates};function distance(t,e){return coordinates[0]=t,coordinates[1]=e,length$2(object$4)}var containsObjectType={Feature:function(t,e){return containsGeometry(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(containsGeometry(n[r].geometry,e))return!0;return!1}},containsGeometryType={Sphere:function(){return!0},Point:function(t,e){return containsPoint$1(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(containsPoint$1(n[r],e))return!0;return!1},LineString:function(t,e){return containsLine(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(containsLine(n[r],e))return!0;return!1},Polygon:function(t,e){return containsPolygon(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(containsPolygon(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(containsGeometry(n[r],e))return!0;return!1}};function containsGeometry(t,e){return!(!t||!containsGeometryType.hasOwnProperty(t.type))&&containsGeometryType[t.type](t,e)}function containsPoint$1(t,e){return 0===distance(t,e)}function containsLine(t,e){for(var n,r,i,o=0,s=t.length;o<s;o++){if(0===(r=distance(t[o],e)))return!0;if(o>0&&(i=distance(t[o],t[o-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<epsilon2$1*i)return!0;n=r}return!1}function containsPolygon(t,e){return!!polygonContains(t.map(ringRadians),pointRadians(e))}function ringRadians(t){return(t=t.map(pointRadians)).pop(),t}function pointRadians(t){return[t[0]*radians,t[1]*radians]}function contains$2(t,e){return(t&&containsObjectType.hasOwnProperty(t.type)?containsObjectType[t.type]:containsGeometry)(t,e)}function graticuleX(t,e,n){var r=sequence(t,e-epsilon$2,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function graticuleY(t,e,n){var r=sequence(t,e-epsilon$2,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function graticule(){var t,e,n,r,i,o,s,a,l,c,u,h,d=10,f=d,p=90,g=360,m=2.5;function A(){return{type:"MultiLineString",coordinates:y()}}function y(){return sequence(ceil$1(r/p)*p,n,p).map(u).concat(sequence(ceil$1(a/g)*g,s,g).map(h)).concat(sequence(ceil$1(e/d)*d,t,d).filter((function(t){return abs$2(t%p)>epsilon$2})).map(l)).concat(sequence(ceil$1(o/f)*f,i,f).filter((function(t){return abs$2(t%g)>epsilon$2})).map(c))}return A.lines=function(){return y().map((function(t){return{type:"LineString",coordinates:t}}))},A.outline=function(){return{type:"Polygon",coordinates:[u(r).concat(h(s).slice(1),u(n).reverse().slice(1),h(a).reverse().slice(1))]}},A.extent=function(t){return arguments.length?A.extentMajor(t).extentMinor(t):A.extentMinor()},A.extentMajor=function(t){return arguments.length?(a=+t[0][1],s=+t[1][1],(r=+t[0][0])>(n=+t[1][0])&&(t=r,r=n,n=t),a>s&&(t=a,a=s,s=t),A.precision(m)):[[r,a],[n,s]]},A.extentMinor=function(n){return arguments.length?(o=+n[0][1],i=+n[1][1],(e=+n[0][0])>(t=+n[1][0])&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),A.precision(m)):[[e,o],[t,i]]},A.step=function(t){return arguments.length?A.stepMajor(t).stepMinor(t):A.stepMinor()},A.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],A):[p,g]},A.stepMinor=function(t){return arguments.length?(d=+t[0],f=+t[1],A):[d,f]},A.precision=function(d){return arguments.length?(m=+d,l=graticuleX(o,i,90),c=graticuleY(e,t,m),u=graticuleX(a,s,90),h=graticuleY(r,n,m),A):m},A.extentMajor([[-180,-90+epsilon$2],[180,90-epsilon$2]]).extentMinor([[-180,-80-epsilon$2],[180,80+epsilon$2]])}function graticule10(){return graticule()()}function interpolate(t,e){var n=t[0]*radians,r=t[1]*radians,i=e[0]*radians,o=e[1]*radians,s=cos$1(r),a=sin$1(r),l=cos$1(o),c=sin$1(o),u=s*cos$1(n),h=s*sin$1(n),d=l*cos$1(i),f=l*sin$1(i),p=2*asin$1(sqrt$2(haversin(o-r)+s*l*haversin(i-n))),g=sin$1(p),m=p?function(t){var e=sin$1(t*=p)/g,n=sin$1(p-t)/g,r=n*u+e*d,i=n*h+e*f,o=n*a+e*c;return[atan2$1(i,r)*degrees,atan2$1(o,sqrt$2(r*r+i*i))*degrees]}:function(){return[n*degrees,r*degrees]};return m.distance=p,m}function identity$6(t){return t}var areaSum=adder(),areaRingSum=adder(),x00$2,y00$2,x0$3,y0$3,areaStream={point:noop$3,lineStart:noop$3,lineEnd:noop$3,polygonStart:function(){areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){areaStream.lineStart=areaStream.lineEnd=areaStream.point=noop$3,areaSum.add(abs$2(areaRingSum)),areaRingSum.reset()},result:function(){var t=areaSum/2;return areaSum.reset(),t}};function areaRingStart(){areaStream.point=areaPointFirst}function areaPointFirst(t,e){areaStream.point=areaPoint,x00$2=x0$3=t,y00$2=y0$3=e}function areaPoint(t,e){areaRingSum.add(y0$3*t-x0$3*e),x0$3=t,y0$3=e}function areaRingEnd(){areaPoint(x00$2,y00$2)}var x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream={point:boundsPoint,lineStart:noop$3,lineEnd:noop$3,polygonStart:noop$3,polygonEnd:noop$3,result:function(){var t=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),t}};function boundsPoint(t,e){t<x0$2&&(x0$2=t),t>x1&&(x1=t),e<y0$2&&(y0$2=e),e>y1&&(y1=e)}var X0=0,Y0=0,Z0=0,X1=0,Y1=0,Z1=0,X2=0,Y2=0,Z2=0,x00$1,y00$1,x0$1,y0$1,centroidStream={point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.point=centroidPoint,centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd},result:function(){var t=Z2?[X2/Z2,Y2/Z2]:Z1?[X1/Z1,Y1/Z1]:Z0?[X0/Z0,Y0/Z0]:[NaN,NaN];return X0=Y0=Z0=X1=Y1=Z1=X2=Y2=Z2=0,t}};function centroidPoint(t,e){X0+=t,Y0+=e,++Z0}function centroidLineStart(){centroidStream.point=centroidPointFirstLine}function centroidPointFirstLine(t,e){centroidStream.point=centroidPointLine,centroidPoint(x0$1=t,y0$1=e)}function centroidPointLine(t,e){var n=t-x0$1,r=e-y0$1,i=sqrt$2(n*n+r*r);X1+=i*(x0$1+t)/2,Y1+=i*(y0$1+e)/2,Z1+=i,centroidPoint(x0$1=t,y0$1=e)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidPointFirstRing}function centroidRingEnd(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(t,e){centroidStream.point=centroidPointRing,centroidPoint(x00$1=x0$1=t,y00$1=y0$1=e)}function centroidPointRing(t,e){var n=t-x0$1,r=e-y0$1,i=sqrt$2(n*n+r*r);X1+=i*(x0$1+t)/2,Y1+=i*(y0$1+e)/2,Z1+=i,X2+=(i=y0$1*t-x0$1*e)*(x0$1+t),Y2+=i*(y0$1+e),Z2+=3*i,centroidPoint(x0$1=t,y0$1=e)}function PathContext(t){this._context=t}PathContext.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,tau$1)}},result:noop$3};var lengthSum=adder(),lengthRing,x00,y00,x0,y0,lengthStream={point:noop$3,lineStart:function(){lengthStream.point=lengthPointFirst},lineEnd:function(){lengthRing&&lengthPoint(x00,y00),lengthStream.point=noop$3},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var t=+lengthSum;return lengthSum.reset(),t}};function lengthPointFirst(t,e){lengthStream.point=lengthPoint,x00=x0=t,y00=y0=e}function lengthPoint(t,e){lengthSum.add(sqrt$2((x0-=t)*x0+(y0-=e)*y0)),x0=t,y0=e}function PathString(){this._string=[]}function circle$3(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function index$3(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),geoStream(t,n(r))),r.result()}return o.area=function(t){return geoStream(t,n(areaStream)),areaStream.result()},o.measure=function(t){return geoStream(t,n(lengthStream)),lengthStream.result()},o.bounds=function(t){return geoStream(t,n(boundsStream)),boundsStream.result()},o.centroid=function(t){return geoStream(t,n(centroidStream)),centroidStream.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,identity$6):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new PathString):new PathContext(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)}function transform$3(t){return{stream:transformer$3(t)}}function transformer$3(t){return function(e){var n=new TransformStream;for(var r in t)n[r]=t[r];return n.stream=e,n}}function TransformStream(){}function fit(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),geoStream(n,t.stream(boundsStream)),e(boundsStream.result()),null!=r&&t.clipExtent(r),t}function fitExtent(t,e,n){return fit(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])}),n)}function fitSize(t,e,n){return fitExtent(t,[[0,0],e],n)}function fitWidth(t,e,n){return fit(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];t.scale(150*i).translate([o,s])}),n)}function fitHeight(t,e,n){return fit(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],s=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,s])}),n)}PathString.prototype={_radius:4.5,_circle:circle$3(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=circle$3(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},TransformStream.prototype={constructor:TransformStream,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var maxDepth=16,cosMinDistance=cos$1(30*radians);function resample(t,e){return+e?resample$1(t,e):resampleNone(t)}function resampleNone(t){return transformer$3({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function resample$1(t,e){function n(r,i,o,s,a,l,c,u,h,d,f,p,g,m){var A=c-r,y=u-i,v=A*A+y*y;if(v>4*e&&g--){var b=s+d,x=a+f,w=l+p,C=sqrt$2(b*b+x*x+w*w),$=asin$1(w/=C),_=abs$2(abs$2(w)-1)<epsilon$2||abs$2(o-h)<epsilon$2?(o+h)/2:atan2$1(x,b),P=t(_,$),S=P[0],M=P[1],E=S-r,T=M-i,k=y*E-A*T;(k*k/v>e||abs$2((A*E+y*T)/v-.5)>.3||s*d+a*f+l*p<cosMinDistance)&&(n(r,i,o,s,a,l,S,M,_,b/=C,x/=C,w,g,m),m.point(S,M),n(S,M,_,b,x,w,c,u,h,d,f,p,g,m))}}return function(e){var r,i,o,s,a,l,c,u,h,d,f,p,g={point:m,lineStart:A,lineEnd:v,polygonStart:function(){e.polygonStart(),g.lineStart=b},polygonEnd:function(){e.polygonEnd(),g.lineStart=A}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function A(){u=NaN,g.point=y,e.lineStart()}function y(r,i){var o=cartesian([r,i]),s=t(r,i);n(u,h,c,d,f,p,u=s[0],h=s[1],c=r,d=o[0],f=o[1],p=o[2],maxDepth,e),e.point(u,h)}function v(){g.point=m,e.lineEnd()}function b(){A(),g.point=x,g.lineEnd=w}function x(t,e){y(r=t,e),i=u,o=h,s=d,a=f,l=p,g.point=y}function w(){n(u,h,c,d,f,p,i,o,r,s,a,l,maxDepth,e),g.lineEnd=v,v()}return g}}var transformRadians=transformer$3({point:function(t,e){this.stream.point(t*radians,e*radians)}});function transformRotate(t){return transformer$3({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function scaleTranslate(t,e,n,r,i){function o(o,s){return[e+t*(o*=r),n-t*(s*=i)]}return o.invert=function(o,s){return[(o-e)/t*r,(n-s)/t*i]},o}function scaleTranslateRotate(t,e,n,r,i,o){var s=cos$1(o),a=sin$1(o),l=s*t,c=a*t,u=s/t,h=a/t,d=(a*n-s*e)/t,f=(a*e+s*n)/t;function p(t,o){return[l*(t*=r)-c*(o*=i)+e,n-c*t-l*o]}return p.invert=function(t,e){return[r*(u*t-h*e+d),i*(f-h*t-u*e)]},p}function projection(t){return projectionMutator((function(){return t}))()}function projectionMutator(t){var e,n,r,i,o,s,a,l,c,u,h=150,d=480,f=250,p=0,g=0,m=0,A=0,y=0,v=0,b=1,x=1,w=null,C=clipAntimeridian,$=null,_=identity$6,P=.5;function S(t){return l(t[0]*radians,t[1]*radians)}function M(t){return(t=l.invert(t[0],t[1]))&&[t[0]*degrees,t[1]*degrees]}function E(){var t=scaleTranslateRotate(h,0,0,b,x,v).apply(null,e(p,g)),r=(v?scaleTranslateRotate:scaleTranslate)(h,d-t[0],f-t[1],b,x,v);return n=rotateRadians(m,A,y),a=compose(e,r),l=compose(n,a),s=resample(a,P),T()}function T(){return c=u=null,S}return S.stream=function(t){return c&&u===t?c:c=transformRadians(transformRotate(n)(C(s(_(u=t)))))},S.preclip=function(t){return arguments.length?(C=t,w=void 0,T()):C},S.postclip=function(t){return arguments.length?(_=t,$=r=i=o=null,T()):_},S.clipAngle=function(t){return arguments.length?(C=+t?clipCircle(w=t*radians):(w=null,clipAntimeridian),T()):w*degrees},S.clipExtent=function(t){return arguments.length?(_=null==t?($=r=i=o=null,identity$6):clipRectangle($=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),T()):null==$?null:[[$,r],[i,o]]},S.scale=function(t){return arguments.length?(h=+t,E()):h},S.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],E()):[d,f]},S.center=function(t){return arguments.length?(p=t[0]%360*radians,g=t[1]%360*radians,E()):[p*degrees,g*degrees]},S.rotate=function(t){return arguments.length?(m=t[0]%360*radians,A=t[1]%360*radians,y=t.length>2?t[2]%360*radians:0,E()):[m*degrees,A*degrees,y*degrees]},S.angle=function(t){return arguments.length?(v=t%360*radians,E()):v*degrees},S.reflectX=function(t){return arguments.length?(b=t?-1:1,E()):b<0},S.reflectY=function(t){return arguments.length?(x=t?-1:1,E()):x<0},S.precision=function(t){return arguments.length?(s=resample(a,P=t*t),T()):sqrt$2(P)},S.fitExtent=function(t,e){return fitExtent(S,t,e)},S.fitSize=function(t,e){return fitSize(S,t,e)},S.fitWidth=function(t,e){return fitWidth(S,t,e)},S.fitHeight=function(t,e){return fitHeight(S,t,e)},function(){return e=t.apply(this,arguments),S.invert=e.invert&&M,E()}}function conicProjection(t){var e=0,n=pi$1/3,r=projectionMutator(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*radians,n=t[1]*radians):[e*degrees,n*degrees]},i}function cylindricalEqualAreaRaw(t){var e=cos$1(t);function n(t,n){return[t*e,sin$1(n)/e]}return n.invert=function(t,n){return[t/e,asin$1(n*e)]},n}function conicEqualAreaRaw(t,e){var n=sin$1(t),r=(n+sin$1(e))/2;if(abs$2(r)<epsilon$2)return cylindricalEqualAreaRaw(t);var i=1+n*(2*r-n),o=sqrt$2(i)/r;function s(t,e){var n=sqrt$2(i-2*r*sin$1(e))/r;return[n*sin$1(t*=r),o-n*cos$1(t)]}return s.invert=function(t,e){var n=o-e,s=atan2$1(t,abs$2(n))*sign$1(n);return n*r<0&&(s-=pi$1*sign$1(t)*sign$1(n)),[s/r,asin$1((i-(t*t+n*n)*r*r)/(2*r))]},s}function conicEqualArea(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])}function albers(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function multiplex(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function albersUsa(){var t,e,n,r,i,o,s=albers(),a=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function u(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function h(){return t=e=null,u}return u.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:s).invert(t)},u.stream=function(n){return t&&e===n?t:t=multiplex([s.stream(e=n),a.stream(n),l.stream(n)])},u.precision=function(t){return arguments.length?(s.precision(t),a.precision(t),l.precision(t),h()):s.precision()},u.scale=function(t){return arguments.length?(s.scale(t),a.scale(.35*t),l.scale(t),u.translate(s.translate())):s.scale()},u.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],u=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,u-.238*e],[o+.455*e,u+.238*e]]).stream(c),r=a.translate([o-.307*e,u+.201*e]).clipExtent([[o-.425*e+epsilon$2,u+.12*e+epsilon$2],[o-.214*e-epsilon$2,u+.234*e-epsilon$2]]).stream(c),i=l.translate([o-.205*e,u+.212*e]).clipExtent([[o-.214*e+epsilon$2,u+.166*e+epsilon$2],[o-.115*e-epsilon$2,u+.234*e-epsilon$2]]).stream(c),h()},u.fitExtent=function(t,e){return fitExtent(u,t,e)},u.fitSize=function(t,e){return fitSize(u,t,e)},u.fitWidth=function(t,e){return fitWidth(u,t,e)},u.fitHeight=function(t,e){return fitHeight(u,t,e)},u.scale(1070)}function azimuthalRaw(t){return function(e,n){var r=cos$1(e),i=cos$1(n),o=t(r*i);return[o*i*sin$1(e),o*sin$1(n)]}}function azimuthalInvert(t){return function(e,n){var r=sqrt$2(e*e+n*n),i=t(r),o=sin$1(i),s=cos$1(i);return[atan2$1(e*o,r*s),asin$1(r&&n*o/r)]}}var azimuthalEqualAreaRaw=azimuthalRaw((function(t){return sqrt$2(2/(1+t))}));function azimuthalEqualArea(){return projection(azimuthalEqualAreaRaw).scale(124.75).clipAngle(179.999)}azimuthalEqualAreaRaw.invert=azimuthalInvert((function(t){return 2*asin$1(t/2)}));var azimuthalEquidistantRaw=azimuthalRaw((function(t){return(t=acos$1(t))&&t/sin$1(t)}));function azimuthalEquidistant(){return projection(azimuthalEquidistantRaw).scale(79.4188).clipAngle(179.999)}function mercatorRaw(t,e){return[t,log$1(tan((halfPi$1+e)/2))]}function mercator(){return mercatorProjection(mercatorRaw).scale(961/tau$1)}function mercatorProjection(t){var e,n,r,i=projection(t),o=i.center,s=i.scale,a=i.translate,l=i.clipExtent,c=null;function u(){var o=pi$1*s(),a=i(rotation(i.rotate()).invert([0,0]));return l(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===mercatorRaw?[[Math.max(a[0]-o,c),e],[Math.min(a[0]+o,n),r]]:[[c,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),u()):s()},i.translate=function(t){return arguments.length?(a(t),u()):a()},i.center=function(t){return arguments.length?(o(t),u()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),u()):null==c?null:[[c,e],[n,r]]},u()}function tany(t){return tan((halfPi$1+t)/2)}function conicConformalRaw(t,e){var n=cos$1(t),r=t===e?sin$1(t):log$1(n/cos$1(e))/log$1(tany(e)/tany(t)),i=n*pow$1(tany(t),r)/r;if(!r)return mercatorRaw;function o(t,e){i>0?e<-halfPi$1+epsilon$2&&(e=-halfPi$1+epsilon$2):e>halfPi$1-epsilon$2&&(e=halfPi$1-epsilon$2);var n=i/pow$1(tany(e),r);return[n*sin$1(r*t),i-n*cos$1(r*t)]}return o.invert=function(t,e){var n=i-e,o=sign$1(r)*sqrt$2(t*t+n*n),s=atan2$1(t,abs$2(n))*sign$1(n);return n*r<0&&(s-=pi$1*sign$1(t)*sign$1(n)),[s/r,2*atan(pow$1(i/o,1/r))-halfPi$1]},o}function conicConformal(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])}function equirectangularRaw(t,e){return[t,e]}function equirectangular(){return projection(equirectangularRaw).scale(152.63)}function conicEquidistantRaw(t,e){var n=cos$1(t),r=t===e?sin$1(t):(n-cos$1(e))/(e-t),i=n/r+t;if(abs$2(r)<epsilon$2)return equirectangularRaw;function o(t,e){var n=i-e,o=r*t;return[n*sin$1(o),i-n*cos$1(o)]}return o.invert=function(t,e){var n=i-e,o=atan2$1(t,abs$2(n))*sign$1(n);return n*r<0&&(o-=pi$1*sign$1(t)*sign$1(n)),[o/r,i-sign$1(r)*sqrt$2(t*t+n*n)]},o}function conicEquidistant(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])}azimuthalEquidistantRaw.invert=azimuthalInvert((function(t){return t})),mercatorRaw.invert=function(t,e){return[t,2*atan(exp(e))-halfPi$1]},equirectangularRaw.invert=equirectangularRaw;var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M=sqrt$2(3)/2,iterations=12;function equalEarthRaw(t,e){var n=asin$1(M*sin$1(e)),r=n*n,i=r*r*r;return[t*cos$1(n)/(M*(A1+3*A2*r+i*(7*A3+9*A4*r))),n*(A1+A2*r+i*(A3+A4*r))]}function equalEarth(){return projection(equalEarthRaw).scale(177.158)}function gnomonicRaw(t,e){var n=cos$1(e),r=cos$1(t)*n;return[n*sin$1(t)/r,sin$1(e)/r]}function gnomonic(){return projection(gnomonicRaw).scale(144.049).clipAngle(60)}function identity$5(){var t,e,n,r,i,o,s,a=1,l=0,c=0,u=1,h=1,d=0,f=null,p=1,g=1,m=transformer$3({point:function(t,e){var n=v([t,e]);this.stream.point(n[0],n[1])}}),A=identity$6;function y(){return p=a*u,g=a*h,o=s=null,v}function v(n){var r=n[0]*p,i=n[1]*g;if(d){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+l,i+c]}return v.invert=function(n){var r=n[0]-l,i=n[1]-c;if(d){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/g]},v.stream=function(t){return o&&s===t?o:o=m(A(s=t))},v.postclip=function(t){return arguments.length?(A=t,f=n=r=i=null,y()):A},v.clipExtent=function(t){return arguments.length?(A=null==t?(f=n=r=i=null,identity$6):clipRectangle(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),y()):null==f?null:[[f,n],[r,i]]},v.scale=function(t){return arguments.length?(a=+t,y()):a},v.translate=function(t){return arguments.length?(l=+t[0],c=+t[1],y()):[l,c]},v.angle=function(n){return arguments.length?(e=sin$1(d=n%360*radians),t=cos$1(d),y()):d*degrees},v.reflectX=function(t){return arguments.length?(u=t?-1:1,y()):u<0},v.reflectY=function(t){return arguments.length?(h=t?-1:1,y()):h<0},v.fitExtent=function(t,e){return fitExtent(v,t,e)},v.fitSize=function(t,e){return fitSize(v,t,e)},v.fitWidth=function(t,e){return fitWidth(v,t,e)},v.fitHeight=function(t,e){return fitHeight(v,t,e)},v}function naturalEarth1Raw(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function naturalEarth1(){return projection(naturalEarth1Raw).scale(175.295)}function orthographicRaw(t,e){return[cos$1(e)*sin$1(t),sin$1(e)]}function orthographic(){return projection(orthographicRaw).scale(249.5).clipAngle(90+epsilon$2)}function stereographicRaw(t,e){var n=cos$1(e),r=1+cos$1(t)*n;return[n*sin$1(t)/r,sin$1(e)/r]}function stereographic(){return projection(stereographicRaw).scale(250).clipAngle(142)}function transverseMercatorRaw(t,e){return[log$1(tan((halfPi$1+e)/2)),-t]}function transverseMercator(){var t=mercatorProjection(transverseMercatorRaw),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}function defaultSeparation$1(t,e){return t.parent===e.parent?1:2}function meanX(t){return t.reduce(meanXReduce,0)/t.length}function meanXReduce(t,e){return t+e.x}function maxY(t){return 1+t.reduce(maxYReduce,0)}function maxYReduce(t,e){return Math.max(t,e.y)}function leafLeft(t){for(var e;e=t.children;)t=e[0];return t}function leafRight(t){for(var e;e=t.children;)t=e[e.length-1];return t}function cluster(){var t=defaultSeparation$1,e=1,n=1,r=!1;function i(i){var o,s=0;i.eachAfter((function(e){var n=e.children;n?(e.x=meanX(n),e.y=maxY(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)}));var a=leafLeft(i),l=leafRight(i),c=a.x-t(a,l)/2,u=l.x+t(l,a)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(u-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function count(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function node_count(){return this.eachAfter(count)}function node_each(t){var e,n,r,i,o=this,s=[o];do{for(e=s.reverse(),s=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r])}while(s.length);return this}function node_eachBefore(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this}function node_eachAfter(t){for(var e,n,r,i=this,o=[i],s=[];i=o.pop();)if(s.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=s.pop();)t(i);return this}function node_sum(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))}function node_sort(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))}function node_path(t){for(var e=this,n=leastCommonAncestor(e,t),r=[e];e!==n;)r.push(e=e.parent);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function leastCommonAncestor(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function node_ancestors(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function node_descendants(){var t=[];return this.each((function(e){t.push(e)})),t}function node_leaves(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t}function node_links(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e}function hierarchy(t,e){var n,r,i,o,s,a=new Node$3(t),l=+t.value&&(a.value=t.value),c=[a];for(null==e&&(e=defaultChildren);n=c.pop();)if(l&&(n.value=+n.data.value),(i=e(n.data))&&(s=i.length))for(n.children=new Array(s),o=s-1;o>=0;--o)c.push(r=n.children[o]=new Node$3(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function defaultChildren(t){return t.children}function copyData(t){t.data=t.data.data}function computeHeight(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Node$3(t){this.data=t,this.depth=this.height=0,this.parent=null}equalEarthRaw.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,s=0;s<iterations&&(o=(i=(r-=n=(r*(A1+A2*i+o*(A3+A4*i))-e)/(A1+3*A2*i+o*(7*A3+9*A4*i)))*r)*i*i,!(abs$2(n)<epsilon2$1));++s);return[M*t*(A1+3*A2*i+o*(7*A3+9*A4*i))/cos$1(r),asin$1(sin$1(r)/M)]},gnomonicRaw.invert=azimuthalInvert(atan),naturalEarth1Raw.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(abs$2(n)>epsilon$2&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},orthographicRaw.invert=azimuthalInvert(asin$1),stereographicRaw.invert=azimuthalInvert((function(t){return 2*atan(t)})),transverseMercatorRaw.invert=function(t,e){return[-e,2*atan(exp(t))-halfPi$1]},Node$3.prototype=hierarchy.prototype={constructor:Node$3,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var slice$3=Array.prototype.slice;function shuffle$1(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}function enclose(t){for(var e,n,r=0,i=(t=shuffle$1(slice$3.call(t))).length,o=[];r<i;)e=t[r],n&&enclosesWeak(n,e)?++r:(n=encloseBasis(o=extendBasis(o,e)),r=0);return n}function extendBasis(t,e){var n,r;if(enclosesWeakAll(e,t))return[e];for(n=0;n<t.length;++n)if(enclosesNot(e,t[n])&&enclosesWeakAll(encloseBasis2(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(enclosesNot(encloseBasis2(t[n],t[r]),e)&&enclosesNot(encloseBasis2(t[n],e),t[r])&&enclosesNot(encloseBasis2(t[r],e),t[n])&&enclosesWeakAll(encloseBasis3(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function enclosesNot(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function enclosesWeak(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function enclosesWeakAll(t,e){for(var n=0;n<e.length;++n)if(!enclosesWeak(t,e[n]))return!1;return!0}function encloseBasis(t){switch(t.length){case 1:return encloseBasis1(t[0]);case 2:return encloseBasis2(t[0],t[1]);case 3:return encloseBasis3(t[0],t[1],t[2])}}function encloseBasis1(t){return{x:t.x,y:t.y,r:t.r}}function encloseBasis2(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,s=e.y,a=e.r,l=o-n,c=s-r,u=a-i,h=Math.sqrt(l*l+c*c);return{x:(n+o+l/h*u)/2,y:(r+s+c/h*u)/2,r:(h+i+a)/2}}function encloseBasis3(t,e,n){var r=t.x,i=t.y,o=t.r,s=e.x,a=e.y,l=e.r,c=n.x,u=n.y,h=n.r,d=r-s,f=r-c,p=i-a,g=i-u,m=l-o,A=h-o,y=r*r+i*i-o*o,v=y-s*s-a*a+l*l,b=y-c*c-u*u+h*h,x=f*p-d*g,w=(p*b-g*v)/(2*x)-r,C=(g*m-p*A)/x,$=(f*v-d*b)/(2*x)-i,_=(d*A-f*m)/x,P=C*C+_*_-1,S=2*(o+w*C+$*_),M=w*w+$*$-o*o,E=-(P?(S+Math.sqrt(S*S-4*P*M))/(2*P):M/S);return{x:r+w+C*E,y:i+$+_*E,r:E}}function place(t,e,n){var r,i,o,s,a=t.x-e.x,l=t.y-e.y,c=a*a+l*l;c?(i=e.r+n.r,s=t.r+n.r,(i*=i)>(s*=s)?(r=(c+s-i)/(2*c),o=Math.sqrt(Math.max(0,s/c-r*r)),n.x=t.x-r*a-o*l,n.y=t.y-r*l+o*a):(r=(c+i-s)/(2*c),o=Math.sqrt(Math.max(0,i/c-r*r)),n.x=e.x+r*a-o*l,n.y=e.y+r*l+o*a)):(n.x=e.x+n.r,n.y=e.y)}function intersects(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function score(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function Node$2(t){this._=t,this.next=null,this.previous=null}function packEnclose(t){if(!(i=t.length))return 0;var e,n,r,i,o,s,a,l,c,u,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(e.x=-(n=t[1]).r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;place(n,e,r=t[2]),e=new Node$2(e),n=new Node$2(n),r=new Node$2(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(a=3;a<i;++a){place(e._,n._,r=t[a]),r=new Node$2(r),l=n.next,c=e.previous,u=n._.r,h=e._.r;do{if(u<=h){if(intersects(l._,r._)){e.next=n=l,n.previous=e,--a;continue t}u+=l._.r,l=l.next}else{if(intersects(c._,r._)){(e=c).next=n,n.previous=e,--a;continue t}h+=c._.r,c=c.previous}}while(l!==c.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,o=score(e);(r=r.next)!==n;)(s=score(r))<o&&(e=r,o=s);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=enclose(e),a=0;a<i;++a)(e=t[a]).x-=r.x,e.y-=r.y;return r.r}function siblings(t){return packEnclose(t),t}function optional(t){return null==t?null:required(t)}function required(t){if("function"!=typeof t)throw new Error;return t}function constantZero(){return 0}function constant$5(t){return function(){return t}}function defaultRadius(t){return Math.sqrt(t.value)}function index$2(){var t=null,e=1,n=1,r=constantZero;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(radiusLeaf(t)).eachAfter(packChildren(r,.5)).eachBefore(translateChild(1)):i.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(r,i.r/Math.min(e,n))).eachBefore(translateChild(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=optional(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:constant$5(+t),i):r},i}function radiusLeaf(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function packChildren(t,e){return function(n){if(r=n.children){var r,i,o,s=r.length,a=t(n)*e||0;if(a)for(i=0;i<s;++i)r[i].r+=a;if(o=packEnclose(r),a)for(i=0;i<s;++i)r[i].r-=a;n.r=o+a}}}function translateChild(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function roundNode(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function treemapDice(t,e,n,r,i){for(var o,s=t.children,a=-1,l=s.length,c=t.value&&(r-e)/t.value;++a<l;)(o=s[a]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c}function partition$1(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&treemapDice(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,s=r.x1-n,a=r.y1-n;s<i&&(i=s=(i+s)/2),a<o&&(o=a=(o+a)/2),r.x0=i,r.y0=o,r.x1=s,r.y1=a}}(e,o)),r&&i.eachBefore(roundNode),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i}var keyPrefix="$",preroot={depth:-1},ambiguous={};function defaultId(t){return t.id}function defaultParentId(t){return t.parentId}function stratify(){var t=defaultId,e=defaultParentId;function n(n){var r,i,o,s,a,l,c,u=n.length,h=new Array(u),d={};for(i=0;i<u;++i)a=h[i]=new Node$3(r=n[i]),null!=(l=t(r,i,n))&&(l+="")&&(d[c=keyPrefix+(a.id=l)]=c in d?ambiguous:a);for(i=0;i<u;++i)if(a=h[i],null!=(l=e(n[i],i,n))&&(l+="")){if(!(s=d[keyPrefix+l]))throw new Error("missing: "+l);if(s===ambiguous)throw new Error("ambiguous: "+l);s.children?s.children.push(a):s.children=[a],a.parent=s}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=preroot,o.eachBefore((function(t){t.depth=t.parent.depth+1,--u})).eachBefore(computeHeight),o.parent=null,u>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=required(e),n):t},n.parentId=function(t){return arguments.length?(e=required(t),n):e},n}function defaultSeparation(t,e){return t.parent===e.parent?1:2}function nextLeft(t){var e=t.children;return e?e[0]:t.t}function nextRight(t){var e=t.children;return e?e[e.length-1]:t.t}function moveSubtree(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function executeShifts(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}function nextAncestor(t,e,n){return t.a.parent===e.parent?t.a:n}function TreeNode(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function treeRoot(t){for(var e,n,r,i,o,s=new TreeNode(t,0),a=[s];e=a.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)a.push(n=e.children[i]=new TreeNode(r[i],i)),n.parent=e;return(s.parent=new TreeNode(null,0)).children=[s],s}function tree(){var t=defaultSeparation,e=1,n=1,r=null;function i(i){var l=treeRoot(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(s),r)i.eachBefore(a);else{var c=i,u=i,h=i;i.eachBefore((function(t){t.x<c.x&&(c=t),t.x>u.x&&(u=t),t.depth>h.depth&&(h=t)}));var d=c===u?1:t(c,u)/2,f=d-c.x,p=e/(u.x+d+f),g=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+f)*p,t.y=t.depth*g}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){executeShifts(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,s=e,a=n,l=o.parent.children[0],c=o.m,u=s.m,h=a.m,d=l.m;a=nextRight(a),o=nextLeft(o),a&&o;)l=nextLeft(l),(s=nextRight(s)).a=e,(i=a.z+h-o.z-c+t(a._,o._))>0&&(moveSubtree(nextAncestor(a,e,r),e,i),c+=i,u+=i),h+=a.m,c+=o.m,d+=l.m,u+=s.m;a&&!nextRight(s)&&(s.t=a,s.m+=h-u),o&&!nextLeft(l)&&(l.t=o,l.m+=c-d,r=e)}return r}(e,i,e.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function treemapSlice(t,e,n,r,i){for(var o,s=t.children,a=-1,l=s.length,c=t.value&&(i-n)/t.value;++a<l;)(o=s[a]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c}TreeNode.prototype=Object.create(Node$3.prototype);var phi=(1+Math.sqrt(5))/2;function squarifyRatio(t,e,n,r,i,o){for(var s,a,l,c,u,h,d,f,p,g,m,A=[],y=e.children,v=0,b=0,x=y.length,w=e.value;v<x;){l=i-n,c=o-r;do{u=y[b++].value}while(!u&&b<x);for(h=d=u,m=u*u*(g=Math.max(c/l,l/c)/(w*t)),p=Math.max(d/m,m/h);b<x;++b){if(u+=a=y[b].value,a<h&&(h=a),a>d&&(d=a),m=u*u*g,(f=Math.max(d/m,m/h))>p){u-=a;break}p=f}A.push(s={value:u,dice:l<c,children:y.slice(v,b)}),s.dice?treemapDice(s,n,r,i,w?r+=c*u/w:o):treemapSlice(s,n,r,w?n+=l*u/w:i,o),w-=u,v=b}return A}const squarify=function t(e){function n(t,n,r,i,o){squarifyRatio(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(phi);function index$1(){var t=squarify,e=!1,n=1,r=1,i=[0],o=constantZero,s=constantZero,a=constantZero,l=constantZero,c=constantZero;function u(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(roundNode),t}function h(e){var n=i[e.depth],r=e.x0+n,u=e.y0+n,h=e.x1-n,d=e.y1-n;h<r&&(r=h=(r+h)/2),d<u&&(u=d=(u+d)/2),e.x0=r,e.y0=u,e.x1=h,e.y1=d,e.children&&(n=i[e.depth+1]=o(e)/2,r+=c(e)-n,u+=s(e)-n,(h-=a(e)-n)<r&&(r=h=(r+h)/2),(d-=l(e)-n)<u&&(u=d=(u+d)/2),t(e,r,u,h,d))}return u.round=function(t){return arguments.length?(e=!!t,u):e},u.size=function(t){return arguments.length?(n=+t[0],r=+t[1],u):[n,r]},u.tile=function(e){return arguments.length?(t=required(e),u):t},u.padding=function(t){return arguments.length?u.paddingInner(t).paddingOuter(t):u.paddingInner()},u.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:constant$5(+t),u):o},u.paddingOuter=function(t){return arguments.length?u.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):u.paddingTop()},u.paddingTop=function(t){return arguments.length?(s="function"==typeof t?t:constant$5(+t),u):s},u.paddingRight=function(t){return arguments.length?(a="function"==typeof t?t:constant$5(+t),u):a},u.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:constant$5(+t),u):l},u.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:constant$5(+t),u):c},u}function binary(t,e,n,r,i){var o,s,a=t.children,l=a.length,c=new Array(l+1);for(c[0]=s=o=0;o<l;++o)c[o+1]=s+=a[o].value;!function t(e,n,r,i,o,s,l){if(e>=n-1){var u=a[e];return u.x0=i,u.y0=o,u.x1=s,void(u.y1=l)}for(var h=c[e],d=r/2+h,f=e+1,p=n-1;f<p;){var g=f+p>>>1;c[g]<d?f=g+1:p=g}d-c[f-1]<c[f]-d&&e+1<f&&--f;var m=c[f]-h,A=r-m;if(s-i>l-o){var y=(i*A+s*m)/r;t(e,f,m,i,o,y,l),t(f,n,A,y,o,s,l)}else{var v=(o*A+l*m)/r;t(e,f,m,i,o,s,v),t(f,n,A,i,v,s,l)}}(0,l,t.value,e,n,r,i)}function sliceDice(t,e,n,r,i){(1&t.depth?treemapSlice:treemapDice)(t,e,n,r,i)}const resquarify=function t(e){function n(t,n,r,i,o){if((s=t._squarify)&&s.ratio===e)for(var s,a,l,c,u,h=-1,d=s.length,f=t.value;++h<d;){for(l=(a=s[h]).children,c=a.value=0,u=l.length;c<u;++c)a.value+=l[c].value;a.dice?treemapDice(a,n,r,i,r+=(o-r)*a.value/f):treemapSlice(a,n,r,n+=(i-n)*a.value/f,o),f-=a.value}else t._squarify=s=squarifyRatio(e,t,n,r,i,o),s.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(phi);function area$1(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)o+=(e=i)[1]*(i=t[n])[0]-e[0]*i[1];return o/2}function centroid(t){for(var e,n,r=-1,i=t.length,o=0,s=0,a=t[i-1],l=0;++r<i;)l+=n=(e=a)[0]*(a=t[r])[1]-a[0]*e[1],o+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return[o/(l*=3),s/l]}function cross$2(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function lexicographicOrder(t,e){return t[0]-e[0]||t[1]-e[1]}function computeUpperHullIndexes(t){for(var e=t.length,n=[0,1],r=2,i=2;i<e;++i){for(;r>1&&cross$2(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function hull(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(lexicographicOrder),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var o=computeUpperHullIndexes(r),s=computeUpperHullIndexes(i),a=s[0]===o[0],l=s[s.length-1]===o[o.length-1],c=[];for(e=o.length-1;e>=0;--e)c.push(t[r[o[e]][2]]);for(e=+a;e<s.length-l;++e)c.push(t[r[s[e]][2]]);return c}function contains$1(t,e){for(var n,r,i=t.length,o=t[i-1],s=e[0],a=e[1],l=o[0],c=o[1],u=!1,h=0;h<i;++h)n=(o=t[h])[0],(r=o[1])>a!=c>a&&s<(l-n)*(a-r)/(c-r)+n&&(u=!u),l=n,c=r;return u}function length$1(t){for(var e,n,r=-1,i=t.length,o=t[i-1],s=o[0],a=o[1],l=0;++r<i;)e=s,n=a,e-=s=(o=t[r])[0],n-=a=o[1],l+=Math.sqrt(e*e+n*n);return l}function defaultSource(){return Math.random()}const uniform=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(defaultSource),normal$3=function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(defaultSource),logNormal=function t(e){function n(){var t=normal$3.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(defaultSource),irwinHall=function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(defaultSource),bates=function t(e){function n(t){var n=irwinHall.source(e)(t);return function(){return n()/t}}return n.source=t,n}(defaultSource),exponential=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(defaultSource);function initRange(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function initInterpolator(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var array$3=Array.prototype,map$1=array$3.map,slice$2=array$3.slice,implicit={name:"implicit"};function ordinal(){var t=map$3(),e=[],n=[],r=implicit;function i(i){var o=i+"",s=t.get(o);if(!s){if(r!==implicit)return r;t.set(o,s=e.push(i))}return n[(s-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=map$3();for(var r,o,s=-1,a=n.length;++s<a;)t.has(o=(r=n[s])+"")||t.set(o,e.push(r));return i},i.range=function(t){return arguments.length?(n=slice$2.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return ordinal(e,n).unknown(r)},initRange.apply(i,arguments),i}function band(){var t,e,n=ordinal().unknown(void 0),r=n.domain,i=n.range,o=[0,1],s=!1,a=0,l=0,c=.5;function u(){var n=r().length,u=o[1]<o[0],h=o[u-0],d=o[1-u];t=(d-h)/Math.max(1,n-a+2*l),s&&(t=Math.floor(t)),h+=(d-h-t*(n-a))*c,e=t*(1-a),s&&(h=Math.round(h),e=Math.round(e));var f=sequence(n).map((function(e){return h+t*e}));return i(u?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),u()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],u()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],s=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,u()):s},n.padding=function(t){return arguments.length?(a=Math.min(1,l=+t),u()):a},n.paddingInner=function(t){return arguments.length?(a=Math.min(1,t),u()):a},n.paddingOuter=function(t){return arguments.length?(l=+t,u()):l},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},n.copy=function(){return band(r(),o).round(s).paddingInner(a).paddingOuter(l).align(c)},initRange.apply(u(),arguments)}function pointish(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return pointish(e())},t}function point$5(){return pointish(band.apply(null,arguments).paddingInner(1))}function constant$4(t){return function(){return t}}function number$4(t){return+t}var unit$1=[0,1];function identity$4(t){return t}function normalize$2(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:constant$4(isNaN(e)?NaN:.5)}function clamper(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function bimap(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=normalize$2(i,r),o=n(s,o)):(r=normalize$2(r,i),o=n(o,s)),function(t){return o(r(t))}}function polymap(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=normalize$2(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=bisectRight(t,e,1,r)-1;return o[n](i[n](e))}}function copy$1(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function transformer$2(){var t,e,n,r,i,o,s=unit$1,a=unit$1,l=interpolateValue,c=identity$4;function u(){return r=Math.min(s.length,a.length)>2?polymap:bimap,i=o=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(s.map(t),a,l)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=r(a,s.map(t),interpolateNumber)))(n)))},h.domain=function(t){return arguments.length?(s=map$1.call(t,number$4),c===identity$4||(c=clamper(s)),u()):s.slice()},h.range=function(t){return arguments.length?(a=slice$2.call(t),u()):a.slice()},h.rangeRound=function(t){return a=slice$2.call(t),l=interpolateRound,u()},h.clamp=function(t){return arguments.length?(c=t?clamper(s):identity$4,h):c!==identity$4},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,u()}}function continuous(t,e){return transformer$2()(t,e)}function tickFormat(t,e,n,r){var i,o=tickStep(t,e,n);switch((r=formatSpecifier(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=precisionPrefix(o,s))||(r.precision=i),formatPrefix(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=precisionRound(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=precisionFixed(o))||(r.precision=i-2*("%"===r.type))}return format$1(r)}function linearish(t){var e=t.domain;return t.ticks=function(t){var n=e();return ticks(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return tickFormat(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,s=i.length-1,a=i[o],l=i[s];return l<a&&(r=a,a=l,l=r,r=o,o=s,s=r),(r=tickIncrement(a,l,n))>0?r=tickIncrement(a=Math.floor(a/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=tickIncrement(a=Math.ceil(a*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[o]=Math.floor(a/r)*r,i[s]=Math.ceil(l/r)*r,e(i)):r<0&&(i[o]=Math.ceil(a*r)/r,i[s]=Math.floor(l*r)/r,e(i)),t},t}function linear(){var t=continuous(identity$4,identity$4);return t.copy=function(){return copy$1(t,linear())},initRange.apply(t,arguments),linearish(t)}function identity$3(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=map$1.call(e,number$4),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return identity$3(t).unknown(e)},t=arguments.length?map$1.call(t,number$4):[0,1],linearish(n)}function nice(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],s=t[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),t[r]=e.floor(o),t[i]=e.ceil(s),t}function transformLog(t){return Math.log(t)}function transformExp(t){return Math.exp(t)}function transformLogn(t){return-Math.log(-t)}function transformExpn(t){return-Math.exp(-t)}function pow10(t){return isFinite(t)?+("1e"+t):t<0?0:t}function powp(t){return 10===t?pow10:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function logp(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function reflect(t){return function(e){return-t(-e)}}function loggish(t){var e,n,r=t(transformLog,transformExp),i=r.domain,o=10;function s(){return e=logp(o),n=powp(o),i()[0]<0?(e=reflect(e),n=reflect(n),t(transformLogn,transformExpn)):t(transformLog,transformExp),r}return r.base=function(t){return arguments.length?(o=+t,s()):o},r.domain=function(t){return arguments.length?(i(t),s()):i()},r.ticks=function(t){var r,s=i(),a=s[0],l=s[s.length-1];(r=l<a)&&(d=a,a=l,l=d);var c,u,h,d=e(a),f=e(l),p=null==t?10:+t,g=[];if(!(o%1)&&f-d<p){if(d=Math.round(d)-1,f=Math.round(f)+1,a>0){for(;d<f;++d)for(u=1,c=n(d);u<o;++u)if(!((h=c*u)<a)){if(h>l)break;g.push(h)}}else for(;d<f;++d)for(u=o-1,c=n(d);u>=1;--u)if(!((h=c*u)<a)){if(h>l)break;g.push(h)}}else g=ticks(d,f,Math.min(f-d,p)).map(n);return r?g.reverse():g},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=format$1(i)),t===1/0)return i;null==t&&(t=10);var s=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=s?i(t):""}},r.nice=function(){return i(nice(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function log(){var t=loggish(transformer$2()).domain([1,10]);return t.copy=function(){return copy$1(t,log()).base(t.base())},initRange.apply(t,arguments),t}function transformSymlog(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function transformSymexp(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function symlogish(t){var e=1,n=t(transformSymlog(e),transformSymexp(e));return n.constant=function(n){return arguments.length?t(transformSymlog(e=+n),transformSymexp(e)):e},linearish(n)}function symlog(){var t=symlogish(transformer$2());return t.copy=function(){return copy$1(t,symlog()).constant(t.constant())},initRange.apply(t,arguments)}function transformPow(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function transformSqrt(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function transformSquare(t){return t<0?-t*t:t*t}function powish(t){var e=t(identity$4,identity$4),n=1;function r(){return 1===n?t(identity$4,identity$4):.5===n?t(transformSqrt,transformSquare):t(transformPow(n),transformPow(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},linearish(e)}function pow(){var t=powish(transformer$2());return t.copy=function(){return copy$1(t,pow()).exponent(t.exponent())},initRange.apply(t,arguments),t}function sqrt$1(){return pow.apply(null,arguments).exponent(.5)}function quantile(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=threshold$1(e,t/i);return o}function o(e){return isNaN(e=+e)?t:n[bisectRight(r,e)]}return o.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,r=0,o=t.length;r<o;++r)null==(n=t[r])||isNaN(n=+n)||e.push(n);return e.sort(ascending$3),i()},o.range=function(t){return arguments.length?(n=slice$2.call(t),i()):n.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return r.slice()},o.copy=function(){return quantile().domain(e).range(n).unknown(t)},initRange.apply(o,arguments)}function quantize(){var t,e=0,n=1,r=1,i=[.5],o=[0,1];function s(e){return e<=e?o[bisectRight(i,e,0,r)]:t}function a(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return s}return s.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],a()):[e,n]},s.range=function(t){return arguments.length?(r=(o=slice$2.call(t)).length-1,a()):o.slice()},s.invertExtent=function(t){var s=o.indexOf(t);return s<0?[NaN,NaN]:s<1?[e,i[0]]:s>=r?[i[r-1],n]:[i[s-1],i[s]]},s.unknown=function(e){return arguments.length?(t=e,s):s},s.thresholds=function(){return i.slice()},s.copy=function(){return quantize().domain([e,n]).range(o).unknown(t)},initRange.apply(linearish(s),arguments)}function threshold(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[bisectRight(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=slice$2.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=slice$2.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return threshold().domain(e).range(n).unknown(t)},initRange.apply(i,arguments)}var t0=new Date,t1=new Date;function newInterval(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var s,a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<r);return a},i.filter=function(n){return newInterval((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return t0.setTime(+e),t1.setTime(+r),t(t0),t(t1),Math.floor(n(t0,t1))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var millisecond=newInterval((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));millisecond.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?newInterval((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):millisecond:null};var milliseconds=millisecond.range,durationSecond$1=1e3,durationMinute$1=6e4,durationHour$1=36e5,durationDay$1=864e5,durationWeek$1=6048e5,second=newInterval((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*durationSecond$1)}),(function(t,e){return(e-t)/durationSecond$1}),(function(t){return t.getUTCSeconds()})),seconds=second.range,minute=newInterval((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*durationSecond$1)}),(function(t,e){t.setTime(+t+e*durationMinute$1)}),(function(t,e){return(e-t)/durationMinute$1}),(function(t){return t.getMinutes()})),minutes=minute.range,hour=newInterval((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*durationSecond$1-t.getMinutes()*durationMinute$1)}),(function(t,e){t.setTime(+t+e*durationHour$1)}),(function(t,e){return(e-t)/durationHour$1}),(function(t){return t.getHours()})),hours=hour.range,day=newInterval((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*durationMinute$1)/durationDay$1}),(function(t){return t.getDate()-1})),days=day.range;function weekday(t){return newInterval((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*durationMinute$1)/durationWeek$1}))}var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),sundays=sunday.range,mondays=monday.range,tuesdays=tuesday.range,wednesdays=wednesday.range,thursdays=thursday.range,fridays=friday.range,saturdays=saturday.range,month=newInterval((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),months=month.range,year=newInterval((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));year.every=function(t){return isFinite(t=Math.floor(t))&&t>0?newInterval((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var years=year.range,utcMinute=newInterval((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*durationMinute$1)}),(function(t,e){return(e-t)/durationMinute$1}),(function(t){return t.getUTCMinutes()})),utcMinutes=utcMinute.range,utcHour=newInterval((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*durationHour$1)}),(function(t,e){return(e-t)/durationHour$1}),(function(t){return t.getUTCHours()})),utcHours=utcHour.range,utcDay=newInterval((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/durationDay$1}),(function(t){return t.getUTCDate()-1})),utcDays=utcDay.range;function utcWeekday(t){return newInterval((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/durationWeek$1}))}var utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,utcMonth=newInterval((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),utcMonths=utcMonth.range,utcYear=newInterval((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));utcYear.every=function(t){return isFinite(t=Math.floor(t))&&t>0?newInterval((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var utcYears=utcYear.range;function localDate(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function utcDate(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function newDate(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function formatLocale(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,s=t.shortDays,a=t.months,l=t.shortMonths,c=formatRe(i),u=formatLookup(i),h=formatRe(o),d=formatLookup(o),f=formatRe(s),p=formatLookup(s),g=formatRe(a),m=formatLookup(a),A=formatRe(l),y=formatLookup(l),v={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},b={a:function(t){return s[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},x={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=A.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return $(t,e,n,r)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function(t,e,r){return $(t,n,e,r)},X:function(t,e,n){return $(t,r,e,n)},y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function w(t,e){return function(n){var r,i,o,s=[],a=-1,l=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===t.charCodeAt(a)&&(s.push(t.slice(l,a)),null!=(i=pads[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),s.push(r),l=a+1);return s.push(t.slice(l,a)),s.join("")}}function C(t,e){return function(n){var r,i,o=newDate(1900,void 0,1);if($(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=utcDate(newDate(o.y,0,1))).getUTCDay(),r=i>4||0===i?utcMonday.ceil(r):utcMonday(r),r=utcDay.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=localDate(newDate(o.y,0,1))).getDay(),r=i>4||0===i?monday.ceil(r):monday(r),r=day.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?utcDate(newDate(o.y,0,1)).getUTCDay():localDate(newDate(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,utcDate(o)):localDate(o)}}function $(t,e,n,r){for(var i,o,s=0,a=e.length,l=n.length;s<a;){if(r>=l)return-1;if(37===(i=e.charCodeAt(s++))){if(i=e.charAt(s++),!(o=x[i in pads?e.charAt(s++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=w(n,v),v.X=w(r,v),v.c=w(e,v),b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),{format:function(t){var e=w(t+="",v);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t+="",!0);return e.toString=function(){return t},e}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g,locale,timeFormat,timeParse,utcFormat,utcParse;function pad$1(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function requote(t){return t.replace(requoteRe,"\\$&")}function formatRe(t){return new RegExp("^(?:"+t.map(requote).join("|")+")","i")}function formatLookup(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function parseWeekdayNumberSunday(t,e,n){var r=numberRe.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function parseWeekdayNumberMonday(t,e,n){var r=numberRe.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function parseWeekNumberSunday(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function parseWeekNumberISO(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function parseWeekNumberMonday(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function parseFullYear(t,e,n){var r=numberRe.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function parseYear(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function parseZone(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function parseQuarter(t,e,n){var r=numberRe.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function parseMonthNumber(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function parseDayOfMonth(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function parseDayOfYear(t,e,n){var r=numberRe.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function parseHour24(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function parseMinutes(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function parseSeconds(t,e,n){var r=numberRe.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function parseMilliseconds(t,e,n){var r=numberRe.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function parseMicroseconds(t,e,n){var r=numberRe.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function parseLiteralPercent(t,e,n){var r=percentRe.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function parseUnixTimestamp(t,e,n){var r=numberRe.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function parseUnixTimestampSeconds(t,e,n){var r=numberRe.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function formatDayOfMonth(t,e){return pad$1(t.getDate(),e,2)}function formatHour24(t,e){return pad$1(t.getHours(),e,2)}function formatHour12(t,e){return pad$1(t.getHours()%12||12,e,2)}function formatDayOfYear(t,e){return pad$1(1+day.count(year(t),t),e,3)}function formatMilliseconds(t,e){return pad$1(t.getMilliseconds(),e,3)}function formatMicroseconds(t,e){return formatMilliseconds(t,e)+"000"}function formatMonthNumber(t,e){return pad$1(t.getMonth()+1,e,2)}function formatMinutes(t,e){return pad$1(t.getMinutes(),e,2)}function formatSeconds(t,e){return pad$1(t.getSeconds(),e,2)}function formatWeekdayNumberMonday(t){var e=t.getDay();return 0===e?7:e}function formatWeekNumberSunday(t,e){return pad$1(sunday.count(year(t)-1,t),e,2)}function dISO(t){var e=t.getDay();return e>=4||0===e?thursday(t):thursday.ceil(t)}function formatWeekNumberISO(t,e){return t=dISO(t),pad$1(thursday.count(year(t),t)+(4===year(t).getDay()),e,2)}function formatWeekdayNumberSunday(t){return t.getDay()}function formatWeekNumberMonday(t,e){return pad$1(monday.count(year(t)-1,t),e,2)}function formatYear(t,e){return pad$1(t.getFullYear()%100,e,2)}function formatYearISO(t,e){return pad$1((t=dISO(t)).getFullYear()%100,e,2)}function formatFullYear(t,e){return pad$1(t.getFullYear()%1e4,e,4)}function formatFullYearISO(t,e){var n=t.getDay();return pad$1((t=n>=4||0===n?thursday(t):thursday.ceil(t)).getFullYear()%1e4,e,4)}function formatZone(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+pad$1(e/60|0,"0",2)+pad$1(e%60,"0",2)}function formatUTCDayOfMonth(t,e){return pad$1(t.getUTCDate(),e,2)}function formatUTCHour24(t,e){return pad$1(t.getUTCHours(),e,2)}function formatUTCHour12(t,e){return pad$1(t.getUTCHours()%12||12,e,2)}function formatUTCDayOfYear(t,e){return pad$1(1+utcDay.count(utcYear(t),t),e,3)}function formatUTCMilliseconds(t,e){return pad$1(t.getUTCMilliseconds(),e,3)}function formatUTCMicroseconds(t,e){return formatUTCMilliseconds(t,e)+"000"}function formatUTCMonthNumber(t,e){return pad$1(t.getUTCMonth()+1,e,2)}function formatUTCMinutes(t,e){return pad$1(t.getUTCMinutes(),e,2)}function formatUTCSeconds(t,e){return pad$1(t.getUTCSeconds(),e,2)}function formatUTCWeekdayNumberMonday(t){var e=t.getUTCDay();return 0===e?7:e}function formatUTCWeekNumberSunday(t,e){return pad$1(utcSunday.count(utcYear(t)-1,t),e,2)}function UTCdISO(t){var e=t.getUTCDay();return e>=4||0===e?utcThursday(t):utcThursday.ceil(t)}function formatUTCWeekNumberISO(t,e){return t=UTCdISO(t),pad$1(utcThursday.count(utcYear(t),t)+(4===utcYear(t).getUTCDay()),e,2)}function formatUTCWeekdayNumberSunday(t){return t.getUTCDay()}function formatUTCWeekNumberMonday(t,e){return pad$1(utcMonday.count(utcYear(t)-1,t),e,2)}function formatUTCYear(t,e){return pad$1(t.getUTCFullYear()%100,e,2)}function formatUTCYearISO(t,e){return pad$1((t=UTCdISO(t)).getUTCFullYear()%100,e,2)}function formatUTCFullYear(t,e){return pad$1(t.getUTCFullYear()%1e4,e,4)}function formatUTCFullYearISO(t,e){var n=t.getUTCDay();return pad$1((t=n>=4||0===n?utcThursday(t):utcThursday.ceil(t)).getUTCFullYear()%1e4,e,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(t){return+t}function formatUnixTimestampSeconds(t){return Math.floor(+t/1e3)}function defaultLocale(t){return locale=formatLocale(t),timeFormat=locale.format,timeParse=locale.parse,utcFormat=locale.utcFormat,utcParse=locale.utcParse,locale}defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var isoSpecifier="%Y-%m-%dT%H:%M:%S.%LZ";function formatIsoNative(t){return t.toISOString()}var formatIso=Date.prototype.toISOString?formatIsoNative:utcFormat(isoSpecifier);function parseIsoNative(t){var e=new Date(t);return isNaN(e)?null:e}var parseIso=+new Date("2000-01-01T00:00:00.000Z")?parseIsoNative:utcParse(isoSpecifier),durationSecond=1e3,durationMinute=60*durationSecond,durationHour=60*durationMinute,durationDay=24*durationHour,durationWeek=7*durationDay,durationMonth=30*durationDay,durationYear=365*durationDay;function date$1(t){return new Date(t)}function number$3(t){return t instanceof Date?+t:+new Date(+t)}function calendar(t,e,n,r,i,o,s,a,l){var c=continuous(identity$4,identity$4),u=c.invert,h=c.domain,d=l(".%L"),f=l(":%S"),p=l("%I:%M"),g=l("%I %p"),m=l("%a %d"),A=l("%b %d"),y=l("%B"),v=l("%Y"),b=[[s,1,durationSecond],[s,5,5*durationSecond],[s,15,15*durationSecond],[s,30,30*durationSecond],[o,1,durationMinute],[o,5,5*durationMinute],[o,15,15*durationMinute],[o,30,30*durationMinute],[i,1,durationHour],[i,3,3*durationHour],[i,6,6*durationHour],[i,12,12*durationHour],[r,1,durationDay],[r,2,2*durationDay],[n,1,durationWeek],[e,1,durationMonth],[e,3,3*durationMonth],[t,1,durationYear]];function x(a){return(s(a)<a?d:o(a)<a?f:i(a)<a?p:r(a)<a?g:e(a)<a?n(a)<a?m:A:t(a)<a?y:v)(a)}function w(e,n,r,i){if(null==e&&(e=10),"number"==typeof e){var o=Math.abs(r-n)/e,s=bisector((function(t){return t[2]})).right(b,o);s===b.length?(i=tickStep(n/durationYear,r/durationYear,e),e=t):s?(i=(s=b[o/b[s-1][2]<b[s][2]/o?s-1:s])[1],e=s[0]):(i=Math.max(tickStep(n,r,e),1),e=a)}return null==i?e:e.every(i)}return c.invert=function(t){return new Date(u(t))},c.domain=function(t){return arguments.length?h(map$1.call(t,number$3)):h().map(date$1)},c.ticks=function(t,e){var n,r=h(),i=r[0],o=r[r.length-1],s=o<i;return s&&(n=i,i=o,o=n),n=(n=w(t,i,o,e))?n.range(i,o+1):[],s?n.reverse():n},c.tickFormat=function(t,e){return null==e?x:l(e)},c.nice=function(t,e){var n=h();return(t=w(t,n[0],n[n.length-1],e))?h(nice(n,t)):c},c.copy=function(){return copy$1(c,calendar(t,e,n,r,i,o,s,a,l))},c}function time(){return initRange.apply(calendar(year,month,sunday,day,hour,minute,second,millisecond,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,millisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer$1(){var t,e,n,r,i,o=0,s=1,a=identity$4,l=!1;function c(e){return isNaN(e=+e)?i:a(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}return c.domain=function(i){return arguments.length?(t=r(o=+i[0]),e=r(s=+i[1]),n=t===e?0:1/(e-t),c):[o,s]},c.clamp=function(t){return arguments.length?(l=!!t,c):l},c.interpolator=function(t){return arguments.length?(a=t,c):a},c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(o),e=i(s),n=t===e?0:1/(e-t),c}}function copy(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function sequential(){var t=linearish(transformer$1()(identity$4));return t.copy=function(){return copy(t,sequential())},initInterpolator.apply(t,arguments)}function sequentialLog(){var t=loggish(transformer$1()).domain([1,10]);return t.copy=function(){return copy(t,sequentialLog()).base(t.base())},initInterpolator.apply(t,arguments)}function sequentialSymlog(){var t=symlogish(transformer$1());return t.copy=function(){return copy(t,sequentialSymlog()).constant(t.constant())},initInterpolator.apply(t,arguments)}function sequentialPow(){var t=powish(transformer$1());return t.copy=function(){return copy(t,sequentialPow()).exponent(t.exponent())},initInterpolator.apply(t,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function sequentialQuantile(){var t=[],e=identity$4;function n(n){if(!isNaN(n=+n))return e((bisectRight(t,n)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var r,i=0,o=e.length;i<o;++i)null==(r=e[i])||isNaN(r=+r)||t.push(r);return t.sort(ascending$3),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return sequentialQuantile(e).domain(t)},initInterpolator.apply(n,arguments)}function transformer(){var t,e,n,r,i,o,s,a=0,l=.5,c=1,u=identity$4,h=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+o(t))-e)*(t<e?r:i),u(h?Math.max(0,Math.min(1,t)):t))}return d.domain=function(s){return arguments.length?(t=o(a=+s[0]),e=o(l=+s[1]),n=o(c=+s[2]),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),d):[a,l,c]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(u=t,d):u},d.unknown=function(t){return arguments.length?(s=t,d):s},function(s){return o=s,t=s(a),e=s(l),n=s(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),d}}function diverging$1(){var t=linearish(transformer()(identity$4));return t.copy=function(){return copy(t,diverging$1())},initInterpolator.apply(t,arguments)}function divergingLog(){var t=loggish(transformer()).domain([.1,1,10]);return t.copy=function(){return copy(t,divergingLog()).base(t.base())},initInterpolator.apply(t,arguments)}function divergingSymlog(){var t=symlogish(transformer());return t.copy=function(){return copy(t,divergingSymlog()).constant(t.constant())},initInterpolator.apply(t,arguments)}function divergingPow(){var t=powish(transformer());return t.copy=function(){return copy(t,divergingPow()).exponent(t.exponent())},initInterpolator.apply(t,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}function colors(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}const category10=colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Accent=colors("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Dark2=colors("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Paired=colors("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Pastel1=colors("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Pastel2=colors("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Set1=colors("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Set2=colors("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Set3=colors("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Tableau10=colors("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function ramp$1(t){return rgbBasis(t[t.length-1])}var scheme$q=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(colors);const BrBG=ramp$1(scheme$q);var scheme$p=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(colors);const PRGn=ramp$1(scheme$p);var scheme$o=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(colors);const PiYG=ramp$1(scheme$o);var scheme$n=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(colors);const PuOr=ramp$1(scheme$n);var scheme$m=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(colors);const RdBu=ramp$1(scheme$m);var scheme$l=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(colors);const RdGy=ramp$1(scheme$l);var scheme$k=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(colors);const RdYlBu=ramp$1(scheme$k);var scheme$j=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(colors);const RdYlGn=ramp$1(scheme$j);var scheme$i=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(colors);const Spectral=ramp$1(scheme$i);var scheme$h=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(colors);const BuGn=ramp$1(scheme$h);var scheme$g=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(colors);const BuPu=ramp$1(scheme$g);var scheme$f=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(colors);const GnBu=ramp$1(scheme$f);var scheme$e=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(colors);const OrRd=ramp$1(scheme$e);var scheme$d=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(colors);const PuBuGn=ramp$1(scheme$d);var scheme$c=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(colors);const PuBu=ramp$1(scheme$c);var scheme$b=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(colors);const PuRd=ramp$1(scheme$b);var scheme$a=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(colors);const RdPu=ramp$1(scheme$a);var scheme$9=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(colors);const YlGnBu=ramp$1(scheme$9);var scheme$8=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(colors);const YlGn=ramp$1(scheme$8);var scheme$7=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(colors);const YlOrBr=ramp$1(scheme$7);var scheme$6=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(colors);const YlOrRd=ramp$1(scheme$6);var scheme$5=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(colors);const Blues=ramp$1(scheme$5);var scheme$4=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(colors);const Greens=ramp$1(scheme$4);var scheme$3=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(colors);const Greys=ramp$1(scheme$3);var scheme$2=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(colors);const Purples=ramp$1(scheme$2);var scheme$1=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(colors);const Reds=ramp$1(scheme$1);var scheme=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(colors);const Oranges=ramp$1(scheme);function cividis(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"}const cubehelix=cubehelixLong(cubehelix$3(300,.5,0),cubehelix$3(-240,.5,1));var warm=cubehelixLong(cubehelix$3(-100,.75,.35),cubehelix$3(80,1.5,.8)),cool=cubehelixLong(cubehelix$3(260,.75,.35),cubehelix$3(80,1.5,.8)),c$2=cubehelix$3();function rainbow(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return c$2.h=360*t-100,c$2.s=1.5-1.5*e,c$2.l=.8-.9*e,c$2+""}var c$1=rgb(),pi_1_3=Math.PI/3,pi_2_3=2*Math.PI/3;function sinebow(t){var e;return t=(.5-t)*Math.PI,c$1.r=255*(e=Math.sin(t))*e,c$1.g=255*(e=Math.sin(t+pi_1_3))*e,c$1.b=255*(e=Math.sin(t+pi_2_3))*e,c$1+""}function turbo(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function ramp(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const viridis=ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var magma=ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),inferno=ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),plasma=ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function constant$3(t){return function(){return t}}var abs$1=Math.abs,atan2=Math.atan2,cos=Math.cos,max$1=Math.max,min$1=Math.min,sin=Math.sin,sqrt=Math.sqrt,epsilon$1=1e-12,pi=Math.PI,halfPi=pi/2,tau=2*pi;function acos(t){return t>1?0:t<-1?pi:Math.acos(t)}function asin(t){return t>=1?halfPi:t<=-1?-halfPi:Math.asin(t)}function arcInnerRadius(t){return t.innerRadius}function arcOuterRadius(t){return t.outerRadius}function arcStartAngle(t){return t.startAngle}function arcEndAngle(t){return t.endAngle}function arcPadAngle(t){return t&&t.padAngle}function intersect(t,e,n,r,i,o,s,a){var l=n-t,c=r-e,u=s-i,h=a-o,d=h*l-u*c;if(!(d*d<epsilon$1))return[t+(d=(u*(e-o)-h*(t-i))/d)*l,e+d*c]}function cornerTangents(t,e,n,r,i,o,s){var a=t-n,l=e-r,c=(s?o:-o)/sqrt(a*a+l*l),u=c*l,h=-c*a,d=t+u,f=e+h,p=n+u,g=r+h,m=(d+p)/2,A=(f+g)/2,y=p-d,v=g-f,b=y*y+v*v,x=i-o,w=d*g-p*f,C=(v<0?-1:1)*sqrt(max$1(0,x*x*b-w*w)),$=(w*v-y*C)/b,_=(-w*y-v*C)/b,P=(w*v+y*C)/b,S=(-w*y+v*C)/b,M=$-m,E=_-A,T=P-m,k=S-A;return M*M+E*E>T*T+k*k&&($=P,_=S),{cx:$,cy:_,x01:-u,y01:-h,x11:$*(i/x-1),y11:_*(i/x-1)}}function arc(){var t=arcInnerRadius,e=arcOuterRadius,n=constant$3(0),r=null,i=arcStartAngle,o=arcEndAngle,s=arcPadAngle,a=null;function l(){var l,c,u=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-halfPi,f=o.apply(this,arguments)-halfPi,p=abs$1(f-d),g=f>d;if(a||(a=l=path$4()),h<u&&(c=h,h=u,u=c),h>epsilon$1)if(p>tau-epsilon$1)a.moveTo(h*cos(d),h*sin(d)),a.arc(0,0,h,d,f,!g),u>epsilon$1&&(a.moveTo(u*cos(f),u*sin(f)),a.arc(0,0,u,f,d,g));else{var m,A,y=d,v=f,b=d,x=f,w=p,C=p,$=s.apply(this,arguments)/2,_=$>epsilon$1&&(r?+r.apply(this,arguments):sqrt(u*u+h*h)),P=min$1(abs$1(h-u)/2,+n.apply(this,arguments)),S=P,M=P;if(_>epsilon$1){var E=asin(_/u*sin($)),T=asin(_/h*sin($));(w-=2*E)>epsilon$1?(b+=E*=g?1:-1,x-=E):(w=0,b=x=(d+f)/2),(C-=2*T)>epsilon$1?(y+=T*=g?1:-1,v-=T):(C=0,y=v=(d+f)/2)}var k=h*cos(y),O=h*sin(y),N=u*cos(x),R=u*sin(x);if(P>epsilon$1){var L,D=h*cos(v),j=h*sin(v),I=u*cos(b),F=u*sin(b);if(p<pi&&(L=intersect(k,O,I,F,D,j,N,R))){var B=k-L[0],z=O-L[1],G=D-L[0],V=j-L[1],W=1/sin(acos((B*G+z*V)/(sqrt(B*B+z*z)*sqrt(G*G+V*V)))/2),H=sqrt(L[0]*L[0]+L[1]*L[1]);S=min$1(P,(u-H)/(W-1)),M=min$1(P,(h-H)/(W+1))}}C>epsilon$1?M>epsilon$1?(m=cornerTangents(I,F,k,O,h,M,g),A=cornerTangents(D,j,N,R,h,M,g),a.moveTo(m.cx+m.x01,m.cy+m.y01),M<P?a.arc(m.cx,m.cy,M,atan2(m.y01,m.x01),atan2(A.y01,A.x01),!g):(a.arc(m.cx,m.cy,M,atan2(m.y01,m.x01),atan2(m.y11,m.x11),!g),a.arc(0,0,h,atan2(m.cy+m.y11,m.cx+m.x11),atan2(A.cy+A.y11,A.cx+A.x11),!g),a.arc(A.cx,A.cy,M,atan2(A.y11,A.x11),atan2(A.y01,A.x01),!g))):(a.moveTo(k,O),a.arc(0,0,h,y,v,!g)):a.moveTo(k,O),u>epsilon$1&&w>epsilon$1?S>epsilon$1?(m=cornerTangents(N,R,D,j,u,-S,g),A=cornerTangents(k,O,I,F,u,-S,g),a.lineTo(m.cx+m.x01,m.cy+m.y01),S<P?a.arc(m.cx,m.cy,S,atan2(m.y01,m.x01),atan2(A.y01,A.x01),!g):(a.arc(m.cx,m.cy,S,atan2(m.y01,m.x01),atan2(m.y11,m.x11),!g),a.arc(0,0,u,atan2(m.cy+m.y11,m.cx+m.x11),atan2(A.cy+A.y11,A.cx+A.x11),g),a.arc(A.cx,A.cy,S,atan2(A.y11,A.x11),atan2(A.y01,A.x01),!g))):a.arc(0,0,u,x,b,g):a.lineTo(N,R)}else a.moveTo(0,0);if(a.closePath(),l)return a=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-pi/2;return[cos(r)*n,sin(r)*n]},l.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:constant$3(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:constant$3(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:constant$3(+t),l):n},l.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:constant$3(+t),l):r},l.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:constant$3(+t),l):i},l.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:constant$3(+t),l):o},l.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:constant$3(+t),l):s},l.context=function(t){return arguments.length?(a=null==t?null:t,l):a},l}function Linear(t){this._context=t}function curveLinear(t){return new Linear(t)}function x$1(t){return t[0]}function y$1(t){return t[1]}function line$2(){var t=x$1,e=y$1,n=constant$3(!0),r=null,i=curveLinear,o=null;function s(s){var a,l,c,u=s.length,h=!1;for(null==r&&(o=i(c=path$4())),a=0;a<=u;++a)!(a<u&&n(l=s[a],a,s))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(l,a,s),+e(l,a,s));if(c)return o=null,c+""||null}return s.x=function(e){return arguments.length?(t="function"==typeof e?e:constant$3(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:constant$3(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:constant$3(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}function area(){var t=x$1,e=null,n=constant$3(0),r=y$1,i=constant$3(!0),o=null,s=curveLinear,a=null;function l(l){var c,u,h,d,f,p=l.length,g=!1,m=new Array(p),A=new Array(p);for(null==o&&(a=s(f=path$4())),c=0;c<=p;++c){if(!(c<p&&i(d=l[c],c,l))===g)if(g=!g)u=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=c-1;h>=u;--h)a.point(m[h],A[h]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+t(d,c,l),A[c]=+n(d,c,l),a.point(e?+e(d,c,l):m[c],r?+r(d,c,l):A[c]))}if(f)return a=null,f+""||null}function c(){return line$2().defined(i).curve(s).context(o)}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:constant$3(+n),e=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:constant$3(+e),l):t},l.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:constant$3(+t),l):e},l.y=function(t){return arguments.length?(n="function"==typeof t?t:constant$3(+t),r=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:constant$3(+t),l):n},l.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:constant$3(+t),l):r},l.lineX0=l.lineY0=function(){return c().x(t).y(n)},l.lineY1=function(){return c().x(t).y(r)},l.lineX1=function(){return c().x(e).y(n)},l.defined=function(t){return arguments.length?(i="function"==typeof t?t:constant$3(!!t),l):i},l.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),l):s},l.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),l):o},l}function descending$1(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function identity$2(t){return t}function pie(){var t=identity$2,e=descending$1,n=null,r=constant$3(0),i=constant$3(tau),o=constant$3(0);function s(s){var a,l,c,u,h,d=s.length,f=0,p=new Array(d),g=new Array(d),m=+r.apply(this,arguments),A=Math.min(tau,Math.max(-tau,i.apply(this,arguments)-m)),y=Math.min(Math.abs(A)/d,o.apply(this,arguments)),v=y*(A<0?-1:1);for(a=0;a<d;++a)(h=g[p[a]=a]=+t(s[a],a,s))>0&&(f+=h);for(null!=e?p.sort((function(t,n){return e(g[t],g[n])})):null!=n&&p.sort((function(t,e){return n(s[t],s[e])})),a=0,c=f?(A-d*v)/f:0;a<d;++a,m=u)g[l=p[a]]={data:s[l],index:a,value:h=g[l],startAngle:m,endAngle:u=m+(h>0?h*c:0)+v,padAngle:y};return g}return s.value=function(e){return arguments.length?(t="function"==typeof e?e:constant$3(+e),s):t},s.sortValues=function(t){return arguments.length?(e=t,n=null,s):e},s.sort=function(t){return arguments.length?(n=t,e=null,s):n},s.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:constant$3(+t),s):r},s.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:constant$3(+t),s):i},s.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:constant$3(+t),s):o},s}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var curveRadialLinear=curveRadial$1(curveLinear);function Radial(t){this._curve=t}function curveRadial$1(t){function e(e){return new Radial(t(e))}return e._curve=t,e}function lineRadial(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(curveRadial$1(t)):e()._curve},t}function lineRadial$1(){return lineRadial(line$2().curve(curveRadialLinear))}function areaRadial(){var t=area().curve(curveRadialLinear),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return lineRadial(n())},delete t.lineX0,t.lineEndAngle=function(){return lineRadial(r())},delete t.lineX1,t.lineInnerRadius=function(){return lineRadial(i())},delete t.lineY0,t.lineOuterRadius=function(){return lineRadial(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(curveRadial$1(t)):e()._curve},t}function pointRadial(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}Radial.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var slice$1=Array.prototype.slice;function linkSource(t){return t.source}function linkTarget(t){return t.target}function link(t){var e=linkSource,n=linkTarget,r=x$1,i=y$1,o=null;function s(){var s,a=slice$1.call(arguments),l=e.apply(this,a),c=n.apply(this,a);if(o||(o=s=path$4()),t(o,+r.apply(this,(a[0]=l,a)),+i.apply(this,a),+r.apply(this,(a[0]=c,a)),+i.apply(this,a)),s)return o=null,s+""||null}return s.source=function(t){return arguments.length?(e=t,s):e},s.target=function(t){return arguments.length?(n=t,s):n},s.x=function(t){return arguments.length?(r="function"==typeof t?t:constant$3(+t),s):r},s.y=function(t){return arguments.length?(i="function"==typeof t?t:constant$3(+t),s):i},s.context=function(t){return arguments.length?(o=null==t?null:t,s):o},s}function curveHorizontal(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function curveVertical(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function curveRadial(t,e,n,r,i){var o=pointRadial(e,n),s=pointRadial(e,n=(n+i)/2),a=pointRadial(r,n),l=pointRadial(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(s[0],s[1],a[0],a[1],l[0],l[1])}function linkHorizontal(){return link(curveHorizontal)}function linkVertical(){return link(curveVertical)}function linkRadial(){var t=link(curveRadial);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}const circle$2={draw:function(t,e){var n=Math.sqrt(e/pi);t.moveTo(n,0),t.arc(0,0,n,0,tau)}},cross$1={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}};var tan30=Math.sqrt(1/3),tan30_2=2*tan30;const diamond$2={draw:function(t,e){var n=Math.sqrt(e/tan30_2),r=n*tan30;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}};var ka=.8908130915292852,kr=Math.sin(pi/10)/Math.sin(7*pi/10),kx=Math.sin(tau/10)*kr,ky=-Math.cos(tau/10)*kr;const star={draw:function(t,e){var n=Math.sqrt(e*ka),r=kx*n,i=ky*n;t.moveTo(0,-n),t.lineTo(r,i);for(var o=1;o<5;++o){var s=tau*o/5,a=Math.cos(s),l=Math.sin(s);t.lineTo(l*n,-a*n),t.lineTo(a*r-l*i,l*r+a*i)}t.closePath()}},square={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}};var sqrt3=Math.sqrt(3);const triangle={draw:function(t,e){var n=-Math.sqrt(e/(3*sqrt3));t.moveTo(0,2*n),t.lineTo(-sqrt3*n,-n),t.lineTo(sqrt3*n,-n),t.closePath()}};var c=-.5,s=Math.sqrt(3)/2,k=1/Math.sqrt(12),a=3*(k/2+1);const wye={draw:function(t,e){var n=Math.sqrt(e/a),r=n/2,i=n*k,o=r,l=n*k+n,u=-o,h=l;t.moveTo(r,i),t.lineTo(o,l),t.lineTo(u,h),t.lineTo(c*r-s*i,s*r+c*i),t.lineTo(c*o-s*l,s*o+c*l),t.lineTo(c*u-s*h,s*u+c*h),t.lineTo(c*r+s*i,c*i-s*r),t.lineTo(c*o+s*l,c*l-s*o),t.lineTo(c*u+s*h,c*h-s*u),t.closePath()}};var symbols=[circle$2,cross$1,diamond$2,square,star,triangle,wye];function symbol(){var t=constant$3(circle$2),e=constant$3(64),n=null;function r(){var r;if(n||(n=r=path$4()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:constant$3(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:constant$3(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}function noop$2(){}function point$4(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Basis(t){this._context=t}function basis(t){return new Basis(t)}function BasisClosed(t){this._context=t}function basisClosed(t){return new BasisClosed(t)}function BasisOpen(t){this._context=t}function basisOpen(t){return new BasisOpen(t)}function Bundle(t,e){this._basis=new Basis(t),this._beta=e}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$4(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$4(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},BasisClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:point$4(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:point$4(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],s=t[n]-i,a=e[n]-o,l=-1;++l<=n;)this._basis.point(this._beta*t[l]+(1-this._beta)*(i+(r=l/n)*s),this._beta*e[l]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const bundle=function t(e){function n(t){return 1===e?new Basis(t):new Bundle(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function point$3(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Cardinal(t,e){this._context=t,this._k=(1-e)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$3(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:point$3(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cardinal=function t(e){function n(t){return new Cardinal(t,e)}return n.tension=function(e){return t(+e)},n}(0);function CardinalClosed(t,e){this._context=t,this._k=(1-e)/6}CardinalClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:point$3(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cardinalClosed=function t(e){function n(t){return new CardinalClosed(t,e)}return n.tension=function(e){return t(+e)},n}(0);function CardinalOpen(t,e){this._context=t,this._k=(1-e)/6}CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$3(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cardinalOpen=function t(e){function n(t){return new CardinalOpen(t,e)}return n.tension=function(e){return t(+e)},n}(0);function point$2(t,e,n){var r=t._x1,i=t._y1,o=t._x2,s=t._y2;if(t._l01_a>epsilon$1){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>epsilon$1){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/u,s=(s*c+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(r,i,o,s,t._x2,t._y2)}function CatmullRom(t,e){this._context=t,this._alpha=e}CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:point$2(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const catmullRom=function t(e){function n(t){return e?new CatmullRom(t,e):new Cardinal(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function CatmullRomClosed(t,e){this._context=t,this._alpha=e}CatmullRomClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:point$2(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const catmullRomClosed=function t(e){function n(t){return e?new CatmullRomClosed(t,e):new CardinalClosed(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function CatmullRomOpen(t,e){this._context=t,this._alpha=e}CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$2(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const catmullRomOpen=function t(e){function n(t){return e?new CatmullRomOpen(t,e):new CardinalOpen(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function LinearClosed(t){this._context=t}function linearClosed(t){return new LinearClosed(t)}function sign(t){return t<0?-1:1}function slope3(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),s=(n-t._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(sign(o)+sign(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function slope2(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function point$1(t,e,n){var r=t._x0,i=t._x1,o=t._y1,s=(i-r)/3;t._context.bezierCurveTo(r+s,t._y0+s*e,i-s,o-s*n,i,o)}function MonotoneX(t){this._context=t}function MonotoneY(t){this._context=new ReflectContext(t)}function ReflectContext(t){this._context=t}function monotoneX(t){return new MonotoneX(t)}function monotoneY(t){return new MonotoneY(t)}function Natural(t){this._context=t}function controlPoints(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)o[e]-=n=i[e]/o[e-1],s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function natural(t){return new Natural(t)}function Step(t,e){this._context=t,this._t=e}function step(t){return new Step(t,.5)}function stepBefore(t){return new Step(t,0)}function stepAfter(t){return new Step(t,1)}function none$1(t,e){if((i=t.length)>1)for(var n,r,i,o=1,s=t[e[0]],a=s.length;o<i;++o)for(r=s,s=t[e[o]],n=0;n<a;++n)s[n][1]+=s[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function none(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function stackValue(t,e){return t[e]}function stack(){var t=constant$3([]),e=none,n=none$1,r=stackValue;function i(i){var o,s,a=t.apply(this,arguments),l=i.length,c=a.length,u=new Array(c);for(o=0;o<c;++o){for(var h,d=a[o],f=u[o]=new Array(l),p=0;p<l;++p)f[p]=h=[0,+r(i[p],d,p,i)],h.data=i[p];f.key=d}for(o=0,s=e(u);o<c;++o)u[s[o]].index=o;return n(u,s),u}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:constant$3(slice$1.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:constant$3(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?none:"function"==typeof t?t:constant$3(slice$1.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?none$1:t,i):n},i}function expand(t,e){if((r=t.length)>0){for(var n,r,i,o=0,s=t[0].length;o<s;++o){for(i=n=0;n<r;++n)i+=t[n][o][1]||0;if(i)for(n=0;n<r;++n)t[n][o][1]/=i}none$1(t,e)}}function diverging(t,e){if((a=t.length)>0)for(var n,r,i,o,s,a,l=0,c=t[e[0]].length;l<c;++l)for(o=s=0,n=0;n<a;++n)(i=(r=t[e[n]][l])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=s,r[0]=s+=i):(r[0]=0,r[1]=i)}function silhouette(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],o=i.length;r<o;++r){for(var s=0,a=0;s<n;++s)a+=t[s][r][1]||0;i[r][1]+=i[r][0]=-a/2}none$1(t,e)}}function wiggle(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,o=0,s=1;s<r;++s){for(var a=0,l=0,c=0;a<i;++a){for(var u=t[e[a]],h=u[s][1]||0,d=(h-(u[s-1][1]||0))/2,f=0;f<a;++f){var p=t[e[f]];d+=(p[s][1]||0)-(p[s-1][1]||0)}l+=h,c+=d*h}n[s-1][1]+=n[s-1][0]=o,l&&(o-=c/l)}n[s-1][1]+=n[s-1][0]=o,none$1(t,e)}}function appearance(t){var e=t.map(peak);return none(t).sort((function(t,n){return e[t]-e[n]}))}function peak(t){for(var e,n=-1,r=0,i=t.length,o=-1/0;++n<i;)(e=+t[n][1])>o&&(o=e,r=n);return r}function ascending(t){var e=t.map(sum$1);return none(t).sort((function(t,n){return e[t]-e[n]}))}function sum$1(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}function descending(t){return ascending(t).reverse()}function insideOut(t){var e,n,r=t.length,i=t.map(sum$1),o=appearance(t),s=0,a=0,l=[],c=[];for(e=0;e<r;++e)n=o[e],s<a?(s+=i[n],l.push(n)):(a+=i[n],c.push(n));return c.reverse().concat(l)}function reverse$1(t){return none(t).reverse()}function constant$2(t){return function(){return t}}function x(t){return t[0]}function y(t){return t[1]}function RedBlackTree(){this._=null}function RedBlackNode(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function RedBlackRotateLeft(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function RedBlackRotateRight(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function RedBlackFirst(t){for(;t.L;)t=t.L;return t}function createEdge(t,e,n,r){var i=[null,null],o=edges.push(i)-1;return i.left=t,i.right=e,n&&setEdgeEnd(i,t,e,n),r&&setEdgeEnd(i,e,t,r),cells[t.index].halfedges.push(o),cells[e.index].halfedges.push(o),i}function createBorderEdge(t,e,n){var r=[e,n];return r.left=t,r}function setEdgeEnd(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function clipEdge(t,e,n,r,i){var o,s=t[0],a=t[1],l=s[0],c=s[1],u=0,h=1,d=a[0]-l,f=a[1]-c;if(o=e-l,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>u&&(u=o)}if(o=r-l,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<h&&(h=o)}if(o=n-c,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>u&&(u=o)}if(o=i-c,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<h&&(h=o)}return!(u>0||h<1)||(u>0&&(t[0]=[l+u*d,c+u*f]),h<1&&(t[1]=[l+h*d,c+h*f]),!0)}}}}}function connectEdge(t,e,n,r,i){var o=t[1];if(o)return!0;var s,a,l=t[0],c=t.left,u=t.right,h=c[0],d=c[1],f=u[0],p=u[1],g=(h+f)/2;if(p===d){if(g<e||g>=r)return;if(h>f){if(l){if(l[1]>=i)return}else l=[g,n];o=[g,i]}else{if(l){if(l[1]<n)return}else l=[g,i];o=[g,n]}}else if(a=(d+p)/2-(s=(h-f)/(p-d))*g,s<-1||s>1)if(h>f){if(l){if(l[1]>=i)return}else l=[(n-a)/s,n];o=[(i-a)/s,i]}else{if(l){if(l[1]<n)return}else l=[(i-a)/s,i];o=[(n-a)/s,n]}else if(d<p){if(l){if(l[0]>=r)return}else l=[e,s*e+a];o=[r,s*r+a]}else{if(l){if(l[0]<e)return}else l=[r,s*r+a];o=[e,s*e+a]}return t[0]=l,t[1]=o,!0}function clipEdges(t,e,n,r){for(var i,o=edges.length;o--;)connectEdge(i=edges[o],t,e,n,r)&&clipEdge(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>epsilon||Math.abs(i[0][1]-i[1][1])>epsilon)||delete edges[o]}function createCell(t){return cells[t.index]={site:t,halfedges:[]}}function cellHalfedgeAngle(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function cellHalfedgeStart(t,e){return e[+(e.left!==t.site)]}function cellHalfedgeEnd(t,e){return e[+(e.left===t.site)]}function sortCellHalfedges(){for(var t,e,n,r,i=0,o=cells.length;i<o;++i)if((t=cells[i])&&(r=(e=t.halfedges).length)){var s=new Array(r),a=new Array(r);for(n=0;n<r;++n)s[n]=n,a[n]=cellHalfedgeAngle(t,edges[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<r;++n)a[n]=e[s[n]];for(n=0;n<r;++n)e[n]=a[n]}}function clipCells(t,e,n,r){var i,o,s,a,l,c,u,h,d,f,p,g,m=cells.length,A=!0;for(i=0;i<m;++i)if(o=cells[i]){for(s=o.site,a=(l=o.halfedges).length;a--;)edges[l[a]]||l.splice(a,1);for(a=0,c=l.length;a<c;)p=(f=cellHalfedgeEnd(o,edges[l[a]]))[0],g=f[1],h=(u=cellHalfedgeStart(o,edges[l[++a%c]]))[0],d=u[1],(Math.abs(p-h)>epsilon||Math.abs(g-d)>epsilon)&&(l.splice(a,0,edges.push(createBorderEdge(s,f,Math.abs(p-t)<epsilon&&r-g>epsilon?[t,Math.abs(h-t)<epsilon?d:r]:Math.abs(g-r)<epsilon&&n-p>epsilon?[Math.abs(d-r)<epsilon?h:n,r]:Math.abs(p-n)<epsilon&&g-e>epsilon?[n,Math.abs(h-n)<epsilon?d:e]:Math.abs(g-e)<epsilon&&p-t>epsilon?[Math.abs(d-e)<epsilon?h:t,e]:null))-1),++c);c&&(A=!1)}if(A){var y,v,b,x=1/0;for(i=0,A=null;i<m;++i)(o=cells[i])&&(b=(y=(s=o.site)[0]-t)*y+(v=s[1]-e)*v)<x&&(x=b,A=o);if(A){var w=[t,e],C=[t,r],$=[n,r],_=[n,e];A.halfedges.push(edges.push(createBorderEdge(s=A.site,w,C))-1,edges.push(createBorderEdge(s,C,$))-1,edges.push(createBorderEdge(s,$,_))-1,edges.push(createBorderEdge(s,_,w))-1)}}for(i=0;i<m;++i)(o=cells[i])&&(o.halfedges.length||delete cells[i])}LinearClosed.prototype={areaStart:noop$2,areaEnd:noop$2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$1(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,point$1(this,slope2(this,n=slope3(this,t,e)),n);break;default:point$1(this,this._t0,n=slope3(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(t,e){MonotoneX.prototype.point.call(this,e,t)},ReflectContext.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=controlPoints(t),i=controlPoints(e),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}},RedBlackTree.prototype={constructor:RedBlackTree,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=RedBlackFirst(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(RedBlackRotateLeft(this,n),n=(t=n).U),n.C=!1,r.C=!0,RedBlackRotateRight(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(RedBlackRotateRight(this,n),n=(t=n).U),n.C=!1,r.C=!0,RedBlackRotateLeft(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,s=t.R;if(n=o?s?RedBlackFirst(s):o:s,i?i.L===t?i.L=n:i.R=n:this._=n,o&&s?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(i=n.U,n.U=t.U,i.L=t=n.R,n.R=s,s.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,RedBlackRotateLeft(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,RedBlackRotateRight(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,RedBlackRotateLeft(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,RedBlackRotateRight(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,RedBlackRotateLeft(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,RedBlackRotateRight(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var circlePool=[],firstCircle;function Circle(){RedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null}function attachCircle(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var s=i[0],a=i[1],l=r[0]-s,c=r[1]-a,u=o[0]-s,h=o[1]-a,d=2*(l*h-c*u);if(!(d>=-epsilon2)){var f=l*l+c*c,p=u*u+h*h,g=(h*f-c*p)/d,m=(l*p-u*f)/d,A=circlePool.pop()||new Circle;A.arc=t,A.site=i,A.x=g+s,A.y=(A.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=A;for(var y=null,v=circles._;v;)if(A.y<v.y||A.y===v.y&&A.x<=v.x){if(!v.L){y=v.P;break}v=v.L}else{if(!v.R){y=v;break}v=v.R}circles.insert(y,A),y||(firstCircle=A)}}}}function detachCircle(t){var e=t.circle;e&&(e.P||(firstCircle=e.N),circles.remove(e),circlePool.push(e),RedBlackNode(e),t.circle=null)}var beachPool=[];function Beach(){RedBlackNode(this),this.edge=this.site=this.circle=null}function createBeach(t){var e=beachPool.pop()||new Beach;return e.site=t,e}function detachBeach(t){detachCircle(t),beaches.remove(t),beachPool.push(t),RedBlackNode(t)}function removeBeach(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,s=t.N,a=[t];detachBeach(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<epsilon&&Math.abs(r-l.circle.cy)<epsilon;)o=l.P,a.unshift(l),detachBeach(l),l=o;a.unshift(l),detachCircle(l);for(var c=s;c.circle&&Math.abs(n-c.circle.x)<epsilon&&Math.abs(r-c.circle.cy)<epsilon;)s=c.N,a.push(c),detachBeach(c),c=s;a.push(c),detachCircle(c);var u,h=a.length;for(u=1;u<h;++u)setEdgeEnd((c=a[u]).edge,(l=a[u-1]).site,c.site,i);(c=a[h-1]).edge=createEdge((l=a[0]).site,c.site,null,i),attachCircle(l),attachCircle(c)}function addBeach(t){for(var e,n,r,i,o=t[0],s=t[1],a=beaches._;a;)if((r=leftBreakPoint(a,s)-o)>epsilon)a=a.L;else{if(!((i=o-rightBreakPoint(a,s))>epsilon)){r>-epsilon?(e=a.P,n=a):i>-epsilon?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}createCell(t);var l=createBeach(t);if(beaches.insert(e,l),e||n){if(e===n)return detachCircle(e),n=createBeach(e.site),beaches.insert(l,n),l.edge=n.edge=createEdge(e.site,l.site),attachCircle(e),void attachCircle(n);if(n){detachCircle(e),detachCircle(n);var c=e.site,u=c[0],h=c[1],d=t[0]-u,f=t[1]-h,p=n.site,g=p[0]-u,m=p[1]-h,A=2*(d*m-f*g),y=d*d+f*f,v=g*g+m*m,b=[(m*y-f*v)/A+u,(d*v-g*y)/A+h];setEdgeEnd(n.edge,c,p,b),l.edge=createEdge(c,t,null,b),n.edge=createEdge(t,p,null,b),attachCircle(e),attachCircle(n)}else l.edge=createEdge(e.site,l.site)}}function leftBreakPoint(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],c=l-e;if(!c)return a;var u=a-r,h=1/o-1/c,d=u/c;return h?(-d+Math.sqrt(d*d-2*h*(u*u/(-2*c)-l+c/2+i-o/2)))/h+r:(r+a)/2}function rightBreakPoint(t,e){var n=t.N;if(n)return leftBreakPoint(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var epsilon=1e-6,epsilon2=1e-12,beaches,cells,circles,edges;function triangleArea(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function lexicographic(t,e){return e[1]-t[1]||e[0]-t[0]}function Diagram(t,e){var n,r,i,o=t.sort(lexicographic).pop();for(edges=[],cells=new Array(t.length),beaches=new RedBlackTree,circles=new RedBlackTree;;)if(i=firstCircle,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(addBeach(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;removeBeach(i.arc)}if(sortCellHalfedges(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],c=+e[1][1];clipEdges(s,a,l,c),clipCells(s,a,l,c)}this.edges=edges,this.cells=cells,beaches=circles=edges=cells=null}function voronoi(){var t=x,e=y,n=null;function r(r){return new Diagram(r.map((function(n,i){var o=[Math.round(t(n,i,r)/epsilon)*epsilon,Math.round(e(n,i,r)/epsilon)*epsilon];return o.index=i,o.data=n,o})),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:constant$2(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:constant$2(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}function constant$1(t){return function(){return t}}function ZoomEvent(t,e,n){this.target=t,this.type=e,this.transform=n}function Transform$1(t,e,n){this.k=t,this.x=e,this.y=n}Diagram.prototype={constructor:Diagram,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return cellHalfedgeStart(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(o=(i=n.halfedges).length)for(var i,o,s,a=n.site,l=-1,c=e[i[o-1]],u=c.left===a?c.right:c.left;++l<o;)s=u,u=(c=e[i[l]]).left===a?c.right:c.left,s&&u&&r<s.index&&r<u.index&&triangleArea(a,s,u)<0&&t.push([a.data,s.data,u.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,o=this,s=o._found||0,a=o.cells.length;!(i=o.cells[s]);)if(++s>=a)return null;var l=t-i.site[0],c=e-i.site[1],u=l*l+c*c;do{i=o.cells[r=s],s=null,i.halfedges.forEach((function(n){var r=o.edges[n],a=r.left;if(a!==i.site&&a||(a=r.right)){var l=t-a[0],c=e-a[1],h=l*l+c*c;h<u&&(u=h,s=a.index)}}))}while(null!==s);return o._found=r,null==n||u<=n*n?i.site:null}},Transform$1.prototype={constructor:Transform$1,scale:function(t){return 1===t?this:new Transform$1(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Transform$1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity$1=new Transform$1(1,0,0);function transform$2(t){for(;!t.__zoom;)if(!(t=t.parentNode))return identity$1;return t.__zoom}function nopropagation(){event.stopImmediatePropagation()}function noevent(){event.preventDefault(),event.stopImmediatePropagation()}function defaultFilter(){return!event.ctrlKey&&!event.button}function defaultExtent(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function defaultTransform(){return this.__zoom||identity$1}function defaultWheelDelta(){return-event.deltaY*(1===event.deltaMode?.05:event.deltaMode?1:.002)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function zoom(){var t,e,n=defaultFilter,r=defaultExtent,i=defaultConstrain,o=defaultWheelDelta,s=defaultTouchable,a=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,u=interpolateZoom,h=dispatch("start","zoom","end"),d=500,f=0;function p(t){t.property("__zoom",defaultTransform).on("wheel.zoom",x).on("mousedown.zoom",w).on("dblclick.zoom",C).filter(s).on("touchstart.zoom",$).on("touchmove.zoom",_).on("touchend.zoom touchcancel.zoom",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(a[0],Math.min(a[1],e)))===t.k?t:new Transform$1(e,t.x,t.y)}function m(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new Transform$1(t.k,r,i)}function A(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function y(t,e,n){t.on("start.zoom",(function(){v(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){v(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,o=v(t,i),s=r.apply(t,i),a=null==n?A(s):"function"==typeof n?n.apply(t,i):n,l=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,i):e,d=u(c.invert(a).concat(l/c.k),h.invert(a).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=d(t),n=l/e[2];t=new Transform$1(n,a[0]-e[0]*n,a[1]-e[1]*n)}o.zoom(null,t)}}))}function v(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.extent=r.apply(t,e),this.taps=0}function x(){if(n.apply(this,arguments)){var t=v(this,arguments),e=this.__zoom,r=Math.max(a[0],Math.min(a[1],e.k*Math.pow(2,o.apply(this,arguments)))),s=mouse(this);if(t.wheel)t.mouse[0][0]===s[0]&&t.mouse[0][1]===s[1]||(t.mouse[1]=e.invert(t.mouse[0]=s)),clearTimeout(t.wheel);else{if(e.k===r)return;t.mouse=[s,e.invert(s)],interrupt(this),t.start()}noevent(),t.wheel=setTimeout(c,150),t.zoom("mouse",i(m(g(e,r),t.mouse[0],t.mouse[1]),t.extent,l))}function c(){t.wheel=null,t.end()}}function w(){if(!e&&n.apply(this,arguments)){var t=v(this,arguments,!0),r=select(event.view).on("mousemove.zoom",c,!0).on("mouseup.zoom",u,!0),o=mouse(this),s=event.clientX,a=event.clientY;dragDisable(event.view),nopropagation(),t.mouse=[o,this.__zoom.invert(o)],interrupt(this),t.start()}function c(){if(noevent(),!t.moved){var e=event.clientX-s,n=event.clientY-a;t.moved=e*e+n*n>f}t.zoom("mouse",i(m(t.that.__zoom,t.mouse[0]=mouse(t.that),t.mouse[1]),t.extent,l))}function u(){r.on("mousemove.zoom mouseup.zoom",null),yesdrag(event.view,t.moved),noevent(),t.end()}}function C(){if(n.apply(this,arguments)){var t=this.__zoom,e=mouse(this),o=t.invert(e),s=t.k*(event.shiftKey?.5:2),a=i(m(g(t,s),e,o),r.apply(this,arguments),l);noevent(),c>0?select(this).transition().duration(c).call(y,a,e):select(this).call(p.transform,a)}}function $(){if(n.apply(this,arguments)){var e,r,i,o,s=event.touches,a=s.length,l=v(this,arguments,event.changedTouches.length===a);for(nopropagation(),r=0;r<a;++r)o=[o=touch(this,s,(i=s[r]).identifier),this.__zoom.invert(o),i.identifier],l.touch0?l.touch1||l.touch0[2]===o[2]||(l.touch1=o,l.taps=0):(l.touch0=o,e=!0,l.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(l.taps<2&&(t=setTimeout((function(){t=null}),d)),interrupt(this),l.start())}}function _(){if(this.__zooming){var e,n,r,o,s=v(this,arguments),a=event.changedTouches,c=a.length;for(noevent(),t&&(t=clearTimeout(t)),s.taps=0,e=0;e<c;++e)r=touch(this,a,(n=a[e]).identifier),s.touch0&&s.touch0[2]===n.identifier?s.touch0[0]=r:s.touch1&&s.touch1[2]===n.identifier&&(s.touch1[0]=r);if(n=s.that.__zoom,s.touch1){var u=s.touch0[0],h=s.touch0[1],d=s.touch1[0],f=s.touch1[1],p=(p=d[0]-u[0])*p+(p=d[1]-u[1])*p,A=(A=f[0]-h[0])*A+(A=f[1]-h[1])*A;n=g(n,Math.sqrt(p/A)),r=[(u[0]+d[0])/2,(u[1]+d[1])/2],o=[(h[0]+f[0])/2,(h[1]+f[1])/2]}else{if(!s.touch0)return;r=s.touch0[0],o=s.touch0[1]}s.zoom("touch",i(m(n,r,o),s.extent,l))}}function P(){if(this.__zooming){var t,n,r=v(this,arguments),i=event.changedTouches,o=i.length;for(nopropagation(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),d),t=0;t<o;++t)n=i[t],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var s=select(this).on("dblclick.zoom");s&&s.apply(this,arguments)}}}return p.transform=function(t,e,n){var r=t.selection?t.selection():t;r.property("__zoom",defaultTransform),t!==r?y(t,e,n):r.interrupt().each((function(){v(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},p.scaleBy=function(t,e,n){p.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},p.scaleTo=function(t,e,n){p.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,s=null==n?A(t):"function"==typeof n?n.apply(this,arguments):n,a=o.invert(s),c="function"==typeof e?e.apply(this,arguments):e;return i(m(g(o,c),s,a),t,l)}),n)},p.translateBy=function(t,e,n){p.transform(t,(function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),l)}))},p.translateTo=function(t,e,n,o){p.transform(t,(function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==o?A(t):"function"==typeof o?o.apply(this,arguments):o;return i(identity$1.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)}),o)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){customEvent(new ZoomEvent(p,t,this.that.__zoom),h.apply,h,[t,this.that,this.args])}},p.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:constant$1(+t),p):o},p.filter=function(t){return arguments.length?(n="function"==typeof t?t:constant$1(!!t),p):n},p.touchable=function(t){return arguments.length?(s="function"==typeof t?t:constant$1(!!t),p):s},p.extent=function(t){return arguments.length?(r="function"==typeof t?t:constant$1([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),p):r},p.scaleExtent=function(t){return arguments.length?(a[0]=+t[0],a[1]=+t[1],p):[a[0],a[1]]},p.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],p):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},p.constrain=function(t){return arguments.length?(i=t,p):i},p.duration=function(t){return arguments.length?(c=+t,p):c},p.interpolate=function(t){return arguments.length?(u=t,p):u},p.on=function(){var t=h.on.apply(h,arguments);return t===h?p:t},p.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,p):Math.sqrt(f)},p}transform$2.prototype=Transform$1.prototype;const d3$1=Object.freeze({__proto__:null,version:version$2,bisect:bisectRight,bisectRight,bisectLeft,ascending:ascending$3,bisector,cross:cross$3,descending:descending$2,deviation,extent:extent$1,histogram,thresholdFreedmanDiaconis:freedmanDiaconis,thresholdScott:scott,thresholdSturges,max:max$3,mean:mean$1,median,merge:merge$1,min:min$2,pairs,permute,quantile:threshold$1,range:sequence,scan,shuffle:shuffle$2,sum:sum$3,ticks,tickIncrement,tickStep,transpose,variance,zip:zip$1,axisTop,axisRight,axisBottom,axisLeft,brush,brushX,brushY,brushSelection,chord,ribbon,nest,set:set$1,map:map$3,keys:keys$1,values:values$1,entries,color,rgb,hsl:hsl$2,lab:lab$1,hcl:hcl$2,lch,gray,cubehelix:cubehelix$3,contours,contourDensity:density,dispatch,drag,dragDisable,dragEnable:yesdrag,dsvFormat,csvParse,csvParseRows,csvFormat,csvFormatBody,csvFormatRows,csvFormatRow,csvFormatValue,tsvParse,tsvParseRows,tsvFormat,tsvFormatBody,tsvFormatRows,tsvFormatRow,tsvFormatValue,autoType,easeLinear:linear$1,easeQuad:quadInOut,easeQuadIn:quadIn,easeQuadOut:quadOut,easeQuadInOut:quadInOut,easeCubic:cubicInOut,easeCubicIn:cubicIn,easeCubicOut:cubicOut,easeCubicInOut:cubicInOut,easePoly:polyInOut,easePolyIn:polyIn,easePolyOut:polyOut,easePolyInOut:polyInOut,easeSin:sinInOut,easeSinIn:sinIn,easeSinOut:sinOut,easeSinInOut:sinInOut,easeExp:expInOut,easeExpIn:expIn,easeExpOut:expOut,easeExpInOut:expInOut,easeCircle:circleInOut,easeCircleIn:circleIn,easeCircleOut:circleOut,easeCircleInOut:circleInOut,easeBounce:bounceOut,easeBounceIn:bounceIn,easeBounceOut:bounceOut,easeBounceInOut:bounceInOut,easeBack:backInOut,easeBackIn:backIn,easeBackOut:backOut,easeBackInOut:backInOut,easeElastic:elasticOut,easeElasticIn:elasticIn,easeElasticOut:elasticOut,easeElasticInOut:elasticInOut,blob,buffer,dsv,csv,tsv,image,json:json$1,text:text$3,xml,html:html$2,svg,forceCenter:center$1,forceCollide:collide,forceLink:link$2,forceManyBody:manyBody,forceRadial:radial$1,forceSimulation:simulation,forceX:x$2,forceY:y$2,formatDefaultLocale:defaultLocale$1,get format(){return format$1},get formatPrefix(){return formatPrefix},formatLocale:formatLocale$1,formatSpecifier,FormatSpecifier,precisionFixed,precisionPrefix,precisionRound,geoArea:area$2,geoBounds:bounds,geoCentroid:centroid$1,geoCircle:circle$4,geoClipAntimeridian:clipAntimeridian,geoClipCircle:clipCircle,geoClipExtent:extent,geoClipRectangle:clipRectangle,geoContains:contains$2,geoDistance:distance,geoGraticule:graticule,geoGraticule10:graticule10,geoInterpolate:interpolate,geoLength:length$2,geoPath:index$3,geoAlbers:albers,geoAlbersUsa:albersUsa,geoAzimuthalEqualArea:azimuthalEqualArea,geoAzimuthalEqualAreaRaw:azimuthalEqualAreaRaw,geoAzimuthalEquidistant:azimuthalEquidistant,geoAzimuthalEquidistantRaw:azimuthalEquidistantRaw,geoConicConformal:conicConformal,geoConicConformalRaw:conicConformalRaw,geoConicEqualArea:conicEqualArea,geoConicEqualAreaRaw:conicEqualAreaRaw,geoConicEquidistant:conicEquidistant,geoConicEquidistantRaw:conicEquidistantRaw,geoEqualEarth:equalEarth,geoEqualEarthRaw:equalEarthRaw,geoEquirectangular:equirectangular,geoEquirectangularRaw:equirectangularRaw,geoGnomonic:gnomonic,geoGnomonicRaw:gnomonicRaw,geoIdentity:identity$5,geoProjection:projection,geoProjectionMutator:projectionMutator,geoMercator:mercator,geoMercatorRaw:mercatorRaw,geoNaturalEarth1:naturalEarth1,geoNaturalEarth1Raw:naturalEarth1Raw,geoOrthographic:orthographic,geoOrthographicRaw:orthographicRaw,geoStereographic:stereographic,geoStereographicRaw:stereographicRaw,geoTransverseMercator:transverseMercator,geoTransverseMercatorRaw:transverseMercatorRaw,geoRotation:rotation,geoStream,geoTransform:transform$3,cluster,hierarchy,pack:index$2,packSiblings:siblings,packEnclose:enclose,partition:partition$1,stratify,tree,treemap:index$1,treemapBinary:binary,treemapDice,treemapSlice,treemapSliceDice:sliceDice,treemapSquarify:squarify,treemapResquarify:resquarify,interpolate:interpolateValue,interpolateArray:array$5,interpolateBasis:basis$2,interpolateBasisClosed:basisClosed$1,interpolateDate:date$2,interpolateDiscrete:discrete,interpolateHue:hue,interpolateNumber,interpolateNumberArray:numberArray,interpolateObject:object$5,interpolateRound,interpolateString,interpolateTransformCss,interpolateTransformSvg,interpolateZoom,interpolateRgb,interpolateRgbBasis:rgbBasis,interpolateRgbBasisClosed:rgbBasisClosed,interpolateHsl:hsl$1,interpolateHslLong:hslLong,interpolateLab:lab,interpolateHcl:hcl$1,interpolateHclLong:hclLong,interpolateCubehelix:cubehelix$2,interpolateCubehelixLong:cubehelixLong,piecewise,quantize:quantize$1,path:path$4,polygonArea:area$1,polygonCentroid:centroid,polygonHull:hull,polygonContains:contains$1,polygonLength:length$1,quadtree,randomUniform:uniform,randomNormal:normal$3,randomLogNormal:logNormal,randomBates:bates,randomIrwinHall:irwinHall,randomExponential:exponential,scaleBand:band,scalePoint:point$5,scaleIdentity:identity$3,scaleLinear:linear,scaleLog:log,scaleSymlog:symlog,scaleOrdinal:ordinal,scaleImplicit:implicit,scalePow:pow,scaleSqrt:sqrt$1,scaleQuantile:quantile,scaleQuantize:quantize,scaleThreshold:threshold,scaleTime:time,scaleUtc:utcTime,scaleSequential:sequential,scaleSequentialLog:sequentialLog,scaleSequentialPow:sequentialPow,scaleSequentialSqrt:sequentialSqrt,scaleSequentialSymlog:sequentialSymlog,scaleSequentialQuantile:sequentialQuantile,scaleDiverging:diverging$1,scaleDivergingLog:divergingLog,scaleDivergingPow:divergingPow,scaleDivergingSqrt:divergingSqrt,scaleDivergingSymlog:divergingSymlog,tickFormat,schemeCategory10:category10,schemeAccent:Accent,schemeDark2:Dark2,schemePaired:Paired,schemePastel1:Pastel1,schemePastel2:Pastel2,schemeSet1:Set1,schemeSet2:Set2,schemeSet3:Set3,schemeTableau10:Tableau10,interpolateBrBG:BrBG,schemeBrBG:scheme$q,interpolatePRGn:PRGn,schemePRGn:scheme$p,interpolatePiYG:PiYG,schemePiYG:scheme$o,interpolatePuOr:PuOr,schemePuOr:scheme$n,interpolateRdBu:RdBu,schemeRdBu:scheme$m,interpolateRdGy:RdGy,schemeRdGy:scheme$l,interpolateRdYlBu:RdYlBu,schemeRdYlBu:scheme$k,interpolateRdYlGn:RdYlGn,schemeRdYlGn:scheme$j,interpolateSpectral:Spectral,schemeSpectral:scheme$i,interpolateBuGn:BuGn,schemeBuGn:scheme$h,interpolateBuPu:BuPu,schemeBuPu:scheme$g,interpolateGnBu:GnBu,schemeGnBu:scheme$f,interpolateOrRd:OrRd,schemeOrRd:scheme$e,interpolatePuBuGn:PuBuGn,schemePuBuGn:scheme$d,interpolatePuBu:PuBu,schemePuBu:scheme$c,interpolatePuRd:PuRd,schemePuRd:scheme$b,interpolateRdPu:RdPu,schemeRdPu:scheme$a,interpolateYlGnBu:YlGnBu,schemeYlGnBu:scheme$9,interpolateYlGn:YlGn,schemeYlGn:scheme$8,interpolateYlOrBr:YlOrBr,schemeYlOrBr:scheme$7,interpolateYlOrRd:YlOrRd,schemeYlOrRd:scheme$6,interpolateBlues:Blues,schemeBlues:scheme$5,interpolateGreens:Greens,schemeGreens:scheme$4,interpolateGreys:Greys,schemeGreys:scheme$3,interpolatePurples:Purples,schemePurples:scheme$2,interpolateReds:Reds,schemeReds:scheme$1,interpolateOranges:Oranges,schemeOranges:scheme,interpolateCividis:cividis,interpolateCubehelixDefault:cubehelix,interpolateRainbow:rainbow,interpolateWarm:warm,interpolateCool:cool,interpolateSinebow:sinebow,interpolateTurbo:turbo,interpolateViridis:viridis,interpolateMagma:magma,interpolateInferno:inferno,interpolatePlasma:plasma,create:create$2,creator,local:local$1,matcher,mouse,namespace,namespaces,clientPoint:point$6,select,selectAll,selection:selection$1,selector,selectorAll,style:styleValue,touch,touches,window:defaultView,get event(){return event},customEvent,arc,area,line:line$2,pie,areaRadial,radialArea:areaRadial,lineRadial:lineRadial$1,radialLine:lineRadial$1,pointRadial,linkHorizontal,linkVertical,linkRadial,symbol,symbols,symbolCircle:circle$2,symbolCross:cross$1,symbolDiamond:diamond$2,symbolSquare:square,symbolStar:star,symbolTriangle:triangle,symbolWye:wye,curveBasisClosed:basisClosed,curveBasisOpen:basisOpen,curveBasis:basis,curveBundle:bundle,curveCardinalClosed:cardinalClosed,curveCardinalOpen:cardinalOpen,curveCardinal:cardinal,curveCatmullRomClosed:catmullRomClosed,curveCatmullRomOpen:catmullRomOpen,curveCatmullRom:catmullRom,curveLinearClosed:linearClosed,curveLinear,curveMonotoneX:monotoneX,curveMonotoneY:monotoneY,curveNatural:natural,curveStep:step,curveStepAfter:stepAfter,curveStepBefore:stepBefore,stack,stackOffsetExpand:expand,stackOffsetDiverging:diverging,stackOffsetNone:none$1,stackOffsetSilhouette:silhouette,stackOffsetWiggle:wiggle,stackOrderAppearance:appearance,stackOrderAscending:ascending,stackOrderDescending:descending,stackOrderInsideOut:insideOut,stackOrderNone:none,stackOrderReverse:reverse$1,timeInterval:newInterval,timeMillisecond:millisecond,timeMilliseconds:milliseconds,utcMillisecond:millisecond,utcMilliseconds:milliseconds,timeSecond:second,timeSeconds:seconds,utcSecond:second,utcSeconds:seconds,timeMinute:minute,timeMinutes:minutes,timeHour:hour,timeHours:hours,timeDay:day,timeDays:days,timeWeek:sunday,timeWeeks:sundays,timeSunday:sunday,timeSundays:sundays,timeMonday:monday,timeMondays:mondays,timeTuesday:tuesday,timeTuesdays:tuesdays,timeWednesday:wednesday,timeWednesdays:wednesdays,timeThursday:thursday,timeThursdays:thursdays,timeFriday:friday,timeFridays:fridays,timeSaturday:saturday,timeSaturdays:saturdays,timeMonth:month,timeMonths:months,timeYear:year,timeYears:years,utcMinute,utcMinutes,utcHour,utcHours,utcDay,utcDays,utcWeek:utcSunday,utcWeeks:utcSundays,utcSunday,utcSundays,utcMonday,utcMondays,utcTuesday,utcTuesdays,utcWednesday,utcWednesdays,utcThursday,utcThursdays,utcFriday,utcFridays,utcSaturday,utcSaturdays,utcMonth,utcMonths,utcYear,utcYears,timeFormatDefaultLocale:defaultLocale,get timeFormat(){return timeFormat},get timeParse(){return timeParse},get utcFormat(){return utcFormat},get utcParse(){return utcParse},timeFormatLocale:formatLocale,isoFormat:formatIso,isoParse:parseIso,now:now$1,timer,timerFlush,timeout,interval,transition,active,interrupt,voronoi,zoom,zoomTransform:transform$2,zoomIdentity:identity$1}),require$$0=getAugmentedNamespace(d3$1);var d3;if(!d3&&"function"==typeof commonjsRequire)try{d3=require$$0}catch(t){}d3||(d3=window.d3);var d3_1=d3,util$6={isSubgraph,edgeToId,applyStyle,applyClass,applyTransition};function isSubgraph(t,e){return!!t.children(e).length}function edgeToId(t){return escapeId(t.v)+":"+escapeId(t.w)+":"+escapeId(t.name)}var ID_DELIM=/:/g;function escapeId(t){return t?String(t).replace(ID_DELIM,"\\:"):""}function applyStyle(t,e){e&&t.attr("style",e)}function applyClass(t,e,n){e&&t.attr("class",e).attr("class",n+" "+t.attr("class"))}function applyTransition(t,e){var n=e.graph();if(lodash_1.isPlainObject(n)){var r=n.transition;if(lodash_1.isFunction(r))return r(t)}return t}var addTextLabel_1=addTextLabel;function addTextLabel(t,e){for(var n=t.append("text"),r=processEscapeSequences(e.label).split("\n"),i=0;i<r.length;i++)n.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(r[i]);return util$6.applyStyle(n,e.labelStyle),n}function processEscapeSequences(t){for(var e,n="",r=!1,i=0;i<t.length;++i)e=t[i],r?(n+="n"===e?"\n":e,r=!1):"\\"===e?r=!0:n+=e;return n}var addHtmlLabel_1=addHtmlLabel;function addHtmlLabel(t,e){var n=t.append("foreignObject").attr("width","100000"),r=n.append("xhtml:div");r.attr("xmlns","http://www.w3.org/1999/xhtml");var i=e.label;switch(typeof i){case"function":r.insert(i);break;case"object":r.insert((function(){return i}));break;default:r.html(i)}util$6.applyStyle(r,e.labelStyle),r.style("display","inline-block"),r.style("white-space","nowrap");var o=r.node().getBoundingClientRect();return n.attr("width",o.width).attr("height",o.height),n}var addSvgLabel=addSVGLabel;function addSVGLabel(t,e){var n=t;return n.node().appendChild(e.label),util$6.applyStyle(n,e.labelStyle),n}var addLabel_1=addLabel;function addLabel(t,e,n){var r=e.label,i=t.append("g");"svg"===e.labelType?addSvgLabel(i,e):"string"!=typeof r||"html"===e.labelType?addHtmlLabel_1(i,e):addTextLabel_1(i,e);var o,s=i.node().getBBox();switch(n){case"top":o=-e.height/2;break;case"bottom":o=e.height/2-s.height;break;default:o=-s.height/2}return i.attr("transform","translate("+-s.width/2+","+o+")"),i}var createNodes_1=createNodes;function createNodes(t,e,n){var r,i=e.nodes().filter((function(t){return!util$6.isSubgraph(e,t)})),o=t.selectAll("g.node").data(i,(function(t){return t})).classed("update",!0);return o.exit().remove(),o.enter().append("g").attr("class","node").style("opacity",0),(o=t.selectAll("g.node")).each((function(t){var r=e.node(t),i=d3_1.select(this);util$6.applyClass(i,r.class,(i.classed("update")?"update ":"")+"node"),i.select("g.label").remove();var o=i.append("g").attr("class","label"),s=addLabel_1(o,r),a=n[r.shape],l=lodash_1.pick(s.node().getBBox(),"width","height");r.elem=this,r.id&&i.attr("id",r.id),r.labelId&&o.attr("id",r.labelId),lodash_1.has(r,"width")&&(l.width=r.width),lodash_1.has(r,"height")&&(l.height=r.height),l.width+=r.paddingLeft+r.paddingRight,l.height+=r.paddingTop+r.paddingBottom,o.attr("transform","translate("+(r.paddingLeft-r.paddingRight)/2+","+(r.paddingTop-r.paddingBottom)/2+")");var c=d3_1.select(this);c.select(".label-container").remove();var u=a(c,l,r).classed("label-container",!0);util$6.applyStyle(u,r.style);var h=u.node().getBBox();r.width=h.width,r.height=h.height})),r=o.exit?o.exit():o.selectAll(null),util$6.applyTransition(r,e).style("opacity",0).remove(),o}var createClusters_1=createClusters;function createClusters(t,e){var n,r=e.nodes().filter((function(t){return util$6.isSubgraph(e,t)})),i=t.selectAll("g.cluster").data(r,(function(t){return t}));return i.selectAll("*").remove(),i.enter().append("g").attr("class","cluster").attr("id",(function(t){return e.node(t).id})).style("opacity",0),i=t.selectAll("g.cluster"),util$6.applyTransition(i,e).style("opacity",1),i.each((function(t){var n=e.node(t),r=d3_1.select(this);d3_1.select(this).append("rect");var i=r.append("g").attr("class","label");addLabel_1(i,n,n.clusterLabelPos)})),i.selectAll("rect").each((function(t){var n=e.node(t),r=d3_1.select(this);util$6.applyStyle(r,n.style)})),n=i.exit?i.exit():i.selectAll(null),util$6.applyTransition(n,e).style("opacity",0).remove(),i}var createEdgeLabels_1=createEdgeLabels;function createEdgeLabels(t,e){var n,r=t.selectAll("g.edgeLabel").data(e.edges(),(function(t){return util$6.edgeToId(t)})).classed("update",!0);return r.exit().remove(),r.enter().append("g").classed("edgeLabel",!0).style("opacity",0),(r=t.selectAll("g.edgeLabel")).each((function(t){var n=d3_1.select(this);n.select(".label").remove();var r=e.edge(t),i=addLabel_1(n,e.edge(t),0).classed("label",!0),o=i.node().getBBox();r.labelId&&i.attr("id",r.labelId),lodash_1.has(r,"width")||(r.width=o.width),lodash_1.has(r,"height")||(r.height=o.height)})),n=r.exit?r.exit():r.selectAll(null),util$6.applyTransition(n,e).style("opacity",0).remove(),r}var createEdgePaths_1=createEdgePaths;function createEdgePaths(t,e,n){var r=t.selectAll("g.edgePath").data(e.edges(),(function(t){return util$6.edgeToId(t)})).classed("update",!0),i=enter(r,e);exit(r,e);var o=void 0!==r.merge?r.merge(i):r;return util$6.applyTransition(o,e).style("opacity",1),o.each((function(t){var n=d3_1.select(this),r=e.edge(t);r.elem=this,r.id&&n.attr("id",r.id),util$6.applyClass(n,r.class,(n.classed("update")?"update ":"")+"edgePath")})),o.selectAll("path.path").each((function(t){var n=e.edge(t);n.arrowheadId=lodash_1.uniqueId("arrowhead");var r=d3_1.select(this).attr("marker-end",(function(){return"url("+makeFragmentRef(location.href,n.arrowheadId)+")"})).style("fill","none");util$6.applyTransition(r,e).attr("d",(function(t){return calcPoints(e,t)})),util$6.applyStyle(r,n.style)})),o.selectAll("defs *").remove(),o.selectAll("defs").each((function(t){var r=e.edge(t);(0,n[r.arrowhead])(d3_1.select(this),r.arrowheadId,r,"arrowhead")})),o}function makeFragmentRef(t,e){return t.split("#")[0]+"#"+e}function calcPoints(t,e){var n=t.edge(e),r=t.node(e.v),i=t.node(e.w),o=n.points.slice(1,n.points.length-1);return o.unshift(intersectNode_1(r,o[0])),o.push(intersectNode_1(i,o[o.length-1])),createLine(n,o)}function createLine(t,e){var n=(d3_1.line||d3_1.svg.line)().x((function(t){return t.x})).y((function(t){return t.y}));return(n.curve||n.interpolate)(t.curve),n(e)}function getCoords(t){var e=t.getBBox(),n=t.ownerSVGElement.getScreenCTM().inverse().multiply(t.getScreenCTM()).translate(e.width/2,e.height/2);return{x:n.e,y:n.f}}function enter(t,e){var n=t.enter().append("g").attr("class","edgePath").style("opacity",0);return n.append("path").attr("class","path").attr("d",(function(t){var n=e.edge(t),r=e.node(t.v).elem;return createLine(n,lodash_1.range(n.points.length).map((function(){return getCoords(r)})))})),n.append("defs"),n}function exit(t,e){var n=t.exit();util$6.applyTransition(n,e).style("opacity",0).remove()}var positionNodes_1=positionNodes;function positionNodes(t,e){function n(t){var n=e.node(t);return"translate("+n.x+","+n.y+")"}t.filter((function(){return!d3_1.select(this).classed("update")})).attr("transform",n),util$6.applyTransition(t,e).style("opacity",1).attr("transform",n)}var positionEdgeLabels_1=positionEdgeLabels;function positionEdgeLabels(t,e){function n(t){var n=e.edge(t);return lodash_1.has(n,"x")?"translate("+n.x+","+n.y+")":""}t.filter((function(){return!d3_1.select(this).classed("update")})).attr("transform",n),util$6.applyTransition(t,e).style("opacity",1).attr("transform",n)}var positionClusters_1=positionClusters;function positionClusters(t,e){var n=t.filter((function(){return!d3_1.select(this).classed("update")}));function r(t){var n=e.node(t);return"translate("+n.x+","+n.y+")"}n.attr("transform",r),util$6.applyTransition(t,e).style("opacity",1).attr("transform",r),util$6.applyTransition(n.selectAll("rect"),e).attr("width",(function(t){return e.node(t).width})).attr("height",(function(t){return e.node(t).height})).attr("x",(function(t){return-e.node(t).width/2})).attr("y",(function(t){return-e.node(t).height/2}))}var shapes={rect:rect$1,ellipse:ellipse$3,circle:circle$1,diamond:diamond$1};function rect$1(t,e,n){var r=t.insert("rect",":first-child").attr("rx",n.rx).attr("ry",n.ry).attr("x",-e.width/2).attr("y",-e.height/2).attr("width",e.width).attr("height",e.height);return n.intersect=function(t){return intersectRect_1(n,t)},r}function ellipse$3(t,e,n){var r=e.width/2,i=e.height/2,o=t.insert("ellipse",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("rx",r).attr("ry",i);return n.intersect=function(t){return intersectEllipse_1(n,r,i,t)},o}function circle$1(t,e,n){var r=Math.max(e.width,e.height)/2,i=t.insert("circle",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("r",r);return n.intersect=function(t){return intersectCircle_1(n,r,t)},i}function diamond$1(t,e,n){var r=e.width*Math.SQRT2/2,i=e.height*Math.SQRT2/2,o=[{x:0,y:-i},{x:-r,y:0},{x:0,y:i},{x:r,y:0}],s=t.insert("polygon",":first-child").attr("points",o.map((function(t){return t.x+","+t.y})).join(" "));return n.intersect=function(t){return intersectPolygon_1(n,o,t)},s}var arrows={default:normal$2,normal:normal$2,vee,undirected};function normal$2(t,e,n,r){var i=t.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");util$6.applyStyle(i,n[r+"Style"]),n[r+"Class"]&&i.attr("class",n[r+"Class"])}function vee(t,e,n,r){var i=t.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");util$6.applyStyle(i,n[r+"Style"]),n[r+"Class"]&&i.attr("class",n[r+"Class"])}function undirected(t,e,n,r){var i=t.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");util$6.applyStyle(i,n[r+"Style"]),n[r+"Class"]&&i.attr("class",n[r+"Class"])}var layout=dagre_1.layout,render_1=render;function render(){var t=createNodes_1,e=createClusters_1,n=createEdgeLabels_1,r=createEdgePaths_1,i=positionNodes_1,o=positionEdgeLabels_1,s=positionClusters_1,a=shapes,l=arrows,c=function(c,u){preProcessGraph(u);var h=createOrSelectGroup(c,"output"),d=createOrSelectGroup(h,"clusters"),f=createOrSelectGroup(h,"edgePaths"),p=n(createOrSelectGroup(h,"edgeLabels"),u),g=t(createOrSelectGroup(h,"nodes"),u,a);layout(u),i(g,u),o(p,u),r(f,u,l);var m=e(d,u);s(m,u),postProcessGraph(u)};return c.createNodes=function(e){return arguments.length?(t=e,c):t},c.createClusters=function(t){return arguments.length?(e=t,c):e},c.createEdgeLabels=function(t){return arguments.length?(n=t,c):n},c.createEdgePaths=function(t){return arguments.length?(r=t,c):r},c.shapes=function(t){return arguments.length?(a=t,c):a},c.arrows=function(t){return arguments.length?(l=t,c):l},c}var NODE_DEFAULT_ATTRS={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},EDGE_DEFAULT_ATTRS={arrowhead:"normal",curve:d3_1.curveLinear};function preProcessGraph(t){t.nodes().forEach((function(e){var n=t.node(e);lodash_1.has(n,"label")||t.children(e).length||(n.label=e),lodash_1.has(n,"paddingX")&&lodash_1.defaults(n,{paddingLeft:n.paddingX,paddingRight:n.paddingX}),lodash_1.has(n,"paddingY")&&lodash_1.defaults(n,{paddingTop:n.paddingY,paddingBottom:n.paddingY}),lodash_1.has(n,"padding")&&lodash_1.defaults(n,{paddingLeft:n.padding,paddingRight:n.padding,paddingTop:n.padding,paddingBottom:n.padding}),lodash_1.defaults(n,NODE_DEFAULT_ATTRS),lodash_1.each(["paddingLeft","paddingRight","paddingTop","paddingBottom"],(function(t){n[t]=Number(n[t])})),lodash_1.has(n,"width")&&(n._prevWidth=n.width),lodash_1.has(n,"height")&&(n._prevHeight=n.height)})),t.edges().forEach((function(e){var n=t.edge(e);lodash_1.has(n,"label")||(n.label=""),lodash_1.defaults(n,EDGE_DEFAULT_ATTRS)}))}function postProcessGraph(t){lodash_1.each(t.nodes(),(function(e){var n=t.node(e);lodash_1.has(n,"_prevWidth")?n.width=n._prevWidth:delete n.width,lodash_1.has(n,"_prevHeight")?n.height=n._prevHeight:delete n.height,delete n._prevWidth,delete n._prevHeight}))}function createOrSelectGroup(t,e){var n=t.select("g."+e);return n.empty()&&(n=t.append("g").attr("class",e)),n}var version$1="0.6.4",dagreD3={graphlib:graphlib_1$1,dagre:dagre_1,intersect:intersect$1,render:render_1,util:util$6,version:version$1};const elsaDesignerTreeCss='g.label>*>*>div,g.label>*>div{position:fixed;transform-origin:0 0}.workflow-canvas{background-color:#fbfbfb;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABSkAAAUpCAYAAACLD4MTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAACjWSURBVHgB7N3ZbhtXFgXQE1myLA8Z0f//g51O4nlWc6NIWHIoiaQ1nFu1FnBRToAATj0UNvedqgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFu2nAuDRajxejZPVOFqN4/Uz4/vv5JfV+Loa56vxaf3PeX4sAACWKHkxefJkPR6tx9H6eVEyZLLklwvP5MjP6wGwWEpKYIny7Xu6Gk9qCpK39S1MwHy/Gh9KyAQAmLNMcJ/Wt4nu28iTKTCTI5Mnkyu/FMCCKCmBpbhYTD6uu5dQ+aamkClgAgCML3ny+Wqc1b9XSN6FFJVvS2EJLISSEpi7BMhnNRWUD/XNe7car8vqSgCAEWWC+0Xdz0T3VZInX5WyEpgxJSUwVyknEybPqo/Mgv9dwiUAwAg6lJPfU1YCs6WkBOZmsw3nWfX9xgmXAAB9JUP+Ur0mu7/3ej3OC2AmlJTAnGSW+9e6nzOCflQKyhSV7woAgC4y0Z3VkyP8Vk6ezC6djwUwA0pKYA7yLUuYfFbjsaoSAODhJU/+Xr22du8qKypfFcDglJTA6LJq8rfVOKlxpaD8sxSVAAAPITkyeXKE3ThXkSeB4Y38EQZIoMyM93GN7aimVaA5U+hTAQBwX57WVFAe1djy93+yGh9W42sBDEhJCYxqLoHyotOaVrg7VwgA4O7luKCfaz47DJOLc9lPVlN+LoDBKCmBEaWgzI2LczyyIucgKSoBAO5WCsrnNT/JkYpKYEhKSmA02cbya82bohIA4O7MtaC8KJlZUQkMRUkJjGRzBuUSLv1KUSlYAgDcrpwD/qKWIXnSGZXAMJSUwCjyvUpBOaczKG+SGfD3JVgCANyGzS3eS5GJ/U2ePC+A5pSUwCj+U8v8ZgmWAAA/bokT3pH/36yofFcAzSkpgRHk1sXTWqYEy8z6C5YAAIdLQXlSy5Tf/VlV+aEAGlNSAt1l5veXWrZ8q7OS8lMBALCvnEF5VsuWTJ1LGb8UQFNLW+oOjCUzvnO/yXtXuYHSxBIAwH6Sn+Z+k/eukquXcAElMCglJdCZYu6bfK8VtgAA+1nKTd67SK5+VgBNKSmBrsx6/9vj9QAA4GZnZZv391JSWgQAtKSkBLoy672d9wIAsBu56d/SAXgvQEtKSqCjzO6a9d7OakoAgJslS1oxuJ13A7SkpAQ6Mrt7Pe8HAOB6T4vrOJsSaEdJCXRjFeXNrKYEALjaSclKN0nedtM30IqSEuhGoNzNkwIAYBurBG+WLsBqU6AVJSXQjbC0G7PfAADbmfTejUlvoBUlJdBJtnoLlbvJ9/ukAAC4KMWbS2F2k9xt0htoQ0kJdKKg3I/ZbwCAy+Sj/djFBLShpAQ6ESr3430BAFxm0ns/8iTQhpIS6OS02Mejsp0JAGBDNtrfcQE0oaQEusj5is7E2Z/VAgAAE+d17y+dgGIXaEFJCXQhHB1GGAcAmJi8PYz3BrSgpAS6EI4Oo9wFAJiYvD2M9wa0oKQEulC2HUaoBACY+H17GEcuAS34iANd+B4dRqgEAJi4BOYwJr2BFpQCQBdWUh4m33FFJQCwdH7bHs67A1rwMQK68D06nHcHACydSdvDeXdAC37YAl0IRwAAcP/0AkALPkYAAAAAwINSUgIAAAAAD0pJCQAAAAA8KCUl0MWX4lBfCwBg2c6LQ8nhQAtKSqALwfJw3h0AsHQmbQ/n3QEtKCmBLj4XhzDzDQAwkYsOo6QEWlBSAl0IlYdR7gIATD4Vh5AngRaUlEAXQuVhhEoAgIlJ78N4b0ALSkqgC2XbYZS7AAATuegw3hvQgpIS6CIzuC6A2Z9QCQAw+VgcwnsDWlBSAl3kwG6F235S7FqBCgAwMem9vw8F0ISSEuhESNqPUhcA4LJ3xT7kb6ANJSXQiZC0n/cFAMBFti7vR/4G2lBSAp1kZaDbBXenpAQAuCylmy3fu3F0ENCKkhLo5m2xi7wnARwA4DLnnO/uTQE0oqQEulFS7sZ5SwAA270qdmFXDtCKkhLoJrPfzhK6XrbmeEcAANslJ9nGfL0sDHDMEtCKkhLoyOz39bwfAIDrvS6uY6s30I6SEujoY1kpeJXMeNvqDQBwvVygY6Xgdnk3VpoC7Sgpga6sFtzOewEAuFmOEJKbtvunABpSUgJdZSWlS3Qus4oSAGB3yU1251zmLEqgLSUl0Flmv8+LjT8LAIB9WE35TcpJZ3UCbT0qgL7O1+O0yOHm7wsAgH2kmMvinMfFy7KyFGjMSkqgu5RzSw9TCdcvCwCAQ2T14NK3OGebt2ODgNaUlMAI/qrlBsusJLXNGwDgcLlEJ3lyqccI2eYNDMF2b2AECZRZTXm2Gj/VsuQcpQ8FAMCPSFGZsu5JLc9/y0pSYABKSmAUSwyWKSjfFAAAt+Hz+rmk885zZJAJb2AISkpgJEsKlikn3UYJAHC7sjtnKRfpmPAGhqKkBEazuURnzkVlDjZ3UQ4AwN3IysLj1Tip+UpB6RxKYChKSmBEcy4qM9utoAQAuFvva74rKhWUwJCUlMCoUlTmQp05FZWvyhZvAID7sjmrcU558u+aduUADEdJCYzsU03hMsHyqMaVsvWfEigBAO7bZuI7Kyp/qnHlgsn/lUtygIEpKYHR5dbvbNfJmUIjftMESgCAh5WJ73er8aTGnPhOjvyrvl0yCTAkJSUwB5n9frf+80jbdXL+ZALllwIA4CElTyabjXROZf7OOSro5frPAEMbeTk7wDaZfHm+Gk+rr8x25zDzjwUAQDfJk39U70U9yZM5LshkNzAbSkpgrs5W40X1CpcJkZntflcAAHTXMU+a7AZmS0kJzN3ZejzkNvCcc5TtQ8pJAIDxdCgrlZPA7CkpgaXIxTrZAp6y8j4CZs4FSogUJgEA5iFnVaawvK9jhZIn39Z0SaQ8CcyekhJYotzceFq3X1huLvBJiHxfDjAHAJij/I5+sh6ZCL/NPJkburNqMlkyu3HkSWAxlJTA0iVUJlxmZvy4phsdT3b47z6vR86ZTID8WA4uBwBYomTH4wvPR+vndVI+JjvKkwBrSkqA7fJ9PNry77+WGW0AAG4mTwIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjOenAmCbfB+Ptvz7r6txXgAAcD15EmAPSkpg6R6txuPVOFn/efO8yZf1+HRhfC4AAJbmuKYMuW+eTH48Xz8/rp9fCmChlJTA0uS7l+D4ZD12CZC7Ssj8sBrv18MMOQDA/CRPJkeerp+3+bs6JWUKy02eBFgMJSWwFFktmRD5tO7v2/duNd7WFDQBABhb8uSLmia87yNPbgrL12XHDrAASkpg7jZh8nE9nATMVzWVlgAAjGOzavJ5Tdu6H0rKykx+y5PAbCkpgbnqUE5+T1kJADCOs5ry5G0eD/Sj5ElgtpSUwNwkRP5avcrJ7yVc/lkORgcA6KjjZPf3UlKmrJQngdlQUgJz8qymQDnKt+3NarwsAAA6SIZMlnxW48h5la8KYAaUlMAcjLB68ipWVQIAPLxchvNb9dravaucV/l3yZPA4Eb8AANclED5+/o5oqOazjuKTwUAwH17WlNBeVRjyu/6XO7zYTW+FsCglJTAyLIVZ+RAuZFV7afr58cCAOC+ZHv3zzX+LsPk4WTj8zLxDQxKSQmM6sV6zEm2qydgfigAAO5aysnnNS8mvoFhKSmBEaWcnFug3EhRebwa7wsAgLuS88yf1jwlTyoqgeEoKYHRzLmg3Mj5mlZUAgDcjaygnGtBuaGoBIajpARGknN25rbF+yqCJQDA7VvChPdG8mRu/P5cAANQUgKjyPfq91oWwRIA4PYsacJ7I3nSrd/AEEa/ERdYhhSUf9QyZTvScQEA8COSJ5dWUEZ+82eif/Tby4EFUFICI0igXOrKb8ESAODHJEf9UcvNU0vckQQMyHZvoLuzWuas90UpKhOqXaQDALC/7Ew5rWXLb//z1fhUAE1ZSQl0ttRtOdvkDKXHBQDAPpInnxWRC4PszgHaUlICnS15m/c2ClsAgP0s9VzzbfL7/5cCaEpJCXSVcvKsuCgrKb0TAIDdJDeZ8L4s78TuHKAlJSXQ1a/FNlZTAgDsRm7aznsBWlJSAh09LjO8V7HCFADgZlZRXk3WBlpSUgIdPS2u4/B3AIDrWS14Pe8HaEdJCXRjpeDNTsrsNwDAVZKTrKK8Xt6Rm76BVpSUQDdPil2Y/QYA2M6unN3YnQO0oqQEuhGWdnNcZr8BAL6X37h25exGmQu0oqQEOsk2ZltzdpPvt1WnAACXnRa7Su4+LoAmlJRAJ85Z3I/3BQBwmUnc/XhfQBtKSqATIWk/3hcAwGVWUu7H+wLaUFICnVgZuJ98w22PBwCY5OggZ3bvx3ZvoA0lJdCFgvIw3hsAwEThtr90At4b0IKSEujipDiE9wYAMJGLDuO9AS0oKYEubFs+jPfG/9u7t502zigKwBulzYG26vs/ZJo2bdJgTmVpbAkLCvaE4P3PfJ80gtyFubCW1/4PAMBE2TaP9wa0oKQEuhCO5vHeAAAmhrfzeG9AC0pKoAufR/MIlQAAE7loHu8NaEEpAHThJsb5vDsAYO18t53PuwNa8GEEdGGCO5/PcgBg7Qxt5/PugBZ8sQUAAID10gsALfgwAgAAAABOSkkJAAAAAJyUkhLo4rYAAIDXdlMADSgpgS6Eo/m8OwBg7Qy85/PugBaUlEAXwtF83h0AsHaGtvNdFUADSkqgi00xx2UBABDXxRwG3kALSkqgC+FoHqsGAAAmhrfzeG9AC0pKoAvhaB7bcwAAJlZSziOHAy0oKYEubPee56IAAAhl2zzKXaAFJSXQRcKRLd/Hs5ISAGBi6H28HB0kTwItKCmBTky/j3NdJt8AADuy0fEUu0AbSkqgk2/FMWz1BgDYJ08ex/sC2lBSAp38WxxDqAQA2CcfHcdKSqANJSXQSc7EEZQOk61MVlICAOzL+YrOOT9MsqTt8UAbSkqgG9PvwygoAQAeytD7a3EIu5iAVpSUQDcJS6bfz/tSAAA8xtD7MHYwAa0oKYFuTL+fl1WUVwUAwGM2pYB7TvK2rd5AK0pKoCOrBJ9maw4AwNP+Lp7yTwE0o6QEOspU12rKx+XdKCkBAJ5mNeX/s4oSaElJCXSV6a6zKR+yKgAA4DBy0+OsogRaUlICXWW6K0Dty9TbKkoAgMNYTflQilurKIGWlJRAZ7ai7FPaAgAc58+yO2cnudrZ70BbbwqgrwTKy7vnvMjU+6IAADjG7fZ5V3wqCwCAxpSUQHcJUln1/bbWK+XkXwUAwBwZeqekXPP33wy8HRsEtGa7NzCCbHO+qnVKSaugBAD4Ptn2vdZVhM56B4ZgJSUwgmzRyWrC97W+4coftd6CFgDgpSRP5hKdtR0jlILyYzmXExiAkhIYxS5Yfrh7zmodPt893woAgJdwU1Np977WIfnZwBsYhpISGMmagmXODXL7IgDAy9oVdmu4SCdb3DcFMAglJTCaBMulF5UpKJ0bBADwY+yKuyUXlSko7cgBhqKkBEZ0tX1SVC5t67eCEgDgx1tqUZkt3rl00U3ewHCUlMCoUlLmMp0EyyVcprMLlF8LAIDXkKIyGWwpRWV2G+UMyosCGJCSEhhZzqjMNpbRb/0WKAEATuOyplWHo+fJ/B0uyQGGpqQERpfp9+6CmRGn4CkmP9ZUVAIA8PqSJzP4zjFCP9d4koVzBuVNAQxMSQksxWb7jLL9O2E4509+LgAATi3ZLMPjDI5TVI6QJ/N//VSOCwIWYmkXTgAkUJ7fPb9VXwmSKSdvCwCAbrKY59eaMmVHyZC5aPFLyZPAgigpgaXqGC4znU+g3BQAAN0lT/5evY4UyrA7edJRQcDiKCmBpetQVionAQDGle3f53W6PJnVkikns3JSOQkslpISWIuUlW/vng/1OtPw3KyYmyJtwwEAWIbkydwC/ku9zv0OF9snBaU8CSyekhJYo11hmZCZwvIlPgsTHHeX9yRMXhYAAEuV1ZXJk+/q5QbguzypmARWSUkJMIXMFJc/bX8/2/77Te1/TiYoXt/7mSdl5FUpJQEA1iyF5f1Mmcscz7a/33c/T17e+7kpW7kBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADW7D+LjbEc7OYEDAAAAABJRU5ErkJggg==");background-repeat:repeat;background-size:30px 30px}.node.activity,.node.add .label-container,.node.start{fill:transparent}.node.activity .label-container,.node.start .label-container{stroke:none}.edgePath{stroke:#000;cursor:pointer}.outcome{background-color:#fbfbfb}.edgePath path.path{stroke:#333;fill:transparent!important;stroke-width:.5px}.label-clickable{fill:transparent!important;stroke:#4677f8;stroke-width:12.5px!important;opacity:0}.edgePath:hover path.path{stroke:red}';let ElsaWorkflowDesigner$1=class{constructor(t){registerInstance(this,t),this.workflowChanged=createEvent(this,"workflow-changed",7),this.activitySelected=createEvent(this,"activitySelected",7),this.activityDeselected=createEvent(this,"activityDeselected",7),this.activityContextMenuButtonClicked=createEvent(this,"activityContextMenuButtonClicked",7),this.connectionContextMenuButtonClicked=createEvent(this,"connectionContextMenuButtonClicked",7),this.activityContextMenuButtonTestClicked=createEvent(this,"activityContextMenuButtonTestClicked",7),this.model={activities:[],connections:[],persistenceBehavior:WorkflowPersistenceBehavior.WorkflowBurst},this.selectedActivityIds=[],this.mode=WorkflowDesignerMode.Edit,this.layoutDirection=LayoutDirection.TopBottom,this.activityContextMenuState={shown:!1,x:0,y:0,activity:null,selectedActivities:{}},this.connectionContextMenuState={shown:!1,x:0,y:0,activity:null},this.activityContextMenuTestState={shown:!1,x:0,y:0,activity:null},this.zoomParams={x:0,y:0,scale:1,initialZoom:!0},this.dagreD3Renderer=new dagreD3.render,this.graph=(new dagreD3.graphlib.Graph).setGraph({}),this.addingActivity=!1,this.activityDisplayContexts=null,this.oldActivityDisplayContexts=null,this.selectedActivities={},this.ignoreCopyPasteActivities=!1,this.onActivityPicked=async t=>{const e=this.newActivity(t);this.addingActivity=!0,await this.showActivityEditorInternal(e,!1)},this.onUpdateActivity=t=>{const e=t;if(this.addingActivity){console.debug(`adding activity with ID ${e.activityId}`);const t=!this.parentActivityOutcome||""==this.parentActivityOutcome;this.addActivity(e,t?null:this.parentActivityId,t?this.parentActivityId:null,this.parentActivityOutcome),this.addingActivity=!1}else console.debug(`updating activity with ID ${e.activityId}`),this.updateActivity(e)},this.onWorkflowExecuted=()=>{const t=select$1(this.el).select(".node.activity"),e=this.graph.node(t.data()).activity;this.selectedActivities[e.activityId]=e,this.activitySelected.emit(e)},this.getLayoutDirection=()=>{switch(this.layoutDirection){case LayoutDirection.BottomTop:return"BT";case LayoutDirection.LeftRight:return"LR";case LayoutDirection.RightLeft:return"RL";case LayoutDirection.TopBottom:default:return"TB"}}}handleContextMenuChange(t){this.ignoreCopyPasteActivities=!0,this.activityContextMenuState=t,this.activityContextMenuButtonClicked.emit(t)}handleConnectionContextMenuChange(t){this.connectionContextMenuState=t,this.connectionContextMenuButtonClicked.emit(t)}handleContextMenuTestChange(t){this.ignoreCopyPasteActivities=!0,this.activityContextMenuTestState=t,this.activityContextMenuButtonTestClicked.emit(t)}handleModelChanged(t){this.updateWorkflowModel(t,!1)}handleSelectedActivityIdsChanged(t){const e=t||[],n=this.workflowModel.activities.filter((t=>e.includes(t.activityId))),r={};for(const t of n)r[t.activityId]=t;this.selectedActivities=r,select$1(this.el).selectAll(".node.activity").each((t=>{select$1(this.graph.node(t).elem).select("div.activity").classed("elsa-border-blue-600",e.includes(t)).classed("elsa-border-gray-200",!e.includes(t))}))}handleActivityContextMenuChanged(t){this.activityContextMenuState=t}handleConnectionContextMenuChanged(t){this.connectionContextMenuState=t}handleActivityContextMenuTestChanged(t){this.activityContextMenuTestState=t}async removeActivity(t){this.removeActivityInternal(t)}async removeSelectedActivities(){let t=Object.assign({},this.workflowModel);Object.keys(this.selectedActivities).forEach((e=>{t=this.removeActivityInternal(this.selectedActivities[e],t)})),this.updateWorkflowModel(t)}async showActivityEditor(t,e){await this.showActivityEditorInternal(t,e)}async addActivitiesFromClipboard(t){let e;this.parentActivityId=null,this.parentActivityOutcome=null;for(const t in this.selectedActivities)e=this.selectedActivities[t].activityId;null!=e&&(this.parentActivityId=e,this.parentActivityOutcome=this.selectedActivities[e].outcomes[0]);for(const e in t)this.addingActivity=!0,t[e].activityId=v4(),await eventBus.emit(EventTypes.UpdateActivity,this,t[e]),this.parentActivityId=t[e].activityId,this.parentActivityOutcome=t[e].outcomes[0];this.selectedActivities={},this.parentActivityId=null,this.parentActivityOutcome=null}connectedCallback(){eventBus.on(EventTypes.ActivityPicked,this.onActivityPicked),eventBus.on(EventTypes.UpdateActivity,this.onUpdateActivity),eventBus.on(EventTypes.WorkflowExecuted,this.onWorkflowExecuted)}disconnectedCallback(){eventBus.detach(EventTypes.ActivityPicked,this.onActivityPicked),eventBus.detach(EventTypes.UpdateActivity,this.onUpdateActivity),eventBus.detach(EventTypes.WorkflowExecuted,this.onWorkflowExecuted),selectAll$1(".node").on("click",null),selectAll$1(".edgePath").on("contextmenu",null)}componentWillLoad(){this.workflowModel=this.model}componentDidLoad(){this.svgD3Selected=select$1(this.svg),this.innerD3Selected=select$1(this.inner),this.safeRender()}safeRender(){if(!this.svgD3Selected)return;const t=this.el.getBoundingClientRect();if(0===t.height||0===t.width){const t=new ResizeObserver((e=>{for(let n of e){const e=n.contentRect;e.height>0&&e.width>0&&(this.renderTree(),t.unobserve(n.target))}}));t.observe(this.el)}else this.renderTree()}async componentWillRender(){if(this.activityDisplayContexts)return;const t=this.workflowModel.activities,e={};for(const n of t)e[n.activityId]=await this.getActivityDisplayContext(n);this.activityDisplayContexts=e,this.safeRender()}async getActivityDisplayContext(t){let e=state.activityDescriptors.find((e=>e.type==t.type)),n=!!e;const r=this.oldActivityDisplayContexts&&this.oldActivityDisplayContexts[t.activityId]||{expanded:!1};n||(e=this.createNotFoundActivityDescriptor(t));const i=n?t.description:`(Not Found) ${n}`,o=i&&i.length>0?i:void 0,s=o?`<p>${o}</p>`:void 0,a=(e.traits&=ActivityTraits.Trigger)==ActivityTraits.Trigger?"rose":"sky",l=n?t.displayName:`(Not Found) ${t.displayName}`,c={activityModel:t,activityDescriptor:e,activityIcon:h(ActivityIcon,{color:a}),bodyDisplay:s,displayName:l,outcomes:[...t.outcomes],expanded:r.expanded};return await eventBus.emit(EventTypes.ActivityDesignDisplaying,this,c),c}createNotFoundActivityDescriptor(t){return{outcomes:["Done"],inputProperties:[],type:`(Not Found) ${t.type}`,outputProperties:[],displayName:`(Not Found) ${t.displayName||t.name||t.type}`,traits:ActivityTraits.Action,description:`(Not Found) ${t.description}`,category:"Not Found",browsable:!1,customAttributes:{}}}async showActivityEditorInternal(t,e){await eventBus.emit(EventTypes.ActivityEditor.Show,this,t,e)}updateWorkflowModel(t,e=!0){this.workflowModel=this.cleanWorkflowModel(t),this.oldActivityDisplayContexts=this.activityDisplayContexts,this.activityDisplayContexts=null,e&&this.workflowChanged.emit(t)}cleanWorkflowModel(t){const e=t.activities.map((t=>t.activityId)),n=(r=e.reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:(t[e]||0)+1})),{}),Object.keys(r).filter((t=>r[t]>1)));var r;if(n.length>0)throw console.error(n),Error("Found duplicate activities. Throwing for now until we find the root cause.");return t.connections=t.connections.filter((e=>{const n=e.sourceId,r=e.targetId,i=null!=t.activities.findIndex((t=>t.activityId==n)),o=null!=t.activities.findIndex((t=>t.activityId==r));return i||(e.sourceId=null),o||(e.targetId=null),!!e.sourceId||!!e.targetId})),t}removeActivityInternal(t,e){let n=e||Object.assign({},this.workflowModel);const r=getInboundConnections(n,t.activityId),i=getOutboundConnections(n,t.activityId);if(n=removeActivity(n,t.activityId),i.length>0&&r.length>0)for(const t of r){const e=findActivity(n,t.sourceId);let r=i.find((e=>e.outcome===t.outcome));r||(r=i[0]),r&&(n=addConnection(n,{sourceId:e.activityId,targetId:r.targetId,outcome:t.outcome}))}return delete this.selectedActivities[t.activityId],e||this.updateWorkflowModel(n),n}newActivity(t){const e={activityId:v4(),type:t.type,outcomes:t.outcomes,displayName:t.displayName,properties:[],propertyStorageProviders:{}};for(const n of t.inputProperties)e.properties[n.name]={syntax:"",expression:""};return e}async addActivity(t,e,n,r){r=r||"Done";const i=Object.assign(Object.assign({},this.workflowModel),{activities:[...this.workflowModel.activities,t]}),o=await this.getActivityDisplayContext(t);if(n){const e=i.connections.find((t=>t.targetId==n&&t.outcome==r));if(e){i.connections=i.connections.filter((t=>t!=e));const n=Object.assign(Object.assign({},e),{sourceId:t.activityId});i.connections.push(n)}else i.connections.push({sourceId:t.activityId,targetId:n,outcome:r})}if(null!=e){const n=i.connections.find((t=>t.sourceId==e&&t.outcome==r));null!=n?(i.connections=i.connections.filter((t=>t!=n)),i.connections.push({sourceId:n.sourceId,targetId:t.activityId,outcome:n.outcome}),i.connections.push({sourceId:t.activityId,targetId:n.targetId,outcome:o.outcomes[0]})):i.connections.push({sourceId:e,targetId:t.activityId,outcome:r})}this.updateWorkflowModel(i),this.parentActivityId=null,this.parentActivityOutcome=null}getRootActivities(){return getChildActivities(this.workflowModel,null)}addConnection(t,e,n){const r=Object.assign({},this.workflowModel),i={sourceId:t,targetId:e,outcome:n};let o=r.connections;this.enableMultipleConnectionsFromSingleSource||(o=[...r.connections.filter((e=>!(e.sourceId===t&&e.outcome===n)))]),r.connections=[...o,i],this.updateWorkflowModel(r),this.parentActivityId=null,this.parentActivityOutcome=null}updateActivity(t){let e=Object.assign({},this.workflowModel);const n=[...e.activities],r=n.findIndex((e=>e.activityId===t.activityId));n[r]=t,this.updateWorkflowModel(Object.assign(Object.assign({},e),{activities:n}))}async showActivityPicker(){await eventBus.emit(EventTypes.ShowActivityPicker)}removeConnection(t,e){let n=Object.assign({},this.workflowModel);n=removeConnection(n,t,e),this.updateWorkflowModel(n)}applyZoom(){this.zoom=zoom$1().on("zoom",(t=>{const{transform:e}=t;this.innerD3Selected.attr("transform",e),this.zoomParams={x:e.x,y:e.y,scale:e.k,initialZoom:this.zoomParams.initialZoom},/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&selectAll$1("g.label > * > * > div, g.label > * > div").style("transform",`scale(${e.k})`)})),this.svgD3Selected.call(this.zoom)}applyInitialZoom(){const{width:t}=this.svgD3Selected.node().getBBox(),e=this.svgD3Selected.node().clientWidth/2,n=select$1(".node.start").attr("transform"),r=e-(t-(t-parseInt(n.replace(/translate|((\)|\())/g,"").split(",")[0])));this.zoom.scaleTo(this.svgD3Selected,1),this.zoom.translateTo(this.svgD3Selected,r,50),this.svgD3Selected.call(this.zoom.transform,identity$b.scale(1).translate(r,50)),this.zoomParams.initialZoom=!1}setEntities(){this.graph=(new dagreD3.graphlib.Graph).setGraph({ranksep:30}),this.graph.graph().rankdir=this.getLayoutDirection();const t=this.getRootActivities();this.graph.setNode("start",{shape:"rect",label:this.mode==WorkflowDesignerMode.Edit?'<button class="elsa-px-6 elsa-py-3 elsa-border elsa-border-transparent elsa-text-base elsa-leading-6 elsa-font-medium elsa-rounded-md elsa-text-white elsa-bg-green-600 hover:elsa-bg-green-500 focus:elsa-outline-none focus:elsa-border-green-700 focus:elsa-shadow-outline-green active:elsa-bg-green-700 elsa-transition elsa-ease-in-out elsa-duration-150">Start</button>':'<button class="elsa-px-6 elsa-py-3 elsa-border elsa-border-transparent elsa-text-base elsa-leading-6 elsa-font-medium elsa-rounded-md elsa-text-white elsa-bg-green-600 focus:elsa-outline-none elsa-cursor-default">Start</button>',rx:5,ry:5,labelType:"html",class:"start"}),t.forEach((t=>{this.graph.setEdge("start",`${t.activityId}/start`,{arrowhead:"undirected"}),this.graph.setNode(`${t.activityId}/start`,{shape:"rect",activity:t,label:this.renderOutcomeButton(),labelType:"html",class:"add"}),this.graph.setEdge(`${t.activityId}/start`,t.activityId,{arrowhead:"undirected"})}));const e=this.activityDisplayContexts||{};this.workflowModel.activities.forEach((t=>{this.graph.setNode(t.activityId,this.createActivityOptions(t));const n=e[t.activityId]||void 0;(n?n.outcomes:t.outcomes||[]).forEach((e=>{this.graph.setNode(`${t.activityId}/${e}`,{shape:"rect",outcome:e,activity:t,label:this.renderOutcomeButton(),labelType:"html",class:"add"}),this.graph.setEdge(t.activityId,`${t.activityId}/${e}`,{label:`<p class="elsa-outcome elsa-mb-4 elsa-relative elsa-z-10 elsa-px-2.5 elsa-py-0.5 elsa-rounded-full elsa-text-xs elsa-font-medium elsa-leading-4 elsa-bg-gray-100 elsa-text-gray-800 elsa-capitalize elsa-cursor-default">${e}</p>`,labelpos:"c",labelType:"html",arrowhead:"undirected"})}))})),this.workflowModel.connections.forEach((({sourceId:t,targetId:e,outcome:n})=>{const r=`${t}/${n}`;this.graph.hasNode(r)?this.graph.setEdge(r,e,{arrowhead:"undirected"}):console.warn(`No source node with ID '${r}' exists.`)}))}renderNodes(){const t=this.innerD3Selected.attr("transform"),e=this.zoomParams.scale,n=select$1(this.el);this.svgD3Selected.call(this.zoom.scaleTo,1),this.dagreD3Renderer(this.innerD3Selected,this.graph),this.svgD3Selected.call(this.zoom.scaleTo,e),this.innerD3Selected.attr("transform",t),!0===this.zoomParams.initialZoom&&this.applyInitialZoom(),this.mode==WorkflowDesignerMode.Edit&&(n.selectAll(".node.add").each((t=>{const e=this.graph.node(t);select$1(e.elem).on("click",(async t=>{t.preventDefault(),n.selectAll(".node.add svg").classed("elsa-text-green-400",!1).classed("elsa-text-gray-400",!0).classed("hover:elsa-text-blue-500",!0),this.parentActivityId=e.activity.activityId,this.parentActivityOutcome=e.outcome,t.shiftKey?select$1(e.elem).select("svg").classed("elsa-text-green-400",!0).classed("elsa-text-gray-400",!1).classed("hover:elsa-text-blue-500",!1):this.mode!==WorkflowDesignerMode.Test&&await this.showActivityPicker()})).on("mouseover",(t=>{t.shiftKey&&select$1(e.elem).select("svg").classed("elsa-text-green-400",!0).classed("hover:elsa-text-blue-500",!1)})).on("mouseout",(()=>{select$1(e.elem).select("svg").classed("elsa-text-green-400",!1).classed("hover:elsa-text-blue-500",!0)})).on("contextmenu",(t=>{t.preventDefault(),t.stopPropagation(),this.parentActivityId=e.activity.activityId,this.parentActivityOutcome=e.outcome,this.handleConnectionContextMenuChange({x:t.clientX,y:t.clientY,shown:!0,activity:e.activity})}))})),n.selectAll(".node.start").each((t=>{select$1(this.graph.node(t).elem).on("click",(async()=>{this.mode!=WorkflowDesignerMode.Test&&await this.showActivityPicker()}))})),n.selectAll(".edgePath").append((function(){const t=this.querySelector(".path").getAttribute("d"),e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttribute("d",t),this.appendChild(e)})).attr("class","label-clickable"),n.selectAll(".edgePath").each((t=>{select$1(this.graph.edge(t).elem).on("contextmenu",(e=>{e.preventDefault();const n=t.v.split("/"),r=t.w.split("/");this.removeConnection(n[0],n[1]||r[1])}))}))),n.selectAll(".node.activity").each((t=>{const e=this.graph.node(t),n=e.activity,r=n.activityId;select$1(e.elem).select(".expand").on("click",(()=>{const t=this.activityDisplayContexts[r];t&&(t.expanded=!t.expanded,this.safeRender())})),select$1(e.elem).on("click",(t=>{if(this.mode==WorkflowDesignerMode.Edit&&this.parentActivityId&&this.parentActivityOutcome)this.addConnection(this.parentActivityId,r,this.parentActivityOutcome);else if(t.shiftKey)this.selectedActivities[r]?delete this.selectedActivities[r]:(this.selectedActivities[r]=n,this.activitySelected.emit(n));else if(this.selectedActivities[r])delete this.selectedActivities[r];else{for(const t in this.selectedActivities)this.activityDeselected.emit(this.selectedActivities[t]);this.selectedActivities={},this.selectedActivities[r]=n,this.activitySelected.emit(n)}})).on("dblclick",(async t=>{if(t.stopPropagation(),this.mode==WorkflowDesignerMode.Edit&&(await this.showActivityEditor(n,!0),!this.selectedActivities[r])){for(const t in this.selectedActivities)this.activityDeselected.emit(this.selectedActivities[t]);this.selectedActivities={},this.selectedActivities[r]=n,this.activitySelected.emit(n)}})),this.mode==WorkflowDesignerMode.Edit||this.mode==WorkflowDesignerMode.Instance?select$1(e.elem).select(".context-menu-button-container button").on("click",(t=>{t.stopPropagation(),this.handleContextMenuChange({x:t.clientX,y:t.clientY,shown:!0,activity:e.activity,selectedActivities:this.selectedActivities})})):this.mode==WorkflowDesignerMode.Test&&select$1(e.elem).select(".context-menu-button-container button").on("click",(t=>{t.stopPropagation(),this.handleContextMenuTestChange({x:t.clientX,y:t.clientY,shown:!0,activity:e.activity})}))}))}renderTree(){this.applyZoom(),this.setEntities(),this.renderNodes()}createActivityOptions(t){return{shape:"rect",label:this.renderActivity(t),rx:5,ry:5,labelType:"html",class:"activity",activity:t}}createOutcomeActivityOptions(){return{shape:"circle",label:this.renderOutcomeButton(),labelType:"html",class:"add",width:32,height:32}}renderOutcomeButton(){return`<svg class="elsa-h-8 elsa-w-8 elsa-text-gray-400 ${this.mode==WorkflowDesignerMode.Edit?"hover:elsa-text-blue-500 elsa-cursor-pointer":"elsa-cursor-default"}" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />\n      </svg>`}renderActivity(t){const e=(this.activityDisplayContexts||{})[t.activityId]||void 0,n=this.activityContextMenuButton?this.activityContextMenuButton(t):"",r=this.activityBorderColor?this.activityBorderColor(t):"gray",i=this.activityBorderColor?r:"blue",o=null!=e?e.displayName:t.displayName,s=t.type,a=e&&e.expanded;return`<div id=activity-${t.activityId}\n    class="activity elsa-border-2 elsa-border-solid elsa-rounded elsa-bg-white elsa-text-left elsa-text-black elsa-text-lg elsa-select-none elsa-max-w-md elsa-shadow-sm elsa-relative ${this.selectedActivities[t.activityId]?`elsa-border-${i}-600`:`elsa-border-${r}-200 hover:elsa-border-${i}-600`}">\n      <div class="elsa-p-3">\n        <div class="elsa-flex elsa-justify-between elsa-space-x-4">\n          <div class="elsa-flex-shrink-0">\n          ${(null==e?void 0:e.activityIcon)||""}\n          </div>\n          <div class="elsa-flex-1 elsa-font-medium elsa-leading-8 elsa-overflow-hidden">\n            <p class="elsa-overflow-ellipsis elsa-text-base">${o}</p>\n            ${s!==o?`<p class="elsa-text-gray-400 elsa-text-sm">${s}</p>`:""}\n          </div>\n          <div class="elsa--mt-2">\n            <div class="context-menu-button-container">\n              ${n}\n            </div>\n            <button type="button" class="expand elsa-ml-1 elsa-text-gray-400 elsa-rounded-full elsa-bg-transparent hover:elsa-text-gray-500 focus:elsa-outline-none focus:elsa-text-gray-500 focus:elsa-bg-gray-100 elsa-transition elsa-ease-in-out elsa-duration-150">\n              ${a?"":'<svg xmlns="http://www.w3.org/2000/svg" class="elsa-w-6 elsa-h-6 elsa-text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />\n              </svg>'}\n              ${a?'<svg xmlns="http://www.w3.org/2000/svg" class="elsa-h-6 elsa-w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />\n              </svg>':""}\n            </button>\n          </div>\n        </div>\n        ${this.renderActivityBody(e)}\n        </div>\n      </div>\n      </div>`}renderActivityBody(t){return t&&t.expanded?`<div class="elsa-border-t elsa-border-t-solid">\n          <div class="elsa-p-4 elsa-text-gray-400 elsa-text-sm">\n            <div class="elsa-mb-2">${(null==t?void 0:t.bodyDisplay)?t.bodyDisplay:""}</div>\n            <div>\n              <span class="elsa-inline-flex elsa-items-center elsa-px-2.5 elsa-py-0.5 elsa-rounded-full elsa-text-xs elsa-font-medium elsa-bg-gray-100 elsa-text-gray-500">\n                <svg class="-elsa-ml-0.5 elsa-mr-1.5 elsa-h-2 elsa-w-2 elsa-text-gray-400" fill="currentColor" viewBox="0 0 8 8">\n                  <circle cx="4" cy="4" r="3" />\n                </svg>\n                ${null!=t?t.activityModel.activityId:""}\n              </span>\n            </div>\n          </div>\n      </div>`:""}render(){return h(Host,{class:"workflow-canvas elsa-flex-1 elsa-flex",ref:t=>this.el=t},this.mode==WorkflowDesignerMode.Test?h("div",null,h("div",{id:"left",style:{border:"4px solid orange",position:"fixed",height:"calc(100vh - 64px)",width:"4px",top:"64",bottom:"0",left:"0"}}),h("div",{id:"right",style:{border:"4px solid orange",position:"fixed",height:"calc(100vh - 64px)",width:"4px",top:"64",bottom:"0",right:"0"}}),h("div",{id:"top",style:{border:"4px solid orange",position:"fixed",height:"4px",left:"0",right:"0",top:"30"}}),h("div",{id:"bottom",style:{border:"4px solid orange",position:"fixed",height:"4px",left:"0",right:"0",bottom:"0"}})):void 0,h("svg",{ref:t=>this.svg=t,id:"svg",style:{height:"calc(100vh - 64px)",width:"100%",pointerEvents:this.activityContextMenuState.shown?"none":""}},h("g",{ref:t=>this.inner=t})))}static get assetsDirs(){return["assets"]}static get watchers(){return{model:["handleModelChanged"],selectedActivityIds:["handleSelectedActivityIdsChanged"],activityContextMenu:["handleActivityContextMenuChanged"],connectionContextMenu:["handleConnectionContextMenuChanged"],activityContextTestMenu:["handleActivityContextMenuTestChanged"]}}};ElsaWorkflowDesigner$1.style=elsaDesignerTreeCss;let ElsaWorkflowEditorNotifications=class{constructor(t){registerInstance(this,t),this.onWorkflowPublished=t=>toastNotificationService.show("Workflow Published",`Workflow successfully published at version ${t.version}.`,1500),this.onWorkflowRetracted=t=>toastNotificationService.show("Workflow Retracted",`Workflow successfully retracted at version ${t.version}.`,1500),this.onWorkflowImported=()=>toastNotificationService.show("Workflow Imported","Workflow successfully imported.",1500),this.onClipboardPermissionsDenied=()=>toastNotificationService.show("Clipboard Error","Clipboard pemission denied.",1500),this.onClipboardCopied=(t,e)=>{toastNotificationService.show(t||"Copy to Clipboard",e||"Activities successfully copied to Clipboard.",1500)}}connectedCallback(){eventBus.on(EventTypes.WorkflowPublished,this.onWorkflowPublished),eventBus.on(EventTypes.WorkflowRetracted,this.onWorkflowRetracted),eventBus.on(EventTypes.WorkflowImported,this.onWorkflowImported),eventBus.on(EventTypes.ClipboardPermissionDenied,this.onClipboardPermissionsDenied),eventBus.on(EventTypes.ClipboardCopied,this.onClipboardCopied)}disconnectedCallback(){eventBus.detach(EventTypes.WorkflowPublished,this.onWorkflowPublished),eventBus.detach(EventTypes.WorkflowRetracted,this.onWorkflowRetracted),eventBus.detach(EventTypes.WorkflowImported,this.onWorkflowImported),eventBus.detach(EventTypes.ClipboardPermissionDenied,this.onClipboardPermissionsDenied),eventBus.detach(EventTypes.ClipboardCopied,this.onClipboardCopied)}},ElsaWorkflowFaultInformation=class{constructor(t){registerInstance(this,t)}render(){if(!this.workflowFault)return;const t=e=>h("div",null,h("div",{class:"elsa-mb-4"},h("strong",{class:"elsa-block elsa-font-bold"},e.type),e.message),e.innerException?h("div",{class:"elsa-ml-4"},t(e.innerException)):void 0);return[h("div",{class:"-elsa-m-3 elsa-p-3 elsa-flex elsa-items-start elsa-rounded-lg hover:elsa-bg-gray-50 elsa-transition elsa-ease-in-out elsa-duration-150"},h("svg",{class:"elsa-flex-shrink-0 elsa-h-6 elsa-w-6 elsa-text-red-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},h("circle",{cx:"12",cy:"12",r:"10"}),h("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),h("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})),h("div",{class:"elsa-ml-4"},h("p",{class:"elsa-text-base elsa-font-medium elsa-text-gray-900"},"Fault"),h("p",{class:"elsa-mt-1 elsa-text-sm elsa-text-gray-500"},t(this.workflowFault.exception),h("pre",{class:"elsa-overflow-x-scroll elsa-max-w-md",onClick:t=>clip$1(t.currentTarget)},JSON.stringify(this.workflowFault,null,1))))),h("a",{href:"#",class:"-elsa-m-3 elsa-p-3 elsa-flex elsa-items-start elsa-rounded-lg hover:elsa-bg-gray-50 elsa-transition elsa-ease-in-out elsa-duration-150"},h("svg",{class:"elsa-flex-shrink-0 elsa-h-6 elsa-w-6 elsa-text-blue-600",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},h("path",{stroke:"none",d:"M0 0h24v24H0z"}),h("rect",{x:"4",y:"5",width:"16",height:"16",rx:"2"}),h("line",{x1:"16",y1:"3",x2:"16",y2:"7"}),h("line",{x1:"8",y1:"3",x2:"8",y2:"7"}),h("line",{x1:"4",y1:"11",x2:"20",y2:"11"}),h("line",{x1:"11",y1:"15",x2:"12",y2:"15"}),h("line",{x1:"12",y1:"15",x2:"12",y2:"18"})),h("div",{class:"elsa-ml-4"},h("p",{class:"elsa-text-base elsa-font-medium elsa-text-gray-900"},"Faulted At"),h("p",{class:"elsa-mt-1 elsa-text-sm elsa-text-gray-500"},hooks(this.faultedAt).format("DD-MM-YYYY HH:mm:ss"))))]}},ElsaWorkflowPerformanceInformation=class{constructor(t){registerInstance(this,t)}render(){if(this.activityStats)return[h("a",{href:"#",class:"-elsa-m-3 elsa-p-3 elsa-flex elsa-items-start elsa-rounded-lg hover:elsa-bg-gray-50 elsa-transition elsa-ease-in-out elsa-duration-150"},h("svg",{class:"elsa-flex-shrink-0 elsa-h-6 elsa-w-6 elsa-text-blue-600",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},h("path",{stroke:"none",d:"M0 0h24v24H0z"}),h("rect",{x:"4",y:"5",width:"16",height:"16",rx:"2"}),h("line",{x1:"16",y1:"3",x2:"16",y2:"7"}),h("line",{x1:"8",y1:"3",x2:"8",y2:"7"}),h("line",{x1:"4",y1:"11",x2:"20",y2:"11"}),h("line",{x1:"11",y1:"15",x2:"12",y2:"15"}),h("line",{x1:"12",y1:"15",x2:"12",y2:"18"})),h("div",{class:"elsa-ml-4"},h("p",{class:"elsa-text-base elsa-font-medium elsa-text-gray-900"},"Average Execution Time"),h("p",{class:"elsa-mt-1 elsa-text-sm elsa-text-gray-500"},durationToString(hooks.duration(this.activityStats.averageExecutionTime))))),h("a",{href:"#",class:"-m-3 elsa-p-3 elsa-flex elsa-items-start elsa-rounded-lg hover:elsa-bg-gray-50 elsa-transition elsa-ease-in-out elsa-duration-150"},h("svg",{class:"elsa-flex-shrink-0 elsa-h-6 elsa-w-6 elsa-text-green-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},h("path",{stroke:"none",d:"M0 0h24v24H0z"}),h("circle",{cx:"12",cy:"12",r:"9"}),h("polyline",{points:"12 7 12 12 15 15"})),h("div",{class:"elsa-ml-4"},h("p",{class:"elsa-text-base elsa-font-medium elsa-text-gray-900"},"Fastest Execution Time"),h("p",{class:"elsa-mt-1 elsa-text-sm elsa-text-gray-500"},durationToString(hooks.duration(this.activityStats.fastestExecutionTime))))),h("a",{href:"#",class:"-elsa-m-3 elsa-p-3 elsa-flex elsa-items-start elsa-rounded-lg hover:elsa-bg-gray-50 elsa-transition elsa-ease-in-out elsa-duration-150"},h("svg",{class:"elsa-flex-shrink-0 elsa-h-6 elsa-w-6 elsa-text-yellow-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},h("path",{stroke:"none",d:"M0 0h24v24H0z"}),h("circle",{cx:"12",cy:"12",r:"9"}),h("polyline",{points:"12 7 12 12 15 15"})),h("div",{class:"elsa-ml-4"},h("p",{class:"elsa-text-base elsa-font-medium elsa-text-gray-900"},"Slowest Execution Time"),h("p",{class:"elsa-mt-1 elsa-text-sm elsa-text-gray-500"},durationToString(hooks.duration(this.activityStats.slowestExecutionTime))))),h("a",{href:"#",class:"-elsa-m-3 elsa-p-3 elsa-flex elsa-items-start elsa-rounded-lg hover:elsa-bg-gray-50 elsa-transition elsa-ease-in-out elsa-duration-150"},h("svg",{class:"elsa-flex-shrink-0 elsa-h-6 elsa-w-6 elsa-text-blue-600",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},h("path",{stroke:"none",d:"M0 0h24v24H0z"}),h("rect",{x:"4",y:"5",width:"16",height:"16",rx:"2"}),h("line",{x1:"16",y1:"3",x2:"16",y2:"7"}),h("line",{x1:"8",y1:"3",x2:"8",y2:"7"}),h("line",{x1:"4",y1:"11",x2:"20",y2:"11"}),h("line",{x1:"11",y1:"15",x2:"12",y2:"15"}),h("line",{x1:"12",y1:"15",x2:"12",y2:"18"})),h("div",{class:"elsa-ml-4"},h("p",{class:"elsa-text-base elsa-font-medium elsa-text-gray-900"},"Last Executed At"),h("p",{class:"elsa-mt-1 elsa-text-sm elsa-text-gray-500"},hooks(this.activityStats.lastExecutedAt).format("DD-MM-YYYY HH:mm:ss"))))]}};var jquery=createCommonjsModule((function(t){var e,n;e="undefined"!=typeof window?window:commonjsGlobal,n=function(t,e){var n=[],r=Object.getPrototypeOf,i=n.slice,o=n.flat?function(t){return n.flat.call(t)}:function(t){return n.concat.apply([],t)},s=n.push,a=n.indexOf,l={},c=l.toString,u=l.hasOwnProperty,h=u.toString,d=h.call(Object),f={},p=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},g=function(t){return null!=t&&t===t.window},m=t.document,A={type:!0,src:!0,nonce:!0,noModule:!0};function y(t,e,n){var r,i,o=(n=n||m).createElement("script");if(o.text=t,e)for(r in A)(i=e[r]||e.getAttribute&&e.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function v(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t}var b="3.6.1",x=function(t,e){return new x.fn.init(t,e)};function w(t){var e=!!t&&"length"in t&&t.length,n=v(t);return!p(t)&&!g(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}x.fn=x.prototype={jquery:b,constructor:x,length:0,toArray:function(){return i.call(this)},get:function(t){return null==t?i.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=x.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return x.each(this,t)},map:function(t){return this.pushStack(x.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(x.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},x.extend=x.fn.extend=function(){var t,e,n,r,i,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||p(s)||(s={}),a===l&&(s=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)r=t[e],"__proto__"!==e&&s!==r&&(c&&r&&(x.isPlainObject(r)||(i=Array.isArray(r)))?(n=s[e],o=i&&!Array.isArray(n)?[]:i||x.isPlainObject(n)?n:{},i=!1,s[e]=x.extend(c,o,r)):void 0!==r&&(s[e]=r));return s},x.extend({expando:"jQuery"+(b+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==c.call(t)||(e=r(t))&&("function"!=typeof(n=u.call(e,"constructor")&&e.constructor)||h.call(n)!==d))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){y(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,r=0;if(w(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(w(Object(t))?x.merge(n,"string"==typeof t?[t]:t):s.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:a.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,s=!n;i<o;i++)!e(t[i],i)!==s&&r.push(t[i]);return r},map:function(t,e,n){var r,i,s=0,a=[];if(w(t))for(r=t.length;s<r;s++)null!=(i=e(t[s],s,n))&&a.push(i);else for(s in t)null!=(i=e(t[s],s,n))&&a.push(i);return o(a)},guid:1,support:f}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=n[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var C=function(t){var e,n,r,i,o,s,a,l,c,u,h,d,f,p,g,m,A,y,v,b="sizzle"+1*new Date,x=t.document,w=0,C=0,$=lt(),_=lt(),P=lt(),S=lt(),M=function(t,e){return t===e&&(h=!0),0},E={}.hasOwnProperty,T=[],k=T.pop,O=T.push,N=T.push,R=T.slice,L=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},D="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",F="\\[[\\x20\\t\\r\\n\\f]*("+I+")(?:"+j+"*([*^$|!~]?=)"+j+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+j+"*\\]",B=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",z=new RegExp(j+"+","g"),G=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),V=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),W=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),H=new RegExp(j+"|>"),U=new RegExp(B),q=new RegExp("^"+I+"$"),Y={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+D+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},rt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,it=function(t,e){return e?"\0"===t?"":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){d()},st=bt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{N.apply(T=R.call(x.childNodes),x.childNodes)}catch(t){N={apply:T.length?function(t,e){O.apply(t,R.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function at(t,e,r,i){var o,a,c,u,h,p,A,y=e&&e.ownerDocument,x=e?e.nodeType:9;if(r=r||[],"string"!=typeof t||!t||1!==x&&9!==x&&11!==x)return r;if(!i&&(d(e),e=e||f,g)){if(11!==x&&(h=Q.exec(t)))if(o=h[1]){if(9===x){if(!(c=e.getElementById(o)))return r;if(c.id===o)return r.push(c),r}else if(y&&(c=y.getElementById(o))&&v(e,c)&&c.id===o)return r.push(c),r}else{if(h[2])return N.apply(r,e.getElementsByTagName(t)),r;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return N.apply(r,e.getElementsByClassName(o)),r}if(n.qsa&&!S[t+" "]&&(!m||!m.test(t))&&(1!==x||"object"!==e.nodeName.toLowerCase())){if(A=t,y=e,1===x&&(H.test(t)||W.test(t))){for((y=tt.test(t)&&At(e.parentNode)||e)===e&&n.scope||((u=e.getAttribute("id"))?u=u.replace(rt,it):e.setAttribute("id",u=b)),a=(p=s(t)).length;a--;)p[a]=(u?"#"+u:":scope")+" "+vt(p[a]);A=p.join(",")}try{return N.apply(r,y.querySelectorAll(A)),r}catch(e){S(t,!0)}finally{u===b&&e.removeAttribute("id")}}}return l(t.replace(G,"$1"),e,r,i)}function lt(){var t=[];return function e(n,i){return t.push(n+" ")>r.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function ct(t){return t[b]=!0,t}function ut(t){var e=f.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=e}function dt(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ft(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ct((function(e){return e=+e,ct((function(n,r){for(var i,o=t([],n.length,e),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))}))}))}function At(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},o=at.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!X.test(t&&t.namespaceURI||e&&e.nodeName||"HTML")},d=at.setDocument=function(t){var e,i,s=t?t.ownerDocument||t:x;return s!=f&&9===s.nodeType&&s.documentElement?(p=(f=s).documentElement,g=!o(f),x!=f&&(i=f.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",ot,!1):i.attachEvent&&i.attachEvent("onunload",ot)),n.scope=ut((function(t){return p.appendChild(t).appendChild(f.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(f.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Z.test(f.getElementsByClassName),n.getById=ut((function(t){return p.appendChild(t).id=b,!f.getElementsByName||!f.getElementsByName(b).length})),n.getById?(r.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},r.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(r.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},r.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,r,i,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(i=e.getElementsByName(t),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},A=[],m=[],(n.qsa=Z.test(f.querySelectorAll))&&(ut((function(t){var e;p.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+D+")"),t.querySelectorAll("[id~="+b+"-]").length||m.push("~="),(e=f.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=f.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Z.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),A.push("!=",B)})),m=m.length&&new RegExp(m.join("|")),A=A.length&&new RegExp(A.join("|")),e=Z.test(p.compareDocumentPosition),v=e||Z.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},M=e?function(t,e){if(t===e)return h=!0,0;var r=!t.compareDocumentPosition-!e.compareDocumentPosition;return r||(1&(r=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===r?t==f||t.ownerDocument==x&&v(x,t)?-1:e==f||e.ownerDocument==x&&v(x,e)?1:u?L(u,t)-L(u,e):0:4&r?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!i||!o)return t==f?-1:e==f?1:i?-1:o?1:u?L(u,t)-L(u,e):0;if(i===o)return dt(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?dt(s[r],a[r]):s[r]==x?-1:a[r]==x?1:0},f):f},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&g&&!S[e+" "]&&(!A||!A.test(e))&&(!m||!m.test(e)))try{var r=y.call(t,e);if(r||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){S(e,!0)}return at(e,f,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=f&&d(t),v(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=f&&d(t);var i=r.attrHandle[e.toLowerCase()],o=i&&E.call(r.attrHandle,e.toLowerCase())?i(t,e,!g):void 0;return void 0!==o?o:n.attributes||!g?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},at.escape=function(t){return(t+"").replace(rt,it)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,r=[],i=0,o=0;if(h=!n.detectDuplicates,u=!n.sortStable&&t.slice(0),t.sort(M),h){for(;e=t[o++];)e===t[o]&&(i=r.push(o));for(;i--;)t.splice(r[i],1)}return u=null,t},i=at.getText=function(t){var e,n="",r=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=i(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[r++];)n+=i(e);return n},(r=at.selectors={cacheLength:50,createPseudo:ct,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&U.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=$[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+j+"|$)"))&&$(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(r){var i=at.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&i.indexOf(n)>-1:"$="===e?n&&i.slice(-n.length)===n:"~="===e?(" "+i.replace(z," ")+" ").indexOf(n)>-1:"|="===e&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,l){var c,u,h,d,f,p,g=o!==s?"nextSibling":"previousSibling",m=e.parentNode,A=a&&e.nodeName.toLowerCase(),y=!l&&!a,v=!1;if(m){if(o){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===A:1===d.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[s?m.firstChild:m.lastChild],s&&y){for(v=(f=(c=(u=(h=(d=m)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&c[1])&&c[2],d=f&&m.childNodes[f];d=++f&&d&&d[g]||(v=f=0)||p.pop();)if(1===d.nodeType&&++v&&d===e){u[t]=[w,f,v];break}}else if(y&&(v=f=(c=(u=(h=(d=e)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&c[1]),!1===v)for(;(d=++f&&d&&d[g]||(v=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==A:1!==d.nodeType)||!++v||(y&&((u=(h=d[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[w,v]),d!==e)););return(v-=i)===r||v%r==0&&v/r>=0}}},PSEUDO:function(t,e){var n,i=r.pseudos[t]||r.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return i[b]?i(e):i.length>1?(n=[t,t,"",e],r.setFilters.hasOwnProperty(t.toLowerCase())?ct((function(t,n){for(var r,o=i(t,e),s=o.length;s--;)t[r=L(t,o[s])]=!(n[r]=o[s])})):function(t){return i(t,0,n)}):i}},pseudos:{not:ct((function(t){var e=[],n=[],r=a(t.replace(G,"$1"));return r[b]?ct((function(t,e,n,i){for(var o,s=r(t,null,i,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))})):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}})),has:ct((function(t){return function(e){return at(t,e).length>0}})),contains:ct((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||i(e)).indexOf(t)>-1}})),lang:ct((function(t){return q.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!r.pseudos.empty(t)},header:function(t){return J.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var r=n<0?n+e:n>e?e:n;--r>=0;)t.push(r);return t})),gt:mt((function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t}))}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[e]=ft(e);for(e in{submit:!0,reset:!0})r.pseudos[e]=pt(e);function yt(){}function vt(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function bt(t,e,n){var r=e.dir,i=e.next,o=i||r,s=n&&"parentNode"===o,a=C++;return e.first?function(e,n,i){for(;e=e[r];)if(1===e.nodeType||s)return t(e,n,i);return!1}:function(e,n,l){var c,u,h,d=[w,a];if(l){for(;e=e[r];)if((1===e.nodeType||s)&&t(e,n,l))return!0}else for(;e=e[r];)if(1===e.nodeType||s)if(u=(h=e[b]||(e[b]={}))[e.uniqueID]||(h[e.uniqueID]={}),i&&i===e.nodeName.toLowerCase())e=e[r]||e;else{if((c=u[o])&&c[0]===w&&c[1]===a)return d[2]=c[2];if(u[o]=d,d[2]=t(e,n,l))return!0}return!1}}function xt(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function wt(t,e,n,r,i){for(var o,s=[],a=0,l=t.length,c=null!=e;a<l;a++)(o=t[a])&&(n&&!n(o,r,i)||(s.push(o),c&&e.push(a)));return s}function Ct(t,e,n,r,i,o){return r&&!r[b]&&(r=Ct(r)),i&&!i[b]&&(i=Ct(i,o)),ct((function(o,s,a,l){var c,u,h,d=[],f=[],p=s.length,g=o||function(t,e,n){for(var r=0,i=e.length;r<i;r++)at(t,e[r],n);return n}(e||"*",a.nodeType?[a]:a,[]),m=!t||!o&&e?g:wt(g,d,t,a,l),A=n?i||(o?t:p||r)?[]:s:m;if(n&&n(m,A,a,l),r)for(c=wt(A,f),r(c,[],a,l),u=c.length;u--;)(h=c[u])&&(A[f[u]]=!(m[f[u]]=h));if(o){if(i||t){if(i){for(c=[],u=A.length;u--;)(h=A[u])&&c.push(m[u]=h);i(null,A=[],c,l)}for(u=A.length;u--;)(h=A[u])&&(c=i?L(o,h):d[u])>-1&&(o[c]=!(s[c]=h))}}else A=wt(A===s?A.splice(p,A.length):A),i?i(null,s,A,l):N.apply(s,A)}))}function $t(t){for(var e,n,i,o=t.length,s=r.relative[t[0].type],a=s||r.relative[" "],l=s?1:0,u=bt((function(t){return t===e}),a,!0),h=bt((function(t){return L(e,t)>-1}),a,!0),d=[function(t,n,r){var i=!s&&(r||n!==c)||((e=n).nodeType?u(t,n,r):h(t,n,r));return e=null,i}];l<o;l++)if(n=r.relative[t[l].type])d=[bt(xt(d),n)];else{if((n=r.filter[t[l].type].apply(null,t[l].matches))[b]){for(i=++l;i<o&&!r.relative[t[i].type];i++);return Ct(l>1&&xt(d),l>1&&vt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(G,"$1"),n,l<i&&$t(t.slice(l,i)),i<o&&$t(t=t.slice(i)),i<o&&vt(t))}d.push(n)}return xt(d)}return yt.prototype=r.filters=r.pseudos,r.setFilters=new yt,s=at.tokenize=function(t,e){var n,i,o,s,a,l,c,u=_[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],c=r.preFilter;a;){for(s in n&&!(i=V.exec(a))||(i&&(a=a.slice(i[0].length)||a),l.push(o=[])),n=!1,(i=W.exec(a))&&(n=i.shift(),o.push({value:n,type:i[0].replace(G," ")}),a=a.slice(n.length)),r.filter)!(i=Y[s].exec(a))||c[s]&&!(i=c[s](i))||(n=i.shift(),o.push({value:n,type:s,matches:i}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):_(t,l).slice(0)},a=at.compile=function(t,e){var n,i=[],o=[],a=P[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=$t(e[n]))[b]?i.push(a):o.push(a);(a=P(t,function(t,e){var n=e.length>0,i=t.length>0,o=function(o,s,a,l,u){var h,p,m,A=0,y="0",v=o&&[],b=[],x=c,C=o||i&&r.find.TAG("*",u),$=w+=null==x?1:Math.random()||.1,_=C.length;for(u&&(c=s==f||s||u);y!==_&&null!=(h=C[y]);y++){if(i&&h){for(p=0,s||h.ownerDocument==f||(d(h),a=!g);m=t[p++];)if(m(h,s||f,a)){l.push(h);break}u&&(w=$)}n&&((h=!m&&h)&&A--,o&&v.push(h))}if(A+=y,n&&y!==A){for(p=0;m=e[p++];)m(v,b,s,a);if(o){if(A>0)for(;y--;)v[y]||b[y]||(b[y]=k.call(l));b=wt(b)}N.apply(l,b),u&&!o&&b.length>0&&A+e.length>1&&at.uniqueSort(l)}return u&&(w=$,c=x),v};return n?ct(o):o}(o,i))).selector=t}return a},l=at.select=function(t,e,n,i){var o,l,c,u,h,d="function"==typeof t&&t,f=!i&&s(t=d.selector||t);if(n=n||[],1===f.length){if((l=f[0]=f[0].slice(0)).length>2&&"ID"===(c=l[0]).type&&9===e.nodeType&&g&&r.relative[l[1].type]){if(!(e=(r.find.ID(c.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(o=Y.needsContext.test(t)?0:l.length;o--&&!r.relative[u=(c=l[o]).type];)if((h=r.find[u])&&(i=h(c.matches[0].replace(et,nt),tt.test(l[0].type)&&At(e.parentNode)||e))){if(l.splice(o,1),!(t=i.length&&vt(l)))return N.apply(n,i),n;break}}return(d||a(t,f))(i,e,!g,n,!e||tt.test(t)&&At(e.parentNode)||e),n},n.sortStable=b.split("").sort(M).join("")===b,n.detectDuplicates=!!h,d(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(f.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ht(D,(function(t,e,n){var r;if(!n)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null})),at}(t);x.find=C,x.expr=C.selectors,x.expr[":"]=x.expr.pseudos,x.uniqueSort=x.unique=C.uniqueSort,x.text=C.getText,x.isXMLDoc=C.isXML,x.contains=C.contains,x.escapeSelector=C.escape;var $=function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&x(t).is(n))break;r.push(t)}return r},_=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},P=x.expr.match.needsContext;function S(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var M=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function E(t,e,n){return p(e)?x.grep(t,(function(t,r){return!!e.call(t,r,t)!==n})):e.nodeType?x.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?x.grep(t,(function(t){return a.call(e,t)>-1!==n})):x.filter(e,t,n)}x.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?x.find.matchesSelector(r,t)?[r]:[]:x.find.matches(t,x.grep(e,(function(t){return 1===t.nodeType})))},x.fn.extend({find:function(t){var e,n,r=this.length,i=this;if("string"!=typeof t)return this.pushStack(x(t).filter((function(){for(e=0;e<r;e++)if(x.contains(i[e],this))return!0})));for(n=this.pushStack([]),e=0;e<r;e++)x.find(t,i[e],n);return r>1?x.uniqueSort(n):n},filter:function(t){return this.pushStack(E(this,t||[],!1))},not:function(t){return this.pushStack(E(this,t||[],!0))},is:function(t){return!!E(this,"string"==typeof t&&P.test(t)?x(t):t||[],!1).length}});var T,k=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(t,e,n){var r,i;if(!t)return this;if(n=n||T,"string"==typeof t){if(!(r="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:k.exec(t))||!r[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(r[1]){if(x.merge(this,x.parseHTML(r[1],(e=e instanceof x?e[0]:e)&&e.nodeType?e.ownerDocument||e:m,!0)),M.test(r[1])&&x.isPlainObject(e))for(r in e)p(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return(i=m.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):p(t)?void 0!==n.ready?n.ready(t):t(x):x.makeArray(t,this)}).prototype=x.fn,T=x(m);var O=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function R(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}x.fn.extend({has:function(t){var e=x(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(x.contains(this,e[t]))return!0}))},closest:function(t,e){var n,r=0,i=this.length,o=[],s="string"!=typeof t&&x(t);if(!P.test(t))for(;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?x.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?a.call(x(t),this[0]):a.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),x.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return $(t,"parentNode")},parentsUntil:function(t,e,n){return $(t,"parentNode",n)},next:function(t){return R(t,"nextSibling")},prev:function(t){return R(t,"previousSibling")},nextAll:function(t){return $(t,"nextSibling")},prevAll:function(t){return $(t,"previousSibling")},nextUntil:function(t,e,n){return $(t,"nextSibling",n)},prevUntil:function(t,e,n){return $(t,"previousSibling",n)},siblings:function(t){return _((t.parentNode||{}).firstChild,t)},children:function(t){return _(t.firstChild)},contents:function(t){return null!=t.contentDocument&&r(t.contentDocument)?t.contentDocument:(S(t,"template")&&(t=t.content||t),x.merge([],t.childNodes))}},(function(t,e){x.fn[t]=function(n,r){var i=x.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(N[t]||x.uniqueSort(i),O.test(t)&&i.reverse()),this.pushStack(i)}}));var L=/[^\x20\t\r\n\f]+/g;function D(t){return t}function j(t){throw t}function I(t,e,n,r){var i;try{t&&p(i=t.promise)?i.call(t).done(e).fail(n):t&&p(i=t.then)?i.call(t,e,n):e.apply(void 0,[t].slice(r))}catch(t){n.apply(void 0,[t])}}x.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return x.each(t.match(L)||[],(function(t,n){e[n]=!0})),e}(t):x.extend({},t);var e,n,r,i,o=[],s=[],a=-1,l=function(){for(i=i||t.once,r=e=!0;s.length;a=-1)for(n=s.shift();++a<o.length;)!1===o[a].apply(n[0],n[1])&&t.stopOnFalse&&(a=o.length,n=!1);t.memory||(n=!1),e=!1,i&&(o=n?[]:"")},c={add:function(){return o&&(n&&!e&&(a=o.length-1,s.push(n)),function e(n){x.each(n,(function(n,r){p(r)?t.unique&&c.has(r)||o.push(r):r&&r.length&&"string"!==v(r)&&e(r)}))}(arguments),n&&!e&&l()),this},remove:function(){return x.each(arguments,(function(t,e){for(var n;(n=x.inArray(e,o,n))>-1;)o.splice(n,1),n<=a&&a--})),this},has:function(t){return t?x.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=s=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=s=[],n||e||(o=n=""),this},locked:function(){return!!i},fireWith:function(t,n){return i||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},x.extend({Deferred:function(e){var n=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return i.then(null,t)},pipe:function(){var t=arguments;return x.Deferred((function(e){x.each(n,(function(n,r){var i=p(t[r[4]])&&t[r[4]];o[r[1]]((function(){var t=i&&i.apply(this,arguments);t&&p(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[r[0]+"With"](this,i?[t]:arguments)}))})),t=null})).promise()},then:function(e,r,i){var o=0;function s(e,n,r,i){return function(){var a=this,l=arguments,c=function(){var t,c;if(!(e<o)){if((t=r.apply(a,l))===n.promise())throw new TypeError("Thenable self-resolution");p(c=t&&("object"==typeof t||"function"==typeof t)&&t.then)?i?c.call(t,s(o,n,D,i),s(o,n,j,i)):(o++,c.call(t,s(o,n,D,i),s(o,n,j,i),s(o,n,D,n.notifyWith))):(r!==D&&(a=void 0,l=[t]),(i||n.resolveWith)(a,l))}},u=i?c:function(){try{c()}catch(t){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(t,u.stackTrace),e+1>=o&&(r!==j&&(a=void 0,l=[t]),n.rejectWith(a,l))}};e?u():(x.Deferred.getStackHook&&(u.stackTrace=x.Deferred.getStackHook()),t.setTimeout(u))}}return x.Deferred((function(t){n[0][3].add(s(0,t,p(i)?i:D,t.notifyWith)),n[1][3].add(s(0,t,p(e)?e:D)),n[2][3].add(s(0,t,p(r)?r:j))})).promise()},promise:function(t){return null!=t?x.extend(t,i):i}},o={};return x.each(n,(function(t,e){var s=e[2],a=e[5];i[e[1]]=s.add,a&&s.add((function(){r=a}),n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),s.add(e[3].fire),o[e[0]]=function(){return o[e[0]+"With"](this===o?void 0:this,arguments),this},o[e[0]+"With"]=s.fireWith})),i.promise(o),e&&e.call(o,o),o},when:function(t){var e=arguments.length,n=e,r=Array(n),o=i.call(arguments),s=x.Deferred(),a=function(t){return function(n){r[t]=this,o[t]=arguments.length>1?i.call(arguments):n,--e||s.resolveWith(r,o)}};if(e<=1&&(I(t,s.done(a(n)).resolve,s.reject,!e),"pending"===s.state()||p(o[n]&&o[n].then)))return s.then();for(;n--;)I(o[n],a(n),s.reject);return s.promise()}});var F=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&F.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},x.readyException=function(e){t.setTimeout((function(){throw e}))};var B=x.Deferred();function z(){m.removeEventListener("DOMContentLoaded",z),t.removeEventListener("load",z),x.ready()}x.fn.ready=function(t){return B.then(t).catch((function(t){x.readyException(t)})),this},x.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==t&&--x.readyWait>0||B.resolveWith(m,[x]))}}),x.ready.then=B.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?t.setTimeout(x.ready):(m.addEventListener("DOMContentLoaded",z),t.addEventListener("load",z));var G=function(t,e,n,r,i,o,s){var a=0,l=t.length,c=null==n;if("object"===v(n))for(a in i=!0,n)G(t,e,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,p(r)||(s=!0),c&&(s?(e.call(t,r),e=null):(c=e,e=function(t,e,n){return c.call(x(t),n)})),e))for(;a<l;a++)e(t[a],n,s?r:r.call(t[a],a,e(t[a],n)));return i?t:c?e.call(t):l?e(t[0],n):o},V=/^-ms-/,W=/-([a-z])/g;function H(t,e){return e.toUpperCase()}function U(t){return t.replace(V,"ms-").replace(W,H)}var q=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Y(){this.expando=x.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(t){var e=t[this.expando];return e||(e={},q(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[U(e)]=n;else for(r in e)i[U(r)]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][U(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r=t[this.expando];if(void 0!==r){if(void 0!==e){n=(e=Array.isArray(e)?e.map(U):(e=U(e))in r?[e]:e.match(L)||[]).length;for(;n--;)delete r[e[n]]}(void 0===e||x.isEmptyObject(r))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!x.isEmptyObject(e)}};var X=new Y,K=new Y,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function Q(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(Z,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:J.test(t)?JSON.parse(t):t)}(n)}catch(t){}K.set(t,e,n)}else n=void 0;return n}x.extend({hasData:function(t){return K.hasData(t)||X.hasData(t)},data:function(t,e,n){return K.access(t,e,n)},removeData:function(t,e){K.remove(t,e)},_data:function(t,e,n){return X.access(t,e,n)},_removeData:function(t,e){X.remove(t,e)}}),x.fn.extend({data:function(t,e){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(i=K.get(o),1===o.nodeType&&!X.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&0===(r=s[n].name).indexOf("data-")&&(r=U(r.slice(5)),Q(o,r,i[r]));X.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each((function(){K.set(this,t)})):G(this,(function(e){var n;if(o&&void 0===e)return void 0!==(n=K.get(o,t))||void 0!==(n=Q(o,t))?n:void 0;this.each((function(){K.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){K.remove(this,t)}))}}),x.extend({queue:function(t,e,n){var r;if(t)return r=X.get(t,e=(e||"fx")+"queue"),n&&(!r||Array.isArray(n)?r=X.access(t,e,x.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){var n=x.queue(t,e=e||"fx"),r=n.length,i=n.shift(),o=x._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,(function(){x.dequeue(t,e)}),o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return X.get(t,n)||X.access(t,n,{empty:x.Callbacks("once memory").add((function(){X.remove(t,[e+"queue",n])}))})}}),x.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?x.queue(this[0],t):void 0===e?this:this.each((function(){var n=x.queue(this,t,e);x._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&x.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){x.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=X.get(o[s],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],rt=m.documentElement,it=function(t){return x.contains(t.ownerDocument,t)},ot={composed:!0};rt.getRootNode&&(it=function(t){return x.contains(t.ownerDocument,t)||t.getRootNode(ot)===t.ownerDocument});var st=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&it(t)&&"none"===x.css(t,"display")};function at(t,e,n,r){var i,o,s=20,a=r?function(){return r.cur()}:function(){return x.css(t,e,"")},l=a(),c=n&&n[3]||(x.cssNumber[e]?"":"px"),u=t.nodeType&&(x.cssNumber[e]||"px"!==c&&+l)&&et.exec(x.css(t,e));if(u&&u[3]!==c){for(c=c||u[3],u=+(l/=2)||1;s--;)x.style(t,e,u+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),u/=o;x.style(t,e,(u*=2)+c),n=n||[]}return n&&(u=+u||+l||0,i=n[1]?u+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=u,r.end=i)),i}var lt={};function ct(t){var e,n=t.ownerDocument,r=t.nodeName,i=lt[r];return i||(e=n.body.appendChild(n.createElement(r)),i=x.css(e,"display"),e.parentNode.removeChild(e),"none"===i&&(i="block"),lt[r]=i,i)}function ut(t,e){for(var n,r,i=[],o=0,s=t.length;o<s;o++)(r=t[o]).style&&(n=r.style.display,e?("none"===n&&(i[o]=X.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&st(r)&&(i[o]=ct(r))):"none"!==n&&(i[o]="none",X.set(r,"display",n)));for(o=0;o<s;o++)null!=i[o]&&(t[o].style.display=i[o]);return t}x.fn.extend({show:function(){return ut(this,!0)},hide:function(){return ut(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){st(this)?x(this).show():x(this).hide()}))}});var ht,dt,ft=/^(?:checkbox|radio)$/i,pt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,gt=/^$|^module$|\/(?:java|ecma)script/i;ht=m.createDocumentFragment().appendChild(m.createElement("div")),(dt=m.createElement("input")).setAttribute("type","radio"),dt.setAttribute("checked","checked"),dt.setAttribute("name","t"),ht.appendChild(dt),f.checkClone=ht.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!ht.cloneNode(!0).lastChild.defaultValue,ht.innerHTML="<option></option>",f.option=!!ht.lastChild;var mt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function At(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&S(t,e)?x.merge([t],n):n}function yt(t,e){for(var n=0,r=t.length;n<r;n++)X.set(t[n],"globalEval",!e||X.get(e[n],"globalEval"))}mt.tbody=mt.tfoot=mt.colgroup=mt.caption=mt.thead,mt.th=mt.td,f.option||(mt.optgroup=mt.option=[1,"<select multiple='multiple'>","</select>"]);var vt=/<|&#?\w+;/;function bt(t,e,n,r,i){for(var o,s,a,l,c,u,h=e.createDocumentFragment(),d=[],f=0,p=t.length;f<p;f++)if((o=t[f])||0===o)if("object"===v(o))x.merge(d,o.nodeType?[o]:o);else if(vt.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(pt.exec(o)||["",""])[1].toLowerCase(),s.innerHTML=(l=mt[a]||mt._default)[1]+x.htmlPrefilter(o)+l[2],u=l[0];u--;)s=s.lastChild;x.merge(d,s.childNodes),(s=h.firstChild).textContent=""}else d.push(e.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(r&&x.inArray(o,r)>-1)i&&i.push(o);else if(c=it(o),s=At(h.appendChild(o),"script"),c&&yt(s),n)for(u=0;o=s[u++];)gt.test(o.type||"")&&n.push(o);return h}var xt=/^([^.]*)(?:\.(.+)|)/;function wt(){return!0}function Ct(){return!1}function $t(t,e){return t===function(){try{return m.activeElement}catch(t){}}()==("focus"===e)}function _t(t,e,n,r,i,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(r=r||n,n=void 0),e)_t(t,a,n,r,e[a],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ct;else if(!i)return t;return 1===o&&(s=i,(i=function(t){return x().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=x.guid++)),t.each((function(){x.event.add(this,e,i,r,n)}))}function Pt(t,e,n){n?(X.set(t,e,!1),x.event.add(t,e,{namespace:!1,handler:function(t){var r,o,s=X.get(this,e);if(1&t.isTrigger&&this[e]){if(s.length)(x.event.special[e]||{}).delegateType&&t.stopPropagation();else if(s=i.call(arguments),X.set(this,e,s),r=n(this,e),this[e](),s!==(o=X.get(this,e))||r?X.set(this,e,!1):o={},s!==o)return t.stopImmediatePropagation(),t.preventDefault(),o&&o.value}else s.length&&(X.set(this,e,{value:x.event.trigger(x.extend(s[0],x.Event.prototype),s.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===X.get(t,e)&&x.event.add(t,e,wt)}x.event={global:{},add:function(t,e,n,r,i){var o,s,a,l,c,u,h,d,f,p,g,m=X.get(t);if(q(t))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&x.find.matchesSelector(rt,i),n.guid||(n.guid=x.guid++),(l=m.events)||(l=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(e){return void 0!==x&&x.event.triggered!==e.type?x.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(L)||[""]).length;c--;)f=g=(a=xt.exec(e[c])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=x.event.special[f]||{},h=x.event.special[f=(i?h.delegateType:h.bindType)||f]||{},u=x.extend({type:f,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&x.expr.match.needsContext.test(i),namespace:p.join(".")},o),(d=l[f])||((d=l[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,r,p,s)||t.addEventListener&&t.addEventListener(f,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),i?d.splice(d.delegateCount++,0,u):d.push(u),x.event.global[f]=!0)},remove:function(t,e,n,r,i){var o,s,a,l,c,u,h,d,f,p,g,m=X.hasData(t)&&X.get(t);if(m&&(l=m.events)){for(c=(e=(e||"").match(L)||[""]).length;c--;)if(f=g=(a=xt.exec(e[c])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=x.event.special[f]||{},d=l[f=(r?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!i&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||r&&r!==u.selector&&("**"!==r||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));s&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,m.handle)||x.removeEvent(t,f,m.handle),delete l[f])}else for(f in l)x.event.remove(t,f+e[c],n,r,!0);x.isEmptyObject(l)&&X.remove(t,"handle events")}},dispatch:function(t){var e,n,r,i,o,s,a=new Array(arguments.length),l=x.event.fix(t),c=(X.get(this,"events")||Object.create(null))[l.type]||[],u=x.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(s=x.event.handlers.call(this,l,c),e=0;(i=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==o.namespace&&!l.rnamespace.test(o.namespace)||(l.handleObj=o,l.data=o.data,void 0!==(r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a))&&!1===(l.result=r)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,r,i,o,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],s={},n=0;n<l;n++)void 0===s[i=(r=e[n]).selector+" "]&&(s[i]=r.needsContext?x(i,this).index(c)>-1:x.find(i,this,null,[c]).length),s[i]&&o.push(r);o.length&&a.push({elem:c,handlers:o})}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(x.Event.prototype,t,{enumerable:!0,configurable:!0,get:p(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[x.expando]?t:new x.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return ft.test(e.type)&&e.click&&S(e,"input")&&Pt(e,"click",wt),!1},trigger:function(t){var e=this||t;return ft.test(e.type)&&e.click&&S(e,"input")&&Pt(e,"click"),!0},_default:function(t){var e=t.target;return ft.test(e.type)&&e.click&&S(e,"input")&&X.get(e,"click")||S(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},x.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},x.Event=function(t,e){if(!(this instanceof x.Event))return new x.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?wt:Ct,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&x.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:Ct,isPropagationStopped:Ct,isImmediatePropagationStopped:Ct,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=wt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=wt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=wt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},(function(t,e){x.event.special[t]={setup:function(){return Pt(this,t,$t),!1},trigger:function(){return Pt(this,t),!0},_default:function(e){return X.get(e.target,t)},delegateType:e}})),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){x.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=this,i=t.relatedTarget,o=t.handleObj;return i&&(i===r||x.contains(r,i))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),x.fn.extend({on:function(t,e,n,r){return _t(this,t,e,n,r)},one:function(t,e,n,r){return _t(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,x(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Ct),this.each((function(){x.event.remove(this,t,n,e)}))}});var St=/<script|<style|<link/i,Mt=/checked\s*(?:[^=]|=\s*.checked.)/i,Et=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Tt(t,e){return S(t,"table")&&S(11!==e.nodeType?e:e.firstChild,"tr")&&x(t).children("tbody")[0]||t}function kt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ot(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Nt(t,e){var n,r,i,o,s,a;if(1===e.nodeType){if(X.hasData(t)&&(a=X.get(t).events))for(i in X.remove(e,"handle events"),a)for(n=0,r=a[i].length;n<r;n++)x.event.add(e,i,a[i][n]);K.hasData(t)&&(o=K.access(t),s=x.extend({},o),K.set(e,s))}}function Rt(t,e){var n=e.nodeName.toLowerCase();"input"===n&&ft.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Lt(t,e,n,r){e=o(e);var i,s,a,l,c,u,h=0,d=t.length,g=d-1,m=e[0],A=p(m);if(A||d>1&&"string"==typeof m&&!f.checkClone&&Mt.test(m))return t.each((function(i){var o=t.eq(i);A&&(e[0]=m.call(this,i,o.html())),Lt(o,e,n,r)}));if(d&&(s=(i=bt(e,t[0].ownerDocument,!1,t,r)).firstChild,1===i.childNodes.length&&(i=s),s||r)){for(l=(a=x.map(At(i,"script"),kt)).length;h<d;h++)c=i,h!==g&&(c=x.clone(c,!0,!0),l&&x.merge(a,At(c,"script"))),n.call(t[h],c,h);if(l)for(u=a[a.length-1].ownerDocument,x.map(a,Ot),h=0;h<l;h++)gt.test((c=a[h]).type||"")&&!X.access(c,"globalEval")&&x.contains(u,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?x._evalUrl&&!c.noModule&&x._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")},u):y(c.textContent.replace(Et,""),c,u))}return t}function Dt(t,e,n){for(var r,i=e?x.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||x.cleanData(At(r)),r.parentNode&&(n&&it(r)&&yt(At(r,"script")),r.parentNode.removeChild(r));return t}x.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var r,i,o,s,a=t.cloneNode(!0),l=it(t);if(!(f.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||x.isXMLDoc(t)))for(s=At(a),r=0,i=(o=At(t)).length;r<i;r++)Rt(o[r],s[r]);if(e)if(n)for(o=o||At(t),s=s||At(a),r=0,i=o.length;r<i;r++)Nt(o[r],s[r]);else Nt(t,a);return(s=At(a,"script")).length>0&&yt(s,!l&&At(t,"script")),a},cleanData:function(t){for(var e,n,r,i=x.event.special,o=0;void 0!==(n=t[o]);o++)if(q(n)){if(e=n[X.expando]){if(e.events)for(r in e.events)i[r]?x.event.remove(n,r):x.removeEvent(n,r,e.handle);n[X.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),x.fn.extend({detach:function(t){return Dt(this,t,!0)},remove:function(t){return Dt(this,t)},text:function(t){return G(this,(function(t){return void 0===t?x.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Lt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Tt(this,t).appendChild(t)}))},prepend:function(){return Lt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Tt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Lt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Lt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(x.cleanData(At(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return x.clone(this,t,e)}))},html:function(t){return G(this,(function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!St.test(t)&&!mt[(pt.exec(t)||["",""])[1].toLowerCase()]){t=x.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(x.cleanData(At(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Lt(this,arguments,(function(e){var n=this.parentNode;x.inArray(this,t)<0&&(x.cleanData(At(this)),n&&n.replaceChild(e,this))}),t)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){x.fn[t]=function(t){for(var n,r=[],i=x(t),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),x(i[a])[e](n),s.apply(r,n.get());return this.pushStack(r)}}));var jt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),It=/^--/,Ft=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},Bt=function(t,e,n){var r,i,o={};for(i in e)o[i]=t.style[i],t.style[i]=e[i];for(i in r=n.call(t),e)t.style[i]=o[i];return r},zt=new RegExp(nt.join("|"),"i"),Gt=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");function Vt(t,e,n){var r,i,o,s,a=It.test(e),l=t.style;return(n=n||Ft(t))&&(s=n.getPropertyValue(e)||n[e],a&&(s=s.replace(Gt,"$1")),""!==s||it(t)||(s=x.style(t,e)),!f.pixelBoxStyles()&&jt.test(s)&&zt.test(e)&&(r=l.width,i=l.minWidth,o=l.maxWidth,l.minWidth=l.maxWidth=l.width=s,s=n.width,l.width=r,l.minWidth=i,l.maxWidth=o)),void 0!==s?s+"":s}function Wt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",rt.appendChild(c).appendChild(u);var e=t.getComputedStyle(u);r="1%"!==e.top,l=12===n(e.marginLeft),u.style.right="60%",s=36===n(e.right),i=36===n(e.width),u.style.position="absolute",o=12===n(u.offsetWidth/3),rt.removeChild(c),u=null}}function n(t){return Math.round(parseFloat(t))}var r,i,o,s,a,l,c=m.createElement("div"),u=m.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===u.style.backgroundClip,x.extend(f,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,n,r,i;return null==a&&(e=m.createElement("table"),n=m.createElement("tr"),r=m.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",r.style.height="9px",r.style.display="block",rt.appendChild(e).appendChild(n).appendChild(r),i=t.getComputedStyle(n),a=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===n.offsetHeight,rt.removeChild(e)),a}}))}();var Ht=["Webkit","Moz","ms"],Ut=m.createElement("div").style,qt={};function Yt(t){return x.cssProps[t]||qt[t]||(t in Ut?t:qt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Ht.length;n--;)if((t=Ht[n]+e)in Ut)return t}(t)||t)}var Xt=/^(none|table(?!-c[ea]).+)/,Kt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"};function Zt(t,e,n){var r=et.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function Qt(t,e,n,r,i,o){var s="width"===e?1:0,a=0,l=0;if(n===(r?"border":"content"))return 0;for(;s<4;s+=2)"margin"===n&&(l+=x.css(t,n+nt[s],!0,i)),r?("content"===n&&(l-=x.css(t,"padding"+nt[s],!0,i)),"margin"!==n&&(l-=x.css(t,"border"+nt[s]+"Width",!0,i))):(l+=x.css(t,"padding"+nt[s],!0,i),"padding"!==n?l+=x.css(t,"border"+nt[s]+"Width",!0,i):a+=x.css(t,"border"+nt[s]+"Width",!0,i));return!r&&o>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l}function te(t,e,n){var r=Ft(t),i=(!f.boxSizingReliable()||n)&&"border-box"===x.css(t,"boxSizing",!1,r),o=i,s=Vt(t,e,r),a="offset"+e[0].toUpperCase()+e.slice(1);if(jt.test(s)){if(!n)return s;s="auto"}return(!f.boxSizingReliable()&&i||!f.reliableTrDimensions()&&S(t,"tr")||"auto"===s||!parseFloat(s)&&"inline"===x.css(t,"display",!1,r))&&t.getClientRects().length&&(i="border-box"===x.css(t,"boxSizing",!1,r),(o=a in t)&&(s=t[a])),(s=parseFloat(s)||0)+Qt(t,e,n||(i?"border":"content"),o,r,s)+"px"}function ee(t,e,n,r,i){return new ee.prototype.init(t,e,n,r,i)}x.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Vt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,s,a=U(e),l=It.test(e),c=t.style;if(l||(e=Yt(a)),s=x.cssHooks[e]||x.cssHooks[a],void 0===n)return s&&"get"in s&&void 0!==(i=s.get(t,!1,r))?i:c[e];"string"==(o=typeof n)&&(i=et.exec(n))&&i[1]&&(n=at(t,e,i),o="number"),null!=n&&n==n&&("number"!==o||l||(n+=i&&i[3]||(x.cssNumber[a]?"":"px")),f.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,r))||(l?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,r){var i,o,s,a=U(e);return It.test(e)||(e=Yt(a)),(s=x.cssHooks[e]||x.cssHooks[a])&&"get"in s&&(i=s.get(t,!0,n)),void 0===i&&(i=Vt(t,e,r)),"normal"===i&&e in Jt&&(i=Jt[e]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),x.each(["height","width"],(function(t,e){x.cssHooks[e]={get:function(t,n,r){if(n)return!Xt.test(x.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?te(t,e,r):Bt(t,Kt,(function(){return te(t,e,r)}))},set:function(t,n,r){var i,o=Ft(t),s=!f.scrollboxSize()&&"absolute"===o.position,a=(s||r)&&"border-box"===x.css(t,"boxSizing",!1,o),l=r?Qt(t,e,r,a,o):0;return a&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-Qt(t,e,"border",!1,o)-.5)),l&&(i=et.exec(n))&&"px"!==(i[3]||"px")&&(t.style[e]=n,n=x.css(t,e)),Zt(0,n,l)}}})),x.cssHooks.marginLeft=Wt(f.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Vt(t,"marginLeft"))||t.getBoundingClientRect().left-Bt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),x.each({margin:"",padding:"",border:"Width"},(function(t,e){x.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[t+nt[r]+e]=o[r]||o[r-2]||o[0];return i}},"margin"!==t&&(x.cssHooks[t+e].set=Zt)})),x.fn.extend({css:function(t,e){return G(this,(function(t,e,n){var r,i,o={},s=0;if(Array.isArray(e)){for(r=Ft(t),i=e.length;s<i;s++)o[e[s]]=x.css(t,e[s],!1,r);return o}return void 0!==n?x.style(t,e,n):x.css(t,e)}),t,e,arguments.length>1)}}),x.Tween=ee,(ee.prototype={constructor:ee,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||x.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var t=ee.propHooks[this.prop];return t&&t.get?t.get(this):ee.propHooks._default.get(this)},run:function(t){var e,n=ee.propHooks[this.prop];return this.pos=e=this.options.duration?x.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):ee.propHooks._default.set(this),this}}).init.prototype=ee.prototype,(ee.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=x.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){x.fx.step[t.prop]?x.fx.step[t.prop](t):1!==t.elem.nodeType||!x.cssHooks[t.prop]&&null==t.elem.style[Yt(t.prop)]?t.elem[t.prop]=t.now:x.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=ee.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},x.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},x.fx=ee.prototype.init,x.fx.step={};var ne,re,ie=/^(?:toggle|show|hide)$/,oe=/queueHooks$/;function se(){re&&(!1===m.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(se):t.setTimeout(se,x.fx.interval),x.fx.tick())}function ae(){return t.setTimeout((function(){ne=void 0})),ne=Date.now()}function le(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=nt[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function ce(t,e,n){for(var r,i=(ue.tweeners[e]||[]).concat(ue.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,e,t))return r}function ue(t,e,n){var r,i,o=0,s=ue.prefilters.length,a=x.Deferred().always((function(){delete l.elem})),l=function(){if(i)return!1;for(var e=ne||ae(),n=Math.max(0,c.startTime+c.duration-e),r=1-(n/c.duration||0),o=0,s=c.tweens.length;o<s;o++)c.tweens[o].run(r);return a.notifyWith(t,[c,r,n]),r<1&&s?n:(s||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:x.extend({},e),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},n),originalProperties:e,originalOptions:n,startTime:ne||ae(),duration:n.duration,tweens:[],createTween:function(e,n){var r=x.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(r),r},stop:function(e){var n=0,r=e?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var n,r,i,o,s;for(n in t)if(i=e[r=U(n)],o=t[n],Array.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),(s=x.cssHooks[r])&&"expand"in s)for(n in o=s.expand(o),delete t[r],o)n in t||(t[n]=o[n],e[n]=i);else e[r]=i}(u,c.opts.specialEasing);o<s;o++)if(r=ue.prefilters[o].call(c,t,u,c.opts))return p(r.stop)&&(x._queueHooks(c.elem,c.opts.queue).stop=r.stop.bind(r)),r;return x.map(u,ce,c),p(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),x.fx.timer(x.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}x.Animation=x.extend(ue,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return at(n.elem,t,et.exec(e),n),n}]},tweener:function(t,e){p(t)?(e=t,t=["*"]):t=t.match(L);for(var n,r=0,i=t.length;r<i;r++)(ue.tweeners[n=t[r]]=ue.tweeners[n]||[]).unshift(e)},prefilters:[function(t,e,n){var r,i,o,s,a,l,c,u,h="width"in e||"height"in e,d=this,f={},p=t.style,g=t.nodeType&&st(t),m=X.get(t,"fxshow");for(r in n.queue||(null==(s=x._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,x.queue(t,"fx").length||s.empty.fire()}))}))),e)if(ie.test(i=e[r])){if(delete e[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;g=!0}f[r]=m&&m[r]||x.style(t,r)}if((l=!x.isEmptyObject(e))||!x.isEmptyObject(f))for(r in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=m&&m.display)&&(c=X.get(t,"display")),"none"===(u=x.css(t,"display"))&&(c?u=c:(ut([t],!0),c=t.style.display||c,u=x.css(t,"display"),ut([t]))),("inline"===u||"inline-block"===u&&null!=c)&&"none"===x.css(t,"float")&&(l||(d.done((function(){p.display=c})),null==c&&(c="none"===(u=p.display)?"":u)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always((function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}))),l=!1,f)l||(m?"hidden"in m&&(g=m.hidden):m=X.access(t,"fxshow",{display:c}),o&&(m.hidden=!g),g&&ut([t],!0),d.done((function(){for(r in g||ut([t]),X.remove(t,"fxshow"),f)x.style(t,r,f[r])}))),l=ce(g?m[r]:0,r,d),r in m||(m[r]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?ue.prefilters.unshift(t):ue.prefilters.push(t)}}),x.speed=function(t,e,n){var r=t&&"object"==typeof t?x.extend({},t):{complete:n||!n&&e||p(t)&&t,duration:t,easing:n&&e||e&&!p(e)&&e};return x.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration=r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){p(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.fn.extend({fadeTo:function(t,e,n,r){return this.filter(st).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=x.isEmptyObject(t),o=x.speed(e,n,r),s=function(){var e=ue(this,x.extend({},t),o);(i||X.get(this,"finish"))&&e.stop(!0)};return s.finish=s,i||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,i=null!=t&&t+"queueHooks",o=x.timers,s=X.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&oe.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));!e&&n||x.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=X.get(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish}))}}),x.each(["toggle","show","hide"],(function(t,e){var n=x.fn[e];x.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(le(e,!0),t,r,i)}})),x.each({slideDown:le("show"),slideUp:le("hide"),slideToggle:le("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){x.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}})),x.timers=[],x.fx.tick=function(){var t,e=0,n=x.timers;for(ne=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||x.fx.stop(),ne=void 0},x.fx.timer=function(t){x.timers.push(t),x.fx.start()},x.fx.interval=13,x.fx.start=function(){re||(re=!0,se())},x.fx.stop=function(){re=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(e,n){return e=x.fx&&x.fx.speeds[e]||e,this.queue(n=n||"fx",(function(n,r){var i=t.setTimeout(n,e);r.stop=function(){t.clearTimeout(i)}}))},function(){var t=m.createElement("input"),e=m.createElement("select").appendChild(m.createElement("option"));t.type="checkbox",f.checkOn=""!==t.value,f.optSelected=e.selected,(t=m.createElement("input")).value="t",t.type="radio",f.radioValue="t"===t.value}();var he,de=x.expr.attrHandle;x.fn.extend({attr:function(t,e){return G(this,x.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){x.removeAttr(this,t)}))}}),x.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?x.prop(t,e,n):(1===o&&x.isXMLDoc(t)||(i=x.attrHooks[e.toLowerCase()]||(x.expr.match.bool.test(e)?he:void 0)),void 0!==n?null===n?void x.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=x.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!f.radioValue&&"radio"===e&&S(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r=0,i=e&&e.match(L);if(i&&1===t.nodeType)for(;n=i[r++];)t.removeAttribute(n)}}),he={set:function(t,e,n){return!1===e?x.removeAttr(t,n):t.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=de[e]||x.find.attr;de[e]=function(t,e,r){var i,o,s=e.toLowerCase();return r||(o=de[s],de[s]=i,i=null!=n(t,e,r)?s:null,de[s]=o),i}}));var fe=/^(?:input|select|textarea|button)$/i,pe=/^(?:a|area)$/i;function ge(t){return(t.match(L)||[]).join(" ")}function me(t){return t.getAttribute&&t.getAttribute("class")||""}function Ae(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(L)||[]}x.fn.extend({prop:function(t,e){return G(this,x.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[x.propFix[t]||t]}))}}),x.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&x.isXMLDoc(t)||(i=x.propHooks[e=x.propFix[e]||e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=x.find.attr(t,"tabindex");return e?parseInt(e,10):fe.test(t.nodeName)||pe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),f.optSelected||(x.propHooks.selected={get:function(){return null},set:function(){}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){x.propFix[this.toLowerCase()]=this})),x.fn.extend({addClass:function(t){var e,n,r,i,o,s;return p(t)?this.each((function(e){x(this).addClass(t.call(this,e,me(this)))})):(e=Ae(t)).length?this.each((function(){if(r=me(this),n=1===this.nodeType&&" "+ge(r)+" "){for(o=0;o<e.length;o++)n.indexOf(" "+(i=e[o])+" ")<0&&(n+=i+" ");s=ge(n),r!==s&&this.setAttribute("class",s)}})):this},removeClass:function(t){var e,n,r,i,o,s;return p(t)?this.each((function(e){x(this).removeClass(t.call(this,e,me(this)))})):arguments.length?(e=Ae(t)).length?this.each((function(){if(r=me(this),n=1===this.nodeType&&" "+ge(r)+" "){for(o=0;o<e.length;o++)for(i=e[o];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");s=ge(n),r!==s&&this.setAttribute("class",s)}})):this:this.attr("class","")},toggleClass:function(t,e){var n,r,i,o,s=typeof t,a="string"===s||Array.isArray(t);return p(t)?this.each((function(n){x(this).toggleClass(t.call(this,n,me(this),e),e)})):"boolean"==typeof e&&a?e?this.addClass(t):this.removeClass(t):(n=Ae(t),this.each((function(){if(a)for(o=x(this),i=0;i<n.length;i++)o.hasClass(r=n[i])?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==s||((r=me(this))&&X.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":X.get(this,"__className__")||""))})))},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&(" "+ge(me(n))+" ").indexOf(e)>-1)return!0;return!1}});var ye=/\r/g;x.fn.extend({val:function(t){var e,n,r,i=this[0];return arguments.length?(r=p(t),this.each((function(n){var i;1===this.nodeType&&(null==(i=r?t.call(this,n,x(this).val()):t)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=x.map(i,(function(t){return null==t?"":t+""}))),(e=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))}))):i?(e=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(ye,""):null==n?"":n:void 0}}),x.extend({valHooks:{option:{get:function(t){var e=x.find.attr(t,"value");return null!=e?e:ge(x.text(t))}},select:{get:function(t){var e,n,r,i=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],l=s?o+1:i.length;for(r=o<0?l:s?o:0;r<l;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!S(n.parentNode,"optgroup"))){if(e=x(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,r,i=t.options,o=x.makeArray(e),s=i.length;s--;)((r=i[s]).selected=x.inArray(x.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),x.each(["radio","checkbox"],(function(){x.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=x.inArray(x(t).val(),e)>-1}},f.checkOn||(x.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),f.focusin="onfocusin"in t;var ve=/^(?:focusinfocus|focusoutblur)$/,be=function(t){t.stopPropagation()};x.extend(x.event,{trigger:function(e,n,r,i){var o,s,a,l,c,h,d,f,A=[r||m],y=u.call(e,"type")?e.type:e,v=u.call(e,"namespace")?e.namespace.split("."):[];if(s=f=a=r=r||m,3!==r.nodeType&&8!==r.nodeType&&!ve.test(y+x.event.triggered)&&(y.indexOf(".")>-1&&(v=y.split("."),y=v.shift(),v.sort()),c=y.indexOf(":")<0&&"on"+y,(e=e[x.expando]?e:new x.Event(y,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),n=null==n?[e]:x.makeArray(n,[e]),d=x.event.special[y]||{},i||!d.trigger||!1!==d.trigger.apply(r,n))){if(!i&&!d.noBubble&&!g(r)){for(ve.test((l=d.delegateType||y)+y)||(s=s.parentNode);s;s=s.parentNode)A.push(s),a=s;a===(r.ownerDocument||m)&&A.push(a.defaultView||a.parentWindow||t)}for(o=0;(s=A[o++])&&!e.isPropagationStopped();)f=s,e.type=o>1?l:d.bindType||y,(h=(X.get(s,"events")||Object.create(null))[e.type]&&X.get(s,"handle"))&&h.apply(s,n),(h=c&&s[c])&&h.apply&&q(s)&&(e.result=h.apply(s,n),!1===e.result&&e.preventDefault());return e.type=y,i||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(A.pop(),n)||!q(r)||c&&p(r[y])&&!g(r)&&((a=r[c])&&(r[c]=null),x.event.triggered=y,e.isPropagationStopped()&&f.addEventListener(y,be),r[y](),e.isPropagationStopped()&&f.removeEventListener(y,be),x.event.triggered=void 0,a&&(r[c]=a)),e.result}},simulate:function(t,e,n){var r=x.extend(new x.Event,n,{type:t,isSimulated:!0});x.event.trigger(r,null,e)}}),x.fn.extend({trigger:function(t,e){return this.each((function(){x.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return x.event.trigger(t,e,n,!0)}}),f.focusin||x.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){x.event.simulate(e,t.target,x.event.fix(t))};x.event.special[e]={setup:function(){var r=this.ownerDocument||this.document||this,i=X.access(r,e);i||r.addEventListener(t,n,!0),X.access(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=X.access(r,e)-1;i?X.access(r,e,i):(r.removeEventListener(t,n,!0),X.remove(r,e))}}}));var xe=t.location,we={guid:Date.now()},Ce=/\?/;x.parseXML=function(e){var n,r;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){}return r=n&&n.getElementsByTagName("parsererror")[0],n&&!r||x.error("Invalid XML: "+(r?x.map(r.childNodes,(function(t){return t.textContent})).join("\n"):e)),n};var $e=/\[\]$/,_e=/\r?\n/g,Pe=/^(?:submit|button|image|reset|file)$/i,Se=/^(?:input|select|textarea|keygen)/i;function Me(t,e,n,r){var i;if(Array.isArray(e))x.each(e,(function(e,i){n||$e.test(t)?r(t,i):Me(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,n,r)}));else if(n||"object"!==v(e))r(t,e);else for(i in e)Me(t+"["+i+"]",e[i],n,r)}x.param=function(t,e){var n,r=[],i=function(t,e){var n=p(e)?e():e;r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!x.isPlainObject(t))x.each(t,(function(){i(this.name,this.value)}));else for(n in t)Me(n,t[n],e,i);return r.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=x.prop(this,"elements");return t?x.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!x(this).is(":disabled")&&Se.test(this.nodeName)&&!Pe.test(t)&&(this.checked||!ft.test(t))})).map((function(t,e){var n=x(this).val();return null==n?null:Array.isArray(n)?x.map(n,(function(t){return{name:e.name,value:t.replace(_e,"\r\n")}})):{name:e.name,value:n.replace(_e,"\r\n")}})).get()}});var Ee=/%20/g,Te=/#.*$/,ke=/([?&])_=[^&]*/,Oe=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ne=/^(?:GET|HEAD)$/,Re=/^\/\//,Le={},De={},je="*/".concat("*"),Ie=m.createElement("a");function Fe(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(L)||[];if(p(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function Be(t,e,n,r){var i={},o=t===De;function s(a){var l;return i[a]=!0,x.each(t[a]||[],(function(t,a){var c=a(e,n,r);return"string"!=typeof c||o||i[c]?o?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)})),l}return s(e.dataTypes[0])||!i["*"]&&s("*")}function ze(t,e){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r||(r={}))[n]=e[n]);return r&&x.extend(!0,t,r),t}Ie.href=xe.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?ze(ze(t,x.ajaxSettings),e):ze(x.ajaxSettings,t)},ajaxPrefilter:Fe(Le),ajaxTransport:Fe(De),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0);var r,i,o,s,a,l,c,u,h,d,f=x.ajaxSetup({},n=n||{}),p=f.context||f,g=f.context&&(p.nodeType||p.jquery)?x(p):x.event,A=x.Deferred(),y=x.Callbacks("once memory"),v=f.statusCode||{},b={},w={},C="canceled",$={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Oe.exec(o);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==c&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)$.always(t[$.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||C;return r&&r.abort(e),_(0,e),this}};if(A.promise($),f.url=((e||f.url||xe.href)+"").replace(Re,xe.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(L)||[""],null==f.crossDomain){l=m.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ie.protocol+"//"+Ie.host!=l.protocol+"//"+l.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=x.param(f.data,f.traditional)),Be(Le,f,n,$),c)return $;for(h in(u=x.event&&f.global)&&0==x.active++&&x.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Ne.test(f.type),i=f.url.replace(Te,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Ee,"+")):(d=f.url.slice(i.length),f.data&&(f.processData||"string"==typeof f.data)&&(i+=(Ce.test(i)?"&":"?")+f.data,delete f.data),!1===f.cache&&(i=i.replace(ke,"$1"),d=(Ce.test(i)?"&":"?")+"_="+we.guid+++d),f.url=i+d),f.ifModified&&(x.lastModified[i]&&$.setRequestHeader("If-Modified-Since",x.lastModified[i]),x.etag[i]&&$.setRequestHeader("If-None-Match",x.etag[i])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&$.setRequestHeader("Content-Type",f.contentType),$.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+je+"; q=0.01":""):f.accepts["*"]),f.headers)$.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,$,f)||c))return $.abort();if(C="abort",y.add(f.complete),$.done(f.success),$.fail(f.error),r=Be(De,f,n,$)){if($.readyState=1,u&&g.trigger("ajaxSend",[$,f]),c)return $;f.async&&f.timeout>0&&(a=t.setTimeout((function(){$.abort("timeout")}),f.timeout));try{c=!1,r.send(b,_)}catch(t){if(c)throw t;_(-1,t)}}else _(-1,"No Transport");function _(e,n,s,l){var h,d,m,b,w,C=n;c||(c=!0,a&&t.clearTimeout(a),r=void 0,o=l||"",$.readyState=e>0?4:0,h=e>=200&&e<300||304===e,s&&(b=function(t,e,n){for(var r,i,o,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){l.unshift(i);break}if(l[0]in n)o=l[0];else{for(i in n){if(!l[0]||t.converters[i+" "+l[0]]){o=i;break}s||(s=i)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),n[o]}(f,$,s)),!h&&x.inArray("script",f.dataTypes)>-1&&x.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),b=function(t,e,n,r){var i,o,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!l&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(s=c[l+" "+o]||c["* "+o]))for(i in c)if((a=i.split(" "))[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+o}}}return{state:"success",data:e}}(f,b,$,h),h?(f.ifModified&&((w=$.getResponseHeader("Last-Modified"))&&(x.lastModified[i]=w),(w=$.getResponseHeader("etag"))&&(x.etag[i]=w)),204===e||"HEAD"===f.type?C="nocontent":304===e?C="notmodified":(C=b.state,d=b.data,h=!(m=b.error))):(m=C,!e&&C||(C="error",e<0&&(e=0))),$.status=e,$.statusText=(n||C)+"",h?A.resolveWith(p,[d,C,$]):A.rejectWith(p,[$,C,m]),$.statusCode(v),v=void 0,u&&g.trigger(h?"ajaxSuccess":"ajaxError",[$,f,h?d:m]),y.fireWith(p,[$,C]),u&&(g.trigger("ajaxComplete",[$,f]),--x.active||x.event.trigger("ajaxStop")))}return $},getJSON:function(t,e,n){return x.get(t,e,n,"json")},getScript:function(t,e){return x.get(t,void 0,e,"script")}}),x.each(["get","post"],(function(t,e){x[e]=function(t,n,r,i){return p(n)&&(i=i||r,r=n,n=void 0),x.ajax(x.extend({url:t,type:e,dataType:i,data:n,success:r},x.isPlainObject(t)&&t))}})),x.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),x._evalUrl=function(t,e,n){return x.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){x.globalEval(t,e,n)}})},x.fn.extend({wrapAll:function(t){var e;return this[0]&&(p(t)&&(t=t.call(this[0])),e=x(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return p(t)?this.each((function(e){x(this).wrapInner(t.call(this,e))})):this.each((function(){var e=x(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=p(t);return this.each((function(n){x(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){x(this).replaceWith(this.childNodes)})),this}}),x.expr.pseudos.hidden=function(t){return!x.expr.pseudos.visible(t)},x.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Ge={0:200,1223:204},Ve=x.ajaxSettings.xhr();f.cors=!!Ve&&"withCredentials"in Ve,f.ajax=Ve=!!Ve,x.ajaxTransport((function(e){var n,r;if(f.cors||Ve&&!e.crossDomain)return{send:function(i,o){var s,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)a[s]=e.xhrFields[s];for(s in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)a.setRequestHeader(s,i[s]);n=function(t){return function(){n&&(n=r=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Ge[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),r=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout((function(){n&&r()}))},n=n("abort");try{a.send(e.hasContent&&e.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}})),x.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return x.globalEval(t),t}}}),x.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),x.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(r,i){e=x("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&i("error"===t.type?404:200,t.type)}),m.head.appendChild(e[0])},abort:function(){n&&n()}}}));var We,He=[],Ue=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=He.pop()||x.expando+"_"+we.guid++;return this[t]=!0,t}}),x.ajaxPrefilter("json jsonp",(function(e,n,r){var i,o,s,a=!1!==e.jsonp&&(Ue.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ue.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=p(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ue,"$1"+i):!1!==e.jsonp&&(e.url+=(Ce.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},e.dataTypes[0]="json",o=t[i],t[i]=function(){s=arguments},r.always((function(){void 0===o?x(t).removeProp(i):t[i]=o,e[i]&&(e.jsonpCallback=n.jsonpCallback,He.push(i)),s&&p(o)&&o(s[0]),s=o=void 0})),"script"})),f.createHTMLDocument=((We=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===We.childNodes.length),x.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(f.createHTMLDocument?((r=(e=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,e.head.appendChild(r)):e=m),o=!n&&[],(i=M.exec(t))?[e.createElement(i[1])]:(i=bt([t],e,o),o&&o.length&&x(o).remove(),x.merge([],i.childNodes)));var r,i,o},x.fn.load=function(t,e,n){var r,i,o,s=this,a=t.indexOf(" ");return a>-1&&(r=ge(t.slice(a)),t=t.slice(0,a)),p(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),s.length>0&&x.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done((function(t){o=arguments,s.html(r?x("<div>").append(x.parseHTML(t)).find(r):t)})).always(n&&function(t,e){s.each((function(){n.apply(this,o||[t.responseText,e,t])}))}),this},x.expr.pseudos.animated=function(t){return x.grep(x.timers,(function(e){return t===e.elem})).length},x.offset={setOffset:function(t,e,n){var r,i,o,s,a,l,c=x.css(t,"position"),u=x(t),h={};"static"===c&&(t.style.position="relative"),a=u.offset(),o=x.css(t,"top"),l=x.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1?(s=(r=u.position()).top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(l)||0),p(e)&&(e=e.call(t,n,x.extend({},a))),null!=e.top&&(h.top=e.top-a.top+s),null!=e.left&&(h.left=e.left-a.left+i),"using"in e?e.using.call(t,h):u.css(h)}},x.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){x.offset.setOffset(this,t,e)}));var e,n,r=this[0];return r?r.getClientRects().length?{top:(e=r.getBoundingClientRect()).top+(n=r.ownerDocument.defaultView).pageYOffset,left:e.left+n.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,r=this[0],i={top:0,left:0};if("fixed"===x.css(r,"position"))e=r.getBoundingClientRect();else{for(e=this.offset(),n=r.ownerDocument,t=r.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===x.css(t,"position");)t=t.parentNode;t&&t!==r&&1===t.nodeType&&((i=x(t).offset()).top+=x.css(t,"borderTopWidth",!0),i.left+=x.css(t,"borderLeftWidth",!0))}return{top:e.top-i.top-x.css(r,"marginTop",!0),left:e.left-i.left-x.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===x.css(t,"position");)t=t.offsetParent;return t||rt}))}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;x.fn[t]=function(r){return G(this,(function(t,r,i){var o;if(g(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===i)return o?o[e]:t[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):t[r]=i}),t,r,arguments.length)}})),x.each(["top","left"],(function(t,e){x.cssHooks[e]=Wt(f.pixelPosition,(function(t,n){if(n)return n=Vt(t,e),jt.test(n)?x(t).position()[e]+"px":n}))})),x.each({Height:"height",Width:"width"},(function(t,e){x.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,r){x.fn[r]=function(i,o){var s=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===o?"margin":"border");return G(this,(function(e,n,i){var o;return g(e)?0===r.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?x.css(e,n,a):x.style(e,n,i,a)}),e,s?i:void 0,s)}}))})),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){x.fn[e]=function(t){return this.on(e,t)}})),x.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){x.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var qe=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(t,e){var n,r,o;if("string"==typeof e&&(n=t[e],e=t,t=n),p(t))return r=i.call(arguments,2),(o=function(){return t.apply(e||this,r.concat(i.call(arguments)))}).guid=t.guid=t.guid||x.guid++,o},x.holdReady=function(t){t?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=S,x.isFunction=p,x.isWindow=g,x.camelCase=U,x.type=v,x.now=Date.now,x.isNumeric=function(t){var e=x.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},x.trim=function(t){return null==t?"":(t+"").replace(qe,"$1")};var Ye=t.jQuery,Xe=t.$;return x.noConflict=function(e){return t.$===x&&(t.$=Xe),e&&t.jQuery===x&&(t.jQuery=Ye),x},void 0===e&&(t.jQuery=t.$=x),x},t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}}));createCommonjsModule((function(t){t.exports=function(t){var e,n,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(t.event.fixHooks)for(var s=r.length;s;)t.event.fixHooks[r[--s]]=t.event.mouseHooks;var a=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=i.length;e;)this.addEventListener(i[--e],l,!1);else this.onmousewheel=l;t.data(this,"mousewheel-line-height",a.getLineHeight(this)),t.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],l,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),r=n["offsetParent"in t.fn?"offsetParent":"parent"]();return r.length||(r=t("body")),parseInt(r.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function l(r){var i=r||window.event,s=o.call(arguments,1),l=0,h=0,d=0,f=0,p=0,g=0;if((r=t.event.fix(i)).type="mousewheel","detail"in i&&(d=-1*i.detail),"wheelDelta"in i&&(d=i.wheelDelta),"wheelDeltaY"in i&&(d=i.wheelDeltaY),"wheelDeltaX"in i&&(h=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(h=-1*d,d=0),l=0===d?h:d,"deltaY"in i&&(l=d=-1*i.deltaY),"deltaX"in i&&(h=i.deltaX,0===d&&(l=-1*h)),0!==d||0!==h){if(1===i.deltaMode){var m=t.data(this,"mousewheel-line-height");l*=m,d*=m,h*=m}else if(2===i.deltaMode){var A=t.data(this,"mousewheel-page-height");l*=A,d*=A,h*=A}if(f=Math.max(Math.abs(d),Math.abs(h)),(!n||f<n)&&(n=f,u(i,f)&&(n/=40)),u(i,f)&&(l/=40,h/=40,d/=40),l=Math[l>=1?"floor":"ceil"](l/n),h=Math[h>=1?"floor":"ceil"](h/n),d=Math[d>=1?"floor":"ceil"](d/n),a.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();p=r.clientX-y.left,g=r.clientY-y.top}return r.deltaX=h,r.deltaY=d,r.deltaFactor=n,r.offsetX=p,r.offsetY=g,r.deltaMode=0,s.unshift(r,l,h,d),e&&clearTimeout(e),e=setTimeout(c,200),(t.event.dispatch||t.event.handle).apply(this,s)}}function c(){n=null}function u(t,e){return a.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}}));const ua=navigator.userAgent;var Platform;if(function(t){t.IS_MAC=navigator.appVersion.indexOf("Mac")>0,t.IS_IOS=!!ua.match(/(iPad|iPhone|iPod)/g),t.IS_WINDOWS=navigator.appVersion.indexOf("Win")>0,t.IS_IE=ua.indexOf("MSIE")>=0,t.IS_IE11=!!ua.match(/Trident\/7\./),t.IS_EDGE=!!ua.match(/Edge\//),t.IS_NETSCAPE=ua.indexOf("Mozilla/")>=0&&ua.indexOf("MSIE")<0&&ua.indexOf("Edge/")<0,t.IS_CHROME_APP=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,t.IS_CHROME=ua.indexOf("Chrome/")>=0&&ua.indexOf("Edge/")<0,t.IS_OPERA=ua.indexOf("Opera/")>=0||ua.indexOf("OPR/")>=0,t.IS_FIREFOX=ua.indexOf("Firefox/")>=0,t.IS_SAFARI=ua.indexOf("AppleWebKit/")>=0&&ua.indexOf("Chrome/")<0&&ua.indexOf("Edge/")<0,t.SUPPORT_TOUCH="ontouchstart"in document.documentElement,t.SUPPORT_POINTER=null!=window.PointerEvent&&!t.IS_MAC,t.SUPPORT_PASSIVE=!1;try{const e=Object.defineProperty({},"passive",{get(){t.SUPPORT_PASSIVE=!0}}),n=document.createElement("div");n.addEventListener&&n.addEventListener("click",(()=>{}),e)}catch(t){}t.NO_FOREIGNOBJECT=!document.createElementNS||"[object SVGForeignObjectElement]"!=`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`||ua.indexOf("Opera/")>=0,t.SUPPORT_FOREIGNOBJECT=!t.NO_FOREIGNOBJECT}(Platform||(Platform={})),function(t){function e(){const t=window.module;return null!=t&&null!=t.hot&&null!=t.hot.status?t.hot.status():"unkonwn"}t.getHMRStatus=e,t.isApplyingHMR=function(){return"apply"===e()};const n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};t.isEventSupported=function(t){const e=document.createElement(n[t]||"div"),r=`on${t}`;let i=r in e;return i||(e.setAttribute(r,"return;"),i="function"==typeof e[r]),i}}(Platform||(Platform={})),Platform.SUPPORT_PASSIVE){jquery.event.special.touchstart={setup(t,e,n){if(!this.addEventListener)return!1;this.addEventListener("touchstart",n,{passive:!0})}};const t=jquery.event.special.mousewheel;if(t){const e=t.setup;t.setup=function(){const t=this.addEventListener;if(!t)return!1;this.addEventListener=(e,n)=>{t.call(this,e,n,{passive:!0})},e.call(this),this.addEventListener=t}}}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((t=>{Object.prototype.hasOwnProperty.call(t,"append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value(...t){const e=document.createDocumentFragment();t.forEach((t=>{const n=t instanceof Node;e.appendChild(n?t:document.createTextNode(String(t)))})),this.appendChild(e)}})}));var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$s=Object.prototype,hasOwnProperty$o=objectProto$s.hasOwnProperty,nativeObjectToString$3=objectProto$s.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(t){var e=hasOwnProperty$o.call(t,symToStringTag$1),n=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var r=!0}catch(t){}var i=nativeObjectToString$3.call(t);return r&&(e?t[symToStringTag$1]=n:delete t[symToStringTag$1]),i}var objectProto$r=Object.prototype,nativeObjectToString$2=objectProto$r.toString;function objectToString(t){return nativeObjectToString$2.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(t){return null==t?void 0===t?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return null!=t&&"object"==typeof t}var symbolTag$3="[object Symbol]";function isSymbol(t){return"symbol"==typeof t||isObjectLike(t)&&baseGetTag(t)==symbolTag$3}var NAN$2=NaN;function baseToNumber(t){return"number"==typeof t?t:isSymbol(t)?NAN$2:+t}function arrayMap(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var isArray=Array.isArray,INFINITY$5=1/0,symbolProto$2=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if("string"==typeof t)return t;if(isArray(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var e=t+"";return"0"==e&&1/t==-INFINITY$5?"-0":e}function createMathOperation(t,e){return function(n,r){var i;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=baseToString(n),r=baseToString(r)):(n=baseToNumber(n),r=baseToNumber(r)),i=t(n,r)}return i}}var add=createMathOperation((function(t,e){return t+e}),0),reWhitespace=/\s/;function trimmedEndIndex(t){for(var e=t.length;e--&&reWhitespace.test(t.charAt(e)););return e}var reTrimStart$2=/^\s+/;function baseTrim(t){return t?t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart$2,""):t}function isObject(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var NAN$1=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if("number"==typeof t)return t;if(isSymbol(t))return NAN$1;if(isObject(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=isObject(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=baseTrim(t);var n=reIsBinary.test(t);return n||reIsOctal.test(t)?freeParseInt(t.slice(2),n?2:8):reIsBadHex.test(t)?NAN$1:+t}var INFINITY$4=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(t){return t?(t=toNumber(t))===INFINITY$4||t===-INFINITY$4?(t<0?-1:1)*MAX_INTEGER:t==t?t:0:0===t?t:0}function toInteger(t){var e=toFinite(t),n=e%1;return e==e?n?e-n:e:0}var FUNC_ERROR_TEXT$b="Expected a function";function after(t,e){if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$b);return t=toInteger(t),function(){if(--t<1)return e.apply(this,arguments)}}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(t){if(!isObject(t))return!1;var e=baseGetTag(t);return e==funcTag$2||e==genTag$1||e==asyncTag||e==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(t){if(null!=t){try{return funcToString$2.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$q=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$n=objectProto$q.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$n).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){return!(!isObject(t)||isMasked(t))&&(isFunction(t)?reIsNative:reIsHostCtor).test(toSource(t))}function getValue(t,e){return null==t?void 0:t[e]}function getNative(t,e){var n=getValue(t,e);return baseIsNative(n)?n:void 0}var WeakMap$1=getNative(root,"WeakMap"),metaMap=WeakMap$1&&new WeakMap$1,baseSetData=metaMap?function(t,e){return metaMap.set(t,e),t}:identity,objectCreate=Object.create,baseCreate=function(){function t(){}return function(e){if(!isObject(e))return{};if(objectCreate)return objectCreate(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function createCtor(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=baseCreate(t.prototype),r=t.apply(n,e);return isObject(r)?r:n}}var WRAP_BIND_FLAG$8=1;function createBind(t,e,n){var r=e&WRAP_BIND_FLAG$8,i=createCtor(t);return function e(){var o=this&&this!==root&&this instanceof e?i:t;return o.apply(r?n:this,arguments)}}function apply$1(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var nativeMax$g=Math.max;function composeArgs(t,e,n,r){for(var i=-1,o=t.length,s=n.length,a=-1,l=e.length,c=nativeMax$g(o-s,0),u=Array(l+c),h=!r;++a<l;)u[a]=e[a];for(;++i<s;)(h||i<o)&&(u[n[i]]=t[i]);for(;c--;)u[a++]=t[i++];return u}var nativeMax$f=Math.max;function composeArgsRight(t,e,n,r){for(var i=-1,o=t.length,s=-1,a=n.length,l=-1,c=e.length,u=nativeMax$f(o-a,0),h=Array(u+c),d=!r;++i<u;)h[i]=t[i];for(var f=i;++l<c;)h[f+l]=e[l];for(;++s<a;)(d||i<o)&&(h[f+n[s]]=t[i++]);return h}function countHolders(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}function baseLodash(){}var MAX_ARRAY_LENGTH$6=4294967295;function LazyWrapper(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH$6,this.__views__=[]}function noop$1(){}LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper;var getData=metaMap?function(t){return metaMap.get(t)}:noop$1,realNames={},objectProto$p=Object.prototype,hasOwnProperty$m=objectProto$p.hasOwnProperty;function getFuncName(t){for(var e=t.name+"",n=realNames[e],r=hasOwnProperty$m.call(realNames,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function LodashWrapper(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function copyArray(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function wrapperClone(t){if(t instanceof LazyWrapper)return t.clone();var e=new LodashWrapper(t.__wrapped__,t.__chain__);return e.__actions__=copyArray(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper;var objectProto$o=Object.prototype,hasOwnProperty$l=objectProto$o.hasOwnProperty;function lodash$1(t){if(isObjectLike(t)&&!isArray(t)&&!(t instanceof LazyWrapper)){if(t instanceof LodashWrapper)return t;if(hasOwnProperty$l.call(t,"__wrapped__"))return wrapperClone(t)}return new LodashWrapper(t)}function isLaziable(t){var e=getFuncName(t),n=lodash$1[e];if("function"!=typeof n||!(e in LazyWrapper.prototype))return!1;if(t===n)return!0;var r=getData(n);return!!r&&t===r[0]}lodash$1.prototype=baseLodash.prototype,lodash$1.prototype.constructor=lodash$1;var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(t){var e=0,n=0;return function(){var r=nativeNow(),i=HOT_SPAN-(r-n);if(n=r,i>0){if(++e>=HOT_COUNT)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var setData=shortOut(baseSetData),reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /;function getWrapDetails(t){var e=t.match(reWrapDetails);return e?e[1].split(reSplitDetails):[]}var reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function insertWrapDetails(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(reWrapComment,"{\n/* [wrapped with "+e+"] */\n")}function constant(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),baseSetToString=defineProperty?function(t,e){return defineProperty(t,"toString",{configurable:!0,enumerable:!1,value:constant(e),writable:!0})}:identity,setToString=shortOut(baseSetToString);function arrayEach(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function baseFindIndex(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function baseIsNaN(t){return t!=t}function strictIndexOf(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function baseIndexOf(t,e,n){return e==e?strictIndexOf(t,e,n):baseFindIndex(t,baseIsNaN,n)}function arrayIncludes(t,e){return!(null==t||!t.length)&&baseIndexOf(t,e,0)>-1}var WRAP_BIND_FLAG$7=1,WRAP_BIND_KEY_FLAG$6=2,WRAP_CURRY_FLAG$6=8,WRAP_CURRY_RIGHT_FLAG$3=16,WRAP_PARTIAL_FLAG$6=32,WRAP_PARTIAL_RIGHT_FLAG$3=64,WRAP_ARY_FLAG$4=128,WRAP_REARG_FLAG$3=256,WRAP_FLIP_FLAG$2=512,wrapFlags=[["ary",WRAP_ARY_FLAG$4],["bind",WRAP_BIND_FLAG$7],["bindKey",WRAP_BIND_KEY_FLAG$6],["curry",WRAP_CURRY_FLAG$6],["curryRight",WRAP_CURRY_RIGHT_FLAG$3],["flip",WRAP_FLIP_FLAG$2],["partial",WRAP_PARTIAL_FLAG$6],["partialRight",WRAP_PARTIAL_RIGHT_FLAG$3],["rearg",WRAP_REARG_FLAG$3]];function updateWrapDetails(t,e){return arrayEach(wrapFlags,(function(n){var r="_."+n[0];e&n[1]&&!arrayIncludes(t,r)&&t.push(r)})),t.sort()}function setWrapToString(t,e,n){var r=e+"";return setToString(t,insertWrapDetails(r,updateWrapDetails(getWrapDetails(r),n)))}var WRAP_BIND_FLAG$6=1,WRAP_BIND_KEY_FLAG$5=2,WRAP_CURRY_BOUND_FLAG$1=4,WRAP_CURRY_FLAG$5=8,WRAP_PARTIAL_FLAG$5=32,WRAP_PARTIAL_RIGHT_FLAG$2=64;function createRecurry(t,e,n,r,i,o,s,a,l,c){var u=e&WRAP_CURRY_FLAG$5;e|=u?WRAP_PARTIAL_FLAG$5:WRAP_PARTIAL_RIGHT_FLAG$2,(e&=~(u?WRAP_PARTIAL_RIGHT_FLAG$2:WRAP_PARTIAL_FLAG$5))&WRAP_CURRY_BOUND_FLAG$1||(e&=~(WRAP_BIND_FLAG$6|WRAP_BIND_KEY_FLAG$5));var h=[t,e,i,u?o:void 0,u?s:void 0,u?void 0:o,u?void 0:s,a,l,c],d=n.apply(void 0,h);return isLaziable(t)&&setData(d,h),d.placeholder=r,setWrapToString(d,t,e)}function getHolder(t){return t.placeholder}var MAX_SAFE_INTEGER$5=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,e){var n=typeof t;return!!(e=null==e?MAX_SAFE_INTEGER$5:e)&&("number"==n||"symbol"!=n&&reIsUint.test(t))&&t>-1&&t%1==0&&t<e}var nativeMin$e=Math.min;function reorder(t,e){for(var n=t.length,r=nativeMin$e(e.length,n),i=copyArray(t);r--;){var o=e[r];t[r]=isIndex(o,n)?i[o]:void 0}return t}var PLACEHOLDER$1="__lodash_placeholder__";function replaceHolders(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==PLACEHOLDER$1||(t[n]=PLACEHOLDER$1,o[i++]=n)}return o}var WRAP_BIND_FLAG$5=1,WRAP_BIND_KEY_FLAG$4=2,WRAP_CURRY_FLAG$4=8,WRAP_CURRY_RIGHT_FLAG$2=16,WRAP_ARY_FLAG$3=128,WRAP_FLIP_FLAG$1=512;function createHybrid(t,e,n,r,i,o,s,a,l,c){var u=e&WRAP_ARY_FLAG$3,h=e&WRAP_BIND_FLAG$5,d=e&WRAP_BIND_KEY_FLAG$4,f=e&(WRAP_CURRY_FLAG$4|WRAP_CURRY_RIGHT_FLAG$2),p=e&WRAP_FLIP_FLAG$1,g=d?void 0:createCtor(t);return function m(){for(var A=arguments.length,y=Array(A),v=A;v--;)y[v]=arguments[v];if(f)var b=getHolder(m),x=countHolders(y,b);if(r&&(y=composeArgs(y,r,i,f)),o&&(y=composeArgsRight(y,o,s,f)),A-=x,f&&A<c){var w=replaceHolders(y,b);return createRecurry(t,e,createHybrid,m.placeholder,n,y,w,a,l,c-A)}var C=h?n:this,$=d?C[t]:t;return A=y.length,a?y=reorder(y,a):p&&A>1&&y.reverse(),u&&l<A&&(y.length=l),this&&this!==root&&this instanceof m&&($=g||createCtor($)),$.apply(C,y)}}function createCurry(t,e,n){var r=createCtor(t);return function i(){for(var o=arguments.length,s=Array(o),a=o,l=getHolder(i);a--;)s[a]=arguments[a];var c=o<3&&s[0]!==l&&s[o-1]!==l?[]:replaceHolders(s,l);if((o-=c.length)<n)return createRecurry(t,e,createHybrid,i.placeholder,void 0,s,c,void 0,void 0,n-o);var u=this&&this!==root&&this instanceof i?r:t;return apply$1(u,this,s)}}var WRAP_BIND_FLAG$4=1;function createPartial(t,e,n,r){var i=e&WRAP_BIND_FLAG$4,o=createCtor(t);return function e(){for(var s=-1,a=arguments.length,l=-1,c=r.length,u=Array(c+a),h=this&&this!==root&&this instanceof e?o:t;++l<c;)u[l]=r[l];for(;a--;)u[l++]=arguments[++s];return apply$1(h,i?n:this,u)}}var PLACEHOLDER="__lodash_placeholder__",WRAP_BIND_FLAG$3=1,WRAP_BIND_KEY_FLAG$3=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG$3=8,WRAP_ARY_FLAG$2=128,WRAP_REARG_FLAG$2=256,nativeMin$d=Math.min;function mergeData(t,e){var n=t[1],r=e[1],i=n|r;if(!(i<(WRAP_BIND_FLAG$3|WRAP_BIND_KEY_FLAG$3|WRAP_ARY_FLAG$2)||r==WRAP_ARY_FLAG$2&&n==WRAP_CURRY_FLAG$3||r==WRAP_ARY_FLAG$2&&n==WRAP_REARG_FLAG$2&&t[7].length<=e[8]||r==(WRAP_ARY_FLAG$2|WRAP_REARG_FLAG$2)&&e[7].length<=e[8]&&n==WRAP_CURRY_FLAG$3))return t;r&WRAP_BIND_FLAG$3&&(t[2]=e[2],i|=n&WRAP_BIND_FLAG$3?0:WRAP_CURRY_BOUND_FLAG);var o=e[3];if(o){var s=t[3];t[3]=s?composeArgs(s,o,e[4]):o,t[4]=s?replaceHolders(t[3],PLACEHOLDER):e[4]}return(o=e[5])&&(t[5]=(s=t[5])?composeArgsRight(s,o,e[6]):o,t[6]=s?replaceHolders(t[5],PLACEHOLDER):e[6]),(o=e[7])&&(t[7]=o),r&WRAP_ARY_FLAG$2&&(t[8]=null==t[8]?e[8]:nativeMin$d(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}var FUNC_ERROR_TEXT$a="Expected a function",WRAP_BIND_FLAG$2=1,WRAP_BIND_KEY_FLAG$2=2,WRAP_CURRY_FLAG$2=8,WRAP_CURRY_RIGHT_FLAG$1=16,WRAP_PARTIAL_FLAG$4=32,WRAP_PARTIAL_RIGHT_FLAG$1=64,nativeMax$e=Math.max;function createWrap(t,e,n,r,i,o,s,a){var l=e&WRAP_BIND_KEY_FLAG$2;if(!l&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$a);var c=r?r.length:0;if(c||(e&=~(WRAP_PARTIAL_FLAG$4|WRAP_PARTIAL_RIGHT_FLAG$1),r=i=void 0),s=void 0===s?s:nativeMax$e(toInteger(s),0),a=void 0===a?a:toInteger(a),c-=i?i.length:0,e&WRAP_PARTIAL_RIGHT_FLAG$1){var u=r,h=i;r=i=void 0}var d=l?void 0:getData(t),f=[t,e,n,r,i,u,h,o,s,a];if(d&&mergeData(f,d),t=f[0],e=f[1],n=f[2],r=f[3],i=f[4],!(a=f[9]=void 0===f[9]?l?0:t.length:nativeMax$e(f[9]-c,0))&&e&(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1)&&(e&=~(WRAP_CURRY_FLAG$2|WRAP_CURRY_RIGHT_FLAG$1)),e&&e!=WRAP_BIND_FLAG$2)p=e==WRAP_CURRY_FLAG$2||e==WRAP_CURRY_RIGHT_FLAG$1?createCurry(t,e,a):e!=WRAP_PARTIAL_FLAG$4&&e!=(WRAP_BIND_FLAG$2|WRAP_PARTIAL_FLAG$4)||i.length?createHybrid.apply(void 0,f):createPartial(t,e,n,r);else var p=createBind(t,e,n);return setWrapToString((d?baseSetData:setData)(p,f),t,e)}var WRAP_ARY_FLAG$1=128;function ary(t,e,n){return e=n?void 0:e,createWrap(t,WRAP_ARY_FLAG$1,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function baseAssignValue(t,e,n){"__proto__"==e&&defineProperty?defineProperty(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function eq(t,e){return t===e||t!=t&&e!=e}var objectProto$n=Object.prototype,hasOwnProperty$k=objectProto$n.hasOwnProperty;function assignValue(t,e,n){var r=t[e];hasOwnProperty$k.call(t,e)&&eq(r,n)&&(void 0!==n||e in t)||baseAssignValue(t,e,n)}function copyObject(t,e,n,r){var i=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var a=e[o],l=r?r(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),i?baseAssignValue(n,a,l):assignValue(n,a,l)}return n}var nativeMax$d=Math.max;function overRest(t,e,n){return e=nativeMax$d(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=nativeMax$d(r.length-e,0),s=Array(o);++i<o;)s[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(s),apply$1(t,this,a)}}function baseRest(t,e){return setToString(overRest(t,e,identity),t+"")}var MAX_SAFE_INTEGER$4=9007199254740991;function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER$4}function isArrayLike(t){return null!=t&&isLength(t.length)&&!isFunction(t)}function isIterateeCall(t,e,n){if(!isObject(n))return!1;var r=typeof e;return!!("number"==r?isArrayLike(n)&&isIndex(e,n.length):"string"==r&&e in n)&&eq(n[e],t)}function createAssigner(t){return baseRest((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&isIterateeCall(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,o)}return e}))}var objectProto$m=Object.prototype;function isPrototype(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||objectProto$m)}function baseTimes(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var argsTag$3="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$3}var objectProto$l=Object.prototype,hasOwnProperty$j=objectProto$l.hasOwnProperty,propertyIsEnumerable$1=objectProto$l.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$j.call(t,"callee")&&!propertyIsEnumerable$1.call(t,"callee")};function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$4="[object Boolean]",dateTag$4="[object Date]",errorTag$3="[object Error]",funcTag$1="[object Function]",mapTag$9="[object Map]",numberTag$4="[object Number]",objectTag$4="[object Object]",regexpTag$4="[object RegExp]",setTag$9="[object Set]",stringTag$4="[object String]",weakMapTag$3="[object WeakMap]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(t){return function(e){return t(e)}}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$4]=typedArrayTags[boolTag$4]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$4]=typedArrayTags[errorTag$3]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$9]=typedArrayTags[numberTag$4]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$4]=typedArrayTags[setTag$9]=typedArrayTags[stringTag$4]=typedArrayTags[weakMapTag$3]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{return freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(t){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$k=Object.prototype,hasOwnProperty$i=objectProto$k.hasOwnProperty;function arrayLikeKeys(t,e){var n=isArray(t),r=!n&&isArguments(t),i=!n&&!r&&isBuffer(t),o=!n&&!r&&!i&&isTypedArray(t),s=n||r||i||o,a=s?baseTimes(t.length,String):[],l=a.length;for(var c in t)!e&&!hasOwnProperty$i.call(t,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex(c,l))||a.push(c);return a}function overArg(t,e){return function(n){return t(e(n))}}var nativeKeys=overArg(Object.keys,Object),objectProto$j=Object.prototype,hasOwnProperty$h=objectProto$j.hasOwnProperty;function baseKeys(t){if(!isPrototype(t))return nativeKeys(t);var e=[];for(var n in Object(t))hasOwnProperty$h.call(t,n)&&"constructor"!=n&&e.push(n);return e}function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}var objectProto$i=Object.prototype,hasOwnProperty$g=objectProto$i.hasOwnProperty,assign=createAssigner((function(t,e){if(isPrototype(e)||isArrayLike(e))copyObject(e,keys(e),t);else for(var n in e)hasOwnProperty$g.call(e,n)&&assignValue(t,n,e[n])}));function nativeKeysIn(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}var objectProto$h=Object.prototype,hasOwnProperty$f=objectProto$h.hasOwnProperty;function baseKeysIn(t){if(!isObject(t))return nativeKeysIn(t);var e=isPrototype(t),n=[];for(var r in t)("constructor"!=r||!e&&hasOwnProperty$f.call(t,r))&&n.push(r);return n}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var assignIn=createAssigner((function(t,e){copyObject(e,keysIn(e),t)})),assignInWith=createAssigner((function(t,e,n,r){copyObject(e,keysIn(e),t,r)})),assignWith=createAssigner((function(t,e,n,r){copyObject(e,keys(e),t,r)})),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,e){if(isArray(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!isSymbol(t))||reIsPlainProp.test(t)||!reIsDeepProp.test(t)||null!=e&&t in Object(e)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$g=Object.prototype,hasOwnProperty$e=objectProto$g.hasOwnProperty;function hashGet(t){var e=this.__data__;if(nativeCreate){var n=e[t];return n===HASH_UNDEFINED$2?void 0:n}return hasOwnProperty$e.call(e,t)?e[t]:void 0}var objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty;function hashHas(t){var e=this.__data__;return nativeCreate?void 0!==e[t]:hasOwnProperty$d.call(e,t)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=nativeCreate&&void 0===e?HASH_UNDEFINED$1:e,this}function Hash(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,e){for(var n=t.length;n--;)if(eq(t[n][0],e))return n;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto$5=Array.prototype,splice$2=arrayProto$5.splice;function listCacheDelete(t){var e=this.__data__,n=assocIndexOf(e,t);return!(n<0||(n==e.length-1?e.pop():splice$2.call(e,n,1),--this.size,0))}function listCacheGet(t){var e=this.__data__,n=assocIndexOf(e,t);return n<0?void 0:e[n][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,e){var n=this.__data__,r=assocIndexOf(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function ListCache(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function getMapData(t,e){var n=t.__data__;return isKeyable(e)?n["string"==typeof e?"string":"hash"]:n.map}function mapCacheDelete(t){var e=getMapData(this,t).delete(t);return this.size-=e?1:0,e}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,e){var n=getMapData(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function MapCache(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$9="Expected a function";function memoize(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$9);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(memoize.Cache||MapCache),n}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var e=memoize(t,(function(t){return n.size===MAX_MEMOIZE_SIZE&&n.clear(),t})),n=e.cache;return e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(rePropName,(function(t,n,r,i){e.push(r?i.replace(reEscapeChar,"$1"):n||t)})),e}));function toString(t){return null==t?"":baseToString(t)}function castPath(t,e){return isArray(t)?t:isKey(t,e)?[t]:stringToPath(toString(t))}var INFINITY$3=1/0;function toKey(t){if("string"==typeof t||isSymbol(t))return t;var e=t+"";return"0"==e&&1/t==-INFINITY$3?"-0":e}function baseGet(t,e){for(var n=0,r=(e=castPath(e,t)).length;null!=t&&n<r;)t=t[toKey(e[n++])];return n&&n==r?t:void 0}function get(t,e,n){var r=null==t?void 0:baseGet(t,e);return void 0===r?n:r}function baseAt(t,e){for(var n=-1,r=e.length,i=Array(r),o=null==t;++n<r;)i[n]=o?void 0:get(t,e[n]);return i}function arrayPush(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(t){return isArray(t)||isArguments(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}function baseFlatten(t,e,n,r,i){var o=-1,s=t.length;for(n||(n=isFlattenable),i||(i=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?baseFlatten(a,e-1,n,r,i):arrayPush(i,a):r||(i[i.length]=a)}return i}function flatten(t){return null!=t&&t.length?baseFlatten(t,1):[]}function flatRest(t){return setToString(overRest(t,void 0,flatten),t+"")}var at=flatRest(baseAt),getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$e=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$c=objectProto$e.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(t){if(!isObjectLike(t)||baseGetTag(t)!=objectTag$3)return!1;var e=getPrototype(t);if(null===e)return!0;var n=hasOwnProperty$c.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&funcToString.call(n)==objectCtorString}var domExcTag="[object DOMException]",errorTag$2="[object Error]";function isError(t){if(!isObjectLike(t))return!1;var e=baseGetTag(t);return e==errorTag$2||e==domExcTag||"string"==typeof t.message&&"string"==typeof t.name&&!isPlainObject(t)}var attempt=baseRest((function(t,e){try{return apply$1(t,void 0,e)}catch(t){return isError(t)?t:new Error(t)}})),FUNC_ERROR_TEXT$8="Expected a function";function before$1(t,e){var n;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$8);return t=toInteger(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var WRAP_BIND_FLAG$1=1,WRAP_PARTIAL_FLAG$3=32,bind=baseRest((function(t,e,n){var r=WRAP_BIND_FLAG$1;if(n.length){var i=replaceHolders(n,getHolder(bind));r|=WRAP_PARTIAL_FLAG$3}return createWrap(t,r,e,n,i)}));bind.placeholder={};var bindAll=flatRest((function(t,e){return arrayEach(e,(function(e){e=toKey(e),baseAssignValue(t,e,bind(t[e],t))})),t})),WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG$1=2,WRAP_PARTIAL_FLAG$2=32,bindKey=baseRest((function(t,e,n){var r=WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG$1;if(n.length){var i=replaceHolders(n,getHolder(bindKey));r|=WRAP_PARTIAL_FLAG$2}return createWrap(e,r,t,n,i)}));function baseSlice(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}function castSlice(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:baseSlice(t,e,n)}bindKey.placeholder={};var rsAstralRange$3="\\ud800-\\udfff",rsComboMarksRange$4="\\u0300-\\u036f",reComboHalfMarksRange$4="\\ufe20-\\ufe2f",rsComboSymbolsRange$4="\\u20d0-\\u20ff",rsComboRange$4=rsComboMarksRange$4+reComboHalfMarksRange$4+rsComboSymbolsRange$4,rsVarRange$3="\\ufe0e\\ufe0f",rsZWJ$3="\\u200d",reHasUnicode=RegExp("["+rsZWJ$3+rsAstralRange$3+rsComboRange$4+rsVarRange$3+"]");function hasUnicode(t){return reHasUnicode.test(t)}function asciiToArray(t){return t.split("")}var rsAstralRange$2="\\ud800-\\udfff",rsComboMarksRange$3="\\u0300-\\u036f",reComboHalfMarksRange$3="\\ufe20-\\ufe2f",rsComboSymbolsRange$3="\\u20d0-\\u20ff",rsComboRange$3=rsComboMarksRange$3+reComboHalfMarksRange$3+rsComboSymbolsRange$3,rsVarRange$2="\\ufe0e\\ufe0f",rsAstral$1="["+rsAstralRange$2+"]",rsCombo$3="["+rsComboRange$3+"]",rsFitz$2="\\ud83c[\\udffb-\\udfff]",rsModifier$2="(?:"+rsCombo$3+"|"+rsFitz$2+")",rsNonAstral$2="[^"+rsAstralRange$2+"]",rsRegional$2="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$2="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$2="\\u200d",reOptMod$2=rsModifier$2+"?",rsOptVar$2="["+rsVarRange$2+"]?",rsOptJoin$2="(?:"+rsZWJ$2+"(?:"+[rsNonAstral$2,rsRegional$2,rsSurrPair$2].join("|")+")"+rsOptVar$2+reOptMod$2+")*",rsSeq$2=rsOptVar$2+reOptMod$2+rsOptJoin$2,rsSymbol$1="(?:"+[rsNonAstral$2+rsCombo$3+"?",rsCombo$3,rsRegional$2,rsSurrPair$2,rsAstral$1].join("|")+")",reUnicode$1=RegExp(rsFitz$2+"(?="+rsFitz$2+")|"+rsSymbol$1+rsSeq$2,"g");function unicodeToArray(t){return t.match(reUnicode$1)||[]}function stringToArray(t){return hasUnicode(t)?unicodeToArray(t):asciiToArray(t)}function createCaseFirst(t){return function(e){var n=hasUnicode(e=toString(e))?stringToArray(e):void 0,r=n?n[0]:e.charAt(0),i=n?castSlice(n,1).join(""):e.slice(1);return r[t]()+i}}var upperFirst=createCaseFirst("toUpperCase");function capitalize(t){return upperFirst(toString(t).toLowerCase())}function arrayReduce(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function basePropertyOf(t){return function(e){return null==t?void 0:t[e]}}var deburredLetters={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},deburrLetter=basePropertyOf(deburredLetters),reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rsComboMarksRange$2="\\u0300-\\u036f",reComboHalfMarksRange$2="\\ufe20-\\ufe2f",rsComboSymbolsRange$2="\\u20d0-\\u20ff",rsComboRange$2=rsComboMarksRange$2+reComboHalfMarksRange$2+rsComboSymbolsRange$2,rsCombo$2="["+rsComboRange$2+"]",reComboMark=RegExp(rsCombo$2,"g");function deburr(t){return(t=toString(t))&&t.replace(reLatin,deburrLetter).replace(reComboMark,"")}var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function asciiWords(t){return t.match(reAsciiWord)||[]}var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function hasUnicodeWord(t){return reHasUnicodeWord.test(t)}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange$1="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange,rsApos$1="[']",rsBreak="["+rsBreakRange+"]",rsCombo$1="["+rsComboRange$1+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange$1+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz$1="\\ud83c[\\udffb-\\udfff]",rsModifier$1="(?:"+rsCombo$1+"|"+rsFitz$1+")",rsNonAstral$1="[^"+rsAstralRange$1+"]",rsRegional$1="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$1="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ$1="\\u200d",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",rsOptContrLower="(?:"+rsApos$1+"(?:d|ll|m|re|s|t|ve))?",rsOptContrUpper="(?:"+rsApos$1+"(?:D|LL|M|RE|S|T|VE))?",reOptMod$1=rsModifier$1+"?",rsOptVar$1="["+rsVarRange$1+"]?",rsOptJoin$1="(?:"+rsZWJ$1+"(?:"+[rsNonAstral$1,rsRegional$1,rsSurrPair$1].join("|")+")"+rsOptVar$1+reOptMod$1+")*",rsOrdLower="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsOrdUpper="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rsSeq$1=rsOptVar$1+reOptMod$1+rsOptJoin$1,rsEmoji="(?:"+[rsDingbat,rsRegional$1,rsSurrPair$1].join("|")+")"+rsSeq$1,reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+"+rsOptContrLower+"(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+"+rsOptContrUpper+"(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+"+rsOptContrLower,rsUpper+"+"+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join("|"),"g");function unicodeWords(t){return t.match(reUnicodeWord)||[]}function words(t,e,n){return t=toString(t),void 0===(e=n?void 0:e)?hasUnicodeWord(t)?unicodeWords(t):asciiWords(t):t.match(e)||[]}var rsApos="[']",reApos=RegExp(rsApos,"g");function createCompounder(t){return function(e){return arrayReduce(words(deburr(e).replace(reApos,"")),t,"")}}var camelCase=createCompounder((function(t,e,n){return e=e.toLowerCase(),t+(n?capitalize(e):e)}));function castArray(){if(!arguments.length)return[];var t=arguments[0];return isArray(t)?t:[t]}var nativeIsFinite$1=root.isFinite,nativeMin$c=Math.min;function createRound(t){var e=Math[t];return function(t,n){if(t=toNumber(t),(n=null==n?0:nativeMin$c(toInteger(n),292))&&nativeIsFinite$1(t)){var r=(toString(t)+"e").split("e");return+((r=(toString(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var ceil=createRound("ceil");function chain(t){var e=lodash$1(t);return e.__chain__=!0,e}var nativeCeil$3=Math.ceil,nativeMax$c=Math.max;function chunk(t,e,n){e=(n?isIterateeCall(t,e,n):void 0===e)?1:nativeMax$c(toInteger(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,s=Array(nativeCeil$3(r/e));i<r;)s[o++]=baseSlice(t,i,i+=e);return s}function baseClamp(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function clamp$1(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=toNumber(n))==n?n:0),void 0!==e&&(e=(e=toNumber(e))==e?e:0),baseClamp(toNumber(t),e,n)}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE$2=200;function stackSet(t,e){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!Map$1||r.length<LARGE_ARRAY_SIZE$2-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new MapCache(r)}return n.set(t,e),this.size=n.size,this}function Stack(t){var e=this.__data__=new ListCache(t);this.size=e.size}function baseAssign(t,e){return t&&copyObject(e,keys(e),t)}function baseAssignIn(t,e){return t&&copyObject(e,keysIn(e),t)}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(t,e){if(e)return t.slice();var n=t.length,r=allocUnsafe?allocUnsafe(n):new t.constructor(n);return t.copy(r),r}function arrayFilter(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}function stubArray(){return[]}var objectProto$d=Object.prototype,propertyIsEnumerable=objectProto$d.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return null==t?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),(function(e){return propertyIsEnumerable.call(t,e)})))}:stubArray;function copySymbols(t,e){return copyObject(t,getSymbols(t),e)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(t){for(var e=[];t;)arrayPush(e,getSymbols(t)),t=getPrototype(t);return e}:stubArray;function copySymbolsIn(t,e){return copyObject(t,getSymbolsIn(t),e)}function baseGetAllKeys(t,e,n){var r=e(t);return isArray(t)?r:arrayPush(r,n(t))}function getAllKeys(t){return baseGetAllKeys(t,keys,getSymbols)}function getAllKeysIn(t){return baseGetAllKeys(t,keysIn,getSymbolsIn)}var DataView$1=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),mapTag$8="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$8="[object Set]",weakMapTag$2="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$1&&getTag(new Map$1)!=mapTag$8||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$8||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$2)&&(getTag=function(t){var e=baseGetTag(t),n=e==objectTag$2?t.constructor:void 0,r=n?toSource(n):"";if(r)switch(r){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$8;case promiseCtorString:return promiseTag;case setCtorString:return setTag$8;case weakMapCtorString:return weakMapTag$2}return e});const getTag$1=getTag;var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function initCloneArray(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&hasOwnProperty$b.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(t){var e=new t.constructor(t.byteLength);return new Uint8Array$1(e).set(new Uint8Array$1(t)),e}function cloneDataView(t,e){var n=e?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var reFlags$1=/\w*$/;function cloneRegExp(t){var e=new t.constructor(t.source,reFlags$1.exec(t));return e.lastIndex=t.lastIndex,e}var symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(t){return symbolValueOf$1?Object(symbolValueOf$1.call(t)):{}}function cloneTypedArray(t,e){var n=e?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var boolTag$3="[object Boolean]",dateTag$3="[object Date]",mapTag$7="[object Map]",numberTag$3="[object Number]",regexpTag$3="[object RegExp]",setTag$7="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,e,n){var r=t.constructor;switch(e){case arrayBufferTag$3:return cloneArrayBuffer(t);case boolTag$3:case dateTag$3:return new r(+t);case dataViewTag$2:return cloneDataView(t,n);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(t,n);case mapTag$7:return new r;case numberTag$3:case stringTag$3:return new r(t);case regexpTag$3:return cloneRegExp(t);case setTag$7:return new r;case symbolTag$2:return cloneSymbol(t)}}function initCloneObject(t){return"function"!=typeof t.constructor||isPrototype(t)?{}:baseCreate(getPrototype(t))}var mapTag$6="[object Map]";function baseIsMap(t){return isObjectLike(t)&&getTag$1(t)==mapTag$6}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$6="[object Set]";function baseIsSet(t){return isObjectLike(t)&&getTag$1(t)==setTag$6}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$7=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$5=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$5="[object Map]",numberTag$2="[object Number]",objectTag$1="[object Object]",regexpTag$2="[object RegExp]",setTag$5="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$1="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(t,e,n,r,i,o){var s,a=e&CLONE_DEEP_FLAG$7,l=e&CLONE_FLAT_FLAG$1,c=e&CLONE_SYMBOLS_FLAG$5;if(n&&(s=i?n(t,r,i,o):n(t)),void 0!==s)return s;if(!isObject(t))return t;var u=isArray(t);if(u){if(s=initCloneArray(t),!a)return copyArray(t,s)}else{var h=getTag$1(t),d=h==funcTag||h==genTag;if(isBuffer(t))return cloneBuffer(t,a);if(h==objectTag$1||h==argsTag$1||d&&!i){if(s=l||d?{}:initCloneObject(t),!a)return l?copySymbolsIn(t,baseAssignIn(s,t)):copySymbols(t,baseAssign(s,t))}else{if(!cloneableTags[h])return i?t:{};s=initCloneByTag(t,h,a)}}o||(o=new Stack);var f=o.get(t);if(f)return f;o.set(t,s),isSet(t)?t.forEach((function(r){s.add(baseClone(r,e,n,r,t,o))})):isMap(t)&&t.forEach((function(r,i){s.set(i,baseClone(r,e,n,i,t,o))}));var p=u?void 0:(c?l?getAllKeysIn:getAllKeys:l?keysIn:keys)(t);return arrayEach(p||t,(function(r,i){p&&(r=t[i=r]),assignValue(s,i,baseClone(r,e,n,i,t,o))})),s}cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$5]=cloneableTags[numberTag$2]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$2]=cloneableTags[setTag$5]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag$1]=!1;var CLONE_SYMBOLS_FLAG$4=4;function clone(t){return baseClone(t,CLONE_SYMBOLS_FLAG$4)}var CLONE_DEEP_FLAG$6=1,CLONE_SYMBOLS_FLAG$3=4;function cloneDeep(t){return baseClone(t,CLONE_DEEP_FLAG$6|CLONE_SYMBOLS_FLAG$3)}var CLONE_DEEP_FLAG$5=1,CLONE_SYMBOLS_FLAG$2=4;function cloneDeepWith(t,e){return baseClone(t,CLONE_DEEP_FLAG$5|CLONE_SYMBOLS_FLAG$2,e="function"==typeof e?e:void 0)}var CLONE_SYMBOLS_FLAG$1=4;function cloneWith(t,e){return baseClone(t,CLONE_SYMBOLS_FLAG$1,e="function"==typeof e?e:void 0)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function compact(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i}function concat(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return arrayPush(isArray(n)?copyArray(n):[n],baseFlatten(e,1))}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function SetCache(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new MapCache;++e<n;)this.add(t[e])}function arraySome(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function cacheHas(t,e){return t.has(e)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(t,e,n,r,i,o){var s=n&COMPARE_PARTIAL_FLAG$5,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(t),u=o.get(e);if(c&&u)return c==e&&u==t;var h=-1,d=!0,f=n&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(o.set(t,e),o.set(e,t);++h<a;){var p=t[h],g=e[h];if(r)var m=s?r(g,p,h,e,t,o):r(p,g,h,t,e,o);if(void 0!==m){if(m)continue;d=!1;break}if(f){if(!arraySome(e,(function(t,e){if(!cacheHas(f,e)&&(p===t||i(p,t,n,r,o)))return f.push(e)}))){d=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){d=!1;break}}return o.delete(t),o.delete(e),d}function mapToArray(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function setToArray(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag="[object Error]",mapTag$4="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$4="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(t,e,n,r,i,o,s){switch(n){case dataViewTag:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case arrayBufferTag$1:return!(t.byteLength!=e.byteLength||!o(new Uint8Array$1(t),new Uint8Array$1(e)));case boolTag$1:case dateTag$1:case numberTag$1:return eq(+t,+e);case errorTag:return t.name==e.name&&t.message==e.message;case regexpTag$1:case stringTag$1:return t==e+"";case mapTag$4:var a=mapToArray;case setTag$4:if(a||(a=setToArray),t.size!=e.size&&!(r&COMPARE_PARTIAL_FLAG$4))return!1;var l=s.get(t);if(l)return l==e;r|=COMPARE_UNORDERED_FLAG$2,s.set(t,e);var c=equalArrays(a(t),a(e),r,i,o,s);return s.delete(t),c;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(e)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty;function equalObjects(t,e,n,r,i,o){var s=n&COMPARE_PARTIAL_FLAG$3,a=getAllKeys(t),l=a.length;if(l!=getAllKeys(e).length&&!s)return!1;for(var c=l;c--;){var u=a[c];if(!(s?u in e:hasOwnProperty$a.call(e,u)))return!1}var h=o.get(t),d=o.get(e);if(h&&d)return h==e&&d==t;var f=!0;o.set(t,e),o.set(e,t);for(var p=s;++c<l;){var g=t[u=a[c]],m=e[u];if(r)var A=s?r(m,g,u,e,t,o):r(g,m,u,t,e,o);if(!(void 0===A?g===m||i(g,m,n,r,o):A)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var y=t.constructor,v=e.constructor;y==v||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v||(f=!1)}return o.delete(t),o.delete(e),f}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseIsEqualDeep(t,e,n,r,i,o){var s=isArray(t),a=isArray(e),l=s?arrayTag:getTag$1(t),c=a?arrayTag:getTag$1(e),u=(l=l==argsTag?objectTag:l)==objectTag,h=(c=c==argsTag?objectTag:c)==objectTag,d=l==c;if(d&&isBuffer(t)){if(!isBuffer(e))return!1;s=!0,u=!1}if(d&&!u)return o||(o=new Stack),s||isTypedArray(t)?equalArrays(t,e,n,r,i,o):equalByTag(t,e,l,n,r,i,o);if(!(n&COMPARE_PARTIAL_FLAG$2)){var f=u&&hasOwnProperty$9.call(t,"__wrapped__"),p=h&&hasOwnProperty$9.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,m=p?e.value():e;return o||(o=new Stack),i(g,m,n,r,o)}}return!!d&&(o||(o=new Stack),equalObjects(t,e,n,r,i,o))}function baseIsEqual(t,e,n,r,i){return t===e||(null==t||null==e||!isObjectLike(t)&&!isObjectLike(e)?t!=t&&e!=e:baseIsEqualDeep(t,e,n,r,baseIsEqual,i))}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=Object(t);i--;){var a=n[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var l=(a=n[i])[0],c=t[l],u=a[1];if(s&&a[2]){if(void 0===c&&!(l in t))return!1}else{var h=new Stack;if(r)var d=r(c,u,l,t,e,h);if(!(void 0===d?baseIsEqual(u,c,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,r,h):d))return!1}}return!0}function isStrictComparable(t){return t==t&&!isObject(t)}function getMatchData(t){for(var e=keys(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,isStrictComparable(i)]}return e}function matchesStrictComparable(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}function baseMatches(t){var e=getMatchData(t);return 1==e.length&&e[0][2]?matchesStrictComparable(e[0][0],e[0][1]):function(n){return n===t||baseIsMatch(n,t,e)}}function baseHasIn(t,e){return null!=t&&e in Object(t)}function hasPath(t,e,n){for(var r=-1,i=(e=castPath(e,t)).length,o=!1;++r<i;){var s=toKey(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&isLength(i)&&isIndex(s,i)&&(isArray(t)||isArguments(t))}function hasIn(t,e){return null!=t&&hasPath(t,e,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,e){return isKey(t)&&isStrictComparable(e)?matchesStrictComparable(toKey(t),e):function(n){var r=get(n,t);return void 0===r&&r===e?hasIn(n,t):baseIsEqual(e,r,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(e){return null==e?void 0:e[t]}}function basePropertyDeep(t){return function(e){return baseGet(e,t)}}function property(t){return isKey(t)?baseProperty(toKey(t)):basePropertyDeep(t)}function baseIteratee(t){return"function"==typeof t?t:null==t?identity:"object"==typeof t?isArray(t)?baseMatchesProperty(t[0],t[1]):baseMatches(t):property(t)}var FUNC_ERROR_TEXT$7="Expected a function";function cond(t){var e=null==t?0:t.length,n=baseIteratee;return t=e?arrayMap(t,(function(t){if("function"!=typeof t[1])throw new TypeError(FUNC_ERROR_TEXT$7);return[n(t[0]),t[1]]})):[],baseRest((function(n){for(var r=-1;++r<e;){var i=t[r];if(apply$1(i[0],this,n))return apply$1(i[1],this,n)}}))}function baseConformsTo(t,e,n){var r=n.length;if(null==t)return!r;for(t=Object(t);r--;){var i=n[r],o=t[i];if(void 0===o&&!(i in t)||!(0,e[i])(o))return!1}return!0}function baseConforms(t){var e=keys(t);return function(n){return baseConformsTo(n,t,e)}}var CLONE_DEEP_FLAG$4=1;function conforms(t){return baseConforms(baseClone(t,CLONE_DEEP_FLAG$4))}function conformsTo(t,e){return null==e||baseConformsTo(t,e,keys(e))}function arrayAggregator(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r}function createBaseFor(t){return function(e,n,r){for(var i=-1,o=Object(e),s=r(e),a=s.length;a--;){var l=s[t?a:++i];if(!1===n(o[l],l,o))break}return e}}var baseFor=createBaseFor();function baseForOwn(t,e){return t&&baseFor(t,e,keys)}function createBaseEach(t,e){return function(n,r){if(null==n)return n;if(!isArrayLike(n))return t(n,r);for(var i=n.length,o=e?i:-1,s=Object(n);(e?o--:++o<i)&&!1!==r(s[o],o,s););return n}}var baseEach=createBaseEach(baseForOwn);function baseAggregator(t,e,n,r){return baseEach(t,(function(t,i,o){e(r,t,n(t),o)})),r}function createAggregator(t,e){return function(n,r){var i=isArray(n)?arrayAggregator:baseAggregator,o=e?e():{};return i(n,t,baseIteratee(r),o)}}var objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty,countBy=createAggregator((function(t,e,n){hasOwnProperty$8.call(t,n)?++t[n]:baseAssignValue(t,n,1)}));function create(t,e){var n=baseCreate(t);return null==e?n:baseAssign(n,e)}var WRAP_CURRY_FLAG$1=8;function curry(t,e,n){var r=createWrap(t,WRAP_CURRY_FLAG$1,void 0,void 0,void 0,void 0,void 0,e=n?void 0:e);return r.placeholder=curry.placeholder,r}curry.placeholder={};var WRAP_CURRY_RIGHT_FLAG=16;function curryRight(t,e,n){var r=createWrap(t,WRAP_CURRY_RIGHT_FLAG,void 0,void 0,void 0,void 0,void 0,e=n?void 0:e);return r.placeholder=curryRight.placeholder,r}curryRight.placeholder={};var now=function(){return root.Date.now()},FUNC_ERROR_TEXT$6="Expected a function",nativeMax$b=Math.max,nativeMin$b=Math.min;function debounce$1(t,e,n){var r,i,o,s,a,l,c=0,u=!1,h=!1,d=!0;if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$6);function f(e){var n=r,o=i;return r=i=void 0,c=e,s=t.apply(o,n)}function p(t){return c=t,a=setTimeout(m,e),u?f(t):s}function g(t){var n=t-l;return void 0===l||n>=e||n<0||h&&t-c>=o}function m(){var t=now();if(g(t))return A(t);a=setTimeout(m,function(t){var n=e-(t-l);return h?nativeMin$b(n,o-(t-c)):n}(t))}function A(t){return a=void 0,d&&r?f(t):(r=i=void 0,s)}function y(){var t=now(),n=g(t);if(r=arguments,i=this,l=t,n){if(void 0===a)return p(l);if(h)return clearTimeout(a),a=setTimeout(m,e),f(l)}return void 0===a&&(a=setTimeout(m,e)),s}return e=toNumber(e)||0,isObject(n)&&(u=!!n.leading,o=(h="maxWait"in n)?nativeMax$b(toNumber(n.maxWait)||0,e):o,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=l=i=a=void 0},y.flush=function(){return void 0===a?s:A(now())},y}function defaultTo(t,e){return null==t||t!=t?e:t}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty,defaults$3=baseRest((function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&isIterateeCall(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],s=keysIn(o),a=-1,l=s.length;++a<l;){var c=s[a],u=t[c];(void 0===u||eq(u,objectProto$8[c])&&!hasOwnProperty$7.call(t,c))&&(t[c]=o[c])}return t}));function assignMergeValue(t,e,n){(void 0!==n&&!eq(t[e],n)||void 0===n&&!(e in t))&&baseAssignValue(t,e,n)}function isArrayLikeObject(t){return isObjectLike(t)&&isArrayLike(t)}function safeGet(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function toPlainObject(t){return copyObject(t,keysIn(t))}function baseMergeDeep(t,e,n,r,i,o,s){var a=safeGet(t,n),l=safeGet(e,n),c=s.get(l);if(c)assignMergeValue(t,n,c);else{var u=o?o(a,l,n+"",t,e,s):void 0,h=void 0===u;if(h){var d=isArray(l),f=!d&&isBuffer(l),p=!d&&!f&&isTypedArray(l);u=l,d||f||p?isArray(a)?u=a:isArrayLikeObject(a)?u=copyArray(a):f?(h=!1,u=cloneBuffer(l,!0)):p?(h=!1,u=cloneTypedArray(l,!0)):u=[]:isPlainObject(l)||isArguments(l)?(u=a,isArguments(a)?u=toPlainObject(a):isObject(a)&&!isFunction(a)||(u=initCloneObject(l))):h=!1}h&&(s.set(l,u),i(u,l,r,o,s),s.delete(l)),assignMergeValue(t,n,u)}}function baseMerge(t,e,n,r,i){t!==e&&baseFor(e,(function(o,s){if(i||(i=new Stack),isObject(o))baseMergeDeep(t,e,s,n,baseMerge,r,i);else{var a=r?r(safeGet(t,s),o,s+"",t,e,i):void 0;void 0===a&&(a=o),assignMergeValue(t,s,a)}}),keysIn)}function customDefaultsMerge(t,e,n,r,i,o){return isObject(t)&&isObject(e)&&(o.set(e,t),baseMerge(t,e,void 0,customDefaultsMerge,o),o.delete(e)),t}var mergeWith=createAssigner((function(t,e,n,r){baseMerge(t,e,n,r)})),defaultsDeep=baseRest((function(t){return t.push(void 0,customDefaultsMerge),apply$1(mergeWith,void 0,t)})),FUNC_ERROR_TEXT$5="Expected a function";function baseDelay(t,e,n){if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$5);return setTimeout((function(){t.apply(void 0,n)}),e)}var defer=baseRest((function(t,e){return baseDelay(t,1,e)})),delay=baseRest((function(t,e,n){return baseDelay(t,toNumber(e)||0,n)}));function arrayIncludesWith(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}var LARGE_ARRAY_SIZE$1=200;function baseDifference(t,e,n,r){var i=-1,o=arrayIncludes,s=!0,a=t.length,l=[],c=e.length;if(!a)return l;n&&(e=arrayMap(e,baseUnary(n))),r?(o=arrayIncludesWith,s=!1):e.length>=LARGE_ARRAY_SIZE$1&&(o=cacheHas,s=!1,e=new SetCache(e));t:for(;++i<a;){var u=t[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,s&&h==h){for(var d=c;d--;)if(e[d]===h)continue t;l.push(u)}else o(e,h,r)||l.push(u)}return l}var difference=baseRest((function(t,e){return isArrayLikeObject(t)?baseDifference(t,baseFlatten(e,1,isArrayLikeObject,!0)):[]}));function last(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var differenceBy=baseRest((function(t,e){var n=last(e);return isArrayLikeObject(n)&&(n=void 0),isArrayLikeObject(t)?baseDifference(t,baseFlatten(e,1,isArrayLikeObject,!0),baseIteratee(n)):[]})),differenceWith=baseRest((function(t,e){var n=last(e);return isArrayLikeObject(n)&&(n=void 0),isArrayLikeObject(t)?baseDifference(t,baseFlatten(e,1,isArrayLikeObject,!0),void 0,n):[]})),divide=createMathOperation((function(t,e){return t/e}),1);function drop(t,e,n){var r=null==t?0:t.length;return r?baseSlice(t,(e=n||void 0===e?1:toInteger(e))<0?0:e,r):[]}function dropRight(t,e,n){var r=null==t?0:t.length;return r?baseSlice(t,0,(e=r-(e=n||void 0===e?1:toInteger(e)))<0?0:e):[]}function baseWhile(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?baseSlice(t,r?0:o,r?o+1:i):baseSlice(t,r?o+1:0,r?i:o)}function dropRightWhile(t,e){return t&&t.length?baseWhile(t,baseIteratee(e),!0,!0):[]}function dropWhile(t,e){return t&&t.length?baseWhile(t,baseIteratee(e),!0):[]}function castFunction(t){return"function"==typeof t?t:identity}function forEach(t,e){return(isArray(t)?arrayEach:baseEach)(t,castFunction(e))}function arrayEachRight(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}var baseForRight=createBaseFor(!0);function baseForOwnRight(t,e){return t&&baseForRight(t,e,keys)}var baseEachRight=createBaseEach(baseForOwnRight,!0);function forEachRight(t,e){return(isArray(t)?arrayEachRight:baseEachRight)(t,castFunction(e))}function endsWith(t,e,n){t=toString(t),e=baseToString(e);var r=t.length,i=n=void 0===n?r:baseClamp(toInteger(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e}function baseToPairs(t,e){return arrayMap(e,(function(e){return[e,t[e]]}))}function setToPairs(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}var mapTag$3="[object Map]",setTag$3="[object Set]";function createToPairs(t){return function(e){var n=getTag$1(e);return n==mapTag$3?mapToArray(e):n==setTag$3?setToPairs(e):baseToPairs(e,t(e))}}var toPairs=createToPairs(keys),toPairsIn=createToPairs(keysIn),htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},escapeHtmlChar=basePropertyOf(htmlEscapes),reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(t){return(t=toString(t))&&reHasUnescapedHtml.test(t)?t.replace(reUnescapedHtml,escapeHtmlChar):t}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);function escapeRegExp(t){return(t=toString(t))&&reHasRegExpChar.test(t)?t.replace(reRegExpChar,"\\$&"):t}function arrayEvery(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function baseEvery(t,e){var n=!0;return baseEach(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function every(t,e,n){var r=isArray(t)?arrayEvery:baseEvery;return n&&isIterateeCall(t,e,n)&&(e=void 0),r(t,baseIteratee(e))}var MAX_ARRAY_LENGTH$5=4294967295;function toLength(t){return t?baseClamp(toInteger(t),0,MAX_ARRAY_LENGTH$5):0}function baseFill(t,e,n,r){var i=t.length;for((n=toInteger(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:toInteger(r))<0&&(r+=i),r=n>r?0:toLength(r);n<r;)t[n++]=e;return t}function fill$1(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&isIterateeCall(t,e,n)&&(n=0,r=i),baseFill(t,e,n,r)):[]}function baseFilter(t,e){var n=[];return baseEach(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function filter$1(t,e){return(isArray(t)?arrayFilter:baseFilter)(t,baseIteratee(e))}function createFind(t){return function(e,n,r){var i=Object(e);if(!isArrayLike(e)){var o=baseIteratee(n);e=keys(e),n=function(t){return o(i[t],t,i)}}var s=t(e,n,r);return s>-1?i[o?e[s]:s]:void 0}}var nativeMax$a=Math.max;function findIndex(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:toInteger(n);return i<0&&(i=nativeMax$a(r+i,0)),baseFindIndex(t,baseIteratee(e),i)}var find$1=createFind(findIndex);function baseFindKey(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function findKey(t,e){return baseFindKey(t,baseIteratee(e),baseForOwn)}var nativeMax$9=Math.max,nativeMin$a=Math.min;function findLastIndex(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=toInteger(n),i=n<0?nativeMax$9(r+i,0):nativeMin$a(i,r-1)),baseFindIndex(t,baseIteratee(e),i,!0)}var findLast=createFind(findLastIndex);function findLastKey(t,e){return baseFindKey(t,baseIteratee(e),baseForOwnRight)}function head(t){return t&&t.length?t[0]:void 0}function baseMap(t,e){var n=-1,r=isArrayLike(t)?Array(t.length):[];return baseEach(t,(function(t,i,o){r[++n]=e(t,i,o)})),r}function map(t,e){return(isArray(t)?arrayMap:baseMap)(t,baseIteratee(e))}function flatMap(t,e){return baseFlatten(map(t,e),1)}var INFINITY$2=1/0;function flatMapDeep(t,e){return baseFlatten(map(t,e),INFINITY$2)}function flatMapDepth(t,e,n){return n=void 0===n?1:toInteger(n),baseFlatten(map(t,e),n)}var INFINITY$1=1/0;function flattenDeep(t){return null!=t&&t.length?baseFlatten(t,INFINITY$1):[]}function flattenDepth(t,e){return null!=t&&t.length?baseFlatten(t,e=void 0===e?1:toInteger(e)):[]}var WRAP_FLIP_FLAG=512;function flip(t){return createWrap(t,WRAP_FLIP_FLAG)}var floor=createRound("floor"),FUNC_ERROR_TEXT$4="Expected a function",WRAP_CURRY_FLAG=8,WRAP_PARTIAL_FLAG$1=32,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG$1=256;function createFlow(t){return flatRest((function(e){var n=e.length,r=n,i=LodashWrapper.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new TypeError(FUNC_ERROR_TEXT$4);if(i&&!s&&"wrapper"==getFuncName(o))var s=new LodashWrapper([],!0)}for(r=s?r:n;++r<n;){var a=getFuncName(o=e[r]),l="wrapper"==a?getData(o):void 0;s=l&&isLaziable(l[0])&&l[1]==(WRAP_ARY_FLAG|WRAP_CURRY_FLAG|WRAP_PARTIAL_FLAG$1|WRAP_REARG_FLAG$1)&&!l[4].length&&1==l[9]?s[getFuncName(l[0])].apply(s,l[3]):1==o.length&&isLaziable(o)?s[a]():s.thru(o)}return function(){var t=arguments,r=t[0];if(s&&1==t.length&&isArray(r))return s.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}}))}var flow=createFlow(),flowRight=createFlow(!0);function forIn(t,e){return null==t?t:baseFor(t,castFunction(e),keysIn)}function forInRight(t,e){return null==t?t:baseForRight(t,castFunction(e),keysIn)}function forOwn(t,e){return t&&baseForOwn(t,castFunction(e))}function forOwnRight(t,e){return t&&baseForOwnRight(t,castFunction(e))}function fromPairs(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function baseFunctions(t,e){return arrayFilter(e,(function(e){return isFunction(t[e])}))}function functions(t){return null==t?[]:baseFunctions(t,keys(t))}function functionsIn(t){return null==t?[]:baseFunctions(t,keysIn(t))}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty,groupBy=createAggregator((function(t,e,n){hasOwnProperty$6.call(t,n)?t[n].push(e):baseAssignValue(t,n,[e])}));function baseGt(t,e){return t>e}function createRelationalOperation(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=toNumber(e),n=toNumber(n)),t(e,n)}}var gt=createRelationalOperation(baseGt),gte=createRelationalOperation((function(t,e){return t>=e})),objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function baseHas(t,e){return null!=t&&hasOwnProperty$5.call(t,e)}function has(t,e){return null!=t&&hasPath(t,e,baseHas)}var nativeMax$8=Math.max,nativeMin$9=Math.min;function baseInRange(t,e,n){return t>=nativeMin$9(e,n)&&t<nativeMax$8(e,n)}function inRange(t,e,n){return e=toFinite(e),void 0===n?(n=e,e=0):n=toFinite(n),baseInRange(t=toNumber(t),e,n)}var stringTag="[object String]";function isString(t){return"string"==typeof t||!isArray(t)&&isObjectLike(t)&&baseGetTag(t)==stringTag}function baseValues(t,e){return arrayMap(e,(function(e){return t[e]}))}function values(t){return null==t?[]:baseValues(t,keys(t))}var nativeMax$7=Math.max;function includes(t,e,n,r){t=isArrayLike(t)?t:values(t),n=n&&!r?toInteger(n):0;var i=t.length;return n<0&&(n=nativeMax$7(i+n,0)),isString(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&baseIndexOf(t,e,n)>-1}var nativeMax$6=Math.max;function indexOf(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:toInteger(n);return i<0&&(i=nativeMax$6(r+i,0)),baseIndexOf(t,e,i)}function initial(t){return null!=t&&t.length?baseSlice(t,0,-1):[]}var nativeMin$8=Math.min;function baseIntersection(t,e,n){for(var r=n?arrayIncludesWith:arrayIncludes,i=t[0].length,o=t.length,s=o,a=Array(o),l=1/0,c=[];s--;){var u=t[s];s&&e&&(u=arrayMap(u,baseUnary(e))),l=nativeMin$8(u.length,l),a[s]=!n&&(e||i>=120&&u.length>=120)?new SetCache(s&&u):void 0}u=t[0];var h=-1,d=a[0];t:for(;++h<i&&c.length<l;){var f=u[h],p=e?e(f):f;if(f=n||0!==f?f:0,!(d?cacheHas(d,p):r(c,p,n))){for(s=o;--s;){var g=a[s];if(!(g?cacheHas(g,p):r(t[s],p,n)))continue t}d&&d.push(p),c.push(f)}}return c}function castArrayLikeObject(t){return isArrayLikeObject(t)?t:[]}var intersection=baseRest((function(t){var e=arrayMap(t,castArrayLikeObject);return e.length&&e[0]===t[0]?baseIntersection(e):[]})),intersectionBy=baseRest((function(t){var e=last(t),n=arrayMap(t,castArrayLikeObject);return e===last(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?baseIntersection(n,baseIteratee(e)):[]})),intersectionWith=baseRest((function(t){var e=last(t),n=arrayMap(t,castArrayLikeObject);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?baseIntersection(n,void 0,e):[]}));function baseInverter(t,e,n,r){return baseForOwn(t,(function(t,i,o){e(r,n(t),i,o)})),r}function createInverter(t,e){return function(n,r){return baseInverter(n,t,e(r),{})}}var objectProto$5=Object.prototype,nativeObjectToString$1=objectProto$5.toString,invert$1=createInverter((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=nativeObjectToString$1.call(e)),t[e]=n}),constant(identity)),objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty,nativeObjectToString=objectProto$4.toString,invertBy=createInverter((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=nativeObjectToString.call(e)),hasOwnProperty$4.call(t,e)?t[e].push(n):t[e]=[n]}),baseIteratee);function parent(t,e){return e.length<2?t:baseGet(t,baseSlice(e,0,-1))}function baseInvoke(t,e,n){var r=null==(t=parent(t,e=castPath(e,t)))?t:t[toKey(last(e))];return null==r?void 0:apply$1(r,t,n)}var invoke=baseRest(baseInvoke),invokeMap=baseRest((function(t,e,n){var r=-1,i="function"==typeof e,o=isArrayLike(t)?Array(t.length):[];return baseEach(t,(function(t){o[++r]=i?apply$1(e,t,n):baseInvoke(t,e,n)})),o})),arrayBufferTag="[object ArrayBuffer]";function baseIsArrayBuffer(t){return isObjectLike(t)&&baseGetTag(t)==arrayBufferTag}var nodeIsArrayBuffer=nodeUtil&&nodeUtil.isArrayBuffer,isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):baseIsArrayBuffer,boolTag="[object Boolean]";function isBoolean(t){return!0===t||!1===t||isObjectLike(t)&&baseGetTag(t)==boolTag}var dateTag="[object Date]";function baseIsDate(t){return isObjectLike(t)&&baseGetTag(t)==dateTag}var nodeIsDate=nodeUtil&&nodeUtil.isDate,isDate=nodeIsDate?baseUnary(nodeIsDate):baseIsDate;function isElement(t){return isObjectLike(t)&&1===t.nodeType&&!isPlainObject(t)}var mapTag$2="[object Map]",setTag$2="[object Set]",objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function isEmpty(t){if(null==t)return!0;if(isArrayLike(t)&&(isArray(t)||"string"==typeof t||"function"==typeof t.splice||isBuffer(t)||isTypedArray(t)||isArguments(t)))return!t.length;var e=getTag$1(t);if(e==mapTag$2||e==setTag$2)return!t.size;if(isPrototype(t))return!baseKeys(t).length;for(var n in t)if(hasOwnProperty$3.call(t,n))return!1;return!0}function isEqual(t,e){return baseIsEqual(t,e)}function isEqualWith(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?baseIsEqual(t,e,void 0,n):!!r}var nativeIsFinite=root.isFinite;function isFinite$1(t){return"number"==typeof t&&nativeIsFinite(t)}function isInteger(t){return"number"==typeof t&&t==toInteger(t)}function isMatch(t,e){return t===e||baseIsMatch(t,e,getMatchData(e))}function isMatchWith(t,e,n){return n="function"==typeof n?n:void 0,baseIsMatch(t,e,getMatchData(e),n)}var numberTag="[object Number]";function isNumber(t){return"number"==typeof t||isObjectLike(t)&&baseGetTag(t)==numberTag}function isNaN$1(t){return isNumber(t)&&t!=+t}var isMaskable=coreJsData?isFunction:stubFalse,CORE_ERROR_TEXT="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function isNative(t){if(isMaskable(t))throw new Error(CORE_ERROR_TEXT);return baseIsNative(t)}function isNil(t){return null==t}function isNull(t){return null===t}var regexpTag="[object RegExp]";function baseIsRegExp(t){return isObjectLike(t)&&baseGetTag(t)==regexpTag}var nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp,isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):baseIsRegExp,MAX_SAFE_INTEGER$3=9007199254740991;function isSafeInteger(t){return isInteger(t)&&t>=-MAX_SAFE_INTEGER$3&&t<=MAX_SAFE_INTEGER$3}function isUndefined(t){return void 0===t}var weakMapTag="[object WeakMap]";function isWeakMap(t){return isObjectLike(t)&&getTag$1(t)==weakMapTag}var weakSetTag="[object WeakSet]";function isWeakSet(t){return isObjectLike(t)&&baseGetTag(t)==weakSetTag}var CLONE_DEEP_FLAG$3=1;function iteratee(t){return baseIteratee("function"==typeof t?t:baseClone(t,CLONE_DEEP_FLAG$3))}var arrayProto$4=Array.prototype,nativeJoin=arrayProto$4.join;function join(t,e){return null==t?"":nativeJoin.call(t,e)}var kebabCase$1=createCompounder((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),keyBy=createAggregator((function(t,e,n){baseAssignValue(t,n,e)}));function strictLastIndexOf(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}var nativeMax$5=Math.max,nativeMin$7=Math.min;function lastIndexOf(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=toInteger(n))<0?nativeMax$5(r+i,0):nativeMin$7(i,r-1)),e==e?strictLastIndexOf(t,e,i):baseFindIndex(t,baseIsNaN,i,!0)}var lowerCase=createCompounder((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),lowerFirst=createCaseFirst("toLowerCase");function baseLt(t,e){return t<e}var lt=createRelationalOperation(baseLt),lte=createRelationalOperation((function(t,e){return t<=e}));function mapKeys(t,e){var n={};return e=baseIteratee(e),baseForOwn(t,(function(t,r,i){baseAssignValue(n,e(t,r,i),t)})),n}function mapValues(t,e){var n={};return e=baseIteratee(e),baseForOwn(t,(function(t,r,i){baseAssignValue(n,r,e(t,r,i))})),n}var CLONE_DEEP_FLAG$2=1;function matches(t){return baseMatches(baseClone(t,CLONE_DEEP_FLAG$2))}var CLONE_DEEP_FLAG$1=1;function matchesProperty(t,e){return baseMatchesProperty(t,baseClone(e,CLONE_DEEP_FLAG$1))}function baseExtremum(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],s=e(o);if(null!=s&&(void 0===a?s==s&&!isSymbol(s):n(s,a)))var a=s,l=o}return l}function max(t){return t&&t.length?baseExtremum(t,identity,baseGt):void 0}function maxBy(t,e){return t&&t.length?baseExtremum(t,baseIteratee(e),baseGt):void 0}function baseSum(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}var NAN=NaN;function baseMean(t,e){var n=null==t?0:t.length;return n?baseSum(t,e)/n:NAN}function mean(t){return baseMean(t,identity)}function meanBy(t,e){return baseMean(t,baseIteratee(e))}var merge=createAssigner((function(t,e,n){baseMerge(t,e,n)})),method=baseRest((function(t,e){return function(n){return baseInvoke(n,t,e)}})),methodOf=baseRest((function(t,e){return function(n){return baseInvoke(t,n,e)}}));function min(t){return t&&t.length?baseExtremum(t,identity,baseLt):void 0}function minBy(t,e){return t&&t.length?baseExtremum(t,baseIteratee(e),baseLt):void 0}function mixin$1(t,e,n){var r=keys(e),i=baseFunctions(e,r),o=!(isObject(n)&&"chain"in n&&!n.chain),s=isFunction(t);return arrayEach(i,(function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=copyArray(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,arrayPush([this.value()],arguments))})})),t}var multiply=createMathOperation((function(t,e){return t*e}),1),FUNC_ERROR_TEXT$3="Expected a function";function negate(t){if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$3);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function iteratorToArray(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}var mapTag$1="[object Map]",setTag$1="[object Set]",symIterator$1=Symbol$1?Symbol$1.iterator:void 0;function toArray(t){if(!t)return[];if(isArrayLike(t))return isString(t)?stringToArray(t):copyArray(t);if(symIterator$1&&t[symIterator$1])return iteratorToArray(t[symIterator$1]());var e=getTag$1(t);return(e==mapTag$1?mapToArray:e==setTag$1?setToArray:values)(t)}function wrapperNext(){void 0===this.__values__&&(this.__values__=toArray(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}}function baseNth(t,e){var n=t.length;if(n)return isIndex(e+=e<0?n:0,n)?t[e]:void 0}function nth(t,e){return t&&t.length?baseNth(t,toInteger(e)):void 0}function nthArg(t){return t=toInteger(t),baseRest((function(e){return baseNth(e,t)}))}function baseUnset(t,e){return null==(t=parent(t,e=castPath(e,t)))||delete t[toKey(last(e))]}function customOmitClone(t){return isPlainObject(t)?void 0:t}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,omit=flatRest((function(t,e){var n={};if(null==t)return n;var r=!1;e=arrayMap(e,(function(e){return e=castPath(e,t),r||(r=e.length>1),e})),copyObject(t,getAllKeysIn(t),n),r&&(n=baseClone(n,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone));for(var i=e.length;i--;)baseUnset(n,e[i]);return n}));function baseSet(t,e,n,r){if(!isObject(t))return t;for(var i=-1,o=(e=castPath(e,t)).length,s=o-1,a=t;null!=a&&++i<o;){var l=toKey(e[i]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=s){var u=a[l];void 0===(c=r?r(u,l,a):void 0)&&(c=isObject(u)?u:isIndex(e[i+1])?[]:{})}assignValue(a,l,c),a=a[l]}return t}function basePickBy(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=baseGet(t,s);n(a,s)&&baseSet(o,castPath(s,t),a)}return o}function pickBy(t,e){if(null==t)return{};var n=arrayMap(getAllKeysIn(t),(function(t){return[t]}));return e=baseIteratee(e),basePickBy(t,n,(function(t,n){return e(t,n[0])}))}function omitBy(t,e){return pickBy(t,negate(baseIteratee(e)))}function once(t){return before$1(2,t)}function baseSortBy(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function compareAscending(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,o=isSymbol(t),s=void 0!==e,a=null===e,l=e==e,c=isSymbol(e);if(!a&&!c&&!o&&t>e||o&&s&&l&&!a&&!c||r&&s&&l||!n&&l||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!l)return-1}return 0}function compareMultiple(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,s=i.length,a=n.length;++r<s;){var l=compareAscending(i[r],o[r]);if(l)return r>=a?l:l*("desc"==n[r]?-1:1)}return t.index-e.index}function baseOrderBy(t,e,n){e=e.length?arrayMap(e,(function(t){return isArray(t)?function(e){return baseGet(e,1===t.length?t[0]:t)}:t})):[identity];var r=-1;return e=arrayMap(e,baseUnary(baseIteratee)),baseSortBy(baseMap(t,(function(t){return{criteria:arrayMap(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return compareMultiple(t,e,n)}))}function orderBy(t,e,n,r){return null==t?[]:(isArray(e)||(e=null==e?[]:[e]),isArray(n=r?void 0:n)||(n=null==n?[]:[n]),baseOrderBy(t,e,n))}function createOver(t){return flatRest((function(e){return e=arrayMap(e,baseUnary(baseIteratee)),baseRest((function(n){var r=this;return t(e,(function(t){return apply$1(t,r,n)}))}))}))}var over=createOver(arrayMap),castRest=baseRest,nativeMin$6=Math.min,overArgs=castRest((function(t,e){var n=(e=1==e.length&&isArray(e[0])?arrayMap(e[0],baseUnary(baseIteratee)):arrayMap(baseFlatten(e,1),baseUnary(baseIteratee))).length;return baseRest((function(r){for(var i=-1,o=nativeMin$6(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return apply$1(t,this,r)}))})),overEvery=createOver(arrayEvery),overSome=createOver(arraySome),MAX_SAFE_INTEGER$2=9007199254740991,nativeFloor$3=Math.floor;function baseRepeat(t,e){var n="";if(!t||e<1||e>MAX_SAFE_INTEGER$2)return n;do{e%2&&(n+=t),(e=nativeFloor$3(e/2))&&(t+=t)}while(e);return n}var asciiSize=baseProperty("length"),rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange+"]",rsCombo="["+rsComboRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeSize(t){for(var e=reUnicode.lastIndex=0;reUnicode.test(t);)++e;return e}function stringSize(t){return hasUnicode(t)?unicodeSize(t):asciiSize(t)}var nativeCeil$2=Math.ceil;function createPadding(t,e){var n=(e=void 0===e?" ":baseToString(e)).length;if(n<2)return n?baseRepeat(e,t):e;var r=baseRepeat(e,nativeCeil$2(t/stringSize(e)));return hasUnicode(e)?castSlice(stringToArray(r),0,t).join(""):r.slice(0,t)}var nativeCeil$1=Math.ceil,nativeFloor$2=Math.floor;function pad(t,e,n){t=toString(t);var r=(e=toInteger(e))?stringSize(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return createPadding(nativeFloor$2(i),n)+t+createPadding(nativeCeil$1(i),n)}function padEnd(t,e,n){t=toString(t);var r=(e=toInteger(e))?stringSize(t):0;return e&&r<e?t+createPadding(e-r,n):t}function padStart(t,e,n){t=toString(t);var r=(e=toInteger(e))?stringSize(t):0;return e&&r<e?createPadding(e-r,n)+t:t}var reTrimStart$1=/^\s+/,nativeParseInt=root.parseInt;function parseInt$1(t,e,n){return n||null==e?e=0:e&&(e=+e),nativeParseInt(toString(t).replace(reTrimStart$1,""),e||0)}var WRAP_PARTIAL_FLAG=32,partial=baseRest((function(t,e){var n=replaceHolders(e,getHolder(partial));return createWrap(t,WRAP_PARTIAL_FLAG,void 0,e,n)}));partial.placeholder={};var WRAP_PARTIAL_RIGHT_FLAG=64,partialRight=baseRest((function(t,e){var n=replaceHolders(e,getHolder(partialRight));return createWrap(t,WRAP_PARTIAL_RIGHT_FLAG,void 0,e,n)}));partialRight.placeholder={};var partition=createAggregator((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));function basePick(t,e){return basePickBy(t,e,(function(e,n){return hasIn(t,n)}))}var pick=flatRest((function(t,e){return null==t?{}:basePick(t,e)}));function wrapperPlant(t){for(var e,n=this;n instanceof baseLodash;){var r=wrapperClone(n);r.__index__=0,r.__values__=void 0,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e}function propertyOf(t){return function(e){return null==t?void 0:baseGet(t,e)}}function baseIndexOfWith(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}var arrayProto$3=Array.prototype,splice$1=arrayProto$3.splice;function basePullAll(t,e,n,r){var i=r?baseIndexOfWith:baseIndexOf,o=-1,s=e.length,a=t;for(t===e&&(e=copyArray(e)),n&&(a=arrayMap(t,baseUnary(n)));++o<s;)for(var l=0,c=e[o],u=n?n(c):c;(l=i(a,u,l,r))>-1;)a!==t&&splice$1.call(a,l,1),splice$1.call(t,l,1);return t}function pullAll(t,e){return t&&t.length&&e&&e.length?basePullAll(t,e):t}var pull=baseRest(pullAll);function pullAllBy(t,e,n){return t&&t.length&&e&&e.length?basePullAll(t,e,baseIteratee(n)):t}function pullAllWith(t,e,n){return t&&t.length&&e&&e.length?basePullAll(t,e,void 0,n):t}var arrayProto$2=Array.prototype,splice=arrayProto$2.splice;function basePullAt(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;isIndex(i)?splice.call(t,i,1):baseUnset(t,i)}}return t}var pullAt=flatRest((function(t,e){var n=null==t?0:t.length,r=baseAt(t,e);return basePullAt(t,arrayMap(e,(function(t){return isIndex(t,n)?+t:t})).sort(compareAscending)),r})),nativeFloor$1=Math.floor,nativeRandom$1=Math.random;function baseRandom(t,e){return t+nativeFloor$1(nativeRandom$1()*(e-t+1))}var freeParseFloat=parseFloat,nativeMin$5=Math.min,nativeRandom=Math.random;function random$1(t,e,n){if(n&&"boolean"!=typeof n&&isIterateeCall(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=toFinite(t),void 0===e?(e=t,t=0):e=toFinite(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=nativeRandom();return nativeMin$5(t+i*(e-t+freeParseFloat("1e-"+((i+"").length-1))),e)}return baseRandom(t,e)}var nativeCeil=Math.ceil,nativeMax$4=Math.max;function baseRange(t,e,n,r){for(var i=-1,o=nativeMax$4(nativeCeil((e-t)/(n||1)),0),s=Array(o);o--;)s[r?o:++i]=t,t+=n;return s}function createRange(t){return function(e,n,r){return r&&"number"!=typeof r&&isIterateeCall(e,n,r)&&(n=r=void 0),e=toFinite(e),void 0===n?(n=e,e=0):n=toFinite(n),baseRange(e,n,r=void 0===r?e<n?1:-1:toFinite(r),t)}}var range=createRange(),rangeRight=createRange(!0),WRAP_REARG_FLAG=256,rearg=flatRest((function(t,e){return createWrap(t,WRAP_REARG_FLAG,void 0,void 0,void 0,e)}));function baseReduce(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function reduce(t,e,n){var r=isArray(t)?arrayReduce:baseReduce,i=arguments.length<3;return r(t,baseIteratee(e),n,i,baseEach)}function arrayReduceRight(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function reduceRight(t,e,n){var r=isArray(t)?arrayReduceRight:baseReduce,i=arguments.length<3;return r(t,baseIteratee(e),n,i,baseEachRight)}function reject(t,e){return(isArray(t)?arrayFilter:baseFilter)(t,negate(baseIteratee(e)))}function remove$1(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=baseIteratee(e);++r<o;){var s=t[r];e(s,r,t)&&(n.push(s),i.push(r))}return basePullAt(t,i),n}function repeat(t,e,n){return e=(n?isIterateeCall(t,e,n):void 0===e)?1:toInteger(e),baseRepeat(toString(t),e)}function replace(){var t=arguments,e=toString(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var FUNC_ERROR_TEXT$2="Expected a function";function rest(t,e){if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$2);return baseRest(t,e=void 0===e?e:toInteger(e))}function result(t,e,n){var r=-1,i=(e=castPath(e,t)).length;for(i||(i=1,t=void 0);++r<i;){var o=null==t?void 0:t[toKey(e[r])];void 0===o&&(r=i,o=n),t=isFunction(o)?o.call(t):o}return t}var arrayProto$1=Array.prototype,nativeReverse=arrayProto$1.reverse;function reverse(t){return null==t?t:nativeReverse.call(t)}var round$2=createRound("round");function arraySample(t){var e=t.length;return e?t[baseRandom(0,e-1)]:void 0}function baseSample(t){return arraySample(values(t))}function sample$1(t){return(isArray(t)?arraySample:baseSample)(t)}function shuffleSelf(t,e){var n=-1,r=t.length,i=r-1;for(e=void 0===e?r:e;++n<e;){var o=baseRandom(n,i),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}function arraySampleSize(t,e){return shuffleSelf(copyArray(t),baseClamp(e,0,t.length))}function baseSampleSize(t,e){var n=values(t);return shuffleSelf(n,baseClamp(e,0,n.length))}function sampleSize(t,e,n){return e=(n?isIterateeCall(t,e,n):void 0===e)?1:toInteger(e),(isArray(t)?arraySampleSize:baseSampleSize)(t,e)}function set(t,e,n){return null==t?t:baseSet(t,e,n)}function setWith(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:baseSet(t,e,n,r)}function arrayShuffle(t){return shuffleSelf(copyArray(t))}function baseShuffle(t){return shuffleSelf(values(t))}function shuffle(t){return(isArray(t)?arrayShuffle:baseShuffle)(t)}var mapTag="[object Map]",setTag="[object Set]";function size(t){if(null==t)return 0;if(isArrayLike(t))return isString(t)?stringSize(t):t.length;var e=getTag$1(t);return e==mapTag||e==setTag?t.size:baseKeys(t).length}function slice(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&isIterateeCall(t,e,n)?(e=0,n=r):(e=null==e?0:toInteger(e),n=void 0===n?r:toInteger(n)),baseSlice(t,e,n)):[]}var snakeCase=createCompounder((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));function baseSome(t,e){var n;return baseEach(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function some(t,e,n){var r=isArray(t)?arraySome:baseSome;return n&&isIterateeCall(t,e,n)&&(e=void 0),r(t,baseIteratee(e))}var sortBy=baseRest((function(t,e){if(null==t)return[];var n=e.length;return n>1&&isIterateeCall(t,e[0],e[1])?e=[]:n>2&&isIterateeCall(e[0],e[1],e[2])&&(e=[e[0]]),baseOrderBy(t,baseFlatten(e,1),[])})),MAX_ARRAY_LENGTH$4=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH$4-1,nativeFloor=Math.floor,nativeMin$4=Math.min;function baseSortedIndexBy(t,e,n,r){var i=0,o=null==t?0:t.length;if(0===o)return 0;for(var s=(e=n(e))!=e,a=null===e,l=isSymbol(e),c=void 0===e;i<o;){var u=nativeFloor((i+o)/2),h=n(t[u]),d=void 0!==h,f=null===h,p=h==h,g=isSymbol(h);if(s)var m=r||p;else m=c?p&&(r||d):a?p&&d&&(r||!f):l?p&&d&&!f&&(r||!g):!f&&!g&&(r?h<=e:h<e);m?i=u+1:o=u}return nativeMin$4(o,MAX_ARRAY_INDEX)}var MAX_ARRAY_LENGTH$3=4294967295,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH$3>>>1;function baseSortedIndex(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=HALF_MAX_ARRAY_LENGTH){for(;r<i;){var o=r+i>>>1,s=t[o];null!==s&&!isSymbol(s)&&(n?s<=e:s<e)?r=o+1:i=o}return i}return baseSortedIndexBy(t,e,identity,n)}function sortedIndex(t,e){return baseSortedIndex(t,e)}function sortedIndexBy(t,e,n){return baseSortedIndexBy(t,e,baseIteratee(n))}function sortedIndexOf(t,e){var n=null==t?0:t.length;if(n){var r=baseSortedIndex(t,e);if(r<n&&eq(t[r],e))return r}return-1}function sortedLastIndex(t,e){return baseSortedIndex(t,e,!0)}function sortedLastIndexBy(t,e,n){return baseSortedIndexBy(t,e,baseIteratee(n),!0)}function sortedLastIndexOf(t,e){if(null!=t&&t.length){var n=baseSortedIndex(t,e,!0)-1;if(eq(t[n],e))return n}return-1}function baseSortedUniq(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!eq(a,l)){var l=a;o[i++]=0===s?0:s}}return o}function sortedUniq(t){return t&&t.length?baseSortedUniq(t):[]}function sortedUniqBy(t,e){return t&&t.length?baseSortedUniq(t,baseIteratee(e)):[]}var MAX_ARRAY_LENGTH$2=4294967295;function split(t,e,n){return n&&"number"!=typeof n&&isIterateeCall(t,e,n)&&(e=n=void 0),(n=void 0===n?MAX_ARRAY_LENGTH$2:n>>>0)?(t=toString(t))&&("string"==typeof e||null!=e&&!isRegExp(e))&&!(e=baseToString(e))&&hasUnicode(t)?castSlice(stringToArray(t),0,n):t.split(e,n):[]}var FUNC_ERROR_TEXT$1="Expected a function",nativeMax$3=Math.max;function spread(t,e){if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT$1);return e=null==e?0:nativeMax$3(toInteger(e),0),baseRest((function(n){var r=n[e],i=castSlice(n,0,e);return r&&arrayPush(i,r),apply$1(t,this,i)}))}var startCase=createCompounder((function(t,e,n){return t+(n?" ":"")+upperFirst(e)}));function startsWith(t,e,n){return t=toString(t),n=null==n?0:baseClamp(toInteger(n),0,t.length),e=baseToString(e),t.slice(n,n+e.length)==e}function stubObject(){return{}}function stubString(){return""}function stubTrue(){return!0}var subtract=createMathOperation((function(t,e){return t-e}),0);function sum(t){return t&&t.length?baseSum(t,identity):0}function sumBy(t,e){return t&&t.length?baseSum(t,baseIteratee(e)):0}function tail(t){var e=null==t?0:t.length;return e?baseSlice(t,1,e):[]}function take(t,e,n){return t&&t.length?baseSlice(t,0,(e=n||void 0===e?1:toInteger(e))<0?0:e):[]}function takeRight(t,e,n){var r=null==t?0:t.length;return r?baseSlice(t,(e=r-(e=n||void 0===e?1:toInteger(e)))<0?0:e,r):[]}function takeRightWhile(t,e){return t&&t.length?baseWhile(t,baseIteratee(e),!1,!0):[]}function takeWhile(t,e){return t&&t.length?baseWhile(t,baseIteratee(e)):[]}function tap(t,e){return e(t),t}var objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function customDefaultsAssignIn(t,e,n,r){return void 0===t||eq(t,objectProto$2[n])&&!hasOwnProperty$2.call(r,n)?e:t}var stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function escapeStringChar(t){return"\\"+stringEscapes[t]}var reInterpolate=/<%=([\s\S]+?)%>/g,reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:{escape}}},INVALID_TEMPL_VAR_ERROR_TEXT="Invalid `variable` option passed into `_.template`",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function template(t,e,n){var r=templateSettings.imports._.templateSettings||templateSettings;n&&isIterateeCall(t,e,n)&&(e=void 0),t=toString(t),e=assignInWith({},e,r,customDefaultsAssignIn);var i,o,s=assignInWith({},e.imports,r.imports,customDefaultsAssignIn),a=keys(s),l=baseValues(s,a),c=0,u=e.interpolate||reNoMatch,h="__p += '",d=RegExp((e.escape||reNoMatch).source+"|"+u.source+"|"+(u===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(e.evaluate||reNoMatch).source+"|$","g"),f=hasOwnProperty$1.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+"\n":"";t.replace(d,(function(e,n,r,s,a,l){return r||(r=s),h+=t.slice(c,l).replace(reUnescapedString,escapeStringChar),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),a&&(o=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+e.length,e})),h+="';\n";var p=hasOwnProperty$1.call(e,"variable")&&e.variable;if(p){if(reForbiddenIdentifierChars.test(p))throw new Error(INVALID_TEMPL_VAR_ERROR_TEXT)}else h="with (obj) {\n"+h+"\n}\n";h=(o?h.replace(reEmptyStringLeading,""):h).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=attempt((function(){return Function(a,f+"return "+h).apply(void 0,l)}));if(g.source=h,isError(g))throw g;return g}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);return isObject(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),debounce$1(t,e,{leading:r,maxWait:e,trailing:i})}function thru(t,e){return e(t)}var MAX_SAFE_INTEGER$1=9007199254740991,MAX_ARRAY_LENGTH$1=4294967295,nativeMin$3=Math.min;function times(t,e){if((t=toInteger(t))<1||t>MAX_SAFE_INTEGER$1)return[];var n=MAX_ARRAY_LENGTH$1,r=nativeMin$3(t,MAX_ARRAY_LENGTH$1);e=castFunction(e),t-=MAX_ARRAY_LENGTH$1;for(var i=baseTimes(r,e);++n<t;)e(n);return i}function wrapperToIterator(){return this}function baseWrapperValue(t,e){var n=t;return n instanceof LazyWrapper&&(n=n.value()),arrayReduce(e,(function(t,e){return e.func.apply(e.thisArg,arrayPush([t],e.args))}),n)}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function toLower(t){return toString(t).toLowerCase()}function toPath$1(t){return isArray(t)?arrayMap(t,toKey):isSymbol(t)?[t]:copyArray(stringToPath(toString(t)))}var MAX_SAFE_INTEGER=9007199254740991;function toSafeInteger(t){return t?baseClamp(toInteger(t),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER):0===t?t:0}function toUpper(t){return toString(t).toUpperCase()}function transform$1(t,e,n){var r=isArray(t),i=r||isBuffer(t)||isTypedArray(t);if(e=baseIteratee(e),null==n){var o=t&&t.constructor;n=i?r?new o:[]:isObject(t)&&isFunction(o)?baseCreate(getPrototype(t)):{}}return(i?arrayEach:baseForOwn)(t,(function(t,r,i){return e(n,t,r,i)})),n}function charsEndIndex(t,e){for(var n=t.length;n--&&baseIndexOf(e,t[n],0)>-1;);return n}function charsStartIndex(t,e){for(var n=-1,r=t.length;++n<r&&baseIndexOf(e,t[n],0)>-1;);return n}function trim(t,e,n){if((t=toString(t))&&(n||void 0===e))return baseTrim(t);if(!t||!(e=baseToString(e)))return t;var r=stringToArray(t),i=stringToArray(e);return castSlice(r,charsStartIndex(r,i),charsEndIndex(r,i)+1).join("")}function trimEnd(t,e,n){if((t=toString(t))&&(n||void 0===e))return t.slice(0,trimmedEndIndex(t)+1);if(!t||!(e=baseToString(e)))return t;var r=stringToArray(t);return castSlice(r,0,charsEndIndex(r,stringToArray(e))+1).join("")}var reTrimStart=/^\s+/;function trimStart(t,e,n){if((t=toString(t))&&(n||void 0===e))return t.replace(reTrimStart,"");if(!t||!(e=baseToString(e)))return t;var r=stringToArray(t);return castSlice(r,charsStartIndex(r,stringToArray(e))).join("")}var DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",reFlags=/\w*$/;function truncate(t,e){var n=DEFAULT_TRUNC_LENGTH,r=DEFAULT_TRUNC_OMISSION;if(isObject(e)){var i="separator"in e?e.separator:i;n="length"in e?toInteger(e.length):n,r="omission"in e?baseToString(e.omission):r}var o=(t=toString(t)).length;if(hasUnicode(t)){var s=stringToArray(t);o=s.length}if(n>=o)return t;var a=n-stringSize(r);if(a<1)return r;var l=s?castSlice(s,0,a).join(""):t.slice(0,a);if(void 0===i)return l+r;if(s&&(a+=l.length-a),isRegExp(i)){if(t.slice(a).search(i)){var c,u=l;for(i.global||(i=RegExp(i.source,toString(reFlags.exec(i))+"g")),i.lastIndex=0;c=i.exec(u);)var h=c.index;l=l.slice(0,void 0===h?a:h)}}else if(t.indexOf(baseToString(i),a)!=a){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+r}function unary(t){return ary(t,1)}var htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},unescapeHtmlChar=basePropertyOf(htmlUnescapes),reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reHasEscapedHtml=RegExp(reEscapedHtml.source);function unescape$1(t){return(t=toString(t))&&reHasEscapedHtml.test(t)?t.replace(reEscapedHtml,unescapeHtmlChar):t}var INFINITY=1/0,createSet=Set$1&&1/setToArray(new Set$1([,-0]))[1]==INFINITY?function(t){return new Set$1(t)}:noop$1,LARGE_ARRAY_SIZE=200;function baseUniq(t,e,n){var r=-1,i=arrayIncludes,o=t.length,s=!0,a=[],l=a;if(n)s=!1,i=arrayIncludesWith;else if(o>=LARGE_ARRAY_SIZE){var c=e?null:createSet(t);if(c)return setToArray(c);s=!1,i=cacheHas,l=new SetCache}else l=e?[]:a;t:for(;++r<o;){var u=t[r],h=e?e(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue t;e&&l.push(h),a.push(u)}else i(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}var union=baseRest((function(t){return baseUniq(baseFlatten(t,1,isArrayLikeObject,!0))})),unionBy=baseRest((function(t){var e=last(t);return isArrayLikeObject(e)&&(e=void 0),baseUniq(baseFlatten(t,1,isArrayLikeObject,!0),baseIteratee(e))})),unionWith=baseRest((function(t){var e=last(t);return e="function"==typeof e?e:void 0,baseUniq(baseFlatten(t,1,isArrayLikeObject,!0),void 0,e)}));function uniq(t){return t&&t.length?baseUniq(t):[]}function uniqBy(t,e){return t&&t.length?baseUniq(t,baseIteratee(e)):[]}function uniqWith(t,e){return e="function"==typeof e?e:void 0,t&&t.length?baseUniq(t,void 0,e):[]}var idCounter$1=0;function uniqueId$1(t){var e=++idCounter$1;return toString(t)+e}function unset(t,e){return null==t||baseUnset(t,e)}var nativeMax$2=Math.max;function unzip(t){if(!t||!t.length)return[];var e=0;return t=arrayFilter(t,(function(t){if(isArrayLikeObject(t))return e=nativeMax$2(t.length,e),!0})),baseTimes(e,(function(e){return arrayMap(t,baseProperty(e))}))}function unzipWith(t,e){if(!t||!t.length)return[];var n=unzip(t);return null==e?n:arrayMap(n,(function(t){return apply$1(e,void 0,t)}))}function baseUpdate(t,e,n,r){return baseSet(t,e,n(baseGet(t,e)),r)}function update(t,e,n){return null==t?t:baseUpdate(t,e,castFunction(n))}function updateWith(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:baseUpdate(t,e,castFunction(n),r)}var upperCase=createCompounder((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}));function valuesIn(t){return null==t?[]:baseValues(t,keysIn(t))}var without=baseRest((function(t,e){return isArrayLikeObject(t)?baseDifference(t,e):[]}));function wrap(t,e){return partial(castFunction(e),t)}var wrapperAt=flatRest((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return baseAt(e,t)};return!(e>1||this.__actions__.length)&&r instanceof LazyWrapper&&isIndex(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:thru,args:[i],thisArg:void 0}),new LodashWrapper(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(i)}));function wrapperChain(){return chain(this)}function wrapperReverse(){var t=this.__wrapped__;if(t instanceof LazyWrapper){var e=t;return this.__actions__.length&&(e=new LazyWrapper(this)),(e=e.reverse()).__actions__.push({func:thru,args:[reverse],thisArg:void 0}),new LodashWrapper(e,this.__chain__)}return this.thru(reverse)}function baseXor(t,e,n){var r=t.length;if(r<2)return r?baseUniq(t[0]):[];for(var i=-1,o=Array(r);++i<r;)for(var s=t[i],a=-1;++a<r;)a!=i&&(o[i]=baseDifference(o[i]||s,t[a],e,n));return baseUniq(baseFlatten(o,1),e,n)}var xor=baseRest((function(t){return baseXor(arrayFilter(t,isArrayLikeObject))})),xorBy=baseRest((function(t){var e=last(t);return isArrayLikeObject(e)&&(e=void 0),baseXor(arrayFilter(t,isArrayLikeObject),baseIteratee(e))})),xorWith=baseRest((function(t){var e=last(t);return e="function"==typeof e?e:void 0,baseXor(arrayFilter(t,isArrayLikeObject),void 0,e)})),zip=baseRest(unzip);function baseZipObject(t,e,n){for(var r=-1,i=t.length,o=e.length,s={};++r<i;)n(s,t[r],r<o?e[r]:void 0);return s}function zipObject(t,e){return baseZipObject(t||[],e||[],assignValue)}function zipObjectDeep(t,e){return baseZipObject(t||[],e||[],baseSet)}var zipWith=baseRest((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,unzipWith(t,n)}));const array$2={chunk,compact,concat,difference,differenceBy,differenceWith,drop,dropRight,dropRightWhile,dropWhile,fill:fill$1,findIndex,findLastIndex,first:head,flatten,flattenDeep,flattenDepth,fromPairs,head,indexOf,initial,intersection,intersectionBy,intersectionWith,join,last,lastIndexOf,nth,pull,pullAll,pullAllBy,pullAllWith,pullAt,remove:remove$1,reverse,slice,sortedIndex,sortedIndexBy,sortedIndexOf,sortedLastIndex,sortedLastIndexBy,sortedLastIndexOf,sortedUniq,sortedUniqBy,tail,take,takeRight,takeRightWhile,takeWhile,union,unionBy,unionWith,uniq,uniqBy,uniqWith,unzip,unzipWith,without,xor,xorBy,xorWith,zip,zipObject,zipObjectDeep,zipWith},collection={countBy,each:forEach,eachRight:forEachRight,every,filter:filter$1,find:find$1,findLast,flatMap,flatMapDeep,flatMapDepth,forEach,forEachRight,groupBy,includes,invokeMap,keyBy,map,orderBy,partition,reduce,reduceRight,reject,sample:sample$1,sampleSize,shuffle,size,some,sortBy},date={now},func={after,ary,before:before$1,bind,bindKey,curry,curryRight,debounce:debounce$1,defer,delay,flip,memoize,negate,once,overArgs,partial,partialRight,rearg,rest,spread,throttle,unary,wrap},lang$2={castArray,clone,cloneDeep,cloneDeepWith,cloneWith,conformsTo,eq,gt,gte,isArguments,isArray,isArrayBuffer,isArrayLike,isArrayLikeObject,isBoolean,isBuffer,isDate,isElement,isEmpty,isEqual,isEqualWith,isError,isFinite:isFinite$1,isFunction,isInteger,isLength,isMap,isMatch,isMatchWith,isNaN:isNaN$1,isNative,isNil,isNull,isNumber,isObject,isObjectLike,isPlainObject,isRegExp,isSafeInteger,isSet,isString,isSymbol,isTypedArray,isUndefined,isWeakMap,isWeakSet,lt,lte,toArray,toFinite,toInteger,toLength,toNumber,toPlainObject,toSafeInteger,toString},math={add,ceil,divide,floor,max,maxBy,mean,meanBy,min,minBy,multiply,round:round$2,subtract,sum,sumBy},number$2={clamp:clamp$1,inRange,random:random$1},object$3={assign,assignIn,assignInWith,assignWith,at,create,defaults:defaults$3,defaultsDeep,entries:toPairs,entriesIn:toPairsIn,extend:assignIn,extendWith:assignInWith,findKey,findLastKey,forIn,forInRight,forOwn,forOwnRight,functions,functionsIn,get,has,hasIn,invert:invert$1,invertBy,invoke,keys,keysIn,mapKeys,mapValues,merge,mergeWith,omit,omitBy,pick,pickBy,result,set,setWith,toPairs,toPairsIn,transform:transform$1,unset,update,updateWith,values,valuesIn},seq={at:wrapperAt,chain,commit:wrapperCommit,lodash:lodash$1,next:wrapperNext,plant:wrapperPlant,reverse:wrapperReverse,tap,thru,toIterator:wrapperToIterator,toJSON:wrapperValue,value:wrapperValue,valueOf:wrapperValue,wrapperChain},string$2={camelCase,capitalize,deburr,endsWith,escape,escapeRegExp,kebabCase:kebabCase$1,lowerCase,lowerFirst,pad,padEnd,padStart,parseInt:parseInt$1,repeat,replace,snakeCase,split,startCase,startsWith,template,templateSettings,toLower,toUpper,trim,trimEnd,trimStart,truncate,unescape:unescape$1,upperCase,upperFirst,words},util$5={attempt,bindAll,cond,conforms,constant,defaultTo,flow,flowRight,identity,iteratee,matches,matchesProperty,method,methodOf,mixin:mixin$1,noop:noop$1,nthArg,over,overEvery,overSome,property,propertyOf,range,rangeRight,stubArray,stubFalse,stubObject,stubString,stubTrue,times,toPath:toPath$1,uniqueId:uniqueId$1};function lazyClone(){var t=new LazyWrapper(this.__wrapped__);return t.__actions__=copyArray(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=copyArray(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=copyArray(this.__views__),t}function lazyReverse(){if(this.__filtered__){var t=new LazyWrapper(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t}var nativeMax$1=Math.max,nativeMin$2=Math.min;function getView(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=nativeMin$2(e,t+s);break;case"takeRight":t=nativeMax$1(t,e-s)}}return{start:t,end:e}}var LAZY_FILTER_FLAG$1=1,LAZY_MAP_FLAG=2,nativeMin$1=Math.min;function lazyValue(){var t=this.__wrapped__.value(),e=this.__dir__,n=isArray(t),r=e<0,i=n?t.length:0,o=getView(0,i,this.__views__),s=o.start,a=o.end,l=a-s,c=r?a:s-1,u=this.__iteratees__,h=u.length,d=0,f=nativeMin$1(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return baseWrapperValue(t,this.__actions__);var p=[];t:for(;l--&&d<f;){for(var g=-1,m=t[c+=e];++g<h;){var A=u[g],y=A.type,v=(0,A.iteratee)(m);if(y==LAZY_MAP_FLAG)m=v;else if(!v){if(y==LAZY_FILTER_FLAG$1)continue t;break t}}p[d++]=m}return p}var VERSION="4.17.21",WRAP_BIND_KEY_FLAG=2,LAZY_FILTER_FLAG=1,LAZY_WHILE_FLAG=3,MAX_ARRAY_LENGTH=4294967295,arrayProto=Array.prototype,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,symIterator=Symbol$1?Symbol$1.iterator:void 0,nativeMax=Math.max,nativeMin=Math.min,mixin=function(t){return function(e,n,r){if(null==r){var i=isObject(n),o=i&&keys(n),s=o&&o.length&&baseFunctions(n,o);(s?s.length:i)||(r=n,n=e,e=this)}return t(e,n,r)}}(mixin$1),source;lodash$1.after=func.after,lodash$1.ary=func.ary,lodash$1.assign=object$3.assign,lodash$1.assignIn=object$3.assignIn,lodash$1.assignInWith=object$3.assignInWith,lodash$1.assignWith=object$3.assignWith,lodash$1.at=object$3.at,lodash$1.before=func.before,lodash$1.bind=func.bind,lodash$1.bindAll=util$5.bindAll,lodash$1.bindKey=func.bindKey,lodash$1.castArray=lang$2.castArray,lodash$1.chain=seq.chain,lodash$1.chunk=array$2.chunk,lodash$1.compact=array$2.compact,lodash$1.concat=array$2.concat,lodash$1.cond=util$5.cond,lodash$1.conforms=util$5.conforms,lodash$1.constant=util$5.constant,lodash$1.countBy=collection.countBy,lodash$1.create=object$3.create,lodash$1.curry=func.curry,lodash$1.curryRight=func.curryRight,lodash$1.debounce=func.debounce,lodash$1.defaults=object$3.defaults,lodash$1.defaultsDeep=object$3.defaultsDeep,lodash$1.defer=func.defer,lodash$1.delay=func.delay,lodash$1.difference=array$2.difference,lodash$1.differenceBy=array$2.differenceBy,lodash$1.differenceWith=array$2.differenceWith,lodash$1.drop=array$2.drop,lodash$1.dropRight=array$2.dropRight,lodash$1.dropRightWhile=array$2.dropRightWhile,lodash$1.dropWhile=array$2.dropWhile,lodash$1.fill=array$2.fill,lodash$1.filter=collection.filter,lodash$1.flatMap=collection.flatMap,lodash$1.flatMapDeep=collection.flatMapDeep,lodash$1.flatMapDepth=collection.flatMapDepth,lodash$1.flatten=array$2.flatten,lodash$1.flattenDeep=array$2.flattenDeep,lodash$1.flattenDepth=array$2.flattenDepth,lodash$1.flip=func.flip,lodash$1.flow=util$5.flow,lodash$1.flowRight=util$5.flowRight,lodash$1.fromPairs=array$2.fromPairs,lodash$1.functions=object$3.functions,lodash$1.functionsIn=object$3.functionsIn,lodash$1.groupBy=collection.groupBy,lodash$1.initial=array$2.initial,lodash$1.intersection=array$2.intersection,lodash$1.intersectionBy=array$2.intersectionBy,lodash$1.intersectionWith=array$2.intersectionWith,lodash$1.invert=object$3.invert,lodash$1.invertBy=object$3.invertBy,lodash$1.invokeMap=collection.invokeMap,lodash$1.iteratee=util$5.iteratee,lodash$1.keyBy=collection.keyBy,lodash$1.keys=keys,lodash$1.keysIn=object$3.keysIn,lodash$1.map=collection.map,lodash$1.mapKeys=object$3.mapKeys,lodash$1.mapValues=object$3.mapValues,lodash$1.matches=util$5.matches,lodash$1.matchesProperty=util$5.matchesProperty,lodash$1.memoize=func.memoize,lodash$1.merge=object$3.merge,lodash$1.mergeWith=object$3.mergeWith,lodash$1.method=util$5.method,lodash$1.methodOf=util$5.methodOf,lodash$1.mixin=mixin,lodash$1.negate=negate,lodash$1.nthArg=util$5.nthArg,lodash$1.omit=object$3.omit,lodash$1.omitBy=object$3.omitBy,lodash$1.once=func.once,lodash$1.orderBy=collection.orderBy,lodash$1.over=util$5.over,lodash$1.overArgs=func.overArgs,lodash$1.overEvery=util$5.overEvery,lodash$1.overSome=util$5.overSome,lodash$1.partial=func.partial,lodash$1.partialRight=func.partialRight,lodash$1.partition=collection.partition,lodash$1.pick=object$3.pick,lodash$1.pickBy=object$3.pickBy,lodash$1.property=util$5.property,lodash$1.propertyOf=util$5.propertyOf,lodash$1.pull=array$2.pull,lodash$1.pullAll=array$2.pullAll,lodash$1.pullAllBy=array$2.pullAllBy,lodash$1.pullAllWith=array$2.pullAllWith,lodash$1.pullAt=array$2.pullAt,lodash$1.range=util$5.range,lodash$1.rangeRight=util$5.rangeRight,lodash$1.rearg=func.rearg,lodash$1.reject=collection.reject,lodash$1.remove=array$2.remove,lodash$1.rest=func.rest,lodash$1.reverse=array$2.reverse,lodash$1.sampleSize=collection.sampleSize,lodash$1.set=object$3.set,lodash$1.setWith=object$3.setWith,lodash$1.shuffle=collection.shuffle,lodash$1.slice=array$2.slice,lodash$1.sortBy=collection.sortBy,lodash$1.sortedUniq=array$2.sortedUniq,lodash$1.sortedUniqBy=array$2.sortedUniqBy,lodash$1.split=string$2.split,lodash$1.spread=func.spread,lodash$1.tail=array$2.tail,lodash$1.take=array$2.take,lodash$1.takeRight=array$2.takeRight,lodash$1.takeRightWhile=array$2.takeRightWhile,lodash$1.takeWhile=array$2.takeWhile,lodash$1.tap=seq.tap,lodash$1.throttle=func.throttle,lodash$1.thru=thru,lodash$1.toArray=lang$2.toArray,lodash$1.toPairs=object$3.toPairs,lodash$1.toPairsIn=object$3.toPairsIn,lodash$1.toPath=util$5.toPath,lodash$1.toPlainObject=lang$2.toPlainObject,lodash$1.transform=object$3.transform,lodash$1.unary=func.unary,lodash$1.union=array$2.union,lodash$1.unionBy=array$2.unionBy,lodash$1.unionWith=array$2.unionWith,lodash$1.uniq=array$2.uniq,lodash$1.uniqBy=array$2.uniqBy,lodash$1.uniqWith=array$2.uniqWith,lodash$1.unset=object$3.unset,lodash$1.unzip=array$2.unzip,lodash$1.unzipWith=array$2.unzipWith,lodash$1.update=object$3.update,lodash$1.updateWith=object$3.updateWith,lodash$1.values=object$3.values,lodash$1.valuesIn=object$3.valuesIn,lodash$1.without=array$2.without,lodash$1.words=string$2.words,lodash$1.wrap=func.wrap,lodash$1.xor=array$2.xor,lodash$1.xorBy=array$2.xorBy,lodash$1.xorWith=array$2.xorWith,lodash$1.zip=array$2.zip,lodash$1.zipObject=array$2.zipObject,lodash$1.zipObjectDeep=array$2.zipObjectDeep,lodash$1.zipWith=array$2.zipWith,lodash$1.entries=object$3.toPairs,lodash$1.entriesIn=object$3.toPairsIn,lodash$1.extend=object$3.assignIn,lodash$1.extendWith=object$3.assignInWith,mixin(lodash$1,lodash$1),lodash$1.add=math.add,lodash$1.attempt=util$5.attempt,lodash$1.camelCase=string$2.camelCase,lodash$1.capitalize=string$2.capitalize,lodash$1.ceil=math.ceil,lodash$1.clamp=number$2.clamp,lodash$1.clone=lang$2.clone,lodash$1.cloneDeep=lang$2.cloneDeep,lodash$1.cloneDeepWith=lang$2.cloneDeepWith,lodash$1.cloneWith=lang$2.cloneWith,lodash$1.conformsTo=lang$2.conformsTo,lodash$1.deburr=string$2.deburr,lodash$1.defaultTo=util$5.defaultTo,lodash$1.divide=math.divide,lodash$1.endsWith=string$2.endsWith,lodash$1.eq=lang$2.eq,lodash$1.escape=string$2.escape,lodash$1.escapeRegExp=string$2.escapeRegExp,lodash$1.every=collection.every,lodash$1.find=collection.find,lodash$1.findIndex=array$2.findIndex,lodash$1.findKey=object$3.findKey,lodash$1.findLast=collection.findLast,lodash$1.findLastIndex=array$2.findLastIndex,lodash$1.findLastKey=object$3.findLastKey,lodash$1.floor=math.floor,lodash$1.forEach=collection.forEach,lodash$1.forEachRight=collection.forEachRight,lodash$1.forIn=object$3.forIn,lodash$1.forInRight=object$3.forInRight,lodash$1.forOwn=object$3.forOwn,lodash$1.forOwnRight=object$3.forOwnRight,lodash$1.get=object$3.get,lodash$1.gt=lang$2.gt,lodash$1.gte=lang$2.gte,lodash$1.has=object$3.has,lodash$1.hasIn=object$3.hasIn,lodash$1.head=array$2.head,lodash$1.identity=identity,lodash$1.includes=collection.includes,lodash$1.indexOf=array$2.indexOf,lodash$1.inRange=number$2.inRange,lodash$1.invoke=object$3.invoke,lodash$1.isArguments=lang$2.isArguments,lodash$1.isArray=isArray,lodash$1.isArrayBuffer=lang$2.isArrayBuffer,lodash$1.isArrayLike=lang$2.isArrayLike,lodash$1.isArrayLikeObject=lang$2.isArrayLikeObject,lodash$1.isBoolean=lang$2.isBoolean,lodash$1.isBuffer=lang$2.isBuffer,lodash$1.isDate=lang$2.isDate,lodash$1.isElement=lang$2.isElement,lodash$1.isEmpty=lang$2.isEmpty,lodash$1.isEqual=lang$2.isEqual,lodash$1.isEqualWith=lang$2.isEqualWith,lodash$1.isError=lang$2.isError,lodash$1.isFinite=lang$2.isFinite,lodash$1.isFunction=lang$2.isFunction,lodash$1.isInteger=lang$2.isInteger,lodash$1.isLength=lang$2.isLength,lodash$1.isMap=lang$2.isMap,lodash$1.isMatch=lang$2.isMatch,lodash$1.isMatchWith=lang$2.isMatchWith,lodash$1.isNaN=lang$2.isNaN,lodash$1.isNative=lang$2.isNative,lodash$1.isNil=lang$2.isNil,lodash$1.isNull=lang$2.isNull,lodash$1.isNumber=lang$2.isNumber,lodash$1.isObject=isObject,lodash$1.isObjectLike=lang$2.isObjectLike,lodash$1.isPlainObject=lang$2.isPlainObject,lodash$1.isRegExp=lang$2.isRegExp,lodash$1.isSafeInteger=lang$2.isSafeInteger,lodash$1.isSet=lang$2.isSet,lodash$1.isString=lang$2.isString,lodash$1.isSymbol=lang$2.isSymbol,lodash$1.isTypedArray=lang$2.isTypedArray,lodash$1.isUndefined=lang$2.isUndefined,lodash$1.isWeakMap=lang$2.isWeakMap,lodash$1.isWeakSet=lang$2.isWeakSet,lodash$1.join=array$2.join,lodash$1.kebabCase=string$2.kebabCase,lodash$1.last=last,lodash$1.lastIndexOf=array$2.lastIndexOf,lodash$1.lowerCase=string$2.lowerCase,lodash$1.lowerFirst=string$2.lowerFirst,lodash$1.lt=lang$2.lt,lodash$1.lte=lang$2.lte,lodash$1.max=math.max,lodash$1.maxBy=math.maxBy,lodash$1.mean=math.mean,lodash$1.meanBy=math.meanBy,lodash$1.min=math.min,lodash$1.minBy=math.minBy,lodash$1.stubArray=util$5.stubArray,lodash$1.stubFalse=util$5.stubFalse,lodash$1.stubObject=util$5.stubObject,lodash$1.stubString=util$5.stubString,lodash$1.stubTrue=util$5.stubTrue,lodash$1.multiply=math.multiply,lodash$1.nth=array$2.nth,lodash$1.noop=util$5.noop,lodash$1.now=date.now,lodash$1.pad=string$2.pad,lodash$1.padEnd=string$2.padEnd,lodash$1.padStart=string$2.padStart,lodash$1.parseInt=string$2.parseInt,lodash$1.random=number$2.random,lodash$1.reduce=collection.reduce,lodash$1.reduceRight=collection.reduceRight,lodash$1.repeat=string$2.repeat,lodash$1.replace=string$2.replace,lodash$1.result=object$3.result,lodash$1.round=math.round,lodash$1.sample=collection.sample,lodash$1.size=collection.size,lodash$1.snakeCase=string$2.snakeCase,lodash$1.some=collection.some,lodash$1.sortedIndex=array$2.sortedIndex,lodash$1.sortedIndexBy=array$2.sortedIndexBy,lodash$1.sortedIndexOf=array$2.sortedIndexOf,lodash$1.sortedLastIndex=array$2.sortedLastIndex,lodash$1.sortedLastIndexBy=array$2.sortedLastIndexBy,lodash$1.sortedLastIndexOf=array$2.sortedLastIndexOf,lodash$1.startCase=string$2.startCase,lodash$1.startsWith=string$2.startsWith,lodash$1.subtract=math.subtract,lodash$1.sum=math.sum,lodash$1.sumBy=math.sumBy,lodash$1.template=string$2.template,lodash$1.times=util$5.times,lodash$1.toFinite=lang$2.toFinite,lodash$1.toInteger=toInteger,lodash$1.toLength=lang$2.toLength,lodash$1.toLower=string$2.toLower,lodash$1.toNumber=lang$2.toNumber,lodash$1.toSafeInteger=lang$2.toSafeInteger,lodash$1.toString=lang$2.toString,lodash$1.toUpper=string$2.toUpper,lodash$1.trim=string$2.trim,lodash$1.trimEnd=string$2.trimEnd,lodash$1.trimStart=string$2.trimStart,lodash$1.truncate=string$2.truncate,lodash$1.unescape=string$2.unescape,lodash$1.uniqueId=util$5.uniqueId,lodash$1.upperCase=string$2.upperCase,lodash$1.upperFirst=string$2.upperFirst,lodash$1.each=collection.forEach,lodash$1.eachRight=collection.forEachRight,lodash$1.first=array$2.head,mixin(lodash$1,(source={},baseForOwn(lodash$1,(function(t,e){hasOwnProperty.call(lodash$1.prototype,e)||(source[e]=t)})),source),{chain:!1}),lodash$1.VERSION=VERSION,(lodash$1.templateSettings=string$2.templateSettings).imports._=lodash$1,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){lodash$1[t].placeholder=lodash$1})),arrayEach(["drop","take"],(function(t,e){LazyWrapper.prototype[t]=function(n){n=void 0===n?1:nativeMax(toInteger(n),0);var r=this.__filtered__&&!e?new LazyWrapper(this):this.clone();return r.__filtered__?r.__takeCount__=nativeMin(n,r.__takeCount__):r.__views__.push({size:nativeMin(n,MAX_ARRAY_LENGTH),type:t+(r.__dir__<0?"Right":"")}),r},LazyWrapper.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),arrayEach(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=n==LAZY_FILTER_FLAG||n==LAZY_WHILE_FLAG;LazyWrapper.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:baseIteratee(t),type:n}),e.__filtered__=e.__filtered__||r,e}})),arrayEach(["head","last"],(function(t,e){var n="take"+(e?"Right":"");LazyWrapper.prototype[t]=function(){return this[n](1).value()[0]}})),arrayEach(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");LazyWrapper.prototype[t]=function(){return this.__filtered__?new LazyWrapper(this):this[n](1)}})),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(t){return this.filter(t).head()},LazyWrapper.prototype.findLast=function(t){return this.reverse().find(t)},LazyWrapper.prototype.invokeMap=baseRest((function(t,e){return"function"==typeof t?new LazyWrapper(this):this.map((function(n){return baseInvoke(n,t,e)}))})),LazyWrapper.prototype.reject=function(t){return this.filter(negate(baseIteratee(t)))},LazyWrapper.prototype.slice=function(t,e){t=toInteger(t);var n=this;return n.__filtered__&&(t>0||e<0)?new LazyWrapper(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=toInteger(e))<0?n.dropRight(-e):n.take(e-t)),n)},LazyWrapper.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(MAX_ARRAY_LENGTH)},baseForOwn(LazyWrapper.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=lodash$1[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(lodash$1.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,a=e instanceof LazyWrapper,l=s[0],c=a||isArray(e),u=function(t){var e=i.apply(lodash$1,arrayPush([t],s));return r&&h?e[0]:e};c&&n&&"function"==typeof l&&1!=l.length&&(a=c=!1);var h=this.__chain__,d=!!this.__actions__.length,f=o&&!h,p=a&&!d;if(!o&&c){e=p?e:new LazyWrapper(this);var g=t.apply(e,s);return g.__actions__.push({func:thru,args:[u],thisArg:void 0}),new LodashWrapper(g,h)}return f&&p?t.apply(this,s):(g=this.thru(u),f?r?g.value()[0]:g.value():g)})})),arrayEach(["pop","push","shift","sort","splice","unshift"],(function(t){var e=arrayProto[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);lodash$1.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(isArray(i)?i:[],t)}return this[n]((function(n){return e.apply(isArray(n)?n:[],t)}))}})),baseForOwn(LazyWrapper.prototype,(function(t,e){var n=lodash$1[e];if(n){var r=n.name+"";hasOwnProperty.call(realNames,r)||(realNames[r]=[]),realNames[r].push({name:e,func:n})}})),realNames[createHybrid(void 0,WRAP_BIND_KEY_FLAG).name]=[{name:"wrapper",func:void 0}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash$1.prototype.at=seq.at,lodash$1.prototype.chain=seq.wrapperChain,lodash$1.prototype.commit=seq.commit,lodash$1.prototype.next=seq.next,lodash$1.prototype.plant=seq.plant,lodash$1.prototype.reverse=seq.reverse,lodash$1.prototype.toJSON=lodash$1.prototype.valueOf=lodash$1.prototype.value=seq.value,lodash$1.prototype.first=lodash$1.prototype.head,symIterator&&(lodash$1.prototype[symIterator]=seq.toIterator);const lodash=Object.freeze({__proto__:null,add,after,ary,assign,assignIn,assignInWith,assignWith,at,attempt,before:before$1,bind,bindAll,bindKey,camelCase,capitalize,castArray,ceil,chain,chunk,clamp:clamp$1,clone,cloneDeep,cloneDeepWith,cloneWith,commit:wrapperCommit,compact,concat,cond,conforms,conformsTo,constant,countBy,create,curry,curryRight,debounce:debounce$1,deburr,defaultTo,defaults:defaults$3,defaultsDeep,defer,delay,difference,differenceBy,differenceWith,divide,drop,dropRight,dropRightWhile,dropWhile,each:forEach,eachRight:forEachRight,endsWith,entries:toPairs,entriesIn:toPairsIn,eq,escape,escapeRegExp,every,extend:assignIn,extendWith:assignInWith,fill:fill$1,filter:filter$1,find:find$1,findIndex,findKey,findLast,findLastIndex,findLastKey,first:head,flatMap,flatMapDeep,flatMapDepth,flatten,flattenDeep,flattenDepth,flip,floor,flow,flowRight,forEach,forEachRight,forIn,forInRight,forOwn,forOwnRight,fromPairs,functions,functionsIn,get,groupBy,gt,gte,has,hasIn,head,identity,inRange,includes,indexOf,initial,intersection,intersectionBy,intersectionWith,invert:invert$1,invertBy,invoke,invokeMap,isArguments,isArray,isArrayBuffer,isArrayLike,isArrayLikeObject,isBoolean,isBuffer,isDate,isElement,isEmpty,isEqual,isEqualWith,isError,isFinite:isFinite$1,isFunction,isInteger,isLength,isMap,isMatch,isMatchWith,isNaN:isNaN$1,isNative,isNil,isNull,isNumber,isObject,isObjectLike,isPlainObject,isRegExp,isSafeInteger,isSet,isString,isSymbol,isTypedArray,isUndefined,isWeakMap,isWeakSet,iteratee,join,kebabCase:kebabCase$1,keyBy,keys,keysIn,last,lastIndexOf,lodash:lodash$1,lowerCase,lowerFirst,lt,lte,map,mapKeys,mapValues,matches,matchesProperty,max,maxBy,mean,meanBy,memoize,merge,mergeWith,method,methodOf,min,minBy,mixin:mixin$1,multiply,negate,next:wrapperNext,noop:noop$1,now,nth,nthArg,omit,omitBy,once,orderBy,over,overArgs,overEvery,overSome,pad,padEnd,padStart,parseInt:parseInt$1,partial,partialRight,partition,pick,pickBy,plant:wrapperPlant,property,propertyOf,pull,pullAll,pullAllBy,pullAllWith,pullAt,random:random$1,range,rangeRight,rearg,reduce,reduceRight,reject,remove:remove$1,repeat,replace,rest,result,reverse,round:round$2,sample:sample$1,sampleSize,set,setWith,shuffle,size,slice,snakeCase,some,sortBy,sortedIndex,sortedIndexBy,sortedIndexOf,sortedLastIndex,sortedLastIndexBy,sortedLastIndexOf,sortedUniq,sortedUniqBy,split,spread,startCase,startsWith,stubArray,stubFalse,stubObject,stubString,stubTrue,subtract,sum,sumBy,tail,take,takeRight,takeRightWhile,takeWhile,tap,template,templateSettings,throttle,thru,times,toArray,toFinite,toInteger,toIterator:wrapperToIterator,toJSON:wrapperValue,toLength,toLower,toNumber,toPairs,toPairsIn,toPath:toPath$1,toPlainObject,toSafeInteger,toString,toUpper,transform:transform$1,trim,trimEnd,trimStart,truncate,unary,unescape:unescape$1,union,unionBy,unionWith,uniq,uniqBy,uniqWith,uniqueId:uniqueId$1,unset,unzip,unzipWith,update,updateWith,upperCase,upperFirst,value:wrapperValue,valueOf:wrapperValue,values,valuesIn,without,words,wrap,wrapperAt,wrapperChain,wrapperCommit,wrapperLodash:lodash$1,wrapperNext,wrapperPlant,wrapperReverse,wrapperToIterator,wrapperValue,xor,xorBy,xorWith,zip,zipObject,zipObjectDeep,zipWith,default:lodash$1}),isNumeric=t=>!Array.isArray(t)&&t-parseFloat(t)+1>=0;function applyMixins(t,...e){e.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((n=>{"constructor"!==n&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))}))}))}const extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])};function inherit(t,e){function n(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}class A{}const isNativeClass=/^\s*class\s+/.test(`${A}`)||/^\s*class\s*\{/.test(`${class{}}`);function createClass(t,e){let n;return isNativeClass?n=class extends e{}:(n=function(){return e.apply(this,arguments)},inherit(n,e)),Object.defineProperty(n,"name",{value:t}),n}function isMaliciousProp(t){return"__proto__"===t}function getByPath(t,e,n="/"){let r;const i=Array.isArray(e)?e:e.split(n);if(i.length)for(r=t;i.length;){const t=i.shift();if(Object(r)!==r||!t||!(t in r))return;r=r[t]}return r}function setByPath(t,e,n,r="/"){const i=Array.isArray(e)?e:e.split(r),o=i.pop();if(o&&!isMaliciousProp(o)){let e=t;i.forEach((t=>{isMaliciousProp(t)||(null==e[t]&&(e[t]={}),e=e[t])})),e[o]=n}return t}function unsetByPath(t,e,n="/"){const r=Array.isArray(e)?e.slice():e.split(n),i=r.pop();if(i)if(r.length>0){const e=getByPath(t,r);e&&delete e[i]}else delete t[i];return t}const cacheStringFunction=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},kebabCase=cacheStringFunction((t=>t.replace(/\B([A-Z])/g,"-$1").toLowerCase())),pascalCase=cacheStringFunction((t=>startCase(camelCase(t)).replace(/ /g,"")));function hashcode(t){let e=2166136261,n=!1,r=t;for(let t=0,i=r.length;t<i;t+=1){let i=r.charCodeAt(t);i>127&&!n&&(r=unescape(encodeURIComponent(r)),i=r.charCodeAt(t),n=!0),e^=i,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}return e>>>0}function uuid(){let t="";const e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let n=0,r=e.length;n<r;n+=1){const r=e[n],i=16*Math.random()|0;t+=("x"===r?i:"y"===r?3&i|8:r).toString(16)}return t}function sanitizeHTML(t,e={}){const n=jquery.parseHTML(t,null,!1);return n.forEach((t=>{const e=t;if(e){const t=e.attributes;if(t)for(let n=0,r=t.length;n<r;n+=1){const r=t.item(n);if(r){const t=r.value.toLowerCase(),n=r.name.toLowerCase();(n.startsWith("on")||t.startsWith("javascript:")||t.startsWith("data:")||t.startsWith("vbscript:"))&&e.removeAttribute(n)}}}})),e.raw?n:jquery("<div/>").append(n).html()}function getSpellingSuggestion(t,e,n){const r=Math.min(2,Math.floor(.34*t.length));let i,o=Math.floor(.4*t.length)+1,s=!1;const a=t.toLowerCase();for(const l of e){const e=n(l);if(void 0!==e&&Math.abs(e.length-a.length)<=r){const n=e.toLowerCase();if(n===a){if(e===t)continue;return l}if(s)continue;if(e.length<3)continue;const r=levenshteinWithMax(a,n,o-1);if(void 0===r)continue;r<3?(s=!0,i=l):(o=r,i=l)}}return i}function levenshteinWithMax(t,e,n){let r=new Array(e.length+1),i=new Array(e.length+1);const o=n+1;for(let t=0;t<=e.length;t+=1)r[t]=t;for(let s=1;s<=t.length;s+=1){const a=t.charCodeAt(s-1),l=s>n?s-n:1,c=e.length>n+s?n+s:e.length;i[0]=s;let u=s;for(let t=1;t<l;t+=1)i[t]=o;for(let t=l;t<=c;t+=1){const n=a===e.charCodeAt(t-1)?r[t-1]:Math.min(r[t]+1,i[t-1]+1,r[t-1]+2);i[t]=n,u=Math.min(u,n)}for(let t=c+1;t<=e.length;t+=1)i[t]=o;if(u>n)return;const h=r;r=i,i=h}const s=r[e.length];return s>n?void 0:s}function isPercentage(t){return"string"==typeof t&&"%"===t.slice(-1)}function normalizePercentage(t,e){if(null==t)return 0;let n;if("string"==typeof t){if(n=parseFloat(t),isPercentage(t)&&(n/=100,Number.isFinite(n)))return n*e}else n=t;return Number.isFinite(n)?n>0&&n<1?n*e:n:0}function parseCssNumeric(t,e){const n=parseFloat(t);if(Number.isNaN(n))return null;let r;if(null==e)r="[A-Za-z]*";else if(Array.isArray(e)){if(0===e.length)return null;r=e.join("|")}else"string"==typeof e&&(r=e);const i=function(e){const n=new RegExp(`(?:\\d+(?:\\.\\d+)*)(${e})$`).exec(t);return n?n[1]:null}(r);return null===i?null:{unit:i,value:n}}function normalizeSides(t){if("object"==typeof t){let e=0,n=0,r=0,i=0;return null!=t.vertical&&Number.isFinite(t.vertical)&&(n=i=t.vertical),null!=t.horizontal&&Number.isFinite(t.horizontal)&&(r=e=t.horizontal),null!=t.left&&Number.isFinite(t.left)&&(e=t.left),null!=t.top&&Number.isFinite(t.top)&&(n=t.top),null!=t.right&&Number.isFinite(t.right)&&(r=t.right),null!=t.bottom&&Number.isFinite(t.bottom)&&(i=t.bottom),{top:n,right:r,bottom:i,left:e}}let e=0;return null!=t&&Number.isFinite(t)&&(e=t),{top:e,right:e,bottom:e,left:e}}function apply(t,e,n){if(n)switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4]);case 6:return t.call(e,n[0],n[1],n[2],n[3],n[4],n[5]);default:return t.apply(e,n)}return t.call(e)}function call(t,e,...n){return apply(t,e,n)}function isAsyncLike(t){return"object"==typeof t&&t.then&&"function"==typeof t.then}function isAsync(t){return null!=t&&(t instanceof Promise||isAsyncLike(t))}function toAsyncBoolean(...t){const e=[];if(t.forEach((t=>{Array.isArray(t)?e.push(...t):e.push(t)})),e.some((t=>isAsync(t)))){const t=e.map((t=>isAsync(t)?t:Promise.resolve(!1!==t)));return Promise.all(t).then((t=>t.reduce(((t,e)=>!1!==e&&t),!0)))}return e.every((t=>!1!==t))}function toDeferredBoolean(...t){const e=toAsyncBoolean(t);return"boolean"==typeof e?Promise.resolve(e):e}const rclass=/[\t\r\n\f]/g,rnotwhite=/\S+/g,fillSpaces=t=>` ${t} `;function getClass(t){return t&&t.getAttribute&&t.getAttribute("class")||""}function hasClass(t,e){if(null==t||null==e)return!1;const n=fillSpaces(getClass(t)),r=fillSpaces(e);return 1===t.nodeType&&n.replace(rclass," ").includes(r)}function addClass(t,e){if(null!=t&&null!=e){if("function"==typeof e)return addClass(t,e(getClass(t)));if("string"==typeof e&&1===t.nodeType){const n=e.match(rnotwhite)||[],r=fillSpaces(getClass(t)).replace(rclass," ");let i=n.reduce(((t,e)=>t.indexOf(fillSpaces(e))<0?`${t}${e} `:t),r);i=i.trim(),r!==i&&t.setAttribute("class",i)}}}function removeClass(t,e){if(null!=t){if("function"==typeof e)return removeClass(t,e(getClass(t)));if((!e||"string"==typeof e)&&1===t.nodeType){const n=(e||"").match(rnotwhite)||[],r=fillSpaces(getClass(t)).replace(rclass," ");let i=n.reduce(((t,e)=>{const n=fillSpaces(e);return t.indexOf(n)>-1?t.replace(n," "):t}),r);i=e?i.trim():"",r!==i&&t.setAttribute("class",i)}}}function toggleClass(t,e,n){if(null!=t&&null!=e)if(null==n||"string"!=typeof e){if("function"==typeof e)return toggleClass(t,e(getClass(t),n),n);"string"==typeof e&&(e.match(rnotwhite)||[]).forEach((e=>{hasClass(t,e)?removeClass(t,e):addClass(t,e)}))}else n?addClass(t,e):removeClass(t,e)}let idCounter=0;function uniqueId(){return idCounter+=1,`v${idCounter}`}function ensureId(t){return null!=t.id&&""!==t.id||(t.id=uniqueId()),t.id}function isSVGGraphicsElement(t){return null!=t&&"function"==typeof t.getScreenCTM&&t instanceof SVGElement}const ns={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},svgVersion="1.1";function createElement(t,e=document){return e.createElement(t)}function createElementNS(t,e=ns.xhtml,n=document){return n.createElementNS(e,t)}function createSvgElement(t,e=document){return createElementNS(t,ns.svg,e)}function createSvgDocument(t){if(t){const e=`<svg xmlns="${ns.svg}" xmlns:xlink="${ns.xlink}" version="${svgVersion}">${t}</svg>`,{documentElement:n}=parseXML(e,{async:!1});return n}const e=document.createElementNS(ns.svg,"svg");return e.setAttributeNS(ns.xmlns,"xmlns:xlink",ns.xlink),e.setAttribute("version",svgVersion),e}function parseXML(t,e={}){let n;try{const r=new DOMParser;null!=e.async&&(r.async=e.async),n=r.parseFromString(t,e.mimeType||"text/xml")}catch(t){n=void 0}if(!n||n.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${t}`);return n}function tagName(t,e=!0){const n=t.nodeName;return e?n.toLowerCase():n.toUpperCase()}function index(t){let e=0,n=t.previousSibling;for(;n;)1===n.nodeType&&(e+=1),n=n.previousSibling;return e}function find(t,e){return t.querySelectorAll(e)}function findOne(t,e){return t.querySelector(e)}function findParentByClass(t,e,n){const r=t.ownerSVGElement;let i=t.parentNode;for(;i&&i!==n&&i!==r;){if(hasClass(i,e))return i;i=i.parentNode}return null}function contains(t,e){const n=e&&e.parentNode;return t===n||!!(n&&1===n.nodeType&&16&t.compareDocumentPosition(n))}function remove(t){t.parentNode&&t.parentNode.removeChild(t)}function empty(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function append(t,e){(Array.isArray(e)?e:[e]).forEach((e=>{null!=e&&t.appendChild(e)}))}function prepend(t,e){const n=t.firstChild;return n?before(n,e):append(t,e)}function before(t,e){const n=t.parentNode;n&&(Array.isArray(e)?e:[e]).forEach((e=>{null!=e&&n.insertBefore(e,t)}))}function appendTo(t,e){null!=e&&e.appendChild(t)}function isHTMLElement(t){try{return t instanceof HTMLElement}catch(e){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}}const CASE_SENSITIVE_ATTR=["viewBox","attributeName","attributeType","repeatCount"];function getAttribute(t,e){return t.getAttribute(e)}function removeAttribute(t,e){const n=qualifyAttr(e);n.ns?t.hasAttributeNS(n.ns,n.local)&&t.removeAttributeNS(n.ns,n.local):t.hasAttribute(e)&&t.removeAttribute(e)}function setAttribute(t,e,n){if(null==n)return removeAttribute(t,e);const r=qualifyAttr(e);r.ns&&"string"==typeof n?t.setAttributeNS(r.ns,e,n):"id"===e?t.id=`${n}`:t.setAttribute(e,`${n}`)}function setAttributes(t,e){Object.keys(e).forEach((n=>{setAttribute(t,n,e[n])}))}function attr(t,e,n){if(null==e){const e=t.attributes,n={};for(let t=0;t<e.length;t+=1)n[e[t].name]=e[t].value;return n}if("string"==typeof e&&void 0===n)return t.getAttribute(e);"object"==typeof e?setAttributes(t,e):setAttribute(t,e,n)}function qualifyAttr(t){if(-1!==t.indexOf(":")){const e=t.split(":");return{ns:ns[e[0]],local:e[1]}}return{ns:null,local:t}}function kebablizeAttrs(t){const e={};return Object.keys(t).forEach((n=>{const r=CASE_SENSITIVE_ATTR.includes(n)?n:kebabCase(n);e[r]=t[n]})),e}function styleToObject(t){const e={};return t.split(";").forEach((t=>{const n=t.trim();if(n){const t=n.split("=");t.length&&(e[t[0].trim()]=t[1]?t[1].trim():"")}})),e}function mergeAttrs(t,e){return Object.keys(e).forEach((n=>{if("class"===n)t[n]=t[n]?`${t[n]} ${e[n]}`:e[n];else if("style"===n){const r="object"==typeof t[n],i="object"==typeof e[n];let o,s;r&&i?(o=t[n],s=e[n]):r?(o=t[n],s=styleToObject(e[n])):i?(o=styleToObject(t[n]),s=e[n]):(o=styleToObject(t[n]),s=styleToObject(e[n])),t[n]=mergeAttrs(o,s)}else t[n]=e[n]})),t}function annotate(t,e,n={}){const r=n.offset||0,i=[],o=[];let s,a,l=null;for(let c=0;c<t.length;c+=1){s=o[c]=t[c];for(let i=0,a=e.length;i<a;i+=1){const a=e[i],l=a.end+r;c>=a.start+r&&c<l&&("string"==typeof s?s=o[c]={t:t[c],attrs:a.attrs}:s.attrs=mergeAttrs(mergeAttrs({},s.attrs),a.attrs),n.includeAnnotationIndices&&(null==s.annotations&&(s.annotations=[]),s.annotations.push(i)))}a=o[c-1],a?isObject(s)&&isObject(a)?(l=l,JSON.stringify(s.attrs)===JSON.stringify(a.attrs)?l.t+=s.t:(i.push(l),l=s)):isObject(s)||isObject(a)?(l=l,i.push(l),l=s):l=(l||"")+s:l=s}return null!=l&&i.push(l),i}function sanitize(t){return t.replace(/ /g,"")}var JSONExt,DataUri;let millimeterSize;!function(t){function e(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t}function n(t){return Array.isArray(t)}t.emptyObject=Object.freeze({}),t.emptyArray=Object.freeze([]),t.isPrimitive=e,t.isArray=n,t.isObject=function(t){return!e(t)&&!n(t)},t.deepEqual=function t(r,i){if(r===i)return!0;if(e(r)||e(i))return!1;const o=n(r),s=n(i);return o===s&&(o&&s?function(e,n){if(e===n)return!0;if(e.length!==n.length)return!1;for(let r=0,i=e.length;r<i;r+=1)if(!t(e[r],n[r]))return!1;return!0}(r,i):function(e,n){if(e===n)return!0;for(const t in e)if(!(t in n))return!1;for(const t in n)if(!(t in e))return!1;for(const r in e)if(!t(e[r],n[r]))return!1;return!0}(r,i))},t.deepCopy=function t(r){return e(r)?r:n(r)?function(e){const n=new Array(e.length);for(let r=0,i=e.length;r<i;r+=1)n[r]=t(e[r]);return n}(r):function(e){const n={};return Object.keys(e).forEach((r=>{n[r]=t(e[r])})),n}(r)}}(JSONExt||(JSONExt={})),function(t){function e(t){const e="data:";return t.substr(0,e.length)===e}function n(t){let e=t.replace(/\s/g,"");e=decodeURIComponent(e);const n=e.indexOf(","),r=e.slice(0,n),i=r.split(":")[1].split(";")[0],o=e.slice(n+1);let s;s=r.indexOf("base64")>=0?atob(o):unescape(encodeURIComponent(o));const a=new Uint8Array(s.length);for(let t=0;t<s.length;t+=1)a[t]=s.charCodeAt(t);return new Blob([a],{type:i})}function r(t,e){const n=window.navigator.msSaveBlob;if(n)n(t,e);else{const n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}}function i(t){const e=parseFloat(t);return Number.isNaN(e)?null:e}t.isDataUrl=e,t.imageToDataUri=function(t,n){if(!t||e(t))return void setTimeout((()=>n(null,t)));const r=()=>{n(new Error(`Failed to load image: ${t}`))},i=window.FileReader?t=>{if(200===t.status){const e=new FileReader;e.onload=t=>{n(null,t.target.result)},e.onerror=r,e.readAsDataURL(t.response)}else r()}:e=>{if(200===e.status){let r=t.split(".").pop()||"png";"svg"===r&&(r="svg+xml");const i=`data:image/${r};base64,`,o=new Uint8Array(e.response),s=i+btoa((t=>{const e=[];for(let n=0;n<t.length;n+=32768)e.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return e.join("")})(o));n(null,s)}else r()},o=new XMLHttpRequest;o.responseType=window.FileReader?"blob":"arraybuffer",o.open("GET",t,!0),o.addEventListener("error",r),o.addEventListener("load",(()=>i(o))),o.send()},t.dataUriToBlob=n,t.downloadBlob=r,t.downloadDataUri=function(t,e){r(n(t),e)},t.svgToDataUrl=function(t,e={}){let n=null;const r=e=>(null==n&&(n=function(t){const e=t.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return e&&e[2]?e[2].replace(/\s+/," ").split(" "):null}(t)),null!=n?i(n[e]):null),o=e=>{const n=t.match(e);return n&&n[2]?i(n[2]):null};let s=e.width;if(null==s&&(s=o(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==s&&(s=r(2)),null==s)throw new Error("Can not parse width from svg string");let a=e.height;if(null==a&&(a=o(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==a&&(a=r(3)),null==a)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(t).replace(/'/g,"%27").replace(/"/g,"%22")}`}}(DataUri||(DataUri={}));const supportedUnits={px:t=>t,mm:t=>millimeterSize*t,cm:t=>millimeterSize*t*10,in:t=>millimeterSize*t*25.4,pt:t=>millimeterSize*(25.4*t/72),pc:t=>millimeterSize*(25.4*t/6)};var Unit;!function(t){function e(t,e,n){const r=jquery("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+(n||""),height:e+(n||"")}).appendTo(document.body),i={width:r.width()||0,height:r.height()||0};return r.remove(),i}t.measure=e,t.toPx=function(t,n){null==millimeterSize&&(millimeterSize=e("1","1","mm").width);const r=n?supportedUnits[n]:null;return r?r(t):t}}(Unit||(Unit={}));const requestAnimationFrame$1=function(){let t;const e=window;if(null!=e&&(t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame,null!=t&&(t=t.bind(e))),null==t){let e=0;t=t=>{const n=(new Date).getTime(),r=Math.max(0,16-(n-e)),i=setTimeout((()=>{t(n+r)}),r);return e=n+r,i}}return t}(),cancelAnimationFrame$1=function(){let t;const e=window;return null!=e&&(t=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.msCancelAnimationFrame||e.msCancelRequestAnimationFrame||e.oCancelAnimationFrame||e.oCancelRequestAnimationFrame||e.mozCancelAnimationFrame||e.mozCancelRequestAnimationFrame,t&&(t=t.bind(e))),null==t&&(t=clearTimeout),t}();function getComputedStyle$1(t,e){const n=t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):window.getComputedStyle(t,null);return n&&e?n.getPropertyValue(e)||n[e]:n}var Angle;function round$1(t,e=0){return Number.isInteger(t)?t:+t.toFixed(e)}function random(t,e){let n,r;if(null==e?(r=null==t?1:t,n=0):(r=e,n=null==t?0:t),r<n){const t=n;n=r,r=t}return Math.floor(Math.random()*(r-n+1)+n)}function clamp(t,e,n){return Number.isNaN(t)?NaN:Number.isNaN(e)||Number.isNaN(n)?0:e<n?t<e?e:t>n?n:t:t<n?n:t>e?e:t}function snapToGrid(t,e){return e*Math.round(t/e)}function containsPoint(t,e){return null!=e&&null!=t&&e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height}function squaredLength(t,e){const n=t.x-e.x,r=t.y-e.y;return n*n+r*r}!document||document.createElement("div"),function(t){t.toDeg=function(t){return 180*t/Math.PI%360},t.toRad=function(t,e=!1){return(e?t:t%360)*Math.PI/180},t.normalize=function(t){return t%360+(t<0?360:0)}}(Angle||(Angle={}));class Geometry{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class Point extends Geometry{constructor(t,e){super(),this.x=null==t?0:t,this.y=null==e?0:e}get[Symbol.toStringTag](){return Point.toStringTag}round(t=0){return this.x=round$1(this.x,t),this.y=round$1(this.y,t),this}add(t,e){const n=Point.create(t,e);return this.x+=n.x,this.y+=n.y,this}update(t,e){const n=Point.create(t,e);return this.x=n.x,this.y=n.y,this}translate(t,e){const n=Point.create(t,e);return this.x+=n.x,this.y+=n.y,this}rotate(t,e){const n=Point.rotate(this,t,e);return this.x=n.x,this.y=n.y,this}scale(t,e,n=new Point){const r=Point.create(n);return this.x=r.x+t*(this.x-r.x),this.y=r.y+e*(this.y-r.y),this}closest(t){if(1===t.length)return Point.create(t[0]);let e=null,n=1/0;return t.forEach((t=>{const r=this.squaredDistance(t);r<n&&(e=t,n=r)})),e?Point.create(e):null}distance(t){return Math.sqrt(this.squaredDistance(t))}squaredDistance(t){const e=Point.create(t),n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistance(t){const e=Point.create(t);return Math.abs(e.x-this.x)+Math.abs(e.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(t=new Point){const e=Point.create(t);let n=Math.atan2(-(e.y-this.y),e.x-this.x);return n<0&&(n=2*Math.PI+n),180*n/Math.PI}angleBetween(t,e){if(this.equals(t)||this.equals(e))return NaN;let n=this.theta(e)-this.theta(t);return n<0&&(n+=360),n}vectorAngle(t){return new Point(0,0).angleBetween(this,t)}toPolar(t){return this.update(Point.toPolar(this,t)),this}changeInAngle(t,e,n=new Point){return this.clone().translate(-t,-e).theta(n)-this.theta(n)}adhereToRect(t){return containsPoint(t,this)||(this.x=Math.min(Math.max(this.x,t.x),t.x+t.width),this.y=Math.min(Math.max(this.y,t.y),t.y+t.height)),this}bearing(t){const e=Point.create(t),n=Angle.toRad(this.y),r=Angle.toRad(e.y),i=Angle.toRad(e.x-this.x),o=Math.sin(i)*Math.cos(r),s=Math.cos(n)*Math.sin(r)-Math.sin(n)*Math.cos(r)*Math.cos(i);let a=Angle.toDeg(Math.atan2(o,s))-22.5;return a<0&&(a+=360),a=parseInt(a/45,10),["NE","E","SE","S","SW","W","NW","N"][a]}cross(t,e){if(null!=t&&null!=e){const n=Point.create(t),r=Point.create(e);return(r.x-this.x)*(n.y-this.y)-(r.y-this.y)*(n.x-this.x)}return NaN}dot(t){const e=Point.create(t);return this.x*e.x+this.y*e.y}diff(t,e){if("number"==typeof t)return new Point(this.x-t,this.y-e);const n=Point.create(t);return new Point(this.x-n.x,this.y-n.y)}lerp(t,e){const n=Point.create(t);return new Point((1-e)*this.x+e*n.x,(1-e)*this.y+e*n.y)}normalize(t=1){const e=t/this.magnitude();return this.scale(e,e)}move(t,e){const n=Point.create(t),r=Angle.toRad(n.theta(this));return this.translate(Math.cos(r)*e,-Math.sin(r)*e)}reflection(t){return Point.create(t).move(this,this.distance(t))}snapToGrid(t,e){return this.x=snapToGrid(this.x,t),this.y=snapToGrid(this.y,null==e?t:e),this}equals(t){const e=Point.create(t);return null!=e&&e.x===this.x&&e.y===this.y}clone(){return Point.clone(this)}toJSON(){return Point.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isPoint=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"number"==typeof e.x&&"number"==typeof e.y&&"function"==typeof e.toPolar}}(Point||(Point={})),function(t){t.isPointLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y},t.isPointData=function(t){return null!=t&&Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}}(Point||(Point={})),function(t){function e(e){return t.isPoint(e)?new t(e.x,e.y):Array.isArray(e)?new t(e[0],e[1]):new t(e.x,e.y)}function n(t,e){return t===e||null!=t&&null!=e&&t.x===e.x&&t.y===e.y}function r(n,r,i,o=new t){const s=e(n),a=e(o),l=s.x-a.x,c=s.y-a.y;return new t(l*r-c*i+a.x,c*r+l*i+a.y)}t.create=function(n,r){return null==n||"number"==typeof n?new t(n,r):e(n)},t.clone=e,t.toJSON=function(e){return t.isPoint(e)?{x:e.x,y:e.y}:Array.isArray(e)?{x:e[0],y:e[1]}:{x:e.x,y:e.y}},t.fromPolar=function(n,r,i=new t){let o=Math.abs(n*Math.cos(r)),s=Math.abs(n*Math.sin(r));const a=e(i),l=Angle.normalize(Angle.toDeg(r));return l<90?s=-s:l<180?(o=-o,s=-s):l<270&&(o=-o),new t(a.x+o,a.y+s)},t.toPolar=function(n,r=new t){const i=e(n),o=e(r),s=i.x-o.x,a=i.y-o.y;return new t(Math.sqrt(s*s+a*a),Angle.toRad(o.theta(i)))},t.equals=n,t.equalPoints=function(t,e){if(null==t&&null!=e||null!=t&&null==e||null!=t&&null!=e&&t.length!==e.length)return!1;if(null!=t&&null!=e)for(let r=0,i=t.length;r<i;r+=1)if(!n(t[r],e[r]))return!1;return!0},t.random=function(e,n,r,i){return new t(random(e,n),random(r,i))},t.rotate=function(t,e,n){const i=Angle.toRad(Angle.normalize(-e)),o=Math.sin(i);return r(t,Math.cos(i),o,n)},t.rotateEx=r}(Point||(Point={}));class Rectangle extends Geometry{constructor(t,e,n,r){super(),this.x=null==t?0:t,this.y=null==e?0:e,this.width=null==n?0:n,this.height=null==r?0:r}get[Symbol.toStringTag](){return Rectangle.toStringTag}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new Point(this.x,this.y)}get topLeft(){return new Point(this.x,this.y)}get topCenter(){return new Point(this.x+this.width/2,this.y)}get topRight(){return new Point(this.x+this.width,this.y)}get center(){return new Point(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new Point(this.x,this.y+this.height)}get bottomCenter(){return new Point(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new Point(this.x+this.width,this.y+this.height)}get corner(){return new Point(this.x+this.width,this.y+this.height)}get rightMiddle(){return new Point(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new Point(this.x,this.y+this.height/2)}get topLine(){return new Line(this.topLeft,this.topRight)}get rightLine(){return new Line(this.topRight,this.bottomRight)}get bottomLine(){return new Line(this.bottomLeft,this.bottomRight)}get leftLine(){return new Line(this.topLeft,this.bottomLeft)}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(t){if(!t)return this.clone();const e=Angle.toRad(t),n=Math.abs(Math.sin(e)),r=Math.abs(Math.cos(e)),i=this.width*r+this.height*n,o=this.width*n+this.height*r;return new Rectangle(this.x+(this.width-i)/2,this.y+(this.height-o)/2,i,o)}round(t=0){return this.x=round$1(this.x,t),this.y=round$1(this.y,t),this.width=round$1(this.width,t),this.height=round$1(this.height,t),this}add(t,e,n,r){const i=Rectangle.create(t,e,n,r),o=Math.min(this.x,i.x),s=Math.min(this.y,i.y),a=Math.max(this.x+this.width,i.x+i.width),l=Math.max(this.y+this.height,i.y+i.height);return this.x=o,this.y=s,this.width=a-o,this.height=l-s,this}update(t,e,n,r){const i=Rectangle.create(t,e,n,r);return this.x=i.x,this.y=i.y,this.width=i.width,this.height=i.height,this}inflate(t,e){const n=t,r=null!=e?e:t;return this.x-=n,this.y-=r,this.width+=2*n,this.height+=2*r,this}snapToGrid(t,e){const n=this.origin.snapToGrid(t,e),r=this.corner.snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=r.x-n.x,this.height=r.y-n.y,this}translate(t,e){const n=Point.create(t,e);return this.x+=n.x,this.y+=n.y,this}scale(t,e,n=new Point){const r=this.origin.scale(t,e,n);return this.x=r.x,this.y=r.y,this.width*=t,this.height*=e,this}rotate(t,e=this.getCenter()){if(0!==t){const n=Angle.toRad(t),r=Math.cos(n),i=Math.sin(n);let o=this.getOrigin(),s=this.getTopRight(),a=this.getBottomRight(),l=this.getBottomLeft();o=Point.rotateEx(o,r,i,e),s=Point.rotateEx(s,r,i,e),a=Point.rotateEx(a,r,i,e),l=Point.rotateEx(l,r,i,e);const c=new Rectangle(o.x,o.y,0,0);c.add(s.x,s.y,0,0),c.add(a.x,a.y,0,0),c.add(l.x,l.y,0,0),this.update(c)}return this}rotate90(){const t=(this.width-this.height)/2;this.x+=t,this.y-=t;const e=this.width;return this.width=this.height,this.height=e,this}moveAndExpand(t){const e=Rectangle.clone(t);return this.x+=e.x||0,this.y+=e.y||0,this.width+=e.width||0,this.height+=e.height||0,this}getMaxScaleToFit(t,e=this.center){const n=Rectangle.clone(t),r=e.x,i=e.y;let o=1/0,s=1/0,a=1/0,l=1/0,c=1/0,u=1/0,h=1/0,d=1/0;const f=n.topLeft;f.x<r&&(o=(this.x-r)/(f.x-r)),f.y<i&&(c=(this.y-i)/(f.y-i));const p=n.bottomRight;p.x>r&&(s=(this.x+this.width-r)/(p.x-r)),p.y>i&&(u=(this.y+this.height-i)/(p.y-i));const g=n.topRight;g.x>r&&(a=(this.x+this.width-r)/(g.x-r)),g.y<i&&(h=(this.y-i)/(g.y-i));const m=n.bottomLeft;return m.x<r&&(l=(this.x-r)/(m.x-r)),m.y>i&&(d=(this.y+this.height-i)/(m.y-i)),{sx:Math.min(o,s,a,l),sy:Math.min(c,u,h,d)}}getMaxUniformScaleToFit(t,e=this.center){const n=this.getMaxScaleToFit(t,e);return Math.min(n.sx,n.sy)}containsPoint(t,e){return containsPoint(this,Point.create(t,e))}containsRect(t,e,n,r){const i=Rectangle.create(t,e,n,r),o=this.x,s=this.y,a=this.width,l=this.height,c=i.x,u=i.y,h=i.width,d=i.height;return 0!==a&&0!==l&&0!==h&&0!==d&&c>=o&&u>=s&&c+h<=o+a&&u+d<=s+l}intersectsWithLine(t){const e=[],n=[];return[this.topLine,this.rightLine,this.bottomLine,this.leftLine].forEach((r=>{const i=t.intersectsWithLine(r);null!==i&&n.indexOf(i.toString())<0&&(e.push(i),n.push(i.toString()))})),e.length>0?e:null}intersectsWithLineFromCenterToPoint(t,e){const n=Point.clone(t),r=this.center;let i=null;null!=e&&0!==e&&n.rotate(e,r);const o=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],s=new Line(r,n);for(let t=o.length-1;t>=0;t-=1){const e=o[t].intersectsWithLine(s);if(null!==e){i=e;break}}return i&&null!=e&&0!==e&&i.rotate(-e,r),i}intersectsWithRect(t,e,n,r){const i=Rectangle.create(t,e,n,r);if(!this.isIntersectWithRect(i))return null;const o=this.origin,s=this.corner,a=i.origin,l=i.corner,c=Math.max(o.x,a.x),u=Math.max(o.y,a.y);return new Rectangle(c,u,Math.min(s.x,l.x)-c,Math.min(s.y,l.y)-u)}isIntersectWithRect(t,e,n,r){const i=Rectangle.create(t,e,n,r),o=this.origin,s=this.corner,a=i.origin,l=i.corner;return!(l.x<=o.x||l.y<=o.y||a.x>=s.x||a.y>=s.y)}normalize(){let t=this.x,e=this.y,n=this.width,r=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,r=-this.height),this.x=t,this.y=e,this.width=n,this.height=r,this}union(t){const e=Rectangle.clone(t),n=this.origin,r=this.corner,i=e.origin,o=e.corner,s=Math.min(n.x,i.x),a=Math.min(n.y,i.y),l=Math.max(r.x,o.x),c=Math.max(r.y,o.y);return new Rectangle(s,a,l-s,c-a)}getNearestSideToPoint(t){const e=Point.clone(t),n=this.x+this.width-e.x,r=e.y-this.y;let i=e.x-this.x,o="left";return n<i&&(i=n,o="right"),r<i&&(i=r,o="top"),this.y+this.height-e.y<i&&(o="bottom"),o}getNearestPointToPoint(t){const e=Point.clone(t);if(this.containsPoint(e))switch(this.getNearestSideToPoint(e)){case"right":return new Point(this.x+this.width,e.y);case"left":return new Point(this.x,e.y);case"bottom":return new Point(e.x,this.y+this.height);case"top":return new Point(e.x,this.y)}return e.adhereToRect(this)}equals(t){return null!=t&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isRectangle=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.width&&"number"==typeof e.height&&"function"==typeof e.inflate&&"function"==typeof e.moveAndExpand}}(Rectangle||(Rectangle={})),(Rectangle||(Rectangle={})).isRectangleLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.width&&"number"==typeof t.height},function(t){function e(e){return t.isRectangle(e)?e.clone():Array.isArray(e)?new t(e[0],e[1],e[2],e[3]):new t(e.x,e.y,e.width,e.height)}t.create=function(n,r,i,o){return null==n||"number"==typeof n?new t(n,r,i,o):e(n)},t.clone=e,t.fromSize=function(e){return new t(0,0,e.width,e.height)},t.fromPositionAndSize=function(e,n){return new t(e.x,e.y,n.width,n.height)},t.fromEllipse=function(e){return new t(e.x-e.a,e.y-e.b,2*e.a,2*e.b)}}(Rectangle||(Rectangle={}));class Line extends Geometry{constructor(t,e,n,r){super(),"number"==typeof t&&"number"==typeof e?(this.start=new Point(t,e),this.end=new Point(n,r)):(this.start=Point.create(t),this.end=Point.create(e))}get[Symbol.toStringTag](){return Line.toStringTag}get center(){return new Point((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}getCenter(){return this.center}round(t=0){return this.start.round(t),this.end.round(t),this}translate(t,e){return"number"==typeof t?(this.start.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.end.translate(t)),this}rotate(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this}scale(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.start.x-this.end.x,e=this.start.y-this.end.y;return t*t+e*e}setLength(t){const e=this.length();if(!e)return this;const n=t/e;return this.scale(n,n,this.start)}parallel(t){const e=this.clone();if(!e.isDifferentiable())return e;const{start:n,end:r}=e,i=n.clone().rotate(270,r),o=r.clone().rotate(90,n);return n.move(o,t),r.move(i,t),e}vector(){return new Point(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const t=new Point(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)}bbox(){const t=Math.min(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),r=Math.max(this.start.y,this.end.y);return new Rectangle(t,e,n-t,r-e)}bearing(){return this.start.bearing(this.end)}closestPoint(t){return this.pointAt(this.closestPointNormalizedLength(t))}closestPointLength(t){return this.closestPointNormalizedLength(t)*this.length()}closestPointTangent(t){return this.tangentAt(this.closestPointNormalizedLength(t))}closestPointNormalizedLength(t){const e=this.vector().dot(new Line(this.start,t).vector()),n=Math.min(1,Math.max(0,e/this.squaredLength()));return Number.isNaN(n)?0:n}pointAt(t){const e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)}pointAtLength(t){const e=this.start,n=this.end;let r=!0;t<0&&(r=!1,t=-t);const i=this.length();return t>=i?r?n.clone():e.clone():this.pointAt((r?t:i-t)/i)}divideAt(t){const e=this.pointAt(t);return[new Line(this.start,e),new Line(e,this.end)]}divideAtLength(t){const e=this.pointAtLength(t);return[new Line(this.start,e),new Line(e,this.end)]}containsPoint(t){const e=this.start,n=this.end;if(0!==e.cross(t,n))return!1;const r=this.length();return!(new Line(e,t).length()>r||new Line(t,n).length()>r)}intersect(t,e){const n=t.intersectsWithLine(this,e);return n?Array.isArray(n)?n:[n]:null}intersectsWithLine(t){const e=new Point(this.end.x-this.start.x,this.end.y-this.start.y),n=new Point(t.end.x-t.start.x,t.end.y-t.start.y),r=e.x*n.y-e.y*n.x,i=new Point(t.start.x-this.start.x,t.start.y-this.start.y),o=i.x*n.y-i.y*n.x,s=i.x*e.y-i.y*e.x;if(0===r||o*r<0||s*r<0)return null;if(r>0){if(o>r||s>r)return null}else if(o<r||s<r)return null;return new Point(this.start.x+o*e.x/r,this.start.y+o*e.y/r)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(t){const e=Point.clone(t),n=this.start,r=this.end;return((r.x-n.x)*(e.y-n.y)-(r.y-n.y)*(e.x-n.x))/this.length()}pointSquaredDistance(t,e){const n=Point.create(t,e);return this.closestPoint(n).squaredDistance(n)}pointDistance(t,e){const n=Point.create(t,e);return this.closestPoint(n).distance(n)}tangentAt(t){if(!this.isDifferentiable())return null;const e=this.start,n=this.end,r=this.pointAt(t),i=new Line(e,n);return i.translate(r.x-e.x,r.y-e.y),i}tangentAtLength(t){if(!this.isDifferentiable())return null;const e=this.start,n=this.end,r=this.pointAtLength(t),i=new Line(e,n);return i.translate(r.x-e.x,r.y-e.y),i}relativeCcw(t,e){const n=Point.create(t,e);let r=n.x-this.start.x,i=n.y-this.start.y;const o=this.end.x-this.start.x,s=this.end.y-this.start.y;let a=r*s-i*o;return 0===a&&(a=r*o+i*s,a>0&&(r-=o,i-=s,a=r*o+i*s,a<0&&(a=0))),a<0?-1:a>0?1:0}equals(t){return null!=t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y}clone(){return new Line(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isLine=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag],r=e;try{if((null==n||n===t.toStringTag)&&Point.isPoint(r.start)&&Point.isPoint(r.end)&&"function"==typeof r.vector&&"function"==typeof r.bearing&&"function"==typeof r.parallel&&"function"==typeof r.intersect)return!0}catch(t){return!1}return!1}}(Line||(Line={}));class Ellipse extends Geometry{constructor(t,e,n,r){super(),this.x=null==t?0:t,this.y=null==e?0:e,this.a=null==n?0:n,this.b=null==r?0:r}get[Symbol.toStringTag](){return Ellipse.toStringTag}get center(){return new Point(this.x,this.y)}bbox(){return Rectangle.fromEllipse(this)}getCenter(){return this.center}inflate(t,e){const n=null!=e?e:t;return this.a+=2*t,this.b+=2*n,this}normalizedDistance(t,e){const n=Point.create(t,e),r=n.x-this.x,i=n.y-this.y,o=this.a,s=this.b;return r*r/(o*o)+i*i/(s*s)}containsPoint(t,e){return this.normalizedDistance(t,e)<=1}intersectsWithLine(t){const e=[],n=this.a,r=this.b,i=t.start,o=t.end,s=t.vector(),a=i.diff(new Point(this.x,this.y)),l=new Point(s.x/(n*n),s.y/(r*r)),c=new Point(a.x/(n*n),a.y/(r*r)),u=s.dot(l),h=s.dot(c),d=h*h-u*(a.dot(c)-1);if(d<0)return null;if(d>0){const t=Math.sqrt(d),n=(-h-t)/u,r=(-h+t)/u;if((n<0||n>1)&&(r<0||r>1))return null;n>=0&&n<=1&&e.push(i.lerp(o,n)),r>=0&&r<=1&&e.push(i.lerp(o,r))}else{const t=-h/u;if(!(t>=0&&t<=1))return null;e.push(i.lerp(o,t))}return e}intersectsWithLineFromCenterToPoint(t,e=0){const n=Point.clone(t);e&&n.rotate(e,this.getCenter());const r=n.x-this.x,i=n.y-this.y;let o;if(0===r)return o=this.bbox().getNearestPointToPoint(n),e?o.rotate(-e,this.getCenter()):o;const s=i/r;let a=Math.sqrt(1/(1/(this.a*this.a)+s*s/(this.b*this.b)));return a=r<0?-a:a,o=new Point(this.x+a,this.y+s*a),e?o.rotate(-e,this.getCenter()):o}tangentTheta(t){const e=Point.clone(t),n=e.x,r=e.y,i=this.a,o=this.b,s=this.bbox().center,a=s.x,l=s.y;let c,u;return n>s.x+i/2||n<s.x-i/2?(u=n>s.x?r-30:r+30,c=i*i/(n-a)-i*i*(r-l)*(u-l)/(o*o*(n-a))+a):(c=r>s.y?n+30:n-30,u=o*o/(r-l)-o*o*(n-a)*(c-a)/(i*i*(r-l))+l),new Point(c,u).theta(e)}scale(t,e){return this.a*=t,this.b*=e,this}rotate(t,e){const n=Rectangle.fromEllipse(this);n.rotate(t,e);const r=Ellipse.fromRect(n);return this.a=r.a,this.b=r.b,this.x=r.x,this.y=r.y,this}translate(t,e){const n=Point.create(t,e);return this.x+=n.x,this.y+=n.y,this}equals(t){return null!=t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b}clone(){return new Ellipse(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isEllipse=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.a&&"number"==typeof e.b&&"function"==typeof e.inflate&&"function"==typeof e.normalizedDistance}}(Ellipse||(Ellipse={})),function(t){function e(e){return t.isEllipse(e)?e.clone():Array.isArray(e)?new t(e[0],e[1],e[2],e[3]):new t(e.x,e.y,e.a,e.b)}t.create=function(n,r,i,o){return null==n||"number"==typeof n?new t(n,r,i,o):e(n)},t.parse=e,t.fromRect=function(e){const n=e.center;return new t(n.x,n.y,e.width/2,e.height/2)}}(Ellipse||(Ellipse={}));class Polyline extends Geometry{constructor(t){if(super(),null!=t){if("string"==typeof t)return Polyline.parse(t);this.points=t.map((t=>Point.create(t)))}else this.points=[]}get[Symbol.toStringTag](){return Polyline.toStringTag}get start(){return 0===this.points.length?null:this.points[0]}get end(){return 0===this.points.length?null:this.points[this.points.length-1]}scale(t,e,n=new Point){return this.points.forEach((r=>r.scale(t,e,n))),this}rotate(t,e){return this.points.forEach((n=>n.rotate(t,e))),this}translate(t,e){const n=Point.create(t,e);return this.points.forEach((t=>t.translate(n.x,n.y))),this}bbox(){if(0===this.points.length)return new Rectangle;let t=1/0,e=-1/0,n=1/0,r=-1/0;const i=this.points;for(let o=0,s=i.length;o<s;o+=1){const s=i[o],a=s.x,l=s.y;a<t&&(t=a),a>e&&(e=a),l<n&&(n=l),l>r&&(r=l)}return new Rectangle(t,n,e-t,r-n)}closestPoint(t){const e=this.closestPointLength(t);return this.pointAtLength(e)}closestPointLength(t){const e=this.points,n=e.length;if(0===n||1===n)return 0;let r=0,i=0,o=1/0;for(let s=0,a=n-1;s<a;s+=1){const n=new Line(e[s],e[s+1]),a=n.length(),l=n.closestPointNormalizedLength(t),c=n.pointAt(l).squaredDistance(t);c<o&&(o=c,i=r+l*a),r+=a}return i}closestPointNormalizedLength(t){const e=this.closestPointLength(t);if(0===e)return 0;const n=this.length();return 0===n?0:e/n}closestPointTangent(t){const e=this.closestPointLength(t);return this.tangentAtLength(e)}containsPoint(t){if(0===this.points.length)return!1;const e=Point.clone(t),n=e.x,r=e.y,i=this.points,o=i.length;let s=o-1,a=0;for(let l=0;l<o;l+=1){const o=i[s],c=i[l];if(e.equals(o))return!0;const u=new Line(o,c);if(u.containsPoint(t))return!0;if(r<=o.y&&r>c.y||r>o.y&&r<=c.y){const e=o.x-n>c.x-n?o.x-n:c.x-n;if(e>=0){const i=new Point(n+e,r),o=new Line(t,i);u.intersectsWithLine(o)&&(a+=1)}}s=l}return a%2==1}intersectsWithLine(t){const e=[];for(let n=0,r=this.points.length-1;n<r;n+=1){const r=t.intersectsWithLine(new Line(this.points[n],this.points[n+1]));r&&e.push(r)}return e.length>0?e:null}isDifferentiable(){for(let t=0,e=this.points.length-1;t<e;t+=1)if(new Line(this.points[t],this.points[t+1]).isDifferentiable())return!0;return!1}length(){let t=0;for(let e=0,n=this.points.length-1;e<n;e+=1)t+=this.points[e].distance(this.points[e+1]);return t}pointAt(t){const e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();if(t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();const r=this.length();return this.pointAtLength(r*t)}pointAtLength(t){const e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();let r=!0;t<0&&(r=!1,t=-t);let i=0;for(let o=0,s=n-1;o<s;o+=1){const n=r?o:s-1-o,a=e[n],l=e[n+1],c=new Line(a,l),u=a.distance(l);if(t<=i+u)return c.pointAtLength((r?1:-1)*(t-i));i+=u}return(r?e[n-1]:e[0]).clone()}tangentAt(t){const e=this.points.length;if(0===e||1===e)return null;t<0&&(t=0),t>1&&(t=1);const n=this.length();return this.tangentAtLength(n*t)}tangentAtLength(t){const e=this.points,n=e.length;if(0===n||1===n)return null;let r,i=!0;t<0&&(i=!1,t=-t);let o=0;for(let s=0,a=n-1;s<a;s+=1){const n=i?s:a-1-s,l=e[n],c=e[n+1],u=new Line(l,c),h=l.distance(c);if(u.isDifferentiable()){if(t<=o+h)return u.tangentAtLength((i?1:-1)*(t-o));r=u}o+=h}return r?r.tangentAt(i?1:0):null}simplify(t={}){const e=this.points;if(e.length<3)return this;const n=t.threshold||0;let r=0;for(;e[r+2];){const t=r+1,i=e[t];new Line(e[r],e[r+2]).closestPoint(i).distance(i)<=n?e.splice(t,1):r+=1}return this}toHull(){const t=this.points,e=t.length;if(0===e)return new Polyline;let n=t[0];for(let r=1;r<e;r+=1)(t[r].y<n.y||t[r].y===n.y&&t[r].x>n.x)&&(n=t[r]);const r=[];for(let i=0;i<e;i+=1){let e=n.theta(t[i]);0===e&&(e=360),r.push([t[i],i,e])}r.sort(((t,e)=>{let n=t[2]-e[2];return 0===n&&(n=e[1]-t[1]),n})),r.length>2&&r.unshift(r[r.length-1]);const i={},o=[],s=t=>`${t[0].toString()}@${t[1]}`;for(;0!==r.length;){const t=r.pop(),e=t[0];if(i[s(t)])continue;let n=!1;for(;!n;)if(o.length<2)o.push(t),n=!0;else{const a=o.pop(),l=a[0],c=o.pop(),u=c[0],h=u.cross(l,e);if(h<0)o.push(c),o.push(a),o.push(t),n=!0;else if(0===h){const t=1e-10,n=l.angleBetween(u,e);Math.abs(n-180)<t||l.equals(e)||u.equals(l)?(i[s(a)]=l,o.push(c)):Math.abs((n+1)%360-1)<t&&(o.push(c),r.push(a))}else i[s(a)]=l,o.push(c)}}let a;o.length>2&&o.pop();let l=-1;for(let t=0,e=o.length;t<e;t+=1){const e=o[t][1];(void 0===a||e<a)&&(a=e,l=t)}let c=[];if(l>0){const t=o.slice(l),e=o.slice(0,l);c=t.concat(e)}else c=o;const u=[];for(let t=0,e=c.length;t<e;t+=1)u.push(c[t][0]);return new Polyline(u)}equals(t){return null!=t&&t.points.length===this.points.length&&t.points.every(((t,e)=>t.equals(this.points[e])))}clone(){return new Polyline(this.points.map((t=>t.clone())))}toJSON(){return this.points.map((t=>t.toJSON()))}serialize(){return this.points.map((t=>`${t.x}, ${t.y}`)).join(" ")}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isPolyline=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.toHull&&"function"==typeof e.simplify}}(Polyline||(Polyline={})),function(t){t.parse=function(e){const n=e.trim();if(""===n)return new t;const r=[],i=n.split(/\s*,\s*|\s+/);for(let t=0,e=i.length;t<e;t+=2)r.push({x:+i[t],y:+i[t+1]});return new t(r)}}(Polyline||(Polyline={}));class Curve extends Geometry{constructor(t,e,n,r){super(),this.PRECISION=3,this.start=Point.create(t),this.controlPoint1=Point.create(e),this.controlPoint2=Point.create(n),this.end=Point.create(r)}get[Symbol.toStringTag](){return Curve.toStringTag}bbox(){const t=this.start,e=this.controlPoint1,n=this.controlPoint2,r=this.end,i=t.x,o=t.y,s=e.x,a=e.y,l=n.x,c=n.y,u=r.x,h=r.y,d=[],f=[],p=[[],[]];let g,m,A,y,v,b,x,w,C,$,_;for(let t=0;t<2;t+=1)if(0===t?(m=6*i-12*s+6*l,g=-3*i+9*s-9*l+3*u,A=3*s-3*i):(m=6*o-12*a+6*c,g=-3*o+9*a-9*c+3*h,A=3*a-3*o),Math.abs(g)<1e-12){if(Math.abs(m)<1e-12)continue;y=-A/m,y>0&&y<1&&f.push(y)}else x=m*m-4*A*g,w=Math.sqrt(x),x<0||(v=(-m+w)/(2*g),v>0&&v<1&&f.push(v),b=(-m-w)/(2*g),b>0&&b<1&&f.push(b));let P=f.length;const S=P;for(;P;)P-=1,y=f[P],_=1-y,C=_*_*_*i+3*_*_*y*s+3*_*y*y*l+y*y*y*u,p[0][P]=C,$=_*_*_*o+3*_*_*y*a+3*_*y*y*c+y*y*y*h,p[1][P]=$,d[P]={X:C,Y:$};f[S]=0,f[S+1]=1,d[S]={X:i,Y:o},d[S+1]={X:u,Y:h},p[0][S]=i,p[1][S]=o,p[0][S+1]=u,p[1][S+1]=h,f.length=S+2,p[0].length=S+2,p[1].length=S+2,d.length=S+2;const M=Math.min.apply(null,p[0]),E=Math.min.apply(null,p[1]),T=Math.max.apply(null,p[0]),k=Math.max.apply(null,p[1]);return new Rectangle(M,E,T-M,k-E)}closestPoint(t,e={}){return this.pointAtT(this.closestPointT(t,e))}closestPointLength(t,e={}){const n=this.getOptions(e);return this.lengthAtT(this.closestPointT(t,n),n)}closestPointNormalizedLength(t,e={}){const n=this.getOptions(e),r=this.closestPointLength(t,n);if(!r)return 0;const i=this.length(n);return 0===i?0:r/i}closestPointT(t,e={}){const n=this.getPrecision(e),r=this.getDivisions(e),i=Math.pow(10,-n);let o=null,s=0,a=0,l=0,c=0,u=0,h=null;const d=r.length;let f=d>0?1/d:0;for(r.forEach(((e,n)=>{const r=e.start.distance(t),i=e.end.distance(t),d=r+i;(null==h||d<h)&&(o=e,s=n*f,a=(n+1)*f,l=r,c=i,h=d,u=e.endpointDistance())}));;){const e=l?Math.abs(l-c)/l:0,n=null!=c?Math.abs(l-c)/c:0,r=!c||c<u*i,h=!l||l<u*i||r;if(e<i||n<i||h)return l<=c?s:a;const d=o.divide(.5);f/=2;const p=d[0].start.distance(t),g=d[0].end.distance(t),m=p+g,A=d[1].start.distance(t),y=d[1].end.distance(t);m<=A+y?(o=d[0],a-=f,l=p,c=g):(o=d[1],s+=f,l=A,c=y)}}closestPointTangent(t,e={}){return this.tangentAtT(this.closestPointT(t,e))}containsPoint(t,e={}){return this.toPolyline(e).containsPoint(t)}divideAt(t,e={}){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);const n=this.tAt(t,e);return this.divideAtT(n)}divideAtLength(t,e={}){const n=this.tAtLength(t,e);return this.divideAtT(n)}divide(t){return this.divideAtT(t)}divideAtT(t){const e=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(t<=0)return[new Curve(e,e,e,e),new Curve(e,n,r,i)];if(t>=1)return[new Curve(e,n,r,i),new Curve(i,i,i,i)];const o=this.getSkeletonPoints(t),s=o.divider,a=o.dividerControlPoint1,l=o.dividerControlPoint2;return[new Curve(e,o.startControlPoint1,o.startControlPoint2,s),new Curve(s,a,l,i)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(t){const e=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:r.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:r.clone(),divider:i.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:i.clone()};const o=new Line(e,n).pointAt(t),s=new Line(n,r).pointAt(t),a=new Line(r,i).pointAt(t),l=new Line(o,s).pointAt(t),c=new Line(s,a).pointAt(t);return{startControlPoint1:o,startControlPoint2:l,divider:new Line(l,c).pointAt(t),dividerControlPoint1:c,dividerControlPoint2:a}}getSubdivisions(t={}){const e=this.getPrecision(t);let n=[new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===e)return n;let r=this.endpointDistance();const i=Math.pow(10,-e);let o=0;for(;;){o+=1;const t=[];n.forEach((e=>{const n=e.divide(.5);t.push(n[0],n[1])}));const e=t.reduce(((t,e)=>t+e.endpointDistance()),0),s=0!==e?(e-r)/e:0;if(o>1&&s<i)return t;n=t,r=e}}length(t={}){return this.getDivisions(t).reduce(((t,e)=>t+e.endpointDistance()),0)}lengthAtT(t,e={}){if(t<=0)return 0;const n=void 0===e.precision?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:n})}pointAt(t,e={}){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const n=this.tAt(t,e);return this.pointAtT(n)}pointAtLength(t,e={}){const n=this.tAtLength(t,e);return this.pointAtT(n)}pointAtT(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider}isDifferentiable(){const t=this.controlPoint1,e=this.controlPoint2,n=this.end;return!(this.start.equals(t)&&t.equals(e)&&e.equals(n))}tangentAt(t,e={}){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);const n=this.tAt(t,e);return this.tangentAtT(n)}tangentAtLength(t,e={}){if(!this.isDifferentiable())return null;const n=this.tAtLength(t,e);return this.tangentAtT(n)}tangentAtT(t){if(!this.isDifferentiable())return null;t<0&&(t=0),t>1&&(t=1);const e=this.getSkeletonPoints(t),n=e.startControlPoint2,r=e.divider,i=new Line(n,e.dividerControlPoint1);return i.translate(r.x-n.x,r.y-n.y),i}getPrecision(t={}){return null==t.precision?this.PRECISION:t.precision}getDivisions(t={}){if(null!=t.subdivisions)return t.subdivisions;const e=this.getPrecision(t);return this.getSubdivisions({precision:e})}getOptions(t={}){return{precision:this.getPrecision(t),subdivisions:this.getDivisions(t)}}tAt(t,e={}){if(t<=0)return 0;if(t>=1)return 1;const n=this.getOptions(e),r=this.length(n);return this.tAtLength(r*t,n)}tAtLength(t,e={}){let n=!0;t<0&&(n=!1,t=-t);const r=this.getPrecision(e),i=this.getDivisions(e),o={precision:r,subdivisions:i};let s,a,l=null,c=0,u=0,h=0;const d=i.length;let f=d>0?1/d:0;for(let e=0;e<d;e+=1){const r=n?e:d-1-e,o=i[e],p=o.endpointDistance();if(t<=h+p){l=o,s=r*f,a=(r+1)*f,c=n?t-h:p+h-t,u=n?p+h-t:t-h;break}h+=p}if(null==l)return n?1:0;const p=this.length(o),g=Math.pow(10,-r);for(;;){let t,e,n;if(t=0!==p?c/p:0,t<g)return s;if(t=0!==p?u/p:0,t<g)return a;const r=l.divide(.5);f/=2;const i=r[0].endpointDistance(),o=r[1].endpointDistance();c<=i?(l=r[0],a-=f,e=c,n=i-e):(l=r[1],s+=f,e=c-i,n=o-e),c=e,u=n}}toPoints(t={}){const e=this.getDivisions(t),n=[e[0].start.clone()];return e.forEach((t=>n.push(t.end.clone()))),n}toPolyline(t={}){return new Polyline(this.toPoints(t))}scale(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.start.rotate(t,e),this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?(this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return null!=t&&this.start.equals(t.start)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)&&this.end.equals(t.end)}clone(){return new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isCurve=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag],r=e;try{if((null==n||n===t.toStringTag)&&Point.isPoint(r.start)&&Point.isPoint(r.controlPoint1)&&Point.isPoint(r.controlPoint2)&&Point.isPoint(r.end)&&"function"==typeof r.toPoints&&"function"==typeof r.toPolyline)return!0}catch(t){return!1}return!1}}(Curve||(Curve={})),function(t){function e(t){const e=t.length,n=[],r=[];let i=2;n[0]=t[0]/i;for(let o=1;o<e;o+=1)r[o]=1/i,i=(o<e-1?4:3.5)-r[o],n[o]=(t[o]-n[o-1])/i;for(let t=1;t<e;t+=1)n[e-t-1]-=r[e-t]*n[e-t];return n}t.throughPoints=function(n){if(null==n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");const r=function(t){const n=t.map((t=>Point.clone(t))),r=[],i=[],o=n.length-1;if(1===o)return r[0]=new Point((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),i[0]=new Point(2*r[0].x-n[0].x,2*r[0].y-n[0].y),[r,i];const s=[];for(let t=1;t<o-1;t+=1)s[t]=4*n[t].x+2*n[t+1].x;s[0]=n[0].x+2*n[1].x,s[o-1]=(8*n[o-1].x+n[o].x)/2;const a=e(s);for(let t=1;t<o-1;t+=1)s[t]=4*n[t].y+2*n[t+1].y;s[0]=n[0].y+2*n[1].y,s[o-1]=(8*n[o-1].y+n[o].y)/2;const l=e(s);for(let t=0;t<o;t+=1)r.push(new Point(a[t],l[t])),i.push(t<o-1?new Point(2*n[t+1].x-a[t+1],2*n[t+1].y-l[t+1]):new Point((n[o].x+a[o-1])/2,(n[o].y+l[o-1])/2));return[r,i]}(n),i=[];for(let e=0,o=r[0].length;e<o;e+=1){const o=new Point(r[0][e].x,r[0][e].y),s=new Point(r[1][e].x,r[1][e].y);i.push(new t(n[e],o,s,n[e+1]))}return i}}(Curve||(Curve={}));class Segment extends Geometry{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(t,e){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(t,e){if(t<=0)return 0;const n=this.length();return t>=1?n:n*t}divideAtT(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class LineTo extends Segment{constructor(t,e){super(),this.endPoint=Line.isLine(t)?t.end.clone().round(2):Point.create(t,e).round(2)}get type(){return"L"}get line(){return new Line(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[new LineTo(e[0]),new LineTo(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[new LineTo(e[0]),new LineTo(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return null!=this.previousSegment&&!this.start.equals(this.end)}clone(){return new LineTo(this.end)}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?this.end.translate(t,e):this.end.translate(t),this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}!function(t){t.create=function(...e){const n=e.length,r=e[0];if(Line.isLine(r))return new t(r);if(Point.isPointLike(r))return 1===n?new t(r):e.map((e=>new t(e)));if(2===n)return new t(+e[0],+e[1]);const i=[];for(let r=0;r<n;r+=2)i.push(new t(+e[r],+e[r+1]));return i}}(LineTo||(LineTo={}));class Close extends Segment{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new Line(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[e[1].isDifferentiable()?new LineTo(e[0]):this.clone(),new LineTo(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[e[1].isDifferentiable()?new LineTo(e[0]):this.clone(),new LineTo(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return!(!this.previousSegment||!this.subpathStartSegment||this.start.equals(this.end))}scale(){return this}rotate(){return this}translate(){return this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}clone(){return new Close}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}!function(t){t.create=function(){return new t}}(Close||(Close={}));class MoveTo extends Segment{constructor(t,e){super(),this.isVisible=!1,this.isSubpathStart=!0,this.endPoint=Line.isLine(t)||Curve.isCurve(t)?t.end.clone().round(2):Point.create(t,e).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?this.end.translate(t,e):this.end.translate(t),this}clone(){return new MoveTo(this.end)}equals(t){return this.type===t.type&&this.end.equals(t.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}!function(t){t.create=function(...e){const n=e.length,r=e[0];if(Line.isLine(r))return new t(r);if(Curve.isCurve(r))return new t(r);if(Point.isPointLike(r)){if(1===n)return new t(r);const i=[];for(let r=0;r<n;r+=1)i.push(0===r?new t(e[r]):new LineTo(e[r]));return i}if(2===n)return new t(+e[0],+e[1]);const i=[];for(let r=0;r<n;r+=2){const n=+e[r],o=+e[r+1];i.push(0===r?new t(n,o):new LineTo(n,o))}return i}}(MoveTo||(MoveTo={}));class CurveTo extends Segment{constructor(t,e,n,r,i,o){super(),Curve.isCurve(t)?(this.controlPoint1=t.controlPoint1.clone().round(2),this.controlPoint2=t.controlPoint2.clone().round(2),this.endPoint=t.end.clone().round(2)):"number"==typeof t?(this.controlPoint1=new Point(t,e).round(2),this.controlPoint2=new Point(n,r).round(2),this.endPoint=new Point(i,o).round(2)):(this.controlPoint1=Point.create(t).round(2),this.controlPoint2=Point.create(e).round(2),this.endPoint=Point.create(n).round(2))}get type(){return"C"}get curve(){return new Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(t){return this.curve.closestPoint(t)}closestPointLength(t){return this.curve.closestPointLength(t)}closestPointNormalizedLength(t){return this.curve.closestPointNormalizedLength(t)}closestPointTangent(t){return this.curve.closestPointTangent(t)}length(){return this.curve.length()}divideAt(t,e={}){const n=this.curve.divideAt(t,e);return[new CurveTo(n[0]),new CurveTo(n[1])]}divideAtLength(t,e={}){const n=this.curve.divideAtLength(t,e);return[new CurveTo(n[0]),new CurveTo(n[1])]}divideAtT(t){const e=this.curve.divideAtT(t);return[new CurveTo(e[0]),new CurveTo(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.curve.pointAt(t)}pointAtLength(t){return this.curve.pointAtLength(t)}tangentAt(t){return this.curve.tangentAt(t)}tangentAtLength(t){return this.curve.tangentAtLength(t)}isDifferentiable(){if(!this.previousSegment)return!1;const t=this.controlPoint1,e=this.controlPoint2,n=this.end;return!(this.start.equals(t)&&t.equals(e)&&e.equals(n))}scale(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return"number"==typeof t?(this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return this.start.equals(t.start)&&this.end.equals(t.end)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)}clone(){return new CurveTo(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.controlPoint1,e=this.controlPoint2,n=this.end;return[this.type,t.x,t.y,e.x,e.y,n.x,n.y].join(" ")}}function rotate$1(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function q2c(t,e,n,r,i,o){const s=1/3,a=2/3;return[s*t+a*n,s*e+a*r,s*i+a*n,s*o+a*r,i,o]}function a2c(t,e,n,r,i,o,s,a,l,c){const u=120*Math.PI/180,h=Math.PI/180*(+i||0);let d,f,p,g,m,A=[];if(c)f=c[0],p=c[1],g=c[2],m=c[3];else{d=rotate$1(t,e,-h),t=d.x,e=d.y,d=rotate$1(a,l,-h);const i=(t-(a=d.x))/2,c=(e-(l=d.y))/2;let u=i*i/(n*n)+c*c/(r*r);u>1&&(u=Math.sqrt(u),n*=u,r*=u);const A=n*n,y=r*r,v=(o===s?-1:1)*Math.sqrt(Math.abs((A*y-A*c*c-y*i*i)/(A*c*c+y*i*i)));g=v*n*c/r+(t+a)/2,m=v*-r*i/n+(e+l)/2,f=Math.asin((e-m)/r),p=Math.asin((l-m)/r),f=t<g?Math.PI-f:f,p=a<g?Math.PI-p:p,f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),s&&f>p&&(f-=2*Math.PI),!s&&p>f&&(p-=2*Math.PI)}let y=p-f;if(Math.abs(y)>u){const t=p,e=a,o=l;p=f+u*(s&&p>f?1:-1),A=a2c(a=g+n*Math.cos(p),l=m+r*Math.sin(p),n,r,i,0,s,e,o,[p,t,g,m])}y=p-f;const v=Math.cos(f),b=Math.sin(f),x=Math.cos(p),w=Math.sin(p),C=Math.tan(y/4),$=4/3*(n*C),_=4/3*(r*C),P=[t,e],S=[t+$*b,e-_*v],M=[a+$*w,l-_*x],E=[a,l];if(S[0]=2*P[0]-S[0],S[1]=2*P[1]-S[1],c)return[S,M,E].concat(A);{A=[S,M,E].concat(A).join().split(",");const t=[],e=A.length;for(let n=0;n<e;n+=1)t[n]=n%2?rotate$1(+A[n-1],+A[n],h).y:rotate$1(+A[n],+A[n+1],h).x;return t}}function parse(t){if(!t)return null;const e="\t\n\v\f\r \u2028\u2029",n=new RegExp(`([a-z])[${e},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${e}]*,?[${e}]*)+)`,"ig"),r=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${e}]*,?[${e}]*`,"ig"),i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return t.replace(n,((t,e,n)=>{const s=[];let a=e.toLowerCase();n.replace(r,((t,e)=>(e&&s.push(+e),t))),"m"===a&&s.length>2&&(o.push([e,...s.splice(0,2)]),a="l",e="m"===e?"l":"L");const l=i[a];for(;s.length>=l&&(o.push([e,...s.splice(0,l)]),l););return t})),o}function abs(t){const e=parse(t);if(!e||!e.length)return[["M",0,0]];let n=0,r=0,i=0,o=0;const s=[];for(let t=0,a=e.length;t<a;t+=1){const a=[];s.push(a);const l=e[t],c=l[0];if(c!==c.toUpperCase())switch(a[0]=c.toUpperCase(),a[0]){case"A":a[1]=l[1],a[2]=l[2],a[3]=l[3],a[4]=l[4],a[5]=l[5],a[6]=+l[6]+n,a[7]=+l[7]+r;break;case"V":a[1]=+l[1]+r;break;case"H":a[1]=+l[1]+n;break;case"M":i=+l[1]+n,o=+l[2]+r;for(let t=1,e=l.length;t<e;t+=1)a[t]=+l[t]+(t%2?n:r);break;default:for(let t=1,e=l.length;t<e;t+=1)a[t]=+l[t]+(t%2?n:r)}else for(let t=0,e=l.length;t<e;t+=1)a[t]=l[t];switch(a[0]){case"Z":n=+i,r=+o;break;case"H":n=a[1];break;case"V":r=a[1];break;case"M":i=a[a.length-2],o=a[a.length-1],n=a[a.length-2],r=a[a.length-1];break;default:n=a[a.length-2],r=a[a.length-1]}}return s}function normalize$1(t){const e=abs(t),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function r(t,e,n){let r,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=null,e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":return 0===parseFloat(t[1])||0===parseFloat(t[2])?["L",t[6],t[7]]:["C"].concat(a2c.apply(0,[e.x,e.y].concat(t.slice(1))));case"S":return"C"===n||"S"===n?(r=2*e.x-e.bx,i=2*e.y-e.by):(r=e.x,i=e.y),["C",r,i].concat(t.slice(1));case"T":return"Q"===n||"T"===n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),["C"].concat(q2c(e.x,e.y,e.qx,e.qy,t[1],t[2]));case"Q":return e.qx=t[1],e.qy=t[2],["C"].concat(q2c(e.x,e.y,t[1],t[2],t[3],t[4]));case"H":return["L"].concat(t[1],e.y);case"V":return["L"].concat(e.x,t[1])}return t}function i(t,n){if(t[n].length>7){t[n].shift();const r=t[n];for(;r.length;)o[n]="A",t.splice(n+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1),a=e.length}}const o=[];let s="",a=e.length;for(let t=0;t<a;t+=1){let a="";e[t]&&(a=e[t][0]),"C"!==a&&(o[t]=a,t>0&&(s=o[t-1])),e[t]=r(e[t],n,s),"A"!==o[t]&&"C"===a&&(o[t]="C"),i(e,t);const l=e[t],c=l.length;n.x=l[c-2],n.y=l[c-1],n.bx=parseFloat(l[c-4])||n.x,n.by=parseFloat(l[c-3])||n.y}return e[0][0]&&"M"===e[0][0]||e.unshift(["M",0,0]),e}function normalizePathData(t){return normalize$1(t).map((t=>t.map((t=>"string"==typeof t?t:round$1(t,2))))).join(",").split(",").join(" ")}!function(t){t.create=function(...e){const n=e.length,r=e[0];if(Curve.isCurve(r))return new t(r);if(Point.isPointLike(r)){if(3===n)return new t(e[0],e[1],e[2]);const r=[];for(let i=0;i<n;i+=3)r.push(new t(e[i],e[i+1],e[i+2]));return r}if(6===n)return new t(e[0],e[1],e[2],e[3],e[4],e[5]);const i=[];for(let r=0;r<n;r+=6)i.push(new t(e[r],e[r+1],e[r+2],e[r+3],e[r+4],e[r+5]));return i}}(CurveTo||(CurveTo={}));const regexSupportedData=new RegExp("^[\\s\\dLMCZz,.]*$");function isValid(t){return"string"==typeof t&&regexSupportedData.test(t)}function mod(t,e){return(t%e+e)%e}function draw(t,e,n,r,i){const o=[],s=t[t.length-1],a=null!=e&&e>0,l=e||0;if(r&&a){const e=(t=t.slice())[0],n=new Point(s.x+(e.x-s.x)/2,s.y+(e.y-s.y)/2);t.splice(0,0,n)}let c=t[0],u=1;for(o.push(n?"M":"L",c.x,c.y);u<(r?t.length:t.length-1);){let e=t[mod(u,t.length)],n=c.x-e.x,r=c.y-e.y;if(a&&(0!==n||0!==r)&&(null==i||i.indexOf(u-1)<0)){let i=Math.sqrt(n*n+r*r);const s=n*Math.min(l,i/2)/i,a=r*Math.min(l,i/2)/i;o.push("L",e.x+s,e.y+a);let c=t[mod(u+1,t.length)];for(;u<t.length-2&&0===Math.round(c.x-e.x)&&0===Math.round(c.y-e.y);)c=t[mod(u+2,t.length)],u+=1;n=c.x-e.x,r=c.y-e.y,i=Math.max(1,Math.sqrt(n*n+r*r));const h=n*Math.min(l,i/2)/i,d=r*Math.min(l,i/2)/i,f=e.x+h,p=e.y+d;o.push("Q",e.x,e.y,f,p),e=new Point(f,p)}else o.push("L",e.x,e.y);c=e,u+=1}return r?o.push("Z"):o.push("L",s.x,s.y),o.map((t=>"string"==typeof t?t:+t.toFixed(3))).join(" ")}function drawPoints(t,e={}){const n=[];return t&&t.length&&t.forEach((t=>{Array.isArray(t)?n.push({x:t[0],y:t[1]}):n.push({x:t.x,y:t.y})})),draw(n,e.round,null==e.initialMove||e.initialMove,e.close,e.exclude)}function arcToCurves(t,e,n,r,i=0,o=0,s=0,a,l){if(0===n||0===r)return[];a-=t,l-=e,n=Math.abs(n),r=Math.abs(r);const c=-a/2,u=-l/2,h=Math.cos(i*Math.PI/180),d=Math.sin(i*Math.PI/180),f=h*c+d*u,p=-1*d*c+h*u,g=f*f,m=p*p,A=n*n,y=r*r,v=g/A+m/y;let b;if(v>1)n=Math.sqrt(v)*n,r=Math.sqrt(v)*r,b=0;else{let t=1;o===s&&(t=-1),b=t*Math.sqrt((A*y-A*m-y*g)/(A*m+y*g))}const x=b*n*p/r,w=-1*b*r*f/n,C=h*x-d*w+a/2,$=d*x+h*w+l/2;let _=Math.atan2((p-w)/r,(f-x)/n)-Math.atan2(0,1),P=_>=0?_:2*Math.PI+_;_=Math.atan2((-p-w)/r,(-f-x)/n)-Math.atan2((p-w)/r,(f-x)/n);let S=_>=0?_:2*Math.PI+_;0===s&&S>0?S-=2*Math.PI:0!==s&&S<0&&(S+=2*Math.PI);const M=2*S/Math.PI,E=Math.ceil(M<0?-1*M:M),T=S/E,k=8/3*Math.sin(T/4)*Math.sin(T/4)/Math.sin(T/2),O=h*n,N=h*r,R=d*n,L=d*r;let D=Math.cos(P),j=Math.sin(P),I=-k*(O*j+L*D),F=-k*(R*j-N*D),B=0,z=0;const G=[];for(let n=0;n<E;n+=1){P+=T,D=Math.cos(P),j=Math.sin(P),B=O*D-L*j+C,z=R*D+N*j+$;const r=-k*(O*j+L*D),i=-k*(R*j-N*D),o=6*n;G[o]=Number(I+t),G[o+1]=Number(F+e),G[o+2]=Number(B-r+t),G[o+3]=Number(z-i+e),G[o+4]=Number(B+t),G[o+5]=Number(z+e),I=B+r,F=z+i}return G.map((t=>+t.toFixed(2)))}function drawArc(t,e,n,r,i=0,o=0,s=0,a,l){const c=[],u=arcToCurves(t,e,n,r,i,o,s,a,l);if(null!=u)for(let t=0,e=u.length;t<e;t+=6)c.push("C",u[t],u[t+1],u[t+2],u[t+3],u[t+4],u[t+5]);return c.join(" ")}class Path$1 extends Geometry{constructor(t){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(t))if(Line.isLine(t[0])||Curve.isCurve(t[0])){let e=null;t.forEach(((t,n)=>{0===n&&this.appendSegment(Path$1.createSegment("M",t.start)),null==e||e.end.equals(t.start)||this.appendSegment(Path$1.createSegment("M",t.start)),Line.isLine(t)?this.appendSegment(Path$1.createSegment("L",t.end)):Curve.isCurve(t)&&this.appendSegment(Path$1.createSegment("C",t.controlPoint1,t.controlPoint2,t.end)),e=t}))}else t.forEach((t=>{t.isSegment&&this.appendSegment(t)}));else null!=t&&(Line.isLine(t)?(this.appendSegment(Path$1.createSegment("M",t.start)),this.appendSegment(Path$1.createSegment("L",t.end))):Curve.isCurve(t)?(this.appendSegment(Path$1.createSegment("M",t.start)),this.appendSegment(Path$1.createSegment("C",t.controlPoint1,t.controlPoint2,t.end))):Polyline.isPolyline(t)?t.points&&t.points.length&&t.points.forEach(((t,e)=>{const n=Path$1.createSegment(0===e?"M":"L",t);this.appendSegment(n)})):t.isSegment&&this.appendSegment(t))}get[Symbol.toStringTag](){return Path$1.toStringTag}get start(){const t=this.segments,e=t.length;if(0===e)return null;for(let n=0;n<e;n+=1){const e=t[n];if(e.isVisible)return e.start}return t[e-1].end}get end(){const t=this.segments,e=t.length;if(0===e)return null;for(let n=e-1;n>=0;n-=1){const e=t[n];if(e.isVisible)return e.end}return t[e-1].end}moveTo(...t){return this.appendSegment(MoveTo.create.call(null,...t))}lineTo(...t){return this.appendSegment(LineTo.create.call(null,...t))}curveTo(...t){return this.appendSegment(CurveTo.create.call(null,...t))}arcTo(t,e,n,r,i,o,s){const a=this.end||new Point,l="number"==typeof o?arcToCurves(a.x,a.y,t,e,n,r,i,o,s):arcToCurves(a.x,a.y,t,e,n,r,i,o.x,o.y);if(null!=l)for(let t=0,e=l.length;t<e;t+=6)this.curveTo(l[t],l[t+1],l[t+2],l[t+3],l[t+4],l[t+5]);return this}quadTo(t,e,n,r){const i=this.end||new Point,o=["M",i.x,i.y];"number"==typeof t?o.push("Q",t,e,n,r):o.push("Q",t.x,t.y,e.x,e.y);const s=Path$1.parse(o.join(" "));return this.appendSegment(s.segments.slice(1)),this}close(){return this.appendSegment(Close.create())}drawPoints(t,e={}){const n=drawPoints(t,e),r=Path$1.parse(n);r&&r.segments&&this.appendSegment(r.segments)}bbox(){const t=this.segments,e=t.length;if(0===e)return null;let n;for(let r=0;r<e;r+=1){const e=t[r];if(e.isVisible){const t=e.bbox();null!=t&&(n=n?n.union(t):t)}}if(null!=n)return n;const r=t[e-1];return new Rectangle(r.end.x,r.end.y,0,0)}appendSegment(t){const e=this.segments.length;let n,r=0!==e?this.segments[e-1]:null;if(Array.isArray(t))for(let e=0,i=t.length;e<i;e+=1)n=this.prepareSegment(t[e],r,null),this.segments.push(n),r=n;else null!=t&&t.isSegment&&(n=this.prepareSegment(t,r,null),this.segments.push(n));return this}insertSegment(t,e){const n=this.segments.length;if(t<0&&(t=n+t+1),t>n||t<0)throw new Error("Index out of range.");let r,i=null,o=null;if(0!==n&&(t>=1?(i=this.segments[t-1],o=i.nextSegment):(i=null,o=this.segments[0])),Array.isArray(e))for(let n=0,s=e.length;n<s;n+=1)r=this.prepareSegment(e[n],i,o),this.segments.splice(t+n,0,r),i=r;else r=this.prepareSegment(e,i,o),this.segments.splice(t,0,r);return this}removeSegment(t){const e=this.fixIndex(t),n=this.segments.splice(e,1)[0],r=n.previousSegment,i=n.nextSegment;return r&&(r.nextSegment=i),i&&(i.previousSegment=r),n.isSubpathStart&&i&&this.updateSubpathStartSegment(i),n}replaceSegment(t,e){const n=this.fixIndex(t);let r;const i=this.segments[n];let o=i.previousSegment;const s=i.nextSegment;let a=i.isSubpathStart;if(Array.isArray(e)){this.segments.splice(t,1);for(let n=0,i=e.length;n<i;n+=1)r=this.prepareSegment(e[n],o,s),this.segments.splice(t+n,0,r),o=r,a&&r.isSubpathStart&&(a=!1)}else r=this.prepareSegment(e,o,s),this.segments.splice(n,1,r),a&&r.isSubpathStart&&(a=!1);a&&s&&this.updateSubpathStartSegment(s)}getSegment(t){const e=this.fixIndex(t);return this.segments[e]}fixIndex(t){const e=this.segments.length;if(0===e)throw new Error("Path has no segments.");let n=t;for(;n<0;)n=e+n;if(n>=e||n<0)throw new Error("Index out of range.");return n}segmentAt(t,e={}){const n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null}segmentAtLength(t,e={}){const n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null}segmentIndexAt(t,e={}){if(0===this.segments.length)return null;const n=clamp(t,0,1),r=this.getOptions(e),i=this.length(r);return this.segmentIndexAtLength(i*n,r)}segmentIndexAtLength(t,e={}){const n=this.segments.length;if(0===n)return null;let r=!0;t<0&&(r=!1,t=-t);const i=this.getPrecision(e),o=this.getSubdivisions(e);let s=0,a=null;for(let e=0;e<n;e+=1){const l=r?e:n-1-e,c=this.segments[l],u=c.length({precision:i,subdivisions:o[l]});if(c.isVisible){if(t<=s+u)return l;a=l}s+=u}return a}getSegmentSubdivisions(t={}){const e=this.getPrecision(t),n=[];for(let t=0,r=this.segments.length;t<r;t+=1){const r=this.segments[t].getSubdivisions({precision:e});n.push(r)}return n}updateSubpathStartSegment(t){let e=t.previousSegment,n=t;for(;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=e?e.subpathStartSegment:null,e=n,n=n.nextSegment}prepareSegment(t,e,n){t.previousSegment=e,t.nextSegment=n,null!=e&&(e.nextSegment=t),null!=n&&(n.previousSegment=t);let r=t;return t.isSubpathStart&&(t.subpathStartSegment=t,r=n),null!=r&&this.updateSubpathStartSegment(r),t}closestPoint(t,e={}){const n=this.closestPointT(t,e);return n?this.pointAtT(n):null}closestPointLength(t,e={}){const n=this.getOptions(e),r=this.closestPointT(t,n);return r?this.lengthAtT(r,n):0}closestPointNormalizedLength(t,e={}){const n=this.getOptions(e),r=this.closestPointLength(t,n);if(0===r)return 0;const i=this.length(n);return 0===i?0:r/i}closestPointT(t,e={}){if(0===this.segments.length)return null;const n=this.getPrecision(e),r=this.getSubdivisions(e);let i,o=1/0;for(let e=0,s=this.segments.length;e<s;e+=1){const s=this.segments[e],a=r[e];if(s.isVisible){const r=s.closestPointT(t,{precision:n,subdivisions:a}),l=squaredLength(s.pointAtT(r),t);l<o&&(i={segmentIndex:e,value:r},o=l)}}return i||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(t,e={}){if(0===this.segments.length)return null;const n=this.getPrecision(e),r=this.getSubdivisions(e);let i,o=1/0;for(let e=0,s=this.segments.length;e<s;e+=1){const s=this.segments[e],a=r[e];if(s.isDifferentiable()){const e=s.closestPointT(t,{precision:n,subdivisions:a}),r=squaredLength(s.pointAtT(e),t);r<o&&(i=s.tangentAtT(e),o=r)}}return i||null}containsPoint(t,e={}){const n=this.toPolylines(e);if(!n)return!1;let r=0;for(let e=0,i=n.length;e<i;e+=1)n[e].containsPoint(t)&&(r+=1);return r%2==1}pointAt(t,e={}){if(0===this.segments.length)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const n=this.getOptions(e),r=this.length(n);return this.pointAtLength(r*t,n)}pointAtLength(t,e={}){if(0===this.segments.length)return null;if(0===t)return this.start.clone();let n=!0;t<0&&(n=!1,t=-t);const r=this.getPrecision(e),i=this.getSubdivisions(e);let o,s=0;for(let e=0,a=this.segments.length;e<a;e+=1){const l=n?e:a-1-e,c=this.segments[l],u=i[l],h=c.length({precision:r,subdivisions:u});if(c.isVisible){if(t<=s+h)return c.pointAtLength((n?1:-1)*(t-s),{precision:r,subdivisions:u});o=c}s+=h}return o?n?o.end:o.start:this.segments[this.segments.length-1].end.clone()}pointAtT(t){const e=this.segments,n=e.length;if(0===n)return null;const r=t.segmentIndex;if(r<0)return e[0].pointAtT(0);if(r>=n)return e[n-1].pointAtT(1);const i=clamp(t.value,0,1);return e[r].pointAtT(i)}divideAt(t,e={}){if(0===this.segments.length)return null;const n=clamp(t,0,1),r=this.getOptions(e),i=this.length(r);return this.divideAtLength(i*n,r)}divideAtLength(t,e={}){if(0===this.segments.length)return null;let n=!0;t<0&&(n=!1,t=-t);const r=this.getPrecision(e),i=this.getSubdivisions(e);let o,s,a,l,c,u=0;for(let e=0,c=this.segments.length;e<c;e+=1){const h=n?e:c-1-e,d=this.getSegment(h),f={precision:r,subdivisions:i[h]},p=d.length(f);if(d.isDifferentiable()&&(a=d,l=h,t<=u+p)){s=h,o=d.divideAtLength((n?1:-1)*(t-u),f);break}u+=p}if(!a)return null;o||(s=l,c=n?1:0,o=a.divideAtT(c));const h=this.clone(),d=s;h.replaceSegment(d,o);const f=d;let p=d+1,g=d+2;o[0].isDifferentiable()||(h.removeSegment(f),p-=1,g-=1);const m=h.getSegment(p).start;h.insertSegment(p,Path$1.createSegment("M",m)),g+=1,o[1].isDifferentiable()||(h.removeSegment(g-1),g-=1);const A=g-f-1;for(let t=g,e=h.segments.length;t<e;t+=1){const e=this.getSegment(t-A),n=h.getSegment(t);if("Z"===n.type&&!e.subpathStartSegment.end.equals(n.subpathStartSegment.end)){const n=Path$1.createSegment("L",e.end);h.replaceSegment(t,n)}}return[new Path$1(h.segments.slice(0,p)),new Path$1(h.segments.slice(p))]}intersectsWithLine(t,e={}){const n=this.toPolylines(e);if(null==n)return null;let r=null;for(let e=0,i=n.length;e<i;e+=1){const i=t.intersect(n[e]);i&&(null==r&&(r=[]),Array.isArray(i)?r.push(...i):r.push(i))}return r}isDifferentiable(){for(let t=0,e=this.segments.length;t<e;t+=1)if(this.segments[t].isDifferentiable())return!0;return!1}isValid(){const t=this.segments;return 0===t.length||"M"===t[0].type}length(t={}){if(0===this.segments.length)return 0;const e=this.getSubdivisions(t);let n=0;for(let t=0,r=this.segments.length;t<r;t+=1)n+=this.segments[t].length({subdivisions:e[t]});return n}lengthAtT(t,e={}){const n=this.segments.length;if(0===n)return 0;let r=t.segmentIndex;if(r<0)return 0;let i=clamp(t.value,0,1);r>=n&&(r=n-1,i=1);const o=this.getPrecision(e),s=this.getSubdivisions(e);let a=0;for(let t=0;t<r;t+=1)a+=this.segments[t].length({precision:o,subdivisions:s[t]});return a+=this.segments[r].lengthAtT(i,{precision:o,subdivisions:s[r]}),a}tangentAt(t,e={}){if(0===this.segments.length)return null;const n=clamp(t,0,1),r=this.getOptions(e),i=this.length(r);return this.tangentAtLength(i*n,r)}tangentAtLength(t,e={}){if(0===this.segments.length)return null;let n=!0;t<0&&(n=!1,t=-t);const r=this.getPrecision(e),i=this.getSubdivisions(e);let o,s=0;for(let e=0,a=this.segments.length;e<a;e+=1){const l=n?e:a-1-e,c=this.segments[l],u=i[l],h=c.length({precision:r,subdivisions:u});if(c.isDifferentiable()){if(t<=s+h)return c.tangentAtLength((n?1:-1)*(t-s),{precision:r,subdivisions:u});o=c}s+=h}return o?o.tangentAtT(n?1:0):null}tangentAtT(t){const e=this.segments.length;if(0===e)return null;const n=t.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=e)return this.segments[e-1].tangentAtT(1);const r=clamp(t.value,0,1);return this.segments[n].tangentAtT(r)}getPrecision(t={}){return null==t.precision?this.PRECISION:t.precision}getSubdivisions(t={}){if(null==t.segmentSubdivisions){const e=this.getPrecision(t);return this.getSegmentSubdivisions({precision:e})}return t.segmentSubdivisions}getOptions(t={}){return{precision:this.getPrecision(t),segmentSubdivisions:this.getSubdivisions(t)}}toPoints(t={}){const e=this.segments,n=e.length;if(0===n)return null;const r=this.getSubdivisions(t),i=[];let o=[];for(let t=0;t<n;t+=1){const n=e[t];if(n.isVisible){const e=r[t];e.length>0?e.forEach((t=>o.push(t.start))):o.push(n.start)}else o.length>0&&(o.push(e[t-1].end),i.push(o),o=[])}return o.length>0&&(o.push(this.end),i.push(o)),i}toPolylines(t={}){const e=this.toPoints(t);return e?e.map((t=>new Polyline(t))):null}scale(t,e,n){return this.segments.forEach((r=>r.scale(t,e,n))),this}rotate(t,e){return this.segments.forEach((n=>n.rotate(t,e))),this}translate(t,e){return this.segments.forEach("number"==typeof t?n=>n.translate(t,e):e=>e.translate(t)),this}clone(){const t=new Path$1;return this.segments.forEach((e=>t.appendSegment(e.clone()))),t}equals(t){if(null==t)return!1;const e=this.segments,n=t.segments,r=e.length;if(n.length!==r)return!1;for(let t=0;t<r;t+=1){const r=e[t],i=n[t];if(r.type!==i.type||!r.equals(i))return!1}return!0}toJSON(){return this.segments.map((t=>t.toJSON()))}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((t=>t.serialize())).join(" ")}toString(){return this.serialize()}}!function(t){t.toStringTag=`X6.Geometry.${t.name}`,t.isPath=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag],r=e;return!(null!=n&&n!==t.toStringTag||!Array.isArray(r.segments)||"function"!=typeof r.moveTo||"function"!=typeof r.lineTo||"function"!=typeof r.curveTo)}}(Path$1||(Path$1={})),function(t){function e(t,...e){if("M"===t)return MoveTo.create.call(null,...e);if("L"===t)return LineTo.create.call(null,...e);if("C"===t)return CurveTo.create.call(null,...e);if("z"===t||"Z"===t)return Close.create();throw new Error(`Invalid path segment type "${t}"`)}t.parse=function(n){if(!n)return new t;const r=new t,i=t.normalize(n).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=i)for(let t=0,n=i.length;t<n;t+=1){const n=i[t].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g);if(null!=n){const t=n[0],i=n.slice(1).map((t=>+t)),o=e.call(null,t,...i);r.appendSegment(o)}}return r},t.createSegment=e}(Path$1||(Path$1={})),function(t){t.normalize=normalizePathData,t.isValid=isValid,t.drawArc=drawArc,t.drawPoints=drawPoints,t.arcToCurves=arcToCurves}(Path$1||(Path$1={}));class Vector{constructor(t,e,n){if(!t)throw new TypeError("Invalid element to create vector");let r;if(Vector.isVector(t))r=t.node;else if("string"==typeof t)if("svg"===t.toLowerCase())r=createSvgDocument();else if("<"===t[0]){const e=createSvgDocument(t);r=document.importNode(e.firstChild,!0)}else r=document.createElementNS(ns.svg,t);else r=t;this.node=r,e&&this.setAttributes(e),n&&this.append(n)}get[Symbol.toStringTag](){return Vector.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(t){this.node.id=t}transform(t,e){return null==t?transform(this.node):(transform(this.node,t,e),this)}translate(t,e=0,n={}){return null==t?translate(this.node):(translate(this.node,t,e,n),this)}rotate(t,e,n,r={}){return null==t?rotate(this.node):(rotate(this.node,t,e,n,r),this)}scale(t,e){return null==t?scale(this.node):(scale(this.node,t,e),this)}getTransformToElement(t){const e=Vector.toNode(t);return getTransformToElement(this.node,e)}removeAttribute(t){return removeAttribute(this.node,t),this}getAttribute(t){return getAttribute(this.node,t)}setAttribute(t,e){return setAttribute(this.node,t,e),this}setAttributes(t){return setAttributes(this.node,t),this}attr(t,e){return null==t?attr(this.node):"string"==typeof t&&void 0===e?attr(this.node,t):("object"==typeof t?attr(this.node,t):attr(this.node,t,e),this)}svg(){return this.node instanceof SVGSVGElement?this:Vector.create(this.node.ownerSVGElement)}defs(){const t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?Vector.create(e):Vector.create("defs").appendTo(t)}text(t,e={}){return text$2(this.node,t,e),this}tagName(){return tagName(this.node)}clone(){return Vector.create(this.node.cloneNode(!0))}remove(){return remove(this.node),this}empty(){return empty(this.node),this}append(t){return append(this.node,Vector.toNodes(t)),this}appendTo(t){return appendTo(this.node,Vector.isVector(t)?t.node:t),this}prepend(t){return prepend(this.node,Vector.toNodes(t)),this}before(t){return before(this.node,Vector.toNodes(t)),this}replace(t){return this.node.parentNode&&this.node.parentNode.replaceChild(Vector.toNode(t),this.node),Vector.create(t)}first(){return this.node.firstChild?Vector.create(this.node.firstChild):null}last(){return this.node.lastChild?Vector.create(this.node.lastChild):null}get(t){const e=this.node.childNodes[t];return e?Vector.create(e):null}indexOf(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(Vector.toNode(t))}find(t){const e=[],n=find(this.node,t);if(n)for(let t=0,r=n.length;t<r;t+=1)e.push(Vector.create(n[t]));return e}findOne(t){const e=findOne(this.node,t);return e?Vector.create(e):null}findParentByClass(t,e){const n=findParentByClass(this.node,t,e);return n?Vector.create(n):null}matches(t){const e=this.node,n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return n&&n.call(e,t)}contains(t){return contains(this.node,Vector.isVector(t)?t.node:t)}wrap(t){const e=Vector.create(t),n=this.node.parentNode;return null!=n&&n.insertBefore(e.node,this.node),e.append(this)}parent(t){let e=this;if(null==e.node.parentNode)return null;if(e=Vector.create(e.node.parentNode),null==t)return e;do{if("string"==typeof t?e.matches(t):e instanceof t)return e}while(e=Vector.create(e.node.parentNode));return e}children(){const t=this.node.childNodes,e=[];for(let n=0;n<t.length;n+=1)1===t[n].nodeType&&e.push(Vector.create(t[n]));return e}eachChild(t,e){const n=this.children();for(let r=0,i=n.length;r<i;r+=1)t.call(n[r],n[r],r,n),e&&n[r].eachChild(t,e);return this}index(){return index(this.node)}hasClass(t){return hasClass(this.node,t)}addClass(t){return addClass(this.node,t),this}removeClass(t){return removeClass(this.node,t),this}toggleClass(t,e){return toggleClass(this.node,t,e),this}toLocalPoint(t,e){return toLocalPoint(this.node,t,e)}toGeometryShape(){return toGeometryShape(this.node)}translateCenterToPoint(t){const e=this.getBBox({target:this.svg()}).getCenter();return this.translate(t.x-e.x,t.y-e.y),this}translateAndAutoOrient(t,e,n){return translateAndAutoOrient(this.node,t,e,n),this}animate(t){return animate(this.node,t)}animateTransform(t){return animateTransform(this.node,t)}animateAlongPath(t,e){return animateAlongPath(this.node,t,e)}normalizePath(){return"path"===this.tagName()&&this.attr("d",Path$1.normalize(this.attr("d"))),this}bbox(t,e){return bbox$1(this.node,t,e)}getBBox(t={}){return getBBox(this.node,{recursive:t.recursive,target:t.target?Vector.toNode(t.target):null})}sample(t=1){return this.node instanceof SVGPathElement?sample(this.node,t):[]}toPath(){return Vector.create(toPath(this.node))}toPathData(){return toPathData(this.node)}}function createTextPathNode(t,e){const n=Vector.create(e),r=Vector.create("textPath"),i=t.d;if(i&&void 0===t["xlink:href"]){const t=Vector.create("path").attr("d",i).appendTo(n.defs());r.attr("xlink:href",`#${t.id}`)}return"object"==typeof t&&r.attr(t),r.node}function annotateTextLine(t,e,n){const r=n.eol,i=n.baseSize,o=n.lineHeight;let s,a=0;const l={},c=e.length-1;for(let o=0;o<=c;o+=1){let l=e[o],u=null;if("object"==typeof l){const t=l.attrs,e=Vector.create("tspan",t);s=e.node;let h=l.t;r&&o===c&&(h+=r),s.textContent=h;const d=t.class;d&&e.addClass(d),n.includeAnnotationIndices&&e.attr("annotations",l.annotations.join(",")),u=parseFloat(t["font-size"]),void 0===u&&(u=i),u&&u>a&&(a=u)}else r&&o===c&&(l+=r),s=document.createTextNode(l||" "),i&&i>a&&(a=i);t.appendChild(s)}return a&&(l.maxFontSize=a),o?l.lineHeight=o:a&&(l.lineHeight=1.2*a),l}!function(t){function e(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&e.node instanceof SVGElement&&"function"==typeof e.animate&&"function"==typeof e.sample&&"function"==typeof e.normalizePath&&"function"==typeof e.toPath}function n(e,n,r){return new t(e,n,r)}function r(t){return e(t)?t.node:t}t.toStringTag=`X6.${t.name}`,t.isVector=e,t.create=n,t.createVectors=function(t){if("<"===t[0]){const e=createSvgDocument(t),r=[];for(let t=0,i=e.childNodes.length;t<i;t+=1)r.push(n(document.importNode(e.childNodes[t],!0)));return r}return[n(t)]},t.toNode=r,t.toNodes=function(t){return Array.isArray(t)?t.map((t=>r(t))):[r(t)]}}(Vector||(Vector={}));const emRegex=/em$/;function emToPx(t,e){const n=parseFloat(t);return emRegex.test(t)?n*e:n}function calculateDY(t,e,n,r){if(!Array.isArray(e))return 0;const i=e.length;if(!i)return 0;let o=e[0];const s=emToPx(o.maxFontSize,n)||n;let a=0;const l=emToPx(r,n);for(let t=1;t<i;t+=1)o=e[t],a+=emToPx(o.lineHeight,n)||l;const c=emToPx(o.maxFontSize,n)||n;let u;switch(t){case"middle":u=s/2-.15*c-a/2;break;case"bottom":u=-.25*c-a;break;default:u=.8*s}return u}function text$2(t,e,n={}){e=sanitize(e);const r=n.eol;let i=n.textPath;const o=n.textVerticalAnchor,s="middle"===o||"bottom"===o||"top"===o;let a=n.x;void 0===a&&(a=t.getAttribute("x")||0);const l=n.includeAnnotationIndices;let c=n.annotations;c&&!Array.isArray(c)&&(c=[c]);const u=n.lineHeight,h="auto"===u,d=h?"1.5em":u||"1em";empty(t),attr(t,{"xml:space":"preserve",display:e||n.displayEmpty?null:"none"});const f=attr(t,"font-size");let p,g,m=parseFloat(f);m||(m=16,!s&&!c||f||attr(t,"font-size",`${m}`)),i?("string"==typeof i&&(i={d:i}),p=createTextPathNode(i,t)):p=document.createDocumentFragment();let A,y=0;const v=e.split("\n"),b=[],x=v.length-1;for(let t=0;t<=x;t+=1){g=d;let e="v-line";const n=createSvgElement("tspan");let o,s=v[t];if(s)if(c){o=annotateTextLine(n,annotate(s,c,{offset:-y,includeAnnotationIndices:l}),{eol:t!==x&&r,baseSize:m,lineHeight:h?null:d,includeAnnotationIndices:l});const e=o.lineHeight;e&&h&&0!==t&&(g=e),0===t&&(A=.8*o.maxFontSize)}else r&&t!==x&&(s+=r),n.textContent=s;else{n.textContent="-",e+=" v-empty-line";const t=n.style;t.fillOpacity=0,t.strokeOpacity=0,c&&(o={})}o&&b.push(o),t>0&&n.setAttribute("dy",g),(t>0||i)&&n.setAttribute("x",a),n.className.baseVal=e,p.appendChild(n),y+=s.length+1}if(s)if(c)g=calculateDY(o,b,m,d);else if("top"===o)g="0.8em";else{let t;switch(x>0?(t=parseFloat(d)||1,t*=x,emRegex.test(d)||(t/=m)):t=0,o){case"middle":g=.3-t/2+"em";break;case"bottom":g=-t-.3+"em"}}else 0===o?g="0em":o?g=o:(g=0,null==t.getAttribute("y")&&t.setAttribute("y",`${A||"0.8em"}`));p.firstChild.setAttribute("dy",g),t.appendChild(p)}function splitText(t,e,n,r){const i=[],o=[];if(null!=e){const n=t.split(e);if(i.push(...n),"string"==typeof e)for(let t=0,r=n.length-1;t<r;t+=1)o.push(e);else{const r=t.match(new RegExp(e,"g"));for(let t=0,e=n.length-1;t<e;t+=1)o.push(r?r[t]:"")}}else{let e="";for(let n=0,r=t.length;n<r;n+=1){const r=t[n];" "===r?(i.push(e),o.push(" "),e=""):r.match(/[^\x00-\xff]/)?(e.length&&(i.push(e),o.push("")),i.push(r),o.push(""),e=""):e+=r}e.length&&i.push(e)}for(let t=0;t<i.length;t+=1){const e=i[t];if(e.indexOf(n)>=0&&e.length>1){const r=e.split(n);for(let t=0,e=r.length-1;t<e;t+=1)r.splice(2*t+1,0,n);const s=r.filter((t=>""!==t));i.splice(t,1,...s);const a=s.map((()=>""));a.pop(),o.splice(t,0,...a)}}for(let t=0;t<i.length;t+=1){const e=i[t],n=e.search(r);n>0&&n<e.length-1&&(i.splice(t,1,e.substring(0,n+1),e.substring(n+1)),o.splice(t,0,""))}return{words:i,separators:o}}function breakText(t,e,n={},r={}){const i=e.width,o=e.height,s=r.svgDocument||createSvgElement("svg"),a=createSvgElement("text"),l=createSvgElement("tspan"),c=document.createTextNode("");attr(a,n),a.appendChild(l),a.style.opacity="0",a.style.display="block",l.style.display="block",l.appendChild(c),s.appendChild(a);const u=null==s.parentNode;u&&document.body.appendChild(s);const h=r.eol||"\n",d=r.separator||" ",f=r.hyphen?new RegExp(r.hyphen):/[^\w\d]/,p=!1!==r.breakWord,g=[],m={};let A,y,v,b=[];const{words:x,separators:w}=splitText(t,r.separator,h,f);for(let t=0,e=0,s=x.length;t<s;t+=1){const u=x[t];if(u)if(u!==h){if(null!=b[e]?(v=w[t-1]||"",c.data=`${b[e]}${v}${u}`):c.data=u,l.getComputedTextLength()<=i)b[e]=c.data,m[e]=w[t],A&&(g[e]=!0,e+=1,A=0);else{if(p){if(!b[e]||A){const n=!!A,r=1===u.length;if(A=u.length-1,n||r){if(r){if(!b[e]){b=[];break}x.splice(t,2,u+x[t+1]),w.splice(t+1,1),g[e]=!0,e+=1,s-=1,t-=1;continue}x[t]=u.substring(0,A),x[t+1]=u.substring(A)+x[t+1]}else x.splice(t,1,u.substring(0,A),u.substring(A)),w.splice(t,0,""),s+=1,e&&!g[e-1]&&(e-=1);t-=1;continue}}else if(!b[e]){b[e]=u,g[e]=!0,e+=1;continue}e+=1,t-=1}if(null!=o){if(null==y){let t;t="auto"===n.lineHeight?{value:1.5,unit:"em"}:parseCssNumeric(n.lineHeight,["em"])||{value:1,unit:"em"},y=t.value,"em"===t.unit&&(y*=Platform.IS_FIREFOX?l.getBBox().height:a.getBBox().height)}if(y*b.length>o){const t=Math.floor(o/y)-1,e=b[t],n=b[t+1];if(b.splice(t+1),null==e)break;let s=r.ellipsis;if(!s)break;"string"!=typeof s&&(s="");let a=e;n&&p&&(a+=v+n);let u,h,f=a.length;do{if(h=a[f],u=a.substring(0,f),h?h.match(d)&&(u+=h):u+=m[t],u+=s,c.data=u,l.getComputedTextLength()<=i){b[t]=u;break}f-=1}while(f>=0);break}}}else g[e]=!0,e+=1,b[e]=""}return remove(u?s:a),b.join(h)}const KAPPA=.551784;function getNumbericAttribute(t,e,n=NaN){const r=t.getAttribute(e);if(null==r)return n;const i=parseFloat(r);return Number.isNaN(i)?n:i}function sample(t,e=1){const n=t.getTotalLength(),r=[];let i,o=0;for(;o<n;)i=t.getPointAtLength(o),r.push({distance:o,x:i.x,y:i.y}),o+=e;return r}function lineToPathData(t){return["M",getNumbericAttribute(t,"x1"),getNumbericAttribute(t,"y1"),"L",getNumbericAttribute(t,"x2"),getNumbericAttribute(t,"y2")].join(" ")}function polygonToPathData(t){const e=getPointsFromSvgElement(t);return 0===e.length?null:`${svgPointsToPath(e)} Z`}function polylineToPathData(t){const e=getPointsFromSvgElement(t);return 0===e.length?null:svgPointsToPath(e)}function svgPointsToPath(t){return`M ${t.map((t=>`${t.x} ${t.y}`)).join(" L")}`}function getPointsFromSvgElement(t){const e=[],n=t.points;if(n)for(let t=0,r=n.numberOfItems;t<r;t+=1)e.push(n.getItem(t));return e}function circleToPathData(t){const e=getNumbericAttribute(t,"cx",0),n=getNumbericAttribute(t,"cy",0),r=getNumbericAttribute(t,"r"),i=r*KAPPA;return["M",e,n-r,"C",e+i,n-r,e+r,n-i,e+r,n,"C",e+r,n+i,e+i,n+r,e,n+r,"C",e-i,n+r,e-r,n+i,e-r,n,"C",e-r,n-i,e-i,n-r,e,n-r,"Z"].join(" ")}function ellipseToPathData(t){const e=getNumbericAttribute(t,"cx",0),n=getNumbericAttribute(t,"cy",0),r=getNumbericAttribute(t,"rx"),i=getNumbericAttribute(t,"ry")||r,o=r*KAPPA,s=i*KAPPA;return["M",e,n-i,"C",e+o,n-i,e+r,n-s,e+r,n,"C",e+r,n+s,e+o,n+i,e,n+i,"C",e-o,n+i,e-r,n+s,e-r,n,"C",e-r,n-s,e-o,n-i,e,n-i,"Z"].join(" ")}function rectangleToPathData(t){return rectToPathData({x:getNumbericAttribute(t,"x",0),y:getNumbericAttribute(t,"y",0),width:getNumbericAttribute(t,"width",0),height:getNumbericAttribute(t,"height",0),rx:getNumbericAttribute(t,"rx",0),ry:getNumbericAttribute(t,"ry",0)})}function rectToPathData(t){let e;const n=t.x,r=t.y,i=t.width,o=t.height,s=Math.min(t.rx||t["top-rx"]||0,i/2),a=Math.min(t.rx||t["bottom-rx"]||0,i/2),l=Math.min(t.ry||t["top-ry"]||0,o/2),c=Math.min(t.ry||t["bottom-ry"]||0,o/2);return e=s||a||l||c?["M",n,r+l,"v",o-l-c,"a",a,c,0,0,0,a,c,"h",i-2*a,"a",a,c,0,0,0,a,-c,"v",-(o-c-l),"a",s,l,0,0,0,-s,-l,"h",-(i-2*s),"a",s,l,0,0,0,-s,l,"Z"]:["M",n,r,"H",n+i,"V",r+o,"H",n,"V",r,"Z"],e.join(" ")}function toPath(t){const e=createSvgElement("path");attr(e,attr(t));const n=toPathData(t);return n&&e.setAttribute("d",n),e}function toPathData(t){const e=t.tagName.toLowerCase();switch(e){case"path":return t.getAttribute("d");case"line":return lineToPathData(t);case"polygon":return polygonToPathData(t);case"polyline":return polylineToPathData(t);case"ellipse":return ellipseToPathData(t);case"circle":return circleToPathData(t);case"rect":return rectangleToPathData(t)}throw new Error(`"${e}" cannot be converted to svg path element.`)}function createSlicePathData(t,e,n,r){const i=2*Math.PI-1e-6,o=t,s=e;let a=n,l=r;if(l<a){const t=a;a=l,l=t}const c=l-a,u=c<Math.PI?"0":"1",h=Math.cos(a),d=Math.sin(a),f=Math.cos(l),p=Math.sin(l);return c>=i?o?`M0,${s}A${s},${s} 0 1,1 0,${-s}A${s},${s} 0 1,1 0,${s}M0,${o}A${o},${o} 0 1,0 0,${-o}A${o},${o} 0 1,0 0,${o}Z`:`M0,${s}A${s},${s} 0 1,1 0,${-s}A${s},${s} 0 1,1 0,${s}Z`:o?`M${s*h},${s*d}A${s},${s} 0 ${u},1 ${s*f},${s*p}L${o*f},${o*p}A${o},${o} 0 ${u},0 ${o*h},${o*d}Z`:`M${s*h},${s*d}A${s},${s} 0 ${u},1 ${s*f},${s*p}L0,0Z`}const svgDocument=createSvgElement("svg"),transformRegex=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,transformSeparatorRegex=/[ ,]+/,transformationListRegex=/^(\w+)\((.*)\)/;function createSVGPoint(t,e){const n=svgDocument.createSVGPoint();return n.x=t,n.y=e,n}function createSVGMatrix(t){const e=svgDocument.createSVGMatrix();if(null!=t){const n=t,r=e;for(const t in n)r[t]=n[t]}return e}function createSVGTransform(t){return null!=t?(t instanceof DOMMatrix||(t=createSVGMatrix(t)),svgDocument.createSVGTransformFromMatrix(t)):svgDocument.createSVGTransform()}function transformStringToMatrix(t){let e=createSVGMatrix();const n=null!=t&&t.match(transformRegex);if(!n)return e;for(let t=0,r=n.length;t<r;t+=1){const r=n[t].match(transformationListRegex);if(r){let t,n,i,o,s,a=createSVGMatrix();const l=r[2].split(transformSeparatorRegex);switch(r[1].toLowerCase()){case"scale":t=parseFloat(l[0]),n=void 0===l[1]?t:parseFloat(l[1]),a=a.scaleNonUniform(t,n);break;case"translate":i=parseFloat(l[0]),o=parseFloat(l[1]),a=a.translate(i,o);break;case"rotate":s=parseFloat(l[0]),i=parseFloat(l[1])||0,o=parseFloat(l[2])||0,a=0!==i||0!==o?a.translate(i,o).rotate(s).translate(-i,-o):a.rotate(s);break;case"skewx":s=parseFloat(l[0]),a=a.skewX(s);break;case"skewy":s=parseFloat(l[0]),a=a.skewY(s);break;case"matrix":a.a=parseFloat(l[0]),a.b=parseFloat(l[1]),a.c=parseFloat(l[2]),a.d=parseFloat(l[3]),a.e=parseFloat(l[4]),a.f=parseFloat(l[5]);break;default:continue}e=e.multiply(a)}}return e}function matrixToTransformString(t){const e=t||{};return`matrix(${null!=e.a?e.a:1},${null!=e.b?e.b:0},${null!=e.c?e.c:0},${null!=e.d?e.d:1},${null!=e.e?e.e:0},${null!=e.f?e.f:0})`}function parseTransformString(t){let e,n,r;if(t){const i=transformSeparatorRegex;if(t.trim().indexOf("matrix")>=0){const i=decomposeMatrix(transformStringToMatrix(t));e=[i.translateX,i.translateY],n=[i.rotation],r=[i.scaleX,i.scaleY];const o=[];0===e[0]&&0===e[1]||o.push(`translate(${e.join(",")})`),1===r[0]&&1===r[1]||o.push(`scale(${r.join(",")})`),0!==n[0]&&o.push(`rotate(${n[0]})`),t=o.join(" ")}else{const o=t.match(/translate\((.*?)\)/);o&&(e=o[1].split(i));const s=t.match(/rotate\((.*?)\)/);s&&(n=s[1].split(i));const a=t.match(/scale\((.*?)\)/);a&&(r=a[1].split(i))}}const i=r&&r[0]?parseFloat(r[0]):1;return{raw:t||"",translation:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:i,sy:r&&r[1]?parseFloat(r[1]):i}}}function deltaTransformPoint(t,e){return{x:e.x*t.a+e.y*t.c+0,y:e.x*t.b+e.y*t.d+0}}function decomposeMatrix(t){const e=deltaTransformPoint(t,{x:0,y:1}),n=deltaTransformPoint(t,{x:1,y:0}),r=180/Math.PI*Math.atan2(e.y,e.x)-90;return{skewX:r,skewY:180/Math.PI*Math.atan2(n.y,n.x),translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),rotation:r}}function matrixToScale(t){let e,n,r,i;return t?(e=null==t.a?1:t.a,i=null==t.d?1:t.d,n=t.b,r=t.c):e=i=1,{sx:n?Math.sqrt(e*e+n*n):e,sy:r?Math.sqrt(r*r+i*i):i}}function matrixToRotation(t){let e={x:0,y:1};return t&&(e=deltaTransformPoint(t,e)),{angle:Angle.normalize(Angle.toDeg(Math.atan2(e.y,e.x))-90)}}function matrixToTranslation(t){return{tx:t&&t.e||0,ty:t&&t.f||0}}function transformPoint(t,e){const n=createSVGPoint(t.x,t.y).matrixTransform(e);return new Point(n.x,n.y)}function transformLine(t,e){return new Line(transformPoint(t.start,e),transformPoint(t.end,e))}function transformRectangle(t,e){const n=svgDocument.createSVGPoint();n.x=t.x,n.y=t.y;const r=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y;const i=n.matrixTransform(e);n.x=t.x+t.width,n.y=t.y+t.height;const o=n.matrixTransform(e);n.x=t.x,n.y=t.y+t.height;const s=n.matrixTransform(e),a=Math.min(r.x,i.x,o.x,s.x),l=Math.max(r.x,i.x,o.x,s.x),c=Math.min(r.y,i.y,o.y,s.y),u=Math.max(r.y,i.y,o.y,s.y);return new Rectangle(a,c,l-a,u-c)}var __rest$x=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function bbox$1(t,e,n){let r;const i=t.ownerSVGElement;if(!i)return new Rectangle(0,0,0,0);try{r=t.getBBox()}catch(e){r={x:t.clientLeft,y:t.clientTop,width:t.clientWidth,height:t.clientHeight}}return e?Rectangle.create(r):transformRectangle(r,getTransformToElement(t,n||i))}function getBBox(t,e={}){let n;if(!t.ownerSVGElement||!isSVGGraphicsElement(t)){if(isHTMLElement(t)){const{left:e,top:n,width:r,height:i}=getBoundingOffsetRect(t);return new Rectangle(e,n,r,i)}return new Rectangle(0,0,0,0)}let r=e.target;if(!e.recursive){try{n=t.getBBox()}catch(e){n={x:t.clientLeft,y:t.clientTop,width:t.clientWidth,height:t.clientHeight}}return r?transformRectangle(n,getTransformToElement(t,r)):Rectangle.create(n)}{const e=t.childNodes,i=e.length;if(0===i)return getBBox(t,{target:r});r||(r=t);for(let t=0;t<i;t+=1){const i=e[t];let o;o=getBBox(i,0===i.childNodes.length?{target:r}:{target:r,recursive:!0}),n=n?n.union(o):o}return n}}function getTransformToElement(t,e){if(isSVGGraphicsElement(e)&&isSVGGraphicsElement(t)){const n=e.getScreenCTM(),r=t.getScreenCTM();if(n&&r)return n.inverse().multiply(r)}return createSVGMatrix()}function toLocalPoint(t,e,n){const r=t instanceof SVGSVGElement?t:t.ownerSVGElement,i=r.createSVGPoint();i.x=e,i.y=n;try{const e=r.getScreenCTM(),n=i.matrixTransform(e.inverse()),o=getTransformToElement(t,r).inverse();return n.matrixTransform(o)}catch(t){return i}}function toGeometryShape(t){const e=e=>{const n=t.getAttribute(e),r=n?parseFloat(n):0;return Number.isNaN(r)?0:r};switch(t instanceof SVGElement&&t.nodeName.toLowerCase()){case"rect":return new Rectangle(e("x"),e("y"),e("width"),e("height"));case"circle":return new Ellipse(e("cx"),e("cy"),e("r"),e("r"));case"ellipse":return new Ellipse(e("cx"),e("cy"),e("rx"),e("ry"));case"polyline":{const e=getPointsFromSvgElement(t);return new Polyline(e)}case"polygon":{const e=getPointsFromSvgElement(t);return e.length>1&&e.push(e[0]),new Polyline(e)}case"path":{let e=t.getAttribute("d");return Path$1.isValid(e)||(e=Path$1.normalize(e)),Path$1.parse(e)}case"line":return new Line(e("x1"),e("y1"),e("x2"),e("y2"))}return getBBox(t)}function animate(t,e){return createAnimation(t,e,"animate")}function animateTransform(t,e){return createAnimation(t,e,"animateTransform")}function createAnimation(t,e,n){const r=createSvgElement(n);t.appendChild(r);try{return setupAnimation(r,e)}catch(t){}return()=>{}}function setupAnimation(t,e){const{start:n,complete:r,repeat:i}=e;attr(t,__rest$x(e,["start","complete","repeat"])),n&&t.addEventListener("beginEvent",n),r&&t.addEventListener("endEvent",r),i&&t.addEventListener("repeatEvent",i);const o=t;return o.beginElement(),()=>o.endElement()}function animateAlongPath(t,e,n){const r=ensureId(n),i=createSvgElement("animateMotion"),o=createSvgElement("mpath");attr(o,{"xlink:href":`#${r}`}),i.appendChild(o),t.appendChild(i);try{return setupAnimation(i,e)}catch(t){if("fake"===document.documentElement.getAttribute("smiling")){const t=i;t.animators=[];const e=window,n=t.getAttribute("id");n&&(e.id2anim[n]=t);const r=e.getTargets(t);for(let n=0,i=r.length;n<i;n+=1){const i=new e.Animator(t,r[n],n);e.animators.push(i),t.animators[n]=i,i.register()}}}return()=>{}}function getBoundingOffsetRect(t){let e=0,n=0,r=0,i=0;if(t){let o=t;for(;o;)e+=o.offsetLeft,n+=o.offsetTop,o=o.offsetParent,o&&(e+=parseInt(getComputedStyle$1(o,"borderLeft"),10),n+=parseInt(getComputedStyle$1(o,"borderTop"),10));r=t.offsetWidth,i=t.offsetHeight}return{left:e,top:n,width:r,height:i}}function transform(t,e,n={}){if(null==e)return transformStringToMatrix(attr(t,"transform"));if(n.absolute)return void t.setAttribute("transform",matrixToTransformString(e));const r=t.transform,i=createSVGTransform(e);r.baseVal.appendItem(i)}function translate(t,e,n=0,r={}){let i=attr(t,"transform");const o=parseTransformString(i);if(null==e)return o.translation;i=o.raw,i=i.replace(/translate\([^)]*\)/g,"").trim(),t.setAttribute("transform",`translate(${r.absolute?e:o.translation.tx+e},${r.absolute?n:o.translation.ty+n}) ${i}`.trim())}function rotate(t,e,n,r,i={}){let o=attr(t,"transform");const s=parseTransformString(o);if(null==e)return s.rotation;o=s.raw,o=o.replace(/rotate\([^)]*\)/g,"").trim(),e%=360,t.setAttribute("transform",`${o} rotate(${i.absolute?e:s.rotation.angle+e}${null!=n&&null!=r?`,${n},${r}`:""})`.trim())}function scale(t,e,n){let r=attr(t,"transform");const i=parseTransformString(r);if(null==e)return i.scale;n=null==n?e:n,r=i.raw,r=r.replace(/scale\([^)]*\)/g,"").trim(),t.setAttribute("transform",`${r} scale(${e},${n})`.trim())}function translateAndAutoOrient(t,e,n,r){const i=Point.create(e),o=Point.create(n);r||(r=t instanceof SVGSVGElement?t:t.ownerSVGElement);const s=scale(t);t.setAttribute("transform","");const a=getBBox(t,{target:r}).scale(s.sx,s.sy),l=createSVGTransform();l.setTranslate(-a.x-a.width/2,-a.y-a.height/2);const c=createSVGTransform(),u=i.angleBetween(o,i.clone().translate(1,0));u&&c.setRotate(u,0,0);const h=createSVGTransform(),d=i.clone().move(o,a.width/2);h.setTranslate(2*i.x-d.x,2*i.y-d.y);const f=getTransformToElement(t,r),p=createSVGTransform();p.setMatrix(h.matrix.multiply(c.matrix.multiply(l.matrix.multiply(f.scale(s.sx,s.sy))))),t.setAttribute("transform",matrixToTransformString(p.matrix))}class MouseWheelHandle{constructor(t,e,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=Platform.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=e,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){Platform.SUPPORT_PASSIVE?this.target.addEventListener(this.eventName,this.onWheel,{passive:!1}):jquery(this.target).on("mousewheel",this.onWheel)}disable(){Platform.SUPPORT_PASSIVE?this.target.removeEventListener(this.eventName,this.onWheel):jquery(this.target).off("mousewheel")}onWheel(t){if(null!=this.onWheelGuard&&!this.onWheelGuard(t))return;let e;this.deltaX+=t.deltaX,this.deltaY+=t.deltaY,t.preventDefault(),0===this.deltaX&&0===this.deltaY||(t.stopPropagation(),e=!0),!0===e&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((()=>{this.didWheel(t)})))}didWheel(t){this.animationFrameId=0,this.onWheelCallback(t,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function debounce(t,e=60){let n=null;return(...r)=>{n&&clearTimeout(n),n=window.setTimeout((()=>{t.apply(this,r)}),e)}}function createSensor$2(t){let e=null,n=[];const r=debounce((()=>{n.forEach((e=>e(t)))})),i=()=>{e&&e.parentNode&&(e.contentDocument&&e.contentDocument.defaultView.removeEventListener("resize",r),e.parentNode.removeChild(e),e=null,n=[])};return{element:t,bind:i=>{e||(e=(()=>{"static"===getComputedStyle(t).position&&(t.style.position="relative");const e=document.createElement("object");return e.onload=()=>{e.contentDocument.defaultView.addEventListener("resize",r),r()},e.style.display="block",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.height="100%",e.style.width="100%",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.zIndex="-1",e.style.opacity="0",e.setAttribute("tabindex","-1"),e.type="text/html",t.appendChild(e),e.data="about:blank",e})()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:t=>{const r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&e&&i()}}}function createSensor$1(t){let e=null,n=[];const r=debounce((()=>{n.forEach((e=>{e(t)}))})),i=()=>{e&&(e.disconnect(),n=[],e=null)};return{element:t,bind:i=>{e||(e=(()=>{const e=new ResizeObserver(r);return e.observe(t),r(),e})()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:t=>{const r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&e&&i()}}}const createSensor="undefined"!=typeof ResizeObserver?createSensor$1:createSensor$2;var SizeSensor,Scheduler;!function(t){const e=new WeakMap;function n(t){let n=e.get(t);return n||(n=createSensor(t),e.set(t,n),n)}t.bind=(t,e)=>{const r=n(t);return r.bind(e),()=>r.unbind(e)},t.clear=t=>{var r;(r=n(t)).destroy(),e.delete(r.element)}}(SizeSensor||(SizeSensor={})),function(t){const e=[],n=[];let r=0;const i=()=>performance.now(),o=t=>t[0],s=t=>1===n.push(t)&&a(),a=(()=>{const t=()=>n.splice(0,n.length).forEach((t=>t()));if("undefined"!=typeof MessageChannel){const{port1:e,port2:n}=new MessageChannel;return e.onmessage=t,()=>n.postMessage(null)}return()=>setTimeout(t)})(),l=()=>{r=i()+16.666666666666668;let n=o(e);for(;n&&!t.shouldYield();){const{callback:t,data:r}=n;n.callback=null;const i=t&&t(r);i?n.callback=i:e.shift(),n=o(e)}n&&s(l)};t.scheduleTask=(t,n)=>{e.push({callback:t,data:n}),s(l)},t.shouldYield=()=>{var t,e;return(null===(e=null===(t=navigator)||void 0===t?void 0:t.scheduling)||void 0===e?void 0:e.isInputPending())||i()>=r}}(Scheduler||(Scheduler={}));class Registry{constructor(t){this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(t,e,n=!1){if("object"==typeof t)return void Object.keys(t).forEach((n=>{this.register(n,t[n],e)}));!this.exist(t)||n||Platform.isApplyingHMR()||this.onDuplicated(t);const r=this.options.process,i=r?call(r,this,t,e):e;return this.data[t]=i,i}unregister(t){const e=t?this.data[t]:null;return delete this.data[t],e}get(t){return t?this.data[t]:null}exist(t){return!!t&&null!=this.data[t]}onDuplicated(t){try{throw this.options.onConflict&&call(this.options.onConflict,this,t),new Error(`${upperFirst(this.options.type)} with name '${t}' already registered.`)}catch(t){throw t}}onNotFound(t,e){throw new Error(this.getSpellingSuggestion(t,e))}getSpellingSuggestion(t,e){const n=this.getSpellingSuggestionForName(t),r=e?`${e} ${lowerFirst(this.options.type)}`:this.options.type;return`${upperFirst(r)} with name '${t}' does not exist.${n?` Did you mean '${n}'?`:""}`}getSpellingSuggestionForName(t){return getSpellingSuggestion(t,Object.keys(this.data),(t=>t))}}!function(t){t.create=function(e){return new t(e)}}(Registry||(Registry={}));const raw={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},ref={},refX={position:positionWrapper("x","width","origin")},refY={position:positionWrapper("y","height","origin")},refDx={position:positionWrapper("x","width","corner")},refDy={position:positionWrapper("y","height","corner")},refWidth={set:setWrapper("width","width")},refHeight={set:setWrapper("height","height")},refRx={set:setWrapper("rx","width")},refRy={set:setWrapper("ry","height")},refRInscribed={set:(()=>{const t=setWrapper("r","width"),e=setWrapper("r","height");return function(n,r){const i=r.refBBox;return call(i.height>i.width?t:e,this,n,r)}})()},refRCircumscribed={set(t,{refBBox:e}){let n=parseFloat(t);const r=isPercentage(t);r&&(n/=100);const i=Math.sqrt(e.height*e.height+e.width*e.width);let o;return Number.isFinite(n)&&(o=r||n>=0&&n<=1?n*i:Math.max(n+i,0)),{r:o}}},refCx={set:setWrapper("cx","width")},refCy={set:setWrapper("cy","height")},refDResetOffset={set:dWrapper({resetOffset:!0})},refDKeepOffset={set:dWrapper({resetOffset:!1})},refPointsResetOffset={set:pointsWrapper({resetOffset:!0})},refPointsKeepOffset={set:pointsWrapper({resetOffset:!1})},refR=refRInscribed,refD=refDResetOffset,refPoints=refPointsResetOffset,refX2=refX,refY2=refY,refWidth2=refWidth,refHeight2=refHeight;function positionWrapper(t,e,n){return(r,{refBBox:i})=>{if(null==r)return null;let o=parseFloat(r);const s=isPercentage(r);let a;if(s&&(o/=100),Number.isFinite(o)){const r=i[n];a=s||o>0&&o<1?r[t]+i[e]*o:r[t]+o}const l=new Point;return l[t]=a||0,l}}function setWrapper(t,e){return function(n,{refBBox:r}){let i=parseFloat(n);const o=isPercentage(n);o&&(i/=100);const s={};if(Number.isFinite(i)){const n=o||i>=0&&i<=1?i*r[e]:Math.max(i+r[e],0);s[t]=n}return s}}function shapeWrapper(t,e){const n="x6-shape",r=e&&e.resetOffset;return function(e,{view:i,elem:o,refBBox:s}){const a=i.$(o);let l=a.data(n);if(!l||l.value!==e){const r=t(e);l={value:e,shape:r,shapeBBox:r.bbox()},a.data(n,l)}const c=l.shape.clone(),u=l.shapeBBox.clone(),h=u.getOrigin(),d=s.getOrigin();u.x=d.x,u.y=d.y;const f=s.getMaxScaleToFit(u,d);return c.scale(0===u.width||0===s.width?1:f.sx,0===u.height||0===s.height?1:f.sy,h),r&&c.translate(-h.x,-h.y),c}}function dWrapper(t){const e=shapeWrapper((function(t){return Path$1.parse(t)}),t);return(t,n)=>({d:e(t,n).serialize()})}function pointsWrapper(t){const e=shapeWrapper((t=>new Polyline(t)),t);return(t,n)=>({points:e(t,n).serialize()})}const fill={qualify:isPlainObject,set:(t,{view:e})=>`url(#${e.graph.defineGradient(t)})`},stroke$1={qualify:isPlainObject,set(t,{view:e}){const n=e.cell,r=Object.assign({},t);if(n.isEdge()&&"linearGradient"===r.type){const t=e.sourcePoint,i=e.targetPoint;r.id=`gradient-${r.type}-${n.id}`,r.attrs=Object.assign(Object.assign({},r.attrs),{x1:t.x,y1:t.y,x2:i.x,y2:i.y,gradientUnits:"userSpaceOnUse"}),e.graph.defs.remove(r.id)}return`url(#${e.graph.defineGradient(r)})`}},text$1={qualify:(t,{attrs:e})=>null==e.textWrap||!isPlainObject(e.textWrap),set(t,{view:e,elem:n,attrs:r}){const i="x6-text",o=e.$(n),s=o.data(i),a=t=>{try{return JSON.parse(t)}catch(e){return t}},l={x:r.x,eol:r.eol,annotations:a(r.annotations),textPath:a(r["text-path"]||r.textPath),textVerticalAnchor:r["text-vertical-anchor"]||r.textVerticalAnchor,displayEmpty:"true"===(r["display-empty"]||r.displayEmpty),lineHeight:r["line-height"]||r.lineHeight},c=r["font-size"]||r.fontSize,u=JSON.stringify([t,l]);if(c&&n.setAttribute("font-size",c),null==s||s!==u){const r=l.textPath;if(null!=r&&"object"==typeof r){const t=r.selector;if("string"==typeof t){const n=e.find(t)[0];n instanceof SVGPathElement&&(ensureId(n),l.textPath=Object.assign({"xlink:href":`#${n.id}`},r))}}text$2(n,`${t}`,l),o.data(i,u)}}},textWrap={qualify:isPlainObject,set(t,{view:e,elem:n,attrs:r,refBBox:i}){const o=t,s=o.width||0;isPercentage(s)?i.width*=parseFloat(s)/100:s<=0?i.width+=s:i.width=s;const a=o.height||0;let l;isPercentage(a)?i.height*=parseFloat(a)/100:a<=0?i.height+=a:i.height=a;let c=o.text;null==c&&(c=r.text),l=null!=c?breakText(`${c}`,i,{"font-weight":r["font-weight"]||r.fontWeight,"font-size":r["font-size"]||r.fontSize,"font-family":r["font-family"]||r.fontFamily,lineHeight:r.lineHeight},{svgDocument:e.graph.view.svg,ellipsis:o.ellipsis,hyphen:o.hyphen,breakWord:o.breakWord}):"",call(text$1.set,this,l,{view:e,elem:n,attrs:r,refBBox:i,cell:e.cell})}},isTextInUse=(t,{attrs:e})=>void 0!==e.text,lineHeight={qualify:isTextInUse},textVerticalAnchor={qualify:isTextInUse},textPath={qualify:isTextInUse},annotations={qualify:isTextInUse},eol={qualify:isTextInUse},displayEmpty={qualify:isTextInUse},title={qualify:(t,{elem:e})=>e instanceof SVGElement,set(t,{view:e,elem:n}){const r="x6-title",i=`${t}`,o=e.$(n),s=o.data(r);if(null==s||s!==i){o.data(r,i);const t=n.firstChild;if(t&&"TITLE"===t.tagName.toUpperCase())t.textContent=i;else{const e=document.createElementNS(n.namespaceURI,"title");e.textContent=i,n.insertBefore(e,t)}}}},xAlign={offset:offsetWrapper("x","width","right")},yAlign={offset:offsetWrapper("y","height","bottom")},resetOffset={offset:(t,{refBBox:e})=>t?{x:-e.x,y:-e.y}:{x:0,y:0}};function offsetWrapper(t,e,n){return(r,{refBBox:i})=>{const o=new Point;let s;return s="middle"===r?i[e]/2:r===n?i[e]:"number"==typeof r&&Number.isFinite(r)?r>-1&&r<1?-i[e]*r:-r:isPercentage(r)?i[e]*parseFloat(r)/100:0,o[t]=-(i[t]+s),o}}const style$1={qualify:isPlainObject,set(t,{view:e,elem:n}){e.$(n).css(t)}},html$1={set(t,{view:e,elem:n}){e.$(n).html(`${t}`)}},filter={qualify:isPlainObject,set:(t,{view:e})=>`url(#${e.graph.defineFilter(t)})`},port={set:t=>null!=t&&"object"==typeof t&&t.id?t.id:t};function normalize(t,e,n){let r,i;"object"==typeof e?(r=e.x,i=e.y):(r=e,i=n);const o=Path$1.parse(t),s=o.bbox();if(s){let t=-s.height/2-s.y,e=-s.width/2-s.x;"number"==typeof r&&(e-=r),"number"==typeof i&&(t-=i),o.translate(e,t)}return o.serialize()}var __rest$w=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const block=t=>{var{size:e,width:n,height:r,offset:i,open:o}=t;return createClassicMarker({size:e,width:n,height:r,offset:i},!0===o,!0,void 0,__rest$w(t,["size","width","height","offset","open"]))},classic=t=>{var{size:e,width:n,height:r,offset:i,factor:o}=t;return createClassicMarker({size:e,width:n,height:r,offset:i},!1,!1,o,__rest$w(t,["size","width","height","offset","factor"]))};function createClassicMarker(t,e,n,r=3/4,i={}){const o=t.size||10,s=t.width||o,a=t.height||o,l=new Path$1,c={};if(e)l.moveTo(s,0).lineTo(0,a/2).lineTo(s,a),c.fill="none";else{if(l.moveTo(0,a/2),l.lineTo(s,0),!n){const t=clamp$1(r,0,1);l.lineTo(s*t,a/2)}l.lineTo(s,a),l.close()}return Object.assign(Object.assign(Object.assign({},c),i),{tagName:"path",d:normalize(l.serialize(),{x:null!=t.offset?t.offset:-s/2})})}var __rest$v=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const diamond=t=>{var{size:e,width:n,height:r,offset:i}=t,o=__rest$v(t,["size","width","height","offset"]);const s=e||10,a=n||s,l=r||s,c=new Path$1;return c.moveTo(0,l/2).lineTo(a/2,0).lineTo(a,l/2).lineTo(a/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:normalize(c.serialize(),null==i?-a/2:i)})};var __rest$u=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const path$3=t=>{var{d:e,offsetX:n,offsetY:r}=t,i=__rest$u(t,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},i),{tagName:"path",d:normalize(e,n,r)})};var __rest$t=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const cross=t=>{var{size:e,width:n,height:r,offset:i}=t,o=__rest$t(t,["size","width","height","offset"]);const s=e||10,a=n||s,l=r||s,c=new Path$1;return c.moveTo(0,0).lineTo(a,l).moveTo(0,l).lineTo(a,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:normalize(c.serialize(),i||-a/2)})};var __rest$s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const async$1=t=>{var{width:e,height:n,offset:r,open:i,flip:o}=t,s=__rest$s(t,["width","height","offset","open","flip"]);let a=n||6;const l=e||10,c=!0===i,u=!0===o,h=Object.assign(Object.assign({},s),{tagName:"path"});u&&(a=-a);const d=new Path$1;return d.moveTo(0,a).lineTo(l,0),c?h.fill="none":(d.lineTo(l,a),d.close()),h.d=normalize(d.serialize(),{x:r||-l/2,y:a/2}),h};var __rest$r=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const circle=t=>{var{r:e}=t,n=__rest$r(t,["r"]);const r=e||5;return Object.assign(Object.assign({cx:r},n),{tagName:"circle",r})},circlePlus=t=>{var{r:e}=t,n=__rest$r(t,["r"]);const r=e||5,i=new Path$1;return i.moveTo(r,0).lineTo(r,2*r),i.moveTo(0,r).lineTo(2*r,r),{children:[Object.assign(Object.assign({},circle({r})),{fill:"none"}),Object.assign(Object.assign({},n),{tagName:"path",d:normalize(i.serialize(),-r)})]}};var __rest$q=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const ellipse$2=t=>{var{rx:e,ry:n}=t,r=__rest$q(t,["rx","ry"]);const i=e||5,o=n||5;return Object.assign(Object.assign({cx:i},r),{tagName:"ellipse",rx:i,ry:o})},markers=Object.freeze({__proto__:null,block,classic,diamond,path:path$3,cross,async:async$1,circle,circlePlus,ellipse:ellipse$2});var Marker;!function(t){t.presets=markers,t.registry=Registry.create({type:"marker"}),t.registry.register(t.presets,!0)}(Marker||(Marker={})),(Marker||(Marker={})).normalize=normalize;var __rest$p=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function qualify(t){return"string"==typeof t||isPlainObject(t)}const sourceMarker={qualify,set:(t,{view:e,attrs:n})=>createMarker("marker-start",t,e,n)},targetMarker={qualify,set:(t,{view:e,attrs:n})=>createMarker("marker-end",t,e,n,{transform:"rotate(180)"})},vertexMarker={qualify,set:(t,{view:e,attrs:n})=>createMarker("marker-mid",t,e,n)};function createMarker(t,e,n,r,i={}){const o="string"==typeof e?{name:e}:e,{name:s,args:a}=o,l=__rest$p(o,["name","args"]);let c=l;if(s&&"string"==typeof s){const t=Marker.registry.get(s);if(!t)return Marker.registry.onNotFound(s);c=t(Object.assign(Object.assign({},l),a))}const u=Object.assign(Object.assign(Object.assign({},normalizeAttr(r,t)),i),c);return{[t]:`url(#${n.graph.defineMarker(u)})`}}function normalizeAttr(t,e){const n={},r=t.stroke;"string"==typeof r&&(n.stroke=r,n.fill=r);let i=t.strokeOpacity;if(null==i&&(i=t["stroke-opacity"]),null==i&&(i=t.opacity),null!=i&&(n["stroke-opacity"]=i,n["fill-opacity"]=i),"marker-mid"!==e){const r=parseFloat(t.strokeWidth||t["stroke-width"]);if(Number.isFinite(r)&&r>1){const t=Math.ceil(r/2);n.refX="marker-start"===e?t:-t}}return n}const isEdgeView=(t,{view:e})=>e.cell.isEdge(),connection={qualify:isEdgeView,set(t,e){var n,r,i,o;const s=e.view,a=t.reverse||!1,l=t.stubs||0;let c;if(Number.isFinite(l)&&0!==l)if(a){let t,e;const a=s.getConnectionLength()||0;l<0?(t=(a+l)/2,e=-l):(t=l,e=a-2*l);const u=s.getConnection();c=null===(o=null===(i=null===(r=null===(n=null==u?void 0:u.divideAtLength(t))||void 0===n?void 0:n[1])||void 0===r?void 0:r.divideAtLength(e))||void 0===i?void 0:i[0])||void 0===o?void 0:o.serialize()}else{let t;t=l<0?((s.getConnectionLength()||0)+l)/2:l;const e=s.getConnection();if(e){const n=e.divideAtLength(t),r=e.divideAtLength(-t);n&&r&&(c=`${n[0].serialize()} ${r[1].serialize()}`)}}return{d:c||s.getConnectionPathData()}}},atConnectionLengthKeepGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtLength",{rotate:!0})},atConnectionLengthIgnoreGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtLength",{rotate:!1})},atConnectionRatioKeepGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtRatio",{rotate:!0})},atConnectionRatioIgnoreGradient={qualify:isEdgeView,set:atConnectionWrapper("getTangentAtRatio",{rotate:!1})},atConnectionLength=atConnectionLengthKeepGradient,atConnectionRatio=atConnectionRatioKeepGradient;function atConnectionWrapper(t,e){const n={x:1,y:0};return(r,i)=>{let o,s;const a=i.view,l=a[t](Number(r));return l?(s=e.rotate?l.vector().vectorAngle(n):0,o=l.start):(o=a.path.start,s=0),0===s?{transform:`translate(${o.x},${o.y}')`}:{transform:`translate(${o.x},${o.y}') rotate(${s})`}}}const attrs=Object.freeze({__proto__:null,ref,refX,refY,refDx,refDy,refWidth,refHeight,refRx,refRy,refRInscribed,refRCircumscribed,refCx,refCy,refDResetOffset,refDKeepOffset,refPointsResetOffset,refPointsKeepOffset,refR,refD,refPoints,refX2,refY2,refWidth2,refHeight2,fill,stroke:stroke$1,text:text$1,textWrap,lineHeight,textVerticalAnchor,textPath,annotations,eol,displayEmpty,title,xAlign,yAlign,resetOffset,style:style$1,html:html$1,filter,port,sourceMarker,targetMarker,vertexMarker,connection,atConnectionLengthKeepGradient,atConnectionLengthIgnoreGradient,atConnectionRatioKeepGradient,atConnectionRatioIgnoreGradient,atConnectionLength,atConnectionRatio});var Attr;(Attr||(Attr={})).isValidDefinition=function(t,e,n){if(null!=t){if("string"==typeof t)return!0;if("function"!=typeof t.qualify||call(t.qualify,this,e,n))return!0}return!1},function(t){t.presets=Object.assign(Object.assign({},raw),attrs),t.registry=Registry.create({type:"attribute definition"}),t.registry.register(t.presets,!0)}(Attr||(Attr={}));const dot={color:"#aaaaaa",thickness:1,markup:"rect",update(t,e){const n=e.thickness*e.sx,r=e.thickness*e.sy;attr(t,{width:n,height:r,rx:n,ry:r,fill:e.color})}},fixedDot={color:"#aaaaaa",thickness:1,markup:"rect",update(t,e){const n=e.sx<=1?e.thickness*e.sx:e.thickness;attr(t,{width:n,height:n,rx:n,ry:n,fill:e.color})}},mesh={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(t,e){let n;const r=e.width,i=e.height,o=e.thickness;n=r-o>=0&&i-o>=0?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",attr(t,{d:n,stroke:e.color,"stroke-width":e.thickness})}},doubleMesh=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(t,e){let n;const r=e.width,i=e.height,o=e.thickness;n=r-o>=0&&i-o>=0?["M",r,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",attr(t,{d:n,stroke:e.color,"stroke-width":e.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(t,e){let n;const r=e.factor||1,i=e.width*r,o=e.height*r,s=e.thickness;n=i-s>=0&&o-s>=0?["M",i,0,"H0 M0 0 V0",o].join(" "):"M 0 0 0 0",e.width=i,e.height=o,attr(t,{d:n,stroke:e.color,"stroke-width":e.thickness})}}],patterns$1=Object.freeze({__proto__:null,dot,fixedDot,mesh,doubleMesh});class Grid{constructor(){this.patterns={},this.root=Vector.create(createSvgDocument(),{width:"100%",height:"100%"},[createSvgElement("defs")]).node}add(t,e){const n=this.root.childNodes[0];n&&n.appendChild(e),this.patterns[t]=e,Vector.create("rect",{width:"100%",height:"100%",fill:`url(#${t})`}).appendTo(this.root)}get(t){return this.patterns[t]}has(t){return null!=this.patterns[t]}}function getString(t,e){return null!=t?t:e}function getNumber(t,e){return null!=t&&Number.isFinite(t)?t:e}function outline(t={}){const e=getString(t.color,"blue"),n=getNumber(t.width,1),r=getNumber(t.margin,2);return`\n    <filter>\n      <feFlood flood-color="${e}" flood-opacity="${getNumber(t.opacity,1)}" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${r+n}" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${r}" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  `.trim()}function highlight(t={}){const e=getString(t.color,"red"),n=getNumber(t.blur,0),r=getNumber(t.width,1);return`\n      <filter>\n        <feFlood flood-color="${e}" flood-opacity="${getNumber(t.opacity,1)}" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${r}"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="${n}"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    `.trim()}function blur(t={}){const e=getNumber(t.x,2);return`\n    <filter>\n      <feGaussianBlur stdDeviation="${null!=t.y&&Number.isFinite(t.y)?[e,t.y]:e}"/>\n    </filter>\n  `.trim()}function dropShadow(t={}){const e=getNumber(t.dx,0),n=getNumber(t.dy,0),r=getString(t.color,"black"),i=getNumber(t.blur,4),o=getNumber(t.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>\n         <feDropShadow stdDeviation="${i}" dx="${e}" dy="${n}" flood-color="${r}" flood-opacity="${o}" />\n       </filter>`.trim():`<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="${i}" />\n         <feOffset dx="${e}" dy="${n}" result="offsetblur" />\n         <feFlood flood-color="${r}" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="${o}" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>`.trim()}function grayScale(t={}){const e=getNumber(t.amount,1),n=.7152-.7152*(1-e);return`\n    <filter>\n      <feColorMatrix type="matrix" values="${.2126+.7874*(1-e)} ${n} ${.0722-.0722*(1-e)} 0 0 ${.2126-.2126*(1-e)} ${.7152+.2848*(1-e)} ${.0722-.0722*(1-e)} 0 0 ${.2126-.2126*(1-e)} ${n} ${.0722+.9278*(1-e)} 0 0 0 0 0 1 0"/>\n    </filter>\n  `.trim()}function sepia(t={}){const e=getNumber(t.amount,1);return`\n      <filter>\n        <feColorMatrix type="matrix" values="${.393+.607*(1-e)} ${.769-.769*(1-e)} ${.189-.189*(1-e)} 0 0 ${.349-.349*(1-e)} ${.686+.314*(1-e)} ${.168-.168*(1-e)} 0 0 ${.272-.272*(1-e)} ${.534-.534*(1-e)} ${.131+.869*(1-e)} 0 0 0 0 0 1 0"/>\n      </filter>\n    `.trim()}function saturate(t={}){return`\n      <filter>\n        <feColorMatrix type="saturate" values="${1-getNumber(t.amount,1)}"/>\n      </filter>\n    `.trim()}function hueRotate(t={}){return`\n      <filter>\n        <feColorMatrix type="hueRotate" values="${getNumber(t.angle,0)}"/>\n      </filter>\n    `.trim()}function invert(t={}){const e=getNumber(t.amount,1),n=1-e;return`\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="${e} ${n}"/>\n          <feFuncG type="table" tableValues="${e} ${n}"/>\n          <feFuncB type="table" tableValues="${e} ${n}"/>\n        </feComponentTransfer>\n      </filter>\n    `.trim()}function brightness(t={}){const e=getNumber(t.amount,1);return`\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="${e}"/>\n        <feFuncG type="linear" slope="${e}"/>\n        <feFuncB type="linear" slope="${e}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}function contrast(t={}){const e=getNumber(t.amount,1),n=.5-e/2;return`\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="${e}" intercept="${n}"/>\n        <feFuncG type="linear" slope="${e}" intercept="${n}"/>\n        <feFuncB type="linear" slope="${e}" intercept="${n}"/>\n      </feComponentTransfer>\n    </filter>\n  `.trim()}!function(t){t.presets=patterns$1,t.registry=Registry.create({type:"grid"}),t.registry.register(t.presets,!0)}(Grid||(Grid={}));const filters=Object.freeze({__proto__:null,outline,highlight,blur,dropShadow,grayScale,sepia,saturate,hueRotate,invert,brightness,contrast});var Filter;!function(t){t.presets=filters,t.registry=Registry.create({type:"filter"}),t.registry.register(t.presets,!0)}(Filter||(Filter={}));const flipX=function(t){const e=document.createElement("canvas"),n=t.width,r=t.height;e.width=2*n,e.height=r;const i=e.getContext("2d");return i.drawImage(t,0,0,n,r),i.translate(2*n,0),i.scale(-1,1),i.drawImage(t,0,0,n,r),e},flipY=function(t){const e=document.createElement("canvas"),n=t.width,r=t.height;e.width=n,e.height=2*r;const i=e.getContext("2d");return i.drawImage(t,0,0,n,r),i.translate(0,2*r),i.scale(1,-1),i.drawImage(t,0,0,n,r),e},flipXY=function(t){const e=document.createElement("canvas"),n=t.width,r=t.height;e.width=2*n,e.height=2*r;const i=e.getContext("2d");return i.drawImage(t,0,0,n,r),i.setTransform(-1,0,0,-1,e.width,e.height),i.drawImage(t,0,0,n,r),i.setTransform(-1,0,0,1,e.width,0),i.drawImage(t,0,0,n,r),i.setTransform(1,0,0,-1,0,e.height),i.drawImage(t,0,0,n,r),e},watermark=function(t,e){const n=t.width,r=t.height,i=document.createElement("canvas");i.width=3*n,i.height=3*r;const o=i.getContext("2d"),s=Angle.toRad(null!=e.angle?-e.angle:-20),a=i.width/4,l=i.height/4;for(let e=0;e<4;e+=1)for(let i=0;i<4;i+=1)(e+i)%2>0&&(o.setTransform(1,0,0,1,(2*e-1)*a,(2*i-1)*l),o.rotate(s),o.drawImage(t,-n/2,-r/2,n,r));return i},patterns=Object.freeze({__proto__:null,flipX,flipY,flipXY,watermark});var Background;!function(t){t.presets=Object.assign({},patterns),t.presets["flip-x"]=flipX,t.presets["flip-y"]=flipY,t.presets["flip-xy"]=flipXY,t.registry=Registry.create({type:"background pattern"}),t.registry.register(t.presets,!0)}(Background||(Background={}));const Config={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,trackable:!1,trackInfo:{},track(t){Config.trackable=t}};var Util$3;!function(t){t.snapToGrid=snapToGrid,t.normalizeMarker=normalize,t.prefix=function(t){return`${Config.prefixCls}-${t}`}}(Util$3||(Util$3={})),(Util$3||(Util$3={})).makeTree=function(t,e,n,r=[]){const i="function"==typeof e.children?e.children(t):t[e.children||"children"];return n||(n=e.createNode(t),r.push(n)),Array.isArray(i)&&i.forEach((t=>{const i=e.createNode(t),o=e.createEdge(n,i);r.push(i,o),this.makeTree(t,e,i,r)})),r};const version="1.33.1",defaultClassName=Util$3.prefix("highlighted"),className$1={highlight(t,e,n){addClass(e,n&&n.className||defaultClassName)},unhighlight(t,e,n){removeClass(e,n&&n.className||defaultClassName)}},className=Util$3.prefix("highlight-opacity"),opacity={highlight(t,e){addClass(e,className)},unhighlight(t,e){removeClass(e,className)}},defaultOptions={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},stroke={highlight(t,e,n){const r=Private$8.getHighlighterId(e,n);if(Private$8.hasCache(r))return;n=defaultsDeep({},n,defaultOptions);const i=Vector.create(e);let o,s;try{o=i.toPathData()}catch(t){s=i.bbox(!0),o=rectToPathData(Object.assign(Object.assign({},n),s))}const a=createSvgElement("path");if(attr(a,Object.assign({d:o,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},n.attrs?kebablizeAttrs(n.attrs):null)),t.isEdgeElement(e))attr(a,"d",t.getConnectionPathData());else{let e=i.getTransformToElement(t.container);const r=n.padding;if(r){null==s&&(s=i.bbox(!0));const t=s.x+s.width/2,n=s.y+s.height/2;s=transformRectangle(s,e);const o=Math.max(s.width,1),a=Math.max(s.height,1),l=(o+r)/o,c=(a+r)/a,u=createSVGMatrix({a:l,b:0,c:0,d:c,e:t-l*t,f:n-c*n});e=e.multiply(u)}transform(a,e)}addClass(a,Util$3.prefix("highlight-stroke"));const l=t.cell,c=()=>Private$8.removeHighlighter(r);l.on("removed",c),l.model&&l.model.on("reseted",c),t.container.appendChild(a),Private$8.setCache(r,a)},unhighlight(t,e,n){Private$8.removeHighlighter(Private$8.getHighlighterId(e,n))}};var Private$8;!function(t){t.getHighlighterId=function(t,e){return ensureId(t),t.id+JSON.stringify(e)};const e={};t.setCache=function(t,n){e[t]=n},t.hasCache=function(t){return null!=e[t]},t.removeHighlighter=function(t){const n=e[t];n&&(remove(n),delete e[t])}}(Private$8||(Private$8={}));const highlighters=Object.freeze({__proto__:null,className:className$1,opacity,stroke});var Highlighter;function normalizePoint$1(t,e={}){return new Point(normalizePercentage(e.x,t.width),normalizePercentage(e.y,t.height))}function toResult$1(t,e,n){return Object.assign({angle:e,position:t.toJSON()},n)}(Highlighter||(Highlighter={})).check=function(t,e){if("function"!=typeof e.highlight)throw new Error(`Highlighter '${t}' is missing required \`highlight()\` method`);if("function"!=typeof e.unhighlight)throw new Error(`Highlighter '${t}' is missing required \`unhighlight()\` method`)},function(t){t.presets=highlighters,t.registry=Registry.create({type:"highlighter"}),t.registry.register(t.presets,!0)}(Highlighter||(Highlighter={}));const absolute=(t,e)=>t.map((({x:t,y:n,angle:r})=>toResult$1(normalizePoint$1(e,{x:t,y:n}),r||0))),ellipse$1=(t,e,n)=>{const r=n.step||20;return ellipseLayout(t,e,n.start||0,((t,e)=>(t+.5-e/2)*r))},ellipseSpread=(t,e,n)=>{const r=n.step||360/t.length;return ellipseLayout(t,e,n.start||0,(t=>t*r))};function ellipseLayout(t,e,n,r){const i=e.getCenter(),o=e.getTopCenter(),s=e.width/e.height,a=Ellipse.fromRect(e),l=t.length;return t.map(((t,e)=>{const c=n+r(e,l),u=o.clone().rotate(-c,i).scale(s,1,i),h=t.compensateRotate?-a.tangentTheta(u):0;return(t.dx||t.dy)&&u.translate(t.dx||0,t.dy||0),t.dr&&u.move(i,t.dr),toResult$1(u.round(),h,t)}))}var __rest$o=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const line$1=(t,e,n)=>lineLayout(t,normalizePoint$1(e,n.start||e.getOrigin()),normalizePoint$1(e,n.end||e.getCorner()),n),left$2=(t,e,n)=>lineLayout(t,e.getTopLeft(),e.getBottomLeft(),n),right$2=(t,e,n)=>lineLayout(t,e.getTopRight(),e.getBottomRight(),n),top$2=(t,e,n)=>lineLayout(t,e.getTopLeft(),e.getTopRight(),n),bottom$2=(t,e,n)=>lineLayout(t,e.getBottomLeft(),e.getBottomRight(),n);function lineLayout(t,e,n,r){const i=new Line(e,n),o=t.length;return t.map(((t,e)=>{var{strict:n}=t,s=__rest$o(t,["strict"]);const a=i.pointAt(n||r.strict?(e+1)/(o+1):(e+.5)/o);return(s.dx||s.dy)&&a.translate(s.dx||0,s.dy||0),toResult$1(a.round(),0,s)}))}const layouts$1=Object.freeze({__proto__:null,absolute,ellipse:ellipse$1,ellipseSpread,line:line$1,left:left$2,right:right$2,top:top$2,bottom:bottom$2});var PortLayout;!function(t){t.presets=layouts$1,t.registry=Registry.create({type:"port layout"}),t.registry.register(t.presets,!0)}(PortLayout||(PortLayout={}));const defaults$2={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function toResult(t,e){const{x:n,y:r,angle:i,attrs:o}=e||{};return defaultsDeep({},{angle:i,attrs:o,position:{x:n,y:r}},t,defaults$2)}const manual=(t,e,n)=>toResult({position:e.getTopLeft()},n),left$1=(t,e,n)=>toResult({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},n),right$1=(t,e,n)=>toResult({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},n),top$1=(t,e,n)=>toResult({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},n),bottom$1=(t,e,n)=>toResult({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},n),outside=(t,e,n)=>outsideLayout(t,e,!1,n),outsideOriented=(t,e,n)=>outsideLayout(t,e,!0,n),inside=(t,e,n)=>insideLayout(t,e,!1,n),insideOriented=(t,e,n)=>insideLayout(t,e,!0,n);function outsideLayout(t,e,n,r){const i=null!=r.offset?r.offset:15,o=e.getCenter().theta(t),s=getBBoxAngles(e);let a,l,c,u,h=0;return o<s[1]||o>s[2]?(a=".3em",l=i,c=0,u="start"):o<s[0]?(a="0",l=0,c=-i,n?(h=-90,u="start"):u="middle"):o<s[3]?(a=".3em",l=-i,c=0,u="end"):(a=".6em",l=0,c=i,n?(h=90,u="start"):u="middle"),toResult({position:{x:Math.round(l),y:Math.round(c)},angle:h,attrs:{".":{y:a,"text-anchor":u}}},r)}function insideLayout(t,e,n,r){const i=null!=r.offset?r.offset:15,o=e.getCenter().theta(t),s=getBBoxAngles(e);let a,l,c,u,h=0;return o<s[1]||o>s[2]?(a=".3em",l=-i,c=0,u="end"):o<s[0]?(a=".6em",l=0,c=i,n?(h=90,u="start"):u="middle"):o<s[3]?(a=".3em",l=i,c=0,u="start"):(a="0em",l=0,c=-i,n?(h=-90,u="start"):u="middle"),toResult({position:{x:Math.round(l),y:Math.round(c)},angle:h,attrs:{".":{y:a,"text-anchor":u}}},r)}function getBBoxAngles(t){const e=t.getCenter(),n=e.theta(t.getTopLeft()),r=e.theta(t.getBottomLeft()),i=e.theta(t.getBottomRight());return[n,e.theta(t.getTopRight()),i,r]}const radial=(t,e,n)=>radialLayout(t.diff(e.getCenter()),!1,n),radialOriented=(t,e,n)=>radialLayout(t.diff(e.getCenter()),!0,n);function radialLayout(t,e,n){const r=null!=n.offset?n.offset:20,i=new Point(0,0),o=-t.theta(i);let s,a=".3em",l=o;return(o+90)%180==0?(s=e?"end":"middle",e||-270!==o||(a="0em")):o>-270&&o<-90?(s="start",l=o-180):s="end",toResult({position:t.clone().move(i,r).diff(t).round().round().toJSON(),angle:e?l:0,attrs:{".":{y:a,"text-anchor":s}}},n)}const layouts=Object.freeze({__proto__:null,manual,left:left$1,right:right$1,top:top$1,bottom:bottom$1,outside,outsideOriented,inside,insideOriented,radial,radialOriented});var PortLabelLayout,Private$7;!function(t){t.presets=layouts,t.registry=Registry.create({type:"port label layout"}),t.registry.register(t.presets,!0)}(PortLabelLayout||(PortLabelLayout={}));class Color{constructor(t,e,n,r){return null==t?this.set(255,255,255,1):"number"==typeof t?this.set(t,e,n,r):"string"==typeof t?Color.fromString(t)||this:Array.isArray(t)?this.set(t):void this.set(t.r,t.g,t.b,null==t.a?1:t.a)}blend(t,e,n){this.set(t.r+(e.r-t.r)*n,t.g+(e.g-t.g)*n,t.b+(e.b-t.b)*n,t.a+(e.a-t.a)*n)}lighten(t){const e=Color.lighten(this.toArray(),t);this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3]}darken(t){this.lighten(-t)}set(t,e,n,r){const i=Array.isArray(t)?t[0]:t,o=Array.isArray(t)?t[1]:e,s=Array.isArray(t)?t[2]:n,a=Array.isArray(t)?t[3]:r;return this.r=Math.round(clamp$1(i,0,255)),this.g=Math.round(clamp$1(o,0,255)),this.b=Math.round(clamp$1(s,0,255)),this.a=null==a?1:clamp$1(a,0,1),this}toHex(){return`#${["r","g","b"].map((t=>{const e=this[t].toString(16);return e.length<2?`0${e}`:e})).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return Color.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(t){const e=`${this.r},${this.g},${this.b},`;return t?`rgb(${e})`:`rgba(${e},${this.a})`}toGrey(){return Color.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}!function(t){function e(e){return new t([...a(e),1])}function n(e){const n=e.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(n){const e=n[1].split(/\s*,\s*/).map((t=>parseInt(t,10)));return new t(e)}return null}function r(t,e,n){n<0&&++n,n>1&&--n;const r=6*n;return r<1?t+(e-t)*r:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function i(e){const n=e.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(n){const e=n[2].split(/\s*,\s*/),r=(parseFloat(e[0])%360+360)%360/360,i=parseFloat(e[1])/100,s=parseFloat(e[2])/100,a=null==e[3]?1:parseInt(e[3],10);return new t(o(r,i,s,a))}return null}function o(t,e,n,i){const o=Array.isArray(t)?t[0]:t,s=Array.isArray(t)?t[1]:e,a=Array.isArray(t)?t[2]:n,l=Array.isArray(t)?t[3]:i,c=a<=.5?a*(s+1):a+s-a*s,u=2*a-c;return[256*r(u,c,o+1/3),256*r(u,c,o),256*r(u,c,o-1/3),null==l?1:l]}function s(e){return new t(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),e?void 0:parseFloat(Math.random().toFixed(2)))}function a(t){const e=0===t.indexOf("#")?t:`#${t}`;let n=Number(`0x${e.substr(1)}`);if(4!==e.length&&7!==e.length||Number.isNaN(n))throw new Error("Invalid hex color.");const r=4===e.length?4:8,i=(1<<r)-1,o=["b","g","r"].map((()=>{const t=n&i;return n>>=r,4===r?17*t:t}));return[o[2],o[1],o[0]]}function l(t,e,n){const r=t=>t.length<2?`0${t}`:t;return`${r(t.toString(16))}${r(e.toString(16))}${r(n.toString(16))}`}function c(t,e){if("string"==typeof t){const n="#"===t[0],r=parseInt(n?t.substr(1):t,16),i=clamp$1((r>>16)+e,0,255),o=clamp$1((r>>8&255)+e,0,255);return`${n?"#":""}${(clamp$1((255&r)+e,0,255)|o<<8|i<<16).toString(16)}`}const n=a(c(l(t[0],t[1],t[2]),e));return[n[0],n[1],n[2],t[3]]}t.fromArray=function(e){return new t(e)},t.fromHex=e,t.fromRGBA=n,t.fromHSLA=i,t.fromString=function(r){if(r.startsWith("#"))return e(r);if(r.startsWith("rgb"))return n(r);const o=t.named[r];return o?e(o):i(r)},t.makeGrey=function(e,n){return t.fromArray([e,e,e,n])},t.rgba2hsla=function(t,e,n,r){const i=Array.isArray(t)?t[0]:t,o=Array.isArray(t)?t[1]:e,s=Array.isArray(t)?t[2]:n,a=Array.isArray(t)?t[3]:r,l=Math.max(i,o,s),c=Math.min(i,o,s),u=(l+c)/2;let h=0,d=0;if(c!==l){const t=l-c;switch(d=u>.5?t/(2-l-c):t/(l+c),l){case i:h=(o-s)/t+(o<s?6:0);break;case o:h=(s-i)/t+2;break;case s:h=(i-o)/t+4}h/=6}return[h,d,u,null==a?1:a]},t.hsla2rgba=o,t.random=s,t.randomHex=function(){let t="#";for(let e=0;e<6;e+=1)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},t.randomRGBA=function(t){return s(t).toString()},t.invert=function(t,e){if("string"==typeof t){const n="#"===t[0],[r,i,o]=a(t);return e?.299*r+.587*i+.114*o>186?"#000000":"#ffffff":`${n?"#":""}${l(255-r,255-i,255-o)}`}const n=t[0],r=t[1],i=t[2],o=t[3];return e?.299*n+.587*r+.114*i>186?[0,0,0,o]:[255,255,255,o]:[255-n,255-r,255-i,o]},t.lighten=function(t,e){return c(t,e)},t.darken=function(t,e){return c(t,-e)}}(Color||(Color={})),(Color||(Color={})).named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};class Events{constructor(){this.listeners={}}on(t,e,n){return null==e||(this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e,n)),this}once(t,e,n){const r=(...i)=>(this.off(t,r),Private$7.call([e,n],i));return this.on(t,r,this)}off(t,e,n){if(!(t||e||n))return this.listeners={},this;const r=this.listeners;return(t?[t]:Object.keys(r)).forEach((t=>{const i=r[t];if(i)if(e||n)for(let t=i.length-2;t>=0;t-=2)e&&i[t]!==e||n&&i[t+1]!==n||i.splice(t,2);else delete r[t]})),this}trigger(t,...e){let n=!0;if("*"!==t){const r=this.listeners[t];null!=r&&(n=Private$7.call([...r],e))}const r=this.listeners["*"];return null!=r?toAsyncBoolean([n,Private$7.call([...r],[t,...e])]):n}emit(t,...e){return this.trigger(t,...e)}}(Private$7||(Private$7={})).call=function(t,e){const n=[];for(let r=0;r<t.length;r+=2){const i=apply(t[r],t[r+1],Array.isArray(e)?e:[e]);n.push(i)}return toAsyncBoolean(n)};class Disposable{get disposed(){return!0===this._disposed}dispose(){this._disposed=!0}}(Disposable||(Disposable={})).dispose=function(){return(t,e,n)=>{const r=n.value,i=t.__proto__;n.value=function(){this.disposed||(r.call(this),i.dispose.call(this))}}};class DisposableSet{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((t=>{t.dispose()})),this.items.clear())}contains(t){return this.items.has(t)}add(t){this.items.add(t)}remove(t){this.items.delete(t)}clear(){this.items.clear()}}!function(t){t.from=function(e){const n=new t;return e.forEach((t=>{n.add(t)})),n}}(DisposableSet||(DisposableSet={}));class Basecoat extends Events{}(Basecoat||(Basecoat={})).dispose=Disposable.dispose,applyMixins(Basecoat,Disposable);class Disablable extends Basecoat{get disabled(){return!0===this._disabled}enable(){delete this._disabled}disable(){this._disabled=!0}}var __decorate$t=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Dijkstra,Timing,Interp,LocalStorage,Private$6;class Dictionary extends Disposable{constructor(){super(),this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(t){return this.map.has(t)}get(t){return this.map.get(t)}set(t,e){this.map.set(t,e),this.arr.push(t)}delete(t){const e=this.arr.indexOf(t);e>=0&&this.arr.splice(e,1);const n=this.map.get(t);return this.map.delete(t),n}each(t){this.arr.forEach((e=>{const n=this.map.get(e);t(n,e)}))}dispose(){this.clear()}}__decorate$t([Disposable.dispose()],Dictionary.prototype,"dispose",null);class PriorityQueue{constructor(t={}){this.comparator=t.comparator||PriorityQueue.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}isEmpty(){return 0===this.data.length}insert(t,e,n){const r={priority:t,value:e},i=this.data.length-1;return n&&(r.id=n,this.index[n]=i),this.data.push(r),this.bubbleUp(i),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(t,e){const n=this.index[t];if(void 0===n)throw new Error(`Node with id '${t}' was not found in the heap.`);const r=this.data,i=this.comparator(e,r[n].priority);i<0?(r[n].priority=e,this.bubbleUp(n)):i>0&&(r[n].priority=e,this.bubbleDown(n))}remove(){const t=this.data,e=t[0],n=t.pop();return delete this.index[t.length],t.length>0&&(t[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),e?e.value:null}heapify(){for(let t=0;t<this.data.length;t+=1)this.bubbleUp(t)}bubbleUp(t){const e=this.data;let n,r,i=t;for(;i>0&&(r=i-1>>>1,this.comparator(e[i].priority,e[r].priority)<0);){n=e[r],e[r]=e[i];let t=e[i].id;null!=t&&(this.index[t]=r),e[i]=n,t=e[i].id,null!=t&&(this.index[t]=i),i=r}}bubbleDown(t){const e=this.data,n=e.length-1;let r=t;for(;;){const t=1+(r<<1),i=t+1;let o=r;if(t<=n&&this.comparator(e[t].priority,e[o].priority)<0&&(o=t),i<=n&&this.comparator(e[i].priority,e[o].priority)<0&&(o=i),o===r)break;{const t=e[o];e[o]=e[r];let n=e[r].id;null!=n&&(this.index[n]=o),e[r]=t,n=e[r].id,null!=n&&(this.index[n]=r),r=o}}}}(PriorityQueue||(PriorityQueue={})).defaultComparator=(t,e)=>t-e,(Dijkstra||(Dijkstra={})).run=function(t,e,n=(()=>1)){const r={},i={},o={},s=new PriorityQueue;for(r[e]=0,Object.keys(t).forEach((t=>{t!==e&&(r[t]=1/0),s.insert(r[t],t,t)}));!s.isEmpty();){const e=s.remove();o[e]=!0;const a=t[e]||[];for(let t=0;t<a.length;t+=1){const l=a[t];if(!o[l]){const t=r[e]+n(e,l);t<r[l]&&(r[l]=t,i[l]=e,s.updatePriority(l,t))}}}return i},function(t){t.linear=t=>t,t.quad=t=>t*t,t.cubic=t=>t*t*t,t.inout=t=>{if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},t.exponential=t=>Math.pow(2,10*(t-1)),t.bounce=t=>{for(let e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11){const r=(11-6*e-11*t)/4;return-r*r+n*n}}}(Timing||(Timing={})),(Timing||(Timing={})).decorators={reverse:t=>e=>1-t(1-e),reflect:t=>e=>.5*(e<.5?t(2*e):2-t(2-2*e)),clamp:(t,e=0,n=1)=>r=>{const i=t(r);return i<e?e:i>n?n:i},back:(t=1.70158)=>e=>e*e*((t+1)*e-t),elastic:(t=1.5)=>e=>Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)},function(t){function e(t){const e=t/1;if(e<1/2.75)return 7.5625*e*e;if(e<2/2.75){const t=e-1.5/2.75;return 7.5625*t*t+.75}if(e<2.5/2.75){const t=e-2.25/2.75;return 7.5625*t*t+.9375}{const t=e-2.625/2.75;return 7.5625*t*t+.984375}}function n(t){return 1-e(1-t)}t.easeInSine=function(t){return-1*Math.cos(t*(Math.PI/2))+1},t.easeOutSine=function(t){return Math.sin(t*(Math.PI/2))},t.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},t.easeInQuad=function(t){return t*t},t.easeOutQuad=function(t){return t*(2-t)},t.easeInOutQuad=function(t){return t<.5?2*t*t:(4-2*t)*t-1},t.easeInCubic=function(t){return t*t*t},t.easeOutCubic=function(t){const e=t-1;return e*e*e+1},t.easeInOutCubic=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},t.easeInQuart=function(t){return t*t*t*t},t.easeOutQuart=function(t){const e=t-1;return 1-e*e*e*e},t.easeInOutQuart=function(t){const e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e},t.easeInQuint=function(t){return t*t*t*t*t},t.easeOutQuint=function(t){const e=t-1;return 1+e*e*e*e*e},t.easeInOutQuint=function(t){const e=t-1;return t<.5?16*t*t*t*t*t:1+16*e*e*e*e*e},t.easeInExpo=function(t){return 0===t?0:Math.pow(2,10*(t-1))},t.easeOutExpo=function(t){return 1===t?1:1-Math.pow(2,-10*t)},t.easeInOutExpo=function(t){if(0===t||1===t)return t;const e=2*t,n=e-1;return e<1?.5*Math.pow(2,10*n):.5*(2-Math.pow(2,-10*n))},t.easeInCirc=function(t){return-1*(Math.sqrt(1-t/1*t)-1)},t.easeOutCirc=function(t){const e=t-1;return Math.sqrt(1-e*e)},t.easeInOutCirc=function(t){const e=2*t,n=e-2;return e<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-n*n)+1)},t.easeInBack=function(t,e=1.70158){return t*t*((e+1)*t-e)},t.easeOutBack=function(t,e=1.70158){const n=t/1-1;return n*n*((e+1)*n+e)+1},t.easeInOutBack=function(t,e=1.70158){const n=2*t,r=n-2,i=1.525*e;return n<1?.5*n*n*((i+1)*n-i):.5*(r*r*((i+1)*r+i)+2)},t.easeInElastic=function(t,e=.7){if(0===t||1===t)return t;const n=t/1-1,r=1-e,i=r/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*n)*Math.sin((n-i)*(2*Math.PI)/r)},t.easeOutElastic=function(t,e=.7){const n=1-e,r=2*t;if(0===t||1===t)return t;const i=n/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*r)*Math.sin((r-i)*(2*Math.PI)/n)+1},t.easeInOutElastic=function(t,e=.65){const n=1-e;if(0===t||1===t)return t;const r=2*t,i=r-1,o=n/(2*Math.PI)*Math.asin(1);return r<1?Math.pow(2,10*i)*Math.sin((i-o)*(2*Math.PI)/n)*-.5:Math.pow(2,-10*i)*Math.sin((i-o)*(2*Math.PI)/n)*.5+1},t.easeOutBounce=e,t.easeInBounce=n,t.easeInOutBounce=function(t){return t<.5?.5*n(2*t):.5*e(2*t-1)+.5}}(Timing||(Timing={})),function(t){t.number=(t,e)=>{const n=e-t;return e=>t+n*e},t.object=(t,e)=>{const n=Object.keys(t);return r=>{const i={};for(let o=n.length-1;-1!==o;o-=1){const s=n[o];i[s]=t[s]+(e[s]-t[s])*r}return i}},t.unit=(t,e)=>{const n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=n.exec(t),i=n.exec(e),o=i?i[1]:"",s=r?+r[1]:0,a=i?+i[1]:0,l=o.indexOf("."),c=l>0?o[1].length-l-1:0,u=a-s,h=r?r[2]:"";return t=>(s+u*t).toFixed(c)+h},t.color=(t,e)=>{const n=parseInt(t.slice(1),16),r=parseInt(e.slice(1),16),i=255&n,o=(255&r)-i,s=65280&n,a=(65280&r)-s,l=16711680&n,c=(16711680&r)-l;return t=>`#${(1<<24|i+o*t&255|s+a*t&65280|l+c*t&16711680).toString(16).slice(1)}`}}(Interp||(Interp={})),function(t){const e=`${Config.prefixCls}.storage`;function n(t,e,n){t&&defer((()=>{t(e,n)}))}function r(t,e){localStorage.setItem(t,JSON.stringify(e))}function i(t){const e=localStorage.getItem(t);return e?JSON.parse(e):null}function o(t){const e=i(a(t));return e?(null==e.keys&&(e.keys=[]),e):{keys:[]}}function s(t,n){return`${e}.${t}.docs.${n}`}function a(t){return`${e}.${t}.index`}t.insert=function(t,e,i){const l=e.id||uniqueId$1("doc-"),c=o(t);c.keys.push(l),r(s(t,l),e),r(a(t),c),n(i,null,Object.assign(Object.assign({},e),{id:l}))},t.find=function(t,e,r){const a=o(t),l=[];if(null==e)a.keys.forEach((e=>{const o=i(s(t,e));o?l.push(o):n(r,new Error(`No document found for an ID '${e}' from index.`))})),n(r,null,l);else if(e.id){const o=i(s(t,e.id));n(r,null,o?[o]:[])}else n(r,null,[])},t.remove=function(t,e,i){const l=o(t);if(null==e)l.keys.forEach((e=>{localStorage.removeItem(s(t,e))})),localStorage.removeItem(a(t)),n(i,null);else if(e.id){const o=l.keys.indexOf(e.id);o>=0&&l.keys.splice(o,1),localStorage.removeItem(s(t,e.id)),r(a(t),l),n(i,null)}}}(LocalStorage||(LocalStorage={}));class View extends Basecoat{constructor(){super(),this.cid=Private$6.uniqueId(),View.views[this.cid]=this}get priority(){return 2}confirmUpdate(t,e){return 0}$(t){return View.$(t)}empty(t=this.container){return this.$(t).empty(),this}unmount(t=this.container){return this.$(t).remove(),this}remove(t=this.container){return t===this.container&&(this.removeEventListeners(document),this.onRemove(),delete View.views[this.cid]),this.unmount(t),this}onRemove(){}setClass(t,e=this.container){e.classList.value=Array.isArray(t)?t.join(" "):t}addClass(t,e=this.container){return this.$(e).addClass(Array.isArray(t)?t.join(" "):t),this}removeClass(t,e=this.container){return this.$(e).removeClass(Array.isArray(t)?t.join(" "):t),this}setStyle(t,e=this.container){return this.$(e).css(t),this}setAttrs(t,e=this.container){return null!=t&&null!=e&&(e instanceof SVGElement?attr(e,t):this.$(e).attr(t)),this}findAttr(t,e=this.container){let n=e;for(;n&&1===n.nodeType;){const e=n.getAttribute(t);if(null!=e)return e;if(n===this.container)return null;n=n.parentNode}return null}find(t,e=this.container,n=this.selectors){return View.find(t,e,n).elems}findOne(t,e=this.container,n=this.selectors){const r=this.find(t,e,n);return r.length>0?r[0]:null}findByAttr(t,e=this.container){let n=e;for(;n&&n.getAttribute;){const e=n.getAttribute(t);if((null!=e||n===this.container)&&"false"!==e)return n;n=n.parentNode}return null}getSelector(t,e){let n;if(t===this.container)return"string"==typeof e&&(n=`> ${e}`),n;if(t){const r=index(t)+1;n=`${t.tagName.toLowerCase()}:nth-child(${r})`,e&&(n+=` > ${e}`),n=this.getSelector(t.parentNode,n)}return n}prefixClassName(t){return Util$3.prefix(t)}delegateEvents(t,e){if(null==t)return this;e||this.undelegateEvents();const n=/^(\S+)\s*(.*)$/;return Object.keys(t).forEach((e=>{const r=e.match(n);if(null==r)return;const i=this.getEventHandler(t[e]);"function"==typeof i&&this.delegateEvent(r[1],r[2],i)})),this}undelegateEvents(){return this.$(this.container).off(this.getEventNamespace()),this}delegateDocumentEvents(t,e){return this.addEventListeners(document,t,e),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(t,e,n){return this.$(this.container).on(t+this.getEventNamespace(),e,n),this}undelegateEvent(t,e,n){const r=t+this.getEventNamespace();return null==e?this.$(this.container).off(r):"string"==typeof e?this.$(this.container).off(r,e,n):this.$(this.container).off(r,e),this}addEventListeners(t,e,n){if(null==e)return this;const r=this.getEventNamespace(),i=this.$(t);return Object.keys(e).forEach((t=>{const o=this.getEventHandler(e[t]);"function"==typeof o&&i.on(t+r,n,o)})),this}removeEventListeners(t){return null!=t&&this.$(t).off(this.getEventNamespace()),this}getEventNamespace(){return`.${Config.prefixCls}-event-${this.cid}`}getEventHandler(t){let e;if("string"==typeof t){const n=this[t];"function"==typeof n&&(e=(...t)=>n.call(this,...t))}else e=(...e)=>t.call(this,...e);return e}getEventTarget(t,e={}){const{target:n,type:r,clientX:i=0,clientY:o=0}=t;return e.fromPoint||"touchmove"===r||"touchend"===r?document.elementFromPoint(i,o):n}stopPropagation(t){return this.setEventData(t,{propagationStopped:!0}),this}isPropagationStopped(t){return!0===this.getEventData(t).propagationStopped}getEventData(t){return this.eventData(t)}setEventData(t,e){return this.eventData(t,e)}eventData(t,e){if(null==t)throw new TypeError("Event object required");let n=t.data;const r=`__${this.cid}__`;return null==e?null==n?{}:n[r]||{}:(null==n&&(n=t.data={}),n[r]=Object.assign(null==n[r]?{}:Object.assign({},n[r]),e),n[r])}normalizeEvent(t){return View.normalizeEvent(t)}}!function(t){function e(t){return jquery(t)}t.$=e,t.createElement=function(t,e){return e?createSvgElement(t||"g"):createElementNS(t||"div")},t.find=function(t,n,r){if(!t||"."===t)return{elems:[n]};if(r){const e=r[t];if(e)return{elems:Array.isArray(e)?e:[e]}}return{isCSSSelector:!0,elems:e(n).find(t).toArray()}},t.normalizeEvent=function(t){let e=t;const n=t.originalEvent,r=n&&n.changedTouches&&n.changedTouches[0];if(r){for(const e in t)void 0===r[e]&&(r[e]=t[e]);e=r}const i=e.target;if(i){const t=i.correspondingUseElement;t&&(e.target=t)}return e}}(View||(View={})),function(t){t.views={},t.getView=function(e){return t.views[e]||null}}(View||(View={})),function(t){let e=0;t.uniqueId=function(){const t=`v${e}`;return e+=1,t}}(Private$6||(Private$6={}));const noop=t=>t;function toPercentage(t,e){return 0===e?"0%":`${Math.round(t/e*100)}%`}function pin(t){return(e,n,r,i)=>n.isEdgeElement(r)?pinEdgeTerminal(t,e,n,r,i):pinNodeTerminal(t,e,n,r,i)}function pinNodeTerminal(t,e,n,r,i){const o=n.cell,s=o.getAngle(),a=n.getUnrotatedBBoxOfElement(r),l=o.getBBox().getCenter(),c=Point.create(i).rotate(s,l);let u=c.x-a.x,h=c.y-a.y;return t&&(u=toPercentage(u,a.width),h=toPercentage(h,a.height)),e.anchor={name:"topLeft",args:{dx:u,dy:h,rotate:!0}},e}function pinEdgeTerminal(t,e,n,r,i){const o=n.getConnection();if(!o)return e;const s=o.closestPointLength(i);if(t){const t=o.length();e.anchor={name:"ratio",args:{ratio:s/t}}}else e.anchor={name:"length",args:{length:s}};return e}const pinRelative=pin(!0),pinAbsolute=pin(!1),strategies=Object.freeze({__proto__:null,noop,pinRelative,pinAbsolute});var ConnectionStrategy,Markup;!function(t){t.presets=strategies,t.registry=Registry.create({type:"connection strategy"}),t.registry.register(t.presets,!0)}(ConnectionStrategy||(ConnectionStrategy={}));class Cache{constructor(t){this.view=t,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new Dictionary,this.pathCache={}}get(t){return this.elemCache.has(t)||this.elemCache.set(t,{}),this.elemCache.get(t)}getData(t){const e=this.get(t);return e.data||(e.data={}),e.data}getMatrix(t){const e=this.get(t);return null==e.matrix&&(e.matrix=getTransformToElement(t,this.view.rotatableNode||this.view.container)),createSVGMatrix(e.matrix)}getShape(t){const e=this.get(t);return null==e.shape&&(e.shape=toGeometryShape(t)),e.shape.clone()}getBoundingRect(t){const e=this.get(t);return null==e.boundingRect&&(e.boundingRect=getBBox(t)),e.boundingRect.clone()}}!function(t){function e(t){return null!=t&&"string"==typeof t}function n(t){return`${t}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}function r(t,e={ns:ns.svg}){const n=document.createDocumentFragment(),r={},i={},o=[{markup:Array.isArray(t)?t:[t],parent:n,ns:e.ns}];for(;o.length>0;){const t=o.pop();let e=t.ns||ns.svg;const n=t.parent;t.markup.forEach((t=>{const s=t.tagName;if(!s)throw new TypeError("Invalid tagName");t.ns&&(e=t.ns);const a=e===ns.svg,l=e?createElementNS(s,e):createElement(s),c=t.attrs;c&&(a?attr(l,kebablizeAttrs(c)):jquery(l).attr(c));const u=t.style;u&&jquery(l).css(u);const h=t.className;null!=h&&l.setAttribute("class",Array.isArray(h)?h.join(" "):h),t.textContent&&(l.textContent=t.textContent);const d=t.selector;if(null!=d){if(i[d])throw new TypeError("Selector must be unique");i[d]=l}if(t.groupSelector){let e=t.groupSelector;Array.isArray(e)||(e=[e]),e.forEach((t=>{r[t]||(r[t]=[]),r[t].push(l)}))}n.appendChild(l);const f=t.children;Array.isArray(f)&&o.push({ns:e,markup:f,parent:l})}))}return Object.keys(r).forEach((t=>{if(i[t])throw new Error("Ambiguous group selector");i[t]=r[t]})),{fragment:n,selectors:i,groups:r}}function i(t){return t instanceof SVGElement?createSvgElement("g"):createElement("div")}t.isJSONMarkup=function(t){return null!=t&&!e(t)},t.isStringMarkup=e,t.clone=function(t){return null==t||e(t)?t:cloneDeep(t)},t.sanitize=n,t.parseStringMarkup=function(t){const e=document.createDocumentFragment();return sanitizeHTML(n(t),{raw:!0}).forEach((t=>{e.appendChild(t)})),{fragment:e,selectors:{},groups:{}}},t.parseJSONMarkup=r,t.renderMarkup=function(t){if(e(t)){const e=Vector.createVectors(t),n=e.length;if(1===n)return{elem:e[0].node};if(n>1){const t=i(e[0].node);return e.forEach((e=>{t.appendChild(e.node)})),{elem:t}}return{}}const n=r(t),o=n.fragment;let s=null;return o.childNodes.length>1?(s=i(o.firstChild),s.appendChild(o)):s=o.firstChild,{elem:s,selectors:n.selectors}},t.parseLabelStringMarkup=function(t){const e=Vector.createVectors(t),n=document.createDocumentFragment();for(let t=0,r=e.length;t<r;t+=1)n.appendChild(e[t].node);return{fragment:n,selectors:{}}}}(Markup||(Markup={})),function(t){function e(t,n,r){if(null!=t){let i;const o=t.tagName.toLowerCase();if(t===n)return i="string"==typeof r?`> ${o} > ${r}`:`> ${o}`,i;const s=t.parentNode;return i=s&&s.childNodes.length>1?`${o}:nth-child(${index(t)+1})`:o,r&&(i+=` > ${r}`),e(t.parentNode,n,i)}return r}function n(t,n,r){if("#text"===t.nodeName)return null;let i=null,o=null,s=null,a=!1;const l={tagName:t.tagName};if(t.attributes){s={};for(let e=0,n=t.attributes.length;e<n;e+=1){const n=t.attributes[e],r=n.nodeName,a=n.nodeValue;"selector"===r?i=a:"groupSelector"===r?o=a:"class"===r?l.attrs={class:a}:s[r]=a}}return null==i&&(a=!0,i=e(t,n)),t.namespaceURI&&(l.ns=t.namespaceURI),null==l.ns&&(["body","div","section","main","nav","footer","span","p","h1","h2","h3","h4","h5","h6","ul","ol","dl","center","strong","pre","form","select","textarea","fieldset","marquee","bgsound","iframe","frameset"].includes(t.tagName)?l.ns=ns.xhtml:r&&(l.ns=r)),i&&(l.selector=i),null!=o&&(l.groupSelector=o),{markup:l,attrs:s,isCSSSelector:a}}t.getSelector=e,t.xml2json=function(e){const r=parseXML(t.sanitize(e),{mimeType:"image/svg+xml"}),i=Array.prototype.slice.call(r.childNodes),o={},s=new WeakMap,a=(t,e,r)=>{const i=n(t,e,r);if(null!=i){const{markup:n,attrs:r,isCSSSelector:l}=i;if(s.set(t,n),n.selector&&null!=r&&(Object.keys(r).length&&(o[n.selector]=r),l&&delete n.selector),t.childNodes&&t.childNodes.length>0)for(let r=0,i=t.childNodes.length;r<i;r+=1){const i=a(t.childNodes[r],e,n.ns);i&&(null==n.children&&(n.children=[]),n.children.push(i))}return n}{const e=s.get(t.parentNode);e&&t.textContent&&(e.textContent=t.textContent)}};return{markup:i.map((t=>a(t,t))).filter((t=>null!=t)),attrs:o}}}(Markup||(Markup={})),function(t){t.getPortContainerMarkup=function(){return"g"},t.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},t.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}}(Markup||(Markup={})),function(t){t.getEdgeMarkup=function(){return t.sanitize('\n    <path class="connection" stroke="black" d="M 0 0 0 0"/>\n    <path class="source-marker" fill="black" stroke="black" d="M 0 0 0 0"/>\n    <path class="target-marker" fill="black" stroke="black" d="M 0 0 0 0"/>\n    <path class="connection-wrap" d="M 0 0 0 0"/>\n    <g class="labels"/>\n    <g class="vertices"/>\n    <g class="arrowheads"/>\n    <g class="tools"/>\n  ')},t.getEdgeToolMarkup=function(){return t.sanitize('\n    <g class="edge-tool">\n      <g class="tool-remove" event="edge:remove">\n        <circle r="11" />\n        <path transform="scale(.8) translate(-16, -16)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z" />\n        <title>Remove edge.</title>\n      </g>\n      <g class="tool-options" event="edge:options">\n        <circle r="11" transform="translate(25)"/>\n        <path fill="white" transform="scale(.55) translate(29, -16)" d="M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z"/>\n        <title>Edge options.</title>\n      </g>\n    </g>\n  ')},t.getEdgeVertexMarkup=function(){return t.sanitize('\n    <g class="vertex-group" transform="translate(<%= x %>, <%= y %>)">\n      <circle class="vertex" data-index="<%= index %>" r="10" />\n      <path class="vertex-remove-area" data-index="<%= index %>" d="M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z" transform="translate(5, -33)"/>\n      <path class="vertex-remove" data-index="<%= index %>" transform="scale(.8) translate(9.5, -37)" d="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z">\n      <title>Remove vertex.</title>\n      </path>\n    </g>\n  ')},t.getEdgeArrowheadMarkup=function(){return t.sanitize('\n    <g class="arrowhead-group arrowhead-group-<%= end %>">\n      <path class="arrowhead" data-terminal="<%= end %>" d="M 26 0 L 0 13 L 26 26 z" />\n    </g>\n  ')}}(Markup||(Markup={})),(Markup||(Markup={})).getForeignObjectMarkup=function(t=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:ns.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:ns.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:t?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}};class AttrManager{constructor(t){this.view=t}get cell(){return this.view.cell}getDefinition(t){return this.cell.getAttrDefinition(t)}processAttrs(t,e){let n,r,i,o,s;const a=[];return Object.keys(e).forEach((r=>{const i=e[r],o=this.getDefinition(r),s=call(Attr.isValidDefinition,this.view,o,i,{elem:t,attrs:e,cell:this.cell,view:this.view});if(o&&s)"string"==typeof o?(null==n&&(n={}),n[o]=i):null!==i&&a.push({name:r,definition:o});else{null==n&&(n={});const t=AttrManager.CASE_SENSITIVE_ATTR.includes(r)?r:kebabCase(r);n[t]=i}})),a.forEach((({name:n,definition:a})=>{const l=e[n];"function"==typeof a.set&&(!isHTMLElement(t)&&AttrManager.DELAY_ATTRS.includes(n)?(null==s&&(s={}),s[n]=l):(null==r&&(r={}),r[n]=l)),"function"==typeof a.offset&&(null==i&&(i={}),i[n]=l),"function"==typeof a.position&&(null==o&&(o={}),o[n]=l)})),{raw:e,normal:n,set:r,offset:i,position:o,delay:s}}mergeProcessedAttrs(t,e){t.set=Object.assign(Object.assign({},t.set),e.set),t.position=Object.assign(Object.assign({},t.position),e.position),t.offset=Object.assign(Object.assign({},t.offset),e.offset);const n=t.normal&&t.normal.transform;null!=n&&e.normal&&(e.normal.transform=n),t.normal=e.normal}findAttrs(t,e,n,r){const i=[],o=new Dictionary;return Object.keys(t).forEach((s=>{const a=t[s];if(!isPlainObject(a))return;const{isCSSSelector:l,elems:c}=View.find(s,e,r);n[s]=c;for(let t=0,e=c.length;t<e;t+=1){const n=c[t],u=r&&r[s]===n,h=o.get(n);if(h){h.array||(i.push(n),h.array=!0,h.attrs=[h.attrs],h.priority=[h.priority]);const t=h.attrs,r=h.priority;if(u)t.unshift(a),r.unshift(-1);else{const n=sortedIndex(r,l?-1:e);t.splice(n,0,a),r.splice(n,0,e)}}else o.set(n,{elem:n,attrs:a,priority:u?-1:e,array:!1})}})),i.forEach((t=>{const e=o.get(t);e.attrs=e.attrs.reduceRight(((t,e)=>merge(t,e)),{})})),o}updateRelativeAttrs(t,e,n,r){const i=e.raw||{};let o=e.normal||{};const s=e.set,a=e.position,l=e.offset,c=e.delay,u=()=>({elem:t,cell:this.cell,view:this.view,attrs:i,refBBox:n.clone()});if(null!=s&&Object.keys(s).forEach((t=>{const e=s[t],n=this.getDefinition(t);if(null!=n){const r=call(n.set,this.view,e,u());"object"==typeof r?o=Object.assign(Object.assign({},o),r):null!=r&&(o[t]=r)}})),isHTMLElement(t))return void this.view.setAttrs(o,t);const h=o.transform,d=transformStringToMatrix(h?`${h}`:null),f=new Point(d.e,d.f);h&&(delete o.transform,d.e=0,d.f=0);let p=1,g=1;if(a||l){const e=this.view.getScaleOfElement(t,r.scalableNode);p=e.sx,g=e.sy}let m=!1;null!=a&&Object.keys(a).forEach((t=>{const e=a[t],n=this.getDefinition(t);if(null!=n){const t=call(n.position,this.view,e,u());null!=t&&(m=!0,f.translate(Point.create(t).scale(p,g)))}})),this.view.setAttrs(o,t);let A=!1;if(null!=l){const e=this.view.getBoundingRectOfElement(t);if(e.width>0&&e.height>0){const n=transformRectangle(e,d).scale(1/p,1/g);Object.keys(l).forEach((e=>{const r=l[e],o=this.getDefinition(e);if(null!=o){const e=call(o.offset,this.view,r,{elem:t,cell:this.cell,view:this.view,attrs:i,refBBox:n});null!=e&&(A=!0,f.translate(Point.create(e).scale(p,g)))}}))}}(null!=h||m||A)&&(f.round(1),d.e=f.x,d.f=f.y,t.setAttribute("transform",matrixToTransformString(d)));const y=()=>{null!=c&&Object.keys(c).forEach((e=>{const n=c[e],r=this.getDefinition(e);if(null!=r){const i=call(r.set,this.view,n,u());"object"==typeof i?this.view.setAttrs(i,t):null!=i&&this.view.setAttrs({[e]:i},t)}}))};r.forceSync?y():Scheduler.scheduleTask(y)}update(t,e,n){const r={},i=this.findAttrs(n.attrs||e,t,r,n.selectors),o=n.attrs?this.findAttrs(e,t,r,n.selectors):i,s=[];i.each((e=>{const i=e.elem,a=e.attrs,l=this.processAttrs(i,a);if(null==l.set&&null==l.position&&null==l.offset&&null==l.delay)this.view.setAttrs(l.normal,i);else{const e=o.get(i),c=e?e.attrs:null,u=c&&null==a.ref?c.ref:a.ref;let h;if(u){if(h=(r[u]||this.view.find(u,t,n.selectors))[0],!h)throw new Error(`"${u}" reference does not exist.`)}else h=null;const d={node:i,refNode:h,attributes:c,processedAttributes:l},f=s.findIndex((t=>t.refNode===i));f>-1?s.splice(f,0,d):s.push(d)}}));const a=new Dictionary;let l;s.forEach((e=>{const r=e.node,i=e.refNode;let o;const c=null!=i&&null!=n.rotatableNode&&contains(n.rotatableNode,i);if(i&&(o=a.get(i)),!o){const e=c?n.rotatableNode:t;o=i?getBBox(i,{target:e}):n.rootBBox,i&&a.set(i,o)}let u;n.attrs&&e.attributes?(u=this.processAttrs(r,e.attributes),this.mergeProcessedAttrs(u,e.processedAttributes)):u=e.processedAttributes;let h=o;c&&null!=n.rotatableNode&&!n.rotatableNode.contains(r)&&(l||(l=transformStringToMatrix(attr(n.rotatableNode,"transform"))),h=transformRectangle(o,l)),s.find((t=>t.refNode===r))&&(n.forceSync=!0),this.updateRelativeAttrs(r,u,h,n)}))}}!function(t){t.CASE_SENSITIVE_ATTR=["viewBox"],t.DELAY_ATTRS=["text","textWrap","sourceMarker","targetMarker"]}(AttrManager||(AttrManager={}));class FlagManager{constructor(t,e,n=[]){this.view=t;const r={},i={};let o=0;Object.keys(e).forEach((t=>{let n=e[t];Array.isArray(n)||(n=[n]),n.forEach((e=>{let n=r[e];n||(o+=1,n=r[e]=1<<o),i[t]|=n}))}));let s=n;if(Array.isArray(s)||(s=[s]),s.forEach((t=>{r[t]||(o+=1,r[t]=1<<o)})),o>25)throw new Error("Maximum number of flags exceeded.");this.flags=r,this.attrs=i,this.bootstrap=n}get cell(){return this.view.cell}getFlag(t){const e=this.flags;return null==e?0:Array.isArray(t)?t.reduce(((t,n)=>t|e[n]),0):0|e[t]}hasAction(t,e){return t&this.getFlag(e)}removeAction(t,e){return t^t&this.getFlag(e)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let t=0;return this.attrs?(Object.keys(this.attrs).forEach((e=>{this.cell.hasChanged(e)&&(t|=this.attrs[e])})),t):t}}var __rest$n=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class CellView extends View{constructor(t,e={}){super(),this.cell=t,this.options=this.ensureOptions(e),this.graph=this.options.graph,this.attr=new AttrManager(this),this.flag=new FlagManager(this,this.options.actions,this.options.bootstrap),this.cache=new Cache(this),this.setContainer(this.ensureContainer()),this.setup(),this.$(this.container).data("view",this),this.init()}static getDefaults(){return this.defaults}static config(t){this.defaults=this.getOptions(t)}static getOptions(t){const e=(t,e)=>null!=e?uniq([...Array.isArray(t)?t:[t],...Array.isArray(e)?e:[e]]):Array.isArray(t)?[...t]:[t],n=cloneDeep(this.getDefaults()),{bootstrap:r,actions:i,events:o,documentEvents:s}=t,a=__rest$n(t,["bootstrap","actions","events","documentEvents"]);return r&&(n.bootstrap=e(n.bootstrap,r)),i&&Object.keys(i).forEach((t=>{const r=i[t],o=n.actions[t];r&&o?n.actions[t]=e(o,r):r&&(n.actions[t]=e(r))})),o&&(n.events=Object.assign(Object.assign({},n.events),o)),t.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),s)),merge(n,a)}get[Symbol.toStringTag](){return CellView.toStringTag}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(t){return this.getConstructor().getOptions(t)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return View.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(t){if(this.container!==t){this.undelegateEvents(),this.container=t,null!=this.options.events&&this.delegateEvents(this.options.events);const e=this.getContainerAttrs();null!=e&&this.setAttrs(e,t);const n=this.getContainerStyle();null!=n&&this.setStyle(n,t);const r=this.getContainerClassName();null!=r&&this.addClass(r,t)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(t,e={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(t){return this.flag.getFlag(t)}hasAction(t,e){return this.flag.hasAction(t,e)}removeAction(t,e){return this.flag.removeAction(t,e)}handleAction(t,e,n,r){if(this.hasAction(t,e)){n();const i=[e];return r&&("string"==typeof r?i.push(r):i.push(...r)),this.removeAction(t,i)}return t}setup(){this.cell.on("changed",(({options:t})=>this.onAttrsChange(t)))}onAttrsChange(t){let e=this.flag.getChangedFlag();!t.updated&&e&&(t.dirty&&this.hasAction(e,"update")&&(e|=this.getFlag("render")),t.toolId&&(t.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,e,this.priority,t))}parseJSONMarkup(t,e){const n=Markup.parseJSONMarkup(t),r=n.selectors,i=this.rootSelector;if(e&&i){if(r[i])throw new Error("Invalid root selector");r[i]=e}return n}can(t){let e=this.graph.options.interacting;if("function"==typeof e&&(e=call(e,this.graph,this)),"object"==typeof e){let n=e[t];return"function"==typeof n&&(n=call(n,this.graph,this)),!1!==n}return"boolean"==typeof e&&e}cleanCache(){return this.cache.clean(),this}getCache(t){return this.cache.get(t)}getDataOfElement(t){return this.cache.getData(t)}getMatrixOfElement(t){return this.cache.getMatrix(t)}getShapeOfElement(t){return this.cache.getShape(t)}getScaleOfElement(t,e){let n,r;if(e&&e.contains(t)){const t=scale(e);n=1/t.sx,r=1/t.sy}else n=1,r=1;return{sx:n,sy:r}}getBoundingRectOfElement(t){return this.cache.getBoundingRect(t)}getBBoxOfElement(t){const e=this.getBoundingRectOfElement(t),n=this.getMatrixOfElement(t),r=this.getRootRotatedMatrix();return transformRectangle(e,this.getRootTranslatedMatrix().multiply(r).multiply(n))}getUnrotatedBBoxOfElement(t){const e=this.getBoundingRectOfElement(t),n=this.getMatrixOfElement(t);return transformRectangle(e,this.getRootTranslatedMatrix().multiply(n))}getBBox(t={}){let e;if(t.useCellGeometry){const t=this.cell,n=t.isNode()?t.getAngle():0;e=t.getBBox().bbox(n)}else e=this.getBBoxOfElement(this.container);return this.graph.localToGraph(e)}getRootTranslatedMatrix(){const t=this.cell,e=t.isNode()?t.getPosition():{x:0,y:0};return createSVGMatrix().translate(e.x,e.y)}getRootRotatedMatrix(){let t=createSVGMatrix();const e=this.cell,n=e.isNode()?e.getAngle():0;if(n){const r=e.getBBox(),i=r.width/2,o=r.height/2;t=t.translate(i,o).rotate(n).translate(-i,-o)}return t}findMagnet(t=this.container){return this.findByAttr("magnet",t)}updateAttrs(t,e,n={}){null==n.rootBBox&&(n.rootBBox=new Rectangle),null==n.selectors&&(n.selectors=this.selectors),this.attr.update(t,e,n)}isEdgeElement(t){return this.cell.isEdge()&&(null==t||t===this.container)}prepareHighlight(t,e={}){const n=t&&this.$(t)[0]||this.container;return e.partial=n===this.container,n}highlight(t,e={}){const n=this.prepareHighlight(t,e);return this.notify("cell:highlight",{magnet:n,options:e,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:e,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:e,view:this,node:this.cell,cell:this.cell}),this}unhighlight(t,e={}){const n=this.prepareHighlight(t,e);return this.notify("cell:unhighlight",{magnet:n,options:e,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:e,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:e,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(t,e){}getEdgeTerminal(t,e,n,r,i){const o=this.cell,s=this.findAttr("port",t),a=t.getAttribute("data-selector"),l={cell:o.id};return null!=a&&(l.magnet=a),null!=s?(l.port=s,o.isNode()&&(o.hasPort(s)||null!=a||(l.selector=this.getSelector(t)))):null==a&&this.container!==t&&(l.selector=this.getSelector(t)),this.customizeEdgeTerminal(l,t,e,n,r,i)}customizeEdgeTerminal(t,e,n,r,i,o){const s=i.getStrategy()||this.graph.options.connecting.strategy;if(s){const a="string"==typeof s?s:s.name,l="string"==typeof s?{}:s.args||{},c=ConnectionStrategy.registry;if(a){const s=c.get(a);if(null==s)return c.onNotFound(a);const u=call(s,this.graph,t,this,e,new Point(n,r),i,o,l);if(u)return u}}return t}getMagnetFromEdgeTerminal(t){const e=this.cell,n=this.container,r=t.port;let i,o=t.magnet;return null!=r&&e.isNode()&&e.hasPort(r)?i=this.findPortElem(r,o)||n:(o||(o=t.selector),o||null==r||(o=`[port="${r}"]`),i=this.findOne(o,n,this.selectors)),i}animate(t,e){const n="string"==typeof t?this.findOne(t):t;if(null==n)throw new Error("Invalid animation element.");const r=n.parentNode,i=Vector.create(n);r||i.appendTo(this.graph.view.stage);const o=e.complete;return e.complete=t=>{r||remove(n),o&&o(t)},i.animate(e)}animateTransform(t,e){const n="string"==typeof t?this.findOne(t):t;if(null==n)throw new Error("Invalid animation element.");const r=n.parentNode,i=Vector.create(n);r||i.appendTo(this.graph.view.stage);const o=e.complete;return e.complete=t=>{r||remove(n),o&&o(t)},i.animateTransform(e)}hasTools(t){const e=this.tools;return null!=e&&(null==t||e.name===t)}addTools(t){if(!this.can("toolsAddable"))return this;if(this.removeTools(),t){const e=ToolsView.isToolsView(t)?t:new ToolsView(t);this.tools=e,this.graph.on("tools:hide",this.hideTools,this),this.graph.on("tools:show",this.showTools,this),this.graph.on("tools:remove",this.removeTools,this),e.config({view:this}),e.mount()}return this}updateTools(t={}){return this.tools&&this.tools.update(t),this}removeTools(){return this.tools&&(this.tools.remove(),this.graph.off("tools:hide",this.hideTools,this),this.graph.off("tools:show",this.showTools,this),this.graph.off("tools:remove",this.removeTools,this),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const t=this.cell.getTools();return this.addTools(t),this}notify(t,e){return this.trigger(t,e),this.graph.trigger(t,e),this}getEventArgs(t,e,n){const r=this,i=r.cell;return null==e||null==n?{e:t,view:r,cell:i}:{e:t,x:e,y:n,view:r,cell:i}}onClick(t,e,n){this.notify("cell:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){this.notify("cell:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){this.notify("cell:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(t,e,n))}onMouseUp(t,e,n){this.notify("cell:mouseup",this.getEventArgs(t,e,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(t,e,n){this.notify("cell:mousemove",this.getEventArgs(t,e,n))}onMouseOver(t){this.notify("cell:mouseover",this.getEventArgs(t))}onMouseOut(t){this.notify("cell:mouseout",this.getEventArgs(t))}onMouseEnter(t){this.notify("cell:mouseenter",this.getEventArgs(t))}onMouseLeave(t){this.notify("cell:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,r){this.notify("cell:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,n)))}onCustomEvent(t,e,n,r){this.notify("cell:customevent",Object.assign({name:e},this.getEventArgs(t,n,r))),this.notify(e,Object.assign({},this.getEventArgs(t,n,r)))}onMagnetMouseDown(t,e,n,r){}onMagnetDblClick(t,e,n,r){}onMagnetContextMenu(t,e,n,r){}onLabelMouseDown(t,e,n){}checkMouseleave(t){const e=this.graph;e.renderer.isAsync()&&e.renderer.dumpView(this);const n=this.getEventTarget(t,{fromPoint:!0}),r=e.renderer.findViewByElem(n);r!==this&&(this.onMouseLeave(t),r&&r.onMouseEnter(t))}}CellView.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},function(t){t.Flag=FlagManager,t.Attr=AttrManager}(CellView||(CellView={})),function(t){t.toStringTag=`X6.${t.name}`,t.isCellView=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.isNodeView&&"function"==typeof e.isEdgeView&&"function"==typeof e.confirmUpdate}}(CellView||(CellView={})),function(t){t.priority=function(t){return function(e){e.config({priority:t})}},t.bootstrap=function(t){return function(e){e.config({bootstrap:t})}}}(CellView||(CellView={})),(CellView||(CellView={})).registry=Registry.create({type:"view"});class ToolsView extends View{constructor(t={}){super(),this.svgContainer=this.createContainer(!0,t),this.htmlContainer=this.createContainer(!1,t),this.config(t)}get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return ToolsView.toStringTag}createContainer(t,e){const n=t?View.createElement("g",!0):View.createElement("div",!1);return addClass(n,this.prefixClassName("cell-tools")),e.className&&addClass(n,e.className),n}config(t){if(this.options=Object.assign(Object.assign({},this.options),t),!CellView.isCellView(t.view)||t.view===this.cellView)return this;this.cellView=t.view,this.cell.isEdge()?(addClass(this.svgContainer,this.prefixClassName("edge-tools")),addClass(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(addClass(this.svgContainer,this.prefixClassName("node-tools")),addClass(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const e=this.options.items;if(!Array.isArray(e))return this;this.tools=[];const n=[];e.forEach((t=>{ToolsView.ToolItem.isToolItem(t)?"vertices"===t.name?n.unshift(t):n.push(t):"vertices"===("object"==typeof t?t.name:t)?n.unshift(t):n.push(t)}));for(let t=0;t<n.length;t+=1){const e=n[t];let r;if(ToolsView.ToolItem.isToolItem(e))r=e;else{const t="object"==typeof e?e.name:e,n="object"==typeof e&&e.args||{};if(t)if(this.cell.isNode()){const e=NodeTool.registry.get(t);if(!e)return NodeTool.registry.onNotFound(t);r=new e(n)}else if(this.cell.isEdge()){const e=EdgeTool.registry.get(t);if(!e)return EdgeTool.registry.onNotFound(t);r=new e(n)}}r&&(r.config(this.cellView,this),r.render(),(!1!==r.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(r.container),this.tools.push(r))}return this}update(t={}){const e=this.tools;return e&&e.forEach((e=>{t.toolId!==e.cid&&e.isVisible()&&e.update()})),this}focus(t){const e=this.tools;return e&&e.forEach((e=>{t===e?e.show():e.hide()})),this}blur(t){const e=this.tools;return e&&e.forEach((e=>{e===t||e.isVisible()||(e.show(),e.update())})),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const t=this.tools;return t&&(t.forEach((t=>t.remove())),this.tools=null),remove(this.svgContainer),remove(this.htmlContainer),super.remove()}mount(){const t=this.tools,e=this.cellView;if(e&&t){const n=t.some((t=>!1!==t.options.isSVGElement)),r=t.some((t=>!1===t.options.isSVGElement));n&&(this.options.local?e.container:e.graph.view.decorator).appendChild(this.svgContainer),r&&this.graph.container.appendChild(this.htmlContainer)}return this}}function getAnchor(t,e,n,r){return call(ConnectionStrategy.presets.pinRelative,this.graph,{},e,n,t,this.cell,r,{}).anchor}function getViewBBox(t,e){return e?t.cell.getBBox():t.cell.isEdge()?t.getConnection().bbox():t.getUnrotatedBBoxOfElement(t.container)}!function(t){t.toStringTag=`X6.${t.name}`,t.isToolsView=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&null!=e.graph&&null!=e.cell&&"function"==typeof e.config&&"function"==typeof e.update&&"function"==typeof e.focus&&"function"==typeof e.blur&&"function"==typeof e.show&&"function"==typeof e.hide}}(ToolsView||(ToolsView={})),function(t){class e extends View{constructor(t={}){super(),this.visible=!0,this.options=this.getOptions(t),this.container=View.createElement(this.options.tagName||"g",!1!==this.options.isSVGElement),addClass(this.container,this.prefixClassName("cell-tool")),"string"==typeof this.options.className&&addClass(this.container,this.options.className),this.init()}static getDefaults(){return this.defaults}static config(t){this.defaults=this.getOptions(t)}static getOptions(t){return merge(cloneDeep(this.getDefaults()),t)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return e.toStringTag}init(){}getOptions(t){return this.constructor.getOptions(t)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(t,e){return this.cellView=t,this.parent=e,this.stamp(this.container),this.cell.isEdge()?addClass(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&addClass(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const t=this.options.markup;if(t){const e=Markup.isStringMarkup(t)?Markup.parseStringMarkup(t):Markup.parseJSONMarkup(t);this.container.appendChild(e.fragment),this.childNodes=e.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(t=this.container){t&&t.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return!!this.visible}focus(){const t=this.options.focusOpacity;return null!=t&&Number.isFinite(t)&&(this.container.style.opacity=`${t}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(t){return null==this.graph||null==this.cellView||this.graph.view.guard(t,this.cellView)}}e.defaults={isSVGElement:!0,tagName:"g"},t.ToolItem=e,function(t){let e=0;t.define=function(t){const n=createClass((r=t.name)?pascalCase(r):(e+=1,`CustomTool${e}`),this);var r;return n.config(t),n}}(e=t.ToolItem||(t.ToolItem={})),function(t){t.toStringTag=`X6.${t.name}`,t.isToolItem=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&null!=e.graph&&null!=e.cell&&"function"==typeof e.config&&"function"==typeof e.update&&"function"==typeof e.focus&&"function"==typeof e.blur&&"function"==typeof e.show&&"function"==typeof e.hide&&"function"==typeof e.isVisible}}(e=t.ToolItem||(t.ToolItem={}))}(ToolsView||(ToolsView={}));class Button extends ToolsView.ToolItem{onRender(){addClass(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const t=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();transform(this.container,t,{absolute:!0})}getNodeMatrix(){const t=this.cellView,e=this.options;let{x:n=0,y:r=0}=e;const{offset:i,useCellGeometry:o,rotate:s}=e;let a=getViewBBox(t,o);const l=t.cell.getAngle();s||(a=a.bbox(l));let c=0,u=0;"number"==typeof i?(c=i,u=i):"object"==typeof i&&(c=i.x,u=i.y),n=normalizePercentage(n,a.width),r=normalizePercentage(r,a.height);let h=createSVGMatrix().translate(a.x+a.width/2,a.y+a.height/2);return s&&(h=h.rotate(l)),h=h.translate(n+c-a.width/2,r+u-a.height/2),h}getEdgeMatrix(){const t=this.cellView,e=this.options,{offset:n=0,distance:r=0,rotate:i}=e;let o,s,a;o=isPercentage(r)?t.getTangentAtRatio(parseFloat(r)/100):t.getTangentAtLength(r),o?(s=o.start,a=o.vector().vectorAngle(new Point(1,0))||0):(s=t.getConnection().start,a=0);let l=createSVGMatrix().translate(s.x,s.y).rotate(a);return l="object"==typeof n?l.translate(n.x||0,n.y||0):l.translate(0,n),i||(l=l.rotate(-a)),l}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.options.onClick;"function"==typeof e&&call(e,this.cellView,{e:t,view:this.cellView,cell:this.cellView.cell,btn:this})}}(Button||(Button={})).config({name:"button",events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}}),function(t){t.Remove=t.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,onClick({view:t,btn:e}){e.parent.remove(),t.cell.remove({ui:!0,toolId:e.cid})}})}(Button||(Button={}));var __rest$m=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Boundary extends ToolsView.ToolItem{onRender(){if(addClass(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const t=this.options.attrs,{class:e}=t,n=__rest$m(t,["class"]);attr(this.container,kebablizeAttrs(n)),e&&addClass(this.container,e)}this.update()}update(){const t=this.cellView,e=this.options,{useCellGeometry:n,rotate:r}=e,i=normalizeSides(e.padding);let o=getViewBBox(t,n).moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom});const s=t.cell;if(s.isNode()){const t=s.getAngle();if(t)if(r){const e=s.getBBox().getCenter();rotate(this.container,t,e.x,e.y,{absolute:!0})}else o=o.bbox(t)}return attr(this.container,o.toJSON()),this}}(Boundary||(Boundary={})).config({name:"boundary",tagName:"rect",padding:10,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}});class Vertices extends ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach((t=>{this.stopHandleListening(t),t.remove()}))}renderHandles(){const t=this.vertices;for(let e=0,n=t.length;e<n;e+=1){const n=t[e],r=this.options.processHandle,i=(0,this.options.createHandle)({index:e,graph:this.graph,guard:t=>this.guard(t),attrs:this.options.attrs||{}});r&&r(i),this.graph.hook.onToolItemCreated({name:"vertices",cell:this.cell,view:this.cellView,tool:i}),i.updatePosition(n.x,n.y),this.stamp(i.container),this.container.appendChild(i.container),this.handles.push(i),this.startHandleListening(i)}}updateHandles(){const t=this.vertices;for(let e=0,n=t.length;e<n;e+=1){const n=t[e],r=this.handles[e];r&&r.updatePosition(n.x,n.y)}}updatePath(){const t=this.childNodes.connection;t&&t.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(t){const e=this.cellView;e.can("vertexMovable")&&(t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.on("remove",this.onHandleRemove,this)}stopHandleListening(t){const e=this.cellView;e.can("vertexMovable")&&(t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.off("remove",this.onHandleRemove,this)}getNeighborPoints(t){const e=this.cellView,n=this.vertices,r=t<n.length-1?n[t+1]:e.targetAnchor;return{prev:Point.create(t>0?n[t-1]:e.sourceAnchor),next:Point.create(r)}}getMouseEventArgs(t){const e=this.normalizeEvent(t),{x:n,y:r}=this.graph.snapToGrid(e.clientX,e.clientY);return{e,x:n,y:r}}onHandleChange({e:t}){this.focus();const e=this.cellView;if(e.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:n,x:r,y:i}=this.getMouseEventArgs(t);e.notifyMouseDown(n,r,i)}}onHandleChanging({handle:t,e}){const n=this.cellView,r=t.options.index,{e:i,x:o,y:s}=this.getMouseEventArgs(e),a={x:o,y:s};this.snapVertex(a,r),n.cell.setVertexAt(r,a,{ui:!0,toolId:this.cid}),t.updatePosition(a.x,a.y),this.options.stopPropagation||n.notifyMouseMove(i,o,s)}onHandleChanged({e:t}){const e=this.options,n=this.cellView;if(e.addable&&this.updatePath(),!e.removeRedundancies)return;n.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),n.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),this.eventData(t).vertexAdded&&n.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid});const{e:r,x:i,y:o}=this.getMouseEventArgs(t);this.options.stopPropagation||n.notifyMouseUp(r,i,o),n.checkMouseleave(r),e.onChanged&&e.onChanged({edge:n.cell,edgeView:n})}snapVertex(t,e){const n=this.options.snapRadius||0;if(n>0){const r=this.getNeighborPoints(e),i=r.prev,o=r.next;Math.abs(t.x-i.x)<n?t.x=i.x:Math.abs(t.x-o.x)<n&&(t.x=o.x),Math.abs(t.y-i.y)<n?t.y=r.prev.y:Math.abs(t.y-o.y)<n&&(t.y=o.y)}}onHandleRemove({handle:t,e}){if(this.options.removable){const n=this.cellView;n.cell.removeVertexAt(t.options.index,{ui:!0}),this.options.addable&&this.updatePath(),n.checkMouseleave(this.normalizeEvent(e))}}onPathMouseDown(t){const e=this.cellView;if(this.guard(t)||!this.options.addable||!e.can("vertexAddable"))return;t.stopPropagation(),t.preventDefault();const n=this.normalizeEvent(t),r=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();e.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const i=e.getVertexIndex(r.x,r.y);this.snapVertex(r,i),e.cell.insertVertex(r,i,{ui:!0,toolId:this.cid}),this.render();const o=this.handles[i];this.eventData(n,{vertexAdded:!0}),o.onMouseDown(n)}onRemove(){this.resetHandles()}}!function(t){t.Handle=class extends View{constructor(t){super(),this.options=t,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}get graph(){return this.options.graph}render(){this.container=View.createElement("circle",!0);const e=this.options.attrs;if("function"==typeof e){const n=t.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),e(this)))}else this.setAttrs(e);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(t,e){this.setAttrs({cx:t,cy:e})}onMouseDown(t){this.options.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},t.data),this.emit("change",{e:t,handle:this}))}onMouseMove(t){this.emit("changing",{e:t,handle:this})}onMouseUp(t){this.emit("changed",{e:t,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(t){this.emit("remove",{e:t,handle:this})}}}(Vertices||(Vertices={})),function(t){const e=Util$3.prefix("edge-tool-vertex-path");t.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:e=>new t.Handle(e),markup:[{tagName:"path",selector:"connection",className:e,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${e}`]:"onPathMouseDown",[`touchstart .${e}`]:"onPathMouseDown"}})}(Vertices||(Vertices={}));class Segments extends ToolsView.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){addClass(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const t=this.cellView,e=[...this.vertices];e.unshift(t.sourcePoint),e.push(t.targetPoint);for(let t=0,n=e.length;t<n-1;t+=1){const n=this.renderHandle(e[t],e[t+1],t);this.stamp(n.container),this.handles.push(n)}return this}renderHandle(t,e,n){const r=this.options.createHandle({index:n,graph:this.graph,guard:t=>this.guard(t),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(r),this.graph.hook.onToolItemCreated({name:"segments",cell:this.cell,view:this.cellView,tool:r}),this.updateHandle(r,t,e),this.container.appendChild(r.container),this.startHandleListening(r),r}startHandleListening(t){t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)}stopHandleListening(t){t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach((t=>{this.stopHandleListening(t),t.remove()}))}shiftHandleIndexes(t){const e=this.handles;for(let n=0,r=e.length;n<r;n+=1)e[n].options.index+=t}resetAnchor(t,e){const n=this.cellView.cell,r={ui:!0,toolId:this.cid};e?n.prop([t,"anchor"],e,r):n.removeProp([t,"anchor"],r)}snapHandle(t,e,n){const r=t.options.axis,i=t.options.index,o=this.cellView.cell.getVertices(),s=o[i-2]||n.sourceAnchor,a=o[i+1]||n.targetAnchor,l=this.options.snapRadius;return Math.abs(e[r]-s[r])<l?e[r]=s[r]:Math.abs(e[r]-a[r])<l&&(e[r]=a[r]),e}onHandleChanging({handle:t,e}){const n=this.graph,r=this.options,i=this.cellView,o=r.anchor,s=t.options.axis,a=t.options.index-1,l=this.getEventData(e),c=this.normalizeEvent(e),u=n.snapToGrid(c.clientX,c.clientY),h=this.snapHandle(t,u.clone(),l),d=cloneDeep(this.vertices);let f=d[a],p=d[a+1];const g=i.sourceView,m=i.sourceBBox;let A=!1,y=!1;if(f?0===a?m.containsPoint(f)?(d.shift(),this.shiftHandleIndexes(-1),A=!0):(f[s]=h[s],y=!0):f[s]=h[s]:(f=i.sourceAnchor.toJSON(),f[s]=h[s],m.containsPoint(f)?A=!0:(d.unshift(f),this.shiftHandleIndexes(1),y=!0)),"function"==typeof o&&g){if(A){const t=l.sourceAnchor.clone();t[s]=h[s];const e=call(o,i,t,g,i.sourceMagnet||g.container,"source",i,this);this.resetAnchor("source",e)}y&&this.resetAnchor("source",l.sourceAnchorDef)}const v=i.targetView,b=i.targetBBox;let x=!1,w=!1;if(p?a===d.length-2?b.containsPoint(p)?(d.pop(),x=!0):(p[s]=h[s],w=!0):p[s]=h[s]:(p=i.targetAnchor.toJSON(),p[s]=h[s],b.containsPoint(p)?x=!0:(d.push(p),w=!0)),"function"==typeof o&&v){if(x){const t=l.targetAnchor.clone();t[s]=h[s];const e=call(o,i,t,v,i.targetMagnet||v.container,"target",i,this);this.resetAnchor("target",e)}w&&this.resetAnchor("target",l.targetAnchorDef)}Point.equalPoints(d,this.vertices)||this.cellView.cell.setVertices(d,{ui:!0,toolId:this.cid}),this.updateHandle(t,f,p,0),r.stopPropagation||i.notifyMouseMove(c,u.x,u.y)}onHandleChange({handle:t,e}){const n=this.options,r=this.handles,i=this.cellView,o=t.options.index;if(Array.isArray(r)){for(let t=0,e=r.length;t<e;t+=1)t!==o&&r[t].hide();if(this.focus(),this.setEventData(e,{sourceAnchor:i.sourceAnchor.clone(),targetAnchor:i.targetAnchor.clone(),sourceAnchorDef:cloneDeep(this.cell.prop(["source","anchor"])),targetAnchorDef:cloneDeep(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!n.stopPropagation){const t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);i.notifyMouseDown(t,n.x,n.y)}}}onHandleChanged({e:t}){const e=this.options,n=this.cellView;e.removeRedundancies&&n.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const r=this.normalizeEvent(t),i=this.graph.snapToGrid(r.clientX,r.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),e.stopPropagation||n.notifyMouseUp(r,i.x,i.y),n.checkMouseleave(r),e.onChanged&&e.onChanged({edge:n.cell,edgeView:n})}updateHandle(t,e,n,r=0){const i=this.options.precision||0,o=Math.abs(e.x-n.x)<i,s=Math.abs(e.y-n.y)<i;if(o||s){const i=new Line(e,n);if(i.length()<this.options.threshold)t.hide();else{const e=i.getCenter(),n=o?"x":"y";e[n]+=r||0;const s=i.vector().vectorAngle(new Point(1,0));t.updatePosition(e.x,e.y,s,this.cellView),t.show(),t.options.axis=n}}else t.hide()}onRemove(){this.resetHandles()}}!function(t){t.Handle=class extends View{constructor(t){super(),this.options=t,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=View.createElement("rect",!0);const e=this.options.attrs;if("function"==typeof e){const n=t.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),e(this)))}else this.setAttrs(e);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(t,e,n,r){const i=r.getClosestPoint(new Point(t,e))||new Point(t,e);let o=createSVGMatrix().translate(i.x,i.y);if(i.equals({x:t,y:e}))o=o.rotate(n);else{let n=new Line(t,e,i.x,i.y).vector().vectorAngle(new Point(1,0));0!==n&&(n+=90),o=o.rotate(n)}this.setAttrs({transform:matrixToTransformString(o),cursor:n%180==0?"row-resize":"col-resize"})}onMouseDown(t){this.options.guard(t)||(this.trigger("change",{e:t,handle:this}),t.stopPropagation(),t.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},t.data))}onMouseMove(t){this.emit("changing",{e:t,handle:this})}onMouseUp(t){this.emit("changed",{e:t,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}}(Segments||(Segments={})),function(t){t.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:e=>new t.Handle(e),anchor:getAnchor})}(Segments||(Segments={}));class Anchor extends ToolsView.ToolItem{get type(){return this.options.type}onRender(){addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){return this.cellView.getTerminalView(this.type)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const t=this.childNodes;if(!t)return;const e=t.anchor;if(!e)return;const n=this.type,r=this.cellView,i=this.options,o=r.getTerminalAnchor(n),s=r.cell.prop([n,"anchor"]);e.setAttribute("transform",`translate(${o.x}, ${o.y})`);const a=s?i.customAnchorAttrs:i.defaultAnchorAttrs;a&&Object.keys(a).forEach((t=>{e.setAttribute(t,a[t])}))}updateArea(){const t=this.childNodes;if(!t)return;const e=t.area;if(!e)return;const n=this.type,r=this.cellView,i=r.getTerminalView(n);if(i){const t=i.cell,o=r.getTerminalMagnet(n);let s,a,l,c=this.options.areaPadding||0;Number.isFinite(c)||(c=0),i.isEdgeElement(o)?(s=i.getBBox(),a=0,l=s.getCenter()):(s=i.getUnrotatedBBoxOfElement(o),a=t.getAngle(),l=s.getCenter(),a&&l.rotate(-a,t.getBBox().getCenter())),s.inflate(c),attr(e,{x:-s.width/2,y:-s.height/2,width:s.width,height:s.height,transform:`translate(${l.x}, ${l.y}) rotate(${a})`})}}toggleArea(t){if(this.childNodes){const e=this.childNodes.area;e&&(e.style.display=t?"":"none")}}onMouseDown(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(t){const e=this.type,n=this.cell;t?n.prop([e,"anchor"],t,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([e,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(t){const e=this.type,n=this.cellView,r=n.getTerminalView(e);if(null==r)return;const i=this.normalizeEvent(t),o=r.cell,s=n.getTerminalMagnet(e);let a=this.graph.clientToLocal(i.clientX,i.clientY);const l=this.options.snap;if("function"==typeof l){const t=call(l,n,a,r,s,e,n,this);a=Point.create(t)}if(this.options.restrictArea)if(r.isEdgeElement(s)){const t=r.getClosestPoint(a);t&&(a=t)}else{const t=r.getUnrotatedBBoxOfElement(s),e=o.getAngle(),n=o.getBBox().getCenter(),i=a.clone().rotate(e,n);t.containsPoint(i)||(a=t.getNearestPointToPoint(i).rotate(-e,n))}let c;const u=this.options.anchor;"function"==typeof u&&(c=call(u,n,a,r,s,e,n,this)),this.resetAnchor(c),this.update()}onMouseUp(t){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1),this.options.removeRedundancies&&this.cellView.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const t=this.options.resetAnchor;t&&this.resetAnchor(!0===t?void 0:t),this.update()}}(Anchor||(Anchor={})).config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:getAnchor,snap(t,e,n,r,i,o){const s=o.options.snapRadius||0,a="source"===r,l=this.cell.getVertexAt(a?0:-1)||this.getTerminalAnchor(a?"target":"source");return l&&(Math.abs(l.x-t.x)<s&&(t.x=l.x),Math.abs(l.y-t.y)<s&&(t.y=l.y)),t}});const SourceAnchor=Anchor.define({name:"source-anchor",type:"source"}),TargetAnchor=Anchor.define({name:"target-anchor",type:"target"});var __rest$l=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Arrowhead extends ToolsView.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const t=this.options.attrs,{class:e}=t,n=__rest$l(t,["class"]);this.setAttrs(n,this.container),e&&addClass(this.container,e)}}onRender(){addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const t=this.ratio,e=this.cellView,n=e.getTangentAtRatio(t),r=n?n.start:e.getPointAtRatio(t),i=n&&n.vector().vectorAngle(new Point(1,0))||0;if(!r)return this;const o=createSVGMatrix().translate(r.x,r.y).rotate(i);return transform(this.container,o,{absolute:!0}),this}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.cellView;if(e.can("arrowheadMovable")){e.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const n=this.graph.snapToGrid(t.clientX,t.clientY),r=e.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:{toolId:this.cid}});this.cellView.setEventData(t,r),this.delegateDocumentEvents(this.options.documentEvents,t.data),e.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(t){const e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY);this.cellView.onMouseMove(e,n.x,n.y),this.update()}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),n=this.cellView,r=this.graph.snapToGrid(e.clientX,e.clientY);n.onMouseUp(e,r.x,r.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(Arrowhead||(Arrowhead={})).config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}});const SourceArrowhead=Arrowhead.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),TargetArrowhead=Arrowhead.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class CellEditor extends ToolsView.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5}render(){return this.createElement(),this.update(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents),this}createElement(){const{cell:t}=this,e=[this.prefixClassName((t.isEdge()?"edge":"node")+"-tool-editor"),this.prefixClassName("cell-tool-editor")];this.editor=ToolsView.createElement("div",!1),this.addClass(e,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}update(){const{graph:t,cell:e,editor:n}=this,r=n.style;let i=new Point,o=20;if(e.isNode())i=e.getBBox().center,o=e.size().width-4;else if(e.isEdge()){const e=this.options.event,n=e.target,r=n.parentElement;if(r&&hasClass(r,this.prefixClassName("edge-label"))){const t=r.getAttribute("data-index")||"0";this.labelIndex=parseInt(t,10);const e=r.getAttribute("transform"),{translation:s}=parseTransformString(e);i=new Point(s.tx,s.ty),o=getBBox(n).width}else{if(!this.options.labelAddable)return this;i=t.clientToLocal(Point.create(e.clientX,e.clientY));const n=this.cellView.path.closestPointLength(i);this.distance=n}}i=t.localToGraph(i),r.left=`${i.x}px`,r.top=`${i.y}px`,r.minWidth=`${o}px`;const s=t.scale();r.transform=`scale(${s.sx}, ${s.sy}) translate(-50%, -50%)`;const a=this.options.attrs;r.fontSize=`${a.fontSize}px`,r.fontFamily=a.fontFamily,r.color=a.color,r.backgroundColor=a.backgroundColor;const l=this.options.getText;let c;return"function"==typeof l&&(c=call(l,this.cellView,{cell:this.cell,index:this.labelIndex})),n.innerText=c||"",this}onDocumentMouseDown(t){if(t.target!==this.editor){const t=this.cell,e=this.editor.innerText.replace(/\n$/,"")||"",n=this.options.setText;"function"==typeof n&&call(n,this.cellView,{cell:this.cell,value:e,index:this.labelIndex,distance:this.distance}),t.removeTool(t.isEdge()?"edge-editor":"node-editor"),this.undelegateDocumentEvents()}}onDblClick(t){t.stopPropagation()}onMouseDown(t){t.stopPropagation()}autoFocus(){setTimeout((()=>{this.editor.focus(),this.selectText()}))}selectText(){if(window.getSelection){const t=document.createRange(),e=window.getSelection();t.selectNodeContents(this.editor),e.removeAllRanges(),e.addRange(t)}}}(CellEditor||(CellEditor={})).config({tagName:"div",isSVGElement:!1,events:{dblclick:"onDblClick",mousedown:"onMouseDown"},documentEvents:{mousedown:"onDocumentMouseDown"}}),function(t){t.NodeEditor=t.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:({cell:t})=>t.attr("text/text"),setText({cell:t,value:e}){t.attr("text/text",e)}}),t.EdgeEditor=t.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:({cell:t,index:e})=>-1===e?"":t.prop(`labels/${e}/attrs/label/text`),setText({cell:t,value:e,index:n,distance:r}){const i=t;-1===n?i.appendLabel({position:{distance:r},attrs:{label:{text:e}}}):e?i.prop(`labels/${n}/attrs/label/text`,e):"number"==typeof n&&i.removeLabelAt(n)}})}(CellEditor||(CellEditor={}));var __rest$k=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},NodeTool,EdgeTool;!function(t){t.presets={boundary:Boundary,button:Button,"button-remove":Button.Remove,"node-editor":CellEditor.NodeEditor},t.registry=Registry.create({type:"node tool",process(t,e){if("function"==typeof e)return e;let n=ToolsView.ToolItem;const{inherit:r}=e,i=__rest$k(e,["inherit"]);if(r){const t=this.get(r);null==t?this.onNotFound(r,"inherited"):n=t}return null==i.name&&(i.name=t),n.define.call(n,i)}}),t.registry.register(t.presets,!0)}(NodeTool||(NodeTool={})),function(t){t.presets={boundary:Boundary,vertices:Vertices,segments:Segments,button:Button,"button-remove":Button.Remove,"source-anchor":SourceAnchor,"target-anchor":TargetAnchor,"source-arrowhead":SourceArrowhead,"target-arrowhead":TargetArrowhead,"edge-editor":CellEditor.EdgeEditor},t.registry=Registry.create({type:"edge tool",process(t,e){if("function"==typeof e)return e;let n=ToolsView.ToolItem;const{inherit:r}=e,i=__rest$k(e,["inherit"]);if(r){const t=this.get(r);null==t?this.onNotFound(r,"inherited"):n=t}return null==i.name&&(i.name=t),n.define.call(n,i)}}),t.registry.register(t.presets,!0)}(EdgeTool||(EdgeTool={}));const center=createBBoxAnchor("center"),top=createBBoxAnchor("topCenter"),bottom=createBBoxAnchor("bottomCenter"),left=createBBoxAnchor("leftMiddle"),right=createBBoxAnchor("rightMiddle"),topLeft=createBBoxAnchor("topLeft"),topRight=createBBoxAnchor("topRight"),bottomLeft=createBBoxAnchor("bottomLeft"),bottomRight=createBBoxAnchor("bottomRight");function createBBoxAnchor(t){return function(e,n,r,i={}){const o=i.rotate?e.getUnrotatedBBoxOfElement(n):e.getBBoxOfElement(n),s=o[t];s.x+=normalizePercentage(i.dx,o.width),s.y+=normalizePercentage(i.dy,o.height);const a=e.cell;return i.rotate?s.rotate(-a.getAngle(),a.getBBox().getCenter()):s}}function resolve$1(t){return function(e,n,r,i){if(r instanceof Element){const o=this.graph.renderer.findViewByElem(r);let s;return s=o?o.isEdgeElement(r)?getPointAtEdge(o,null!=i.fixedAt?i.fixedAt:"50%"):o.getBBoxOfElement(r).getCenter():new Point,t.call(this,e,n,s,i)}return t.apply(this,arguments)}}function getPointAtEdge(t,e){const n=isPercentage(e),r="string"==typeof e?parseFloat(e):e;return n?t.getPointAtRatio(r/100):t.getPointAtLength(r)}const orthogonal$1=function(t,e,n,r){const i=t.cell.getAngle(),o=t.getBBoxOfElement(e),s=o.getCenter(),a=o.getTopLeft(),l=o.getBottomRight();let c=r.padding;if(Number.isFinite(c)||(c=0),a.y+c<=n.y&&n.y<=l.y-c){const t=n.y-s.y;s.x+=0===i||180===i?0:1*t/Math.tan(Angle.toRad(i)),s.y+=t}else if(a.x+c<=n.x&&n.x<=l.x-c){const t=n.x-s.x;s.y+=90===i||270===i?0:t*Math.tan(Angle.toRad(i)),s.x+=t}return s},orth$2=resolve$1(orthogonal$1),nodeCenter=function(t,e,n,r,i){const o=t.cell.getConnectionPoint(this.cell,i);return(r.dx||r.dy)&&o.translate(r.dx||0,r.dy||0),o},middleSide=function(t,e,n,r){let i,o,s=0;const a=t.cell;r.rotate?(i=t.getUnrotatedBBoxOfElement(e),o=a.getBBox().getCenter(),s=a.getAngle()):i=t.getBBoxOfElement(e);const l=r.padding;null!=l&&Number.isFinite(l)&&i.inflate(l),r.rotate&&n.rotate(s,o);const c=i.getNearestSideToPoint(n);let u;switch(c){case"left":u=i.getLeftMiddle();break;case"right":u=i.getRightMiddle();break;case"top":u=i.getTopCenter();break;case"bottom":u=i.getBottomCenter()}const h=r.direction;return"H"===h?"top"!==c&&"bottom"!==c||(u=n.x<=i.x+i.width?i.getLeftMiddle():i.getRightMiddle()):"V"===h&&(u=n.y<=i.y+i.height?i.getTopCenter():i.getBottomCenter()),r.rotate?u.rotate(-s,o):u},midSide=resolve$1(middleSide),anchors$1=Object.freeze({__proto__:null,center,top,bottom,left,right,topLeft,topRight,bottomLeft,bottomRight,orth:orth$2,nodeCenter,midSide});var NodeAnchor;!function(t){t.presets=anchors$1,t.registry=Registry.create({type:"node endpoint"}),t.registry.register(t.presets,!0)}(NodeAnchor||(NodeAnchor={}));const ratio=function(t,e,n,r){let i=null!=r.ratio?r.ratio:.5;return i>1&&(i/=100),t.getPointAtRatio(i)},length=function(t,e,n,r){return t.getPointAtLength(null!=r.length?r.length:20)},getClosestPoint=function(t,e,n){const r=t.getClosestPoint(n);return null!=r?r:new Point},closest=resolve$1(getClosestPoint),orthogonal=function(t,e,n,r){const i=1e6,o=t.getConnection(),s=t.getConnectionSubdivisions(),a=new Line(n.clone().translate(0,i),n.clone().translate(0,-i)),l=new Line(n.clone().translate(i,0),n.clone().translate(-i,0)),c=a.intersect(o,{segmentSubdivisions:s}),u=l.intersect(o,{segmentSubdivisions:s}),h=[];return c&&h.push(...c),u&&h.push(...u),h.length>0?n.closest(h):null!=r.fallbackAt?getPointAtEdge(t,r.fallbackAt):call(getClosestPoint,this,t,e,n,r)},orth$1=resolve$1(orthogonal),anchors=Object.freeze({__proto__:null,closest,ratio,length,orth:orth$1});var EdgeAnchor;function offset(t,e,n){let r;if("object"==typeof n){if(Number.isFinite(n.y)){const r=new Line(e,t),{start:i,end:o}=r.parallel(n.y);e=i,t=o}r=n.x}else r=n;if(null==r||!Number.isFinite(r))return t;const i=t.distance(e);return 0===r&&i>0?t:t.move(e,-Math.min(r,i-1))}function getStrokeWidth(t){const e=t.getAttribute("stroke-width");return null===e?0:parseFloat(e)||0}function findShapeNode(t){if(null==t)return null;let e=t;do{let t=e.tagName;if("string"!=typeof t)return null;if(t=t.toUpperCase(),"G"===t)e=e.firstElementChild;else{if("TITLE"!==t)break;e=e.nextElementSibling}}while(e);return e}!function(t){t.presets=anchors,t.registry=Registry.create({type:"edge endpoint"}),t.registry.register(t.presets,!0)}(EdgeAnchor||(EdgeAnchor={}));const bbox=function(t,e,n,r){const i=e.getBBoxOfElement(n);r.stroked&&i.inflate(getStrokeWidth(n)/2);const o=t.intersect(i);return offset(o&&o.length?t.start.closest(o):t.end,t.start,r.offset)},rect=function(t,e,n,r,i){const o=e.cell,s=o.isNode()?o.getAngle():0;if(0===s)return call(bbox,this,t,e,n,r,i);const a=e.getUnrotatedBBoxOfElement(n);r.stroked&&a.inflate(getStrokeWidth(n)/2);const l=a.getCenter(),c=t.clone().rotate(s,l),u=c.setLength(1e6).intersect(a);return offset(u&&u.length?c.start.closest(u).rotate(-s,l):t.end,t.start,r.offset)},boundary=function(t,e,n,r){let i,o;const s=t.end,a=r.selector;if(i="string"==typeof a?e.findOne(a):Array.isArray(a)?getByPath(n,a):findShapeNode(n),!isSVGGraphicsElement(i)){if(i===n||!isSVGGraphicsElement(n))return s;i=n}const l=e.getShapeOfElement(i),c=e.getMatrixOfElement(i),u=e.getRootTranslatedMatrix(),h=e.getRootRotatedMatrix(),d=u.multiply(h).multiply(c),f=transformLine(t,d.inverse()),p=f.start.clone(),g=e.getDataOfElement(i);if(!1===r.insideout){null==g.shapeBBox&&(g.shapeBBox=l.bbox());const t=g.shapeBBox;if(null!=t&&t.containsPoint(p))return s}let m;if(!0===r.extrapolate&&f.setLength(1e6),Path$1.isPath(l)){const t=r.precision||2;null==g.segmentSubdivisions&&(g.segmentSubdivisions=l.getSegmentSubdivisions({precision:t})),m={precision:t,segmentSubdivisions:g.segmentSubdivisions},o=f.intersect(l,m)}else o=f.intersect(l);o?Array.isArray(o)&&(o=p.closest(o)):!0===r.sticky&&(o=Rectangle.isRectangle(l)?l.getNearestPointToPoint(p):Ellipse.isEllipse(l)?l.intersectsWithLineFromCenterToPoint(p):l.closestPoint(p,m));const A=o?transformPoint(o,d):s;let y=r.offset||0;return!1!==r.stroked&&("object"==typeof y?(y=Object.assign({},y),null==y.x&&(y.x=0),y.x+=getStrokeWidth(i)/2):y+=getStrokeWidth(i)/2),offset(A,t.start,y)};function alignLine(t,e,n=0){const{start:r,end:i}=t;let o,s,a,l;switch(e){case"left":l="x",o=i,s=r,a=-1;break;case"right":l="x",o=r,s=i,a=1;break;case"top":l="y",o=i,s=r,a=-1;break;case"bottom":l="y",o=r,s=i,a=1;break;default:return}r[l]<i[l]?o[l]=s[l]:s[l]=o[l],Number.isFinite(n)&&(o[l]+=a*n,s[l]+=a*n)}const anchor=function(t,e,n,r){const{alignOffset:i,align:o}=r;return o&&alignLine(t,o,i),offset(t.end,t.start,r.offset)},connectionPoints=Object.freeze({__proto__:null,bbox,rect,boundary,anchor});var ConnectionPoint;!function(t){t.presets=connectionPoints,t.registry=Registry.create({type:"connection point"}),t.registry.register(t.presets,!0)}(ConnectionPoint||(ConnectionPoint={}));const normal$1=function(t){return[...t]},oneSide=function(t,e,n){const r=e.side||"bottom",i=normalizeSides(e.padding||40),o=n.sourceBBox,s=n.targetBBox,a=o.getCenter(),l=s.getCenter();let c,u,h;switch(r){case"top":h=-1,c="y",u="height";break;case"left":h=-1,c="x",u="width";break;case"right":h=1,c="x",u="width";break;default:h=1,c="y",u="height"}return a[c]+=h*(o[u]/2+i[r]),l[c]+=h*(s[u]/2+i[r]),h*(a[c]-l[c])>0?l[c]=a[c]:a[c]=l[c],[a.toJSON(),...t,l.toJSON()]};function getPointBBox(t){return new Rectangle(t.x,t.y,0,0)}function getPaddingBox(t={}){const e=normalizeSides(t.padding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function getSourceBBox$1(t,e={}){return t.sourceBBox.clone().moveAndExpand(getPaddingBox(e))}function getTargetBBox$1(t,e={}){return t.targetBBox.clone().moveAndExpand(getPaddingBox(e))}function getSourceAnchor(t,e={}){return t.sourceAnchor?t.sourceAnchor:getSourceBBox$1(t,e).getCenter()}function getTargetAnchor(t,e={}){return t.targetAnchor?t.targetAnchor:getTargetBBox$1(t,e).getCenter()}const orth=function(t,e,n){let r=getSourceBBox$1(n,e),i=getTargetBBox$1(n,e);const o=getSourceAnchor(n,e),s=getTargetAnchor(n,e);r=r.union(getPointBBox(o)),i=i.union(getPointBBox(s));const a=t.map((t=>Point.create(t)));a.unshift(o),a.push(s);let l=null;const c=[];for(let t=0,n=a.length-1;t<n;t+=1){let o=null;const s=a[t],u=a[t+1],h=null!=Private$5.getBearing(s,u);if(0===t)t+1===n?r.intersectsWithRect(i.clone().inflate(1))?o=Private$5.insideNode(s,u,r,i):h||(o=Private$5.nodeToNode(s,u,r,i)):r.containsPoint(u)?o=Private$5.insideNode(s,u,r,getPointBBox(u).moveAndExpand(getPaddingBox(e))):h||(o=Private$5.nodeToVertex(s,u,r));else if(t+1===n){const t=h&&Private$5.getBearing(u,s)===l;i.containsPoint(s)||t?o=Private$5.insideNode(s,u,getPointBBox(s).moveAndExpand(getPaddingBox(e)),i,l):h||(o=Private$5.vertexToNode(s,u,i,l))}else h||(o=Private$5.vertexToVertex(s,u,l));o?(c.push(...o.points),l=o.direction):l=Private$5.getBearing(s,u),t+1<n&&c.push(u)}return c};var Private$5;!function(t){const e={N:"S",S:"N",E:"W",W:"E"},n={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function r(t,e,n){let r=new Point(t.x,e.y);return n.containsPoint(r)&&(r=new Point(e.x,t.y)),r}function i(t,e){return t["W"===e||"E"===e?"width":"height"]}function o(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function s(t,n,r){const i=new Point(t.x,n.y),s=new Point(n.x,t.y),a=o(t,i),l=o(t,s),c=r?e[r]:null,u=a===r||a!==c&&(l===c||l!==r)?i:s;return{points:[u],direction:o(u,n)}}function a(t,e,n){const i=r(t,e,n);return{points:[i],direction:o(i,e)}}t.getBBoxSize=i,t.getBearing=o,t.vertexToVertex=s,t.nodeToVertex=a,t.vertexToNode=function(t,e,n,s){const a=[new Point(t.x,e.y),new Point(e.x,t.y)],l=a.filter((t=>!n.containsPoint(t))),c=l.filter((e=>o(e,t)!==s));let u;if(c.length>0)return u=c.filter((e=>o(t,e)===s)).pop(),u=u||c[0],{points:[u],direction:o(u,e)};{u=difference(a,l)[0];const c=Point.create(e).move(u,-i(n,s)/2);return{points:[r(c,t,n),c],direction:o(c,e)}}},t.nodeToNode=function(t,e,n,r){let l=a(e,t,r);const c=l.points[0];if(n.containsPoint(c)){l=a(t,e,n);const u=l.points[0];if(r.containsPoint(u)){const h=Point.create(t).move(u,-i(n,o(t,u))/2),d=Point.create(e).move(c,-i(r,o(e,c))/2),f=new Line(h,d).getCenter(),p=a(t,f,n),g=s(f,e,p.direction);l.points=[p.points[0],g.points[0]],l.direction=g.direction}}return l},t.insideNode=function(t,e,i,s,a){const l=i.union(s).inflate(1),c=l.getCenter(),u=c.distance(e)>c.distance(t),h=u?e:t,d=u?t:e;let f,p,g,m;return a?(f=Point.fromPolar(l.width+l.height,n[a],h),f=l.getNearestPointToPoint(f).move(f,-1)):f=l.getNearestPointToPoint(h).move(h,1),p=r(f,d,l),f.round().equals(p.round())?(p=Point.fromPolar(l.width+l.height,Angle.toRad(f.theta(h))+Math.PI/2,d),p=l.getNearestPointToPoint(p).move(d,1).round(),g=r(f,p,l),m=u?[p,g,f]:[f,g,p]):m=u?[p,f]:[f,p],{points:m,direction:o(u?f:p,e)}}}(Private$5||(Private$5={}));const defaults$1={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeShapes:[],excludeNodes:[],excludeHiddenNodes:!1,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return resolve(this.step,this)},directions(){const t=resolve(this.step,this),e=resolve(this.cost,this);return[{cost:e,offsetX:t,offsetY:0},{cost:e,offsetX:-t,offsetY:0},{cost:e,offsetX:0,offsetY:t},{cost:e,offsetX:0,offsetY:-t}]},penalties(){const t=resolve(this.step,this);return{0:0,45:t/2,90:t/2}},paddingBox(){const t=resolve(this.step,this);return{x:-t,y:-t,width:2*t,height:2*t}},fallbackRouter:orth,draggingRouter:null};function resolve(t,e){return"function"==typeof t?t.call(e):t}function resolveOptions(t){const e=Object.keys(t).reduce(((e,n)=>(e[n]="fallbackRouter"===n||"draggingRouter"===n||"fallbackRoute"===n?t[n]:resolve(t[n],t),e)),{});if(e.padding){const t=normalizeSides(e.padding);e.paddingBox={x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}return e.directions.forEach((t=>{const e=new Point(0,0),n=new Point(t.offsetX,t.offsetY);t.angle=Angle.normalize(e.theta(n))})),e}const OPEN=1,CLOSE=2;class SortedSet{constructor(){this.items=[],this.hash={},this.values={}}add(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=OPEN,this.values[t]=e;const n=sortedIndexBy(this.items,t,(t=>this.values[t]));this.items.splice(n,0,t)}pop(){const t=this.items.shift();return t&&(this.hash[t]=CLOSE),t}isOpen(t){return this.hash[t]===OPEN}isClose(t){return this.hash[t]===CLOSE}isEmpty(){return 0===this.items.length}}class ObstacleMap{constructor(t){this.options=t,this.mapGridSize=100,this.map={}}build(t,e){const n=this.options,r=n.excludeTerminals.reduce(((n,r)=>{const i=e[r];if(i){const e=t.getCell(i.cell);e&&n.push(e)}return n}),[]);let i=[];const o=t.getCell(e.getSourceCellId());o&&(i=union(i,o.getAncestors().map((t=>t.id))));const s=t.getCell(e.getTargetCellId());s&&(i=union(i,s.getAncestors().map((t=>t.id))));const a=this.mapGridSize;return t.getNodes().reduce(((t,e)=>{const o=e.shape,s=!!o&&n.excludeShapes.includes(o),l=r.some((t=>t.id===e.id)),c=n.excludeNodes.includes(e),u=i.includes(e.id),h=n.excludeHiddenNodes&&!e.isVisible();if(!(s||l||c||u||h)){const r=e.getBBox().moveAndExpand(n.paddingBox),i=r.getOrigin().snapToGrid(a),o=r.getCorner().snapToGrid(a);for(let e=i.x;e<=o.x;e+=a)for(let n=i.y;n<=o.y;n+=a){const i=new Point(e,n).toString();null==t[i]&&(t[i]=[]),t[i].push(r)}}return t}),this.map),this}isAccessible(t){const e=t.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[e];return!n||n.every((e=>!e.containsPoint(t)))}}function getSourceBBox(t,e){const n=t.sourceBBox.clone();return e&&e.paddingBox?n.moveAndExpand(e.paddingBox):n}function getTargetBBox(t,e){const n=t.targetBBox.clone();return e&&e.paddingBox?n.moveAndExpand(e.paddingBox):n}function getSourceEndpoint(t,e){return t.sourceAnchor?t.sourceAnchor:getSourceBBox(t,e).getCenter()}function getTargetEndpoint(t,e){return t.targetAnchor?t.targetAnchor:getTargetBBox(t,e).getCenter()}function getDirectionAngle(t,e,n,r,i){const o=360/n,s=t.theta(fixAngleEnd(t,e,r,i)),a=Angle.normalize(s+o/2);return o*Math.floor(a/o)}function fixAngleEnd(t,e,n,r){const i=r.step;return new Point(t.x+(e.x-t.x)/n.x*i,t.y+(e.y-t.y)/n.y*i)}function getDirectionChange(t,e){const n=Math.abs(t-e);return n>180?360-n:n}function getGridOffsets(t,e){const n=e.step;return e.directions.forEach((e=>{e.gridOffsetX=e.offsetX/n*t.x,e.gridOffsetY=e.offsetY/n*t.y})),e.directions}function getGrid(t,e,n){return{source:e.clone(),x:getGridDimension(n.x-e.x,t),y:getGridDimension(n.y-e.y,t)}}function getGridDimension(t,e){if(!t)return e;const n=Math.abs(t),r=Math.round(n/e);return r?e+(n-r*e)/r:n}function snapGrid(t,e){const n=e.source,r=Util$3.snapToGrid(t.x-n.x,e.x)+n.x,i=Util$3.snapToGrid(t.y-n.y,e.y)+n.y;return new Point(r,i)}function round(t,e){return t.round(e)}function align(t,e,n){return round(snapGrid(t.clone(),e),n)}function getKey(t){return t.toString()}function normalizePoint(t){return new Point(0===t.x?0:Math.abs(t.x)/t.x,0===t.y?0:Math.abs(t.y)/t.y)}function getCost(t,e){let n=1/0;for(let r=0,i=e.length;r<i;r+=1){const i=t.manhattanDistance(e[r]);i<n&&(n=i)}return n}function getRectPoints(t,e,n,r,i){const o=i.precision,s=i.directionMap,a=t.diff(e.getCenter()),l=Object.keys(s).reduce(((i,l)=>{if(n.includes(l)){const n=s[l],c=new Point(t.x+n.x*(Math.abs(a.x)+e.width),t.y+n.y*(Math.abs(a.y)+e.height)),u=new Line(t,c).intersect(e)||[];let h,d=null;for(let e=0;e<u.length;e+=1){const n=u[e],r=t.squaredDistance(n);(null==h||r>h)&&(h=r,d=n)}if(d){let t=align(d,r,o);e.containsPoint(t)&&(t=align(t.translate(n.x*r.x,n.y*r.y),r,o)),i.push(t)}}return i}),[]);return e.containsPoint(t)||l.push(align(t,r,o)),l}function reconstructRoute(t,e,n,r,i){const o=[];let s,a=normalizePoint(i.diff(n)),l=getKey(n),c=t[l];for(;c;){s=e[l];const n=normalizePoint(s.diff(c));n.equals(a)||(o.unshift(s),a=n),l=getKey(c),c=t[l]}const u=e[l];return normalizePoint(u.diff(r)).equals(a)||o.unshift(u),o}function findRoute(t,e,n,r,i){const o=i.precision;let s,a;s=Rectangle.isRectangle(e)?round(getSourceEndpoint(t,i).clone(),o):round(e.clone(),o),a=Rectangle.isRectangle(n)?round(getTargetEndpoint(t,i).clone(),o):round(n.clone(),o);const l=getGrid(i.step,s,a),c=s,u=a;let h,d;if(h=Rectangle.isRectangle(e)?getRectPoints(c,e,i.startDirections,l,i):[c],d=Rectangle.isRectangle(n)?getRectPoints(a,n,i.endDirections,l,i):[u],h=h.filter((t=>r.isAccessible(t))),d=d.filter((t=>r.isAccessible(t))),h.length>0&&d.length>0){const t=new SortedSet,e={},n={},s={};for(let n=0,r=h.length;n<r;n+=1){const r=h[n],i=getKey(r);t.add(i,getCost(r,d)),e[i]=r,s[i]=0}const a=i.previousDirectionAngle,f=void 0===a;let p,g;const m=getGridOffsets(l,i),A=m.length,y=d.reduce(((t,e)=>{const n=getKey(e);return t.push(n),t}),[]),v=Point.equalPoints(h,d);let b=i.maxLoopCount;for(;!t.isEmpty()&&b>0;){const h=t.pop(),x=e[h],w=n[h],C=s[h],$=x.equals(c),_=null==w;let P;if(P=_?f?$?null:getDirectionAngle(c,x,A,l,i):a:getDirectionAngle(w,x,A,l,i),(!_||!v)&&y.indexOf(h)>=0)return i.previousDirectionAngle=P,reconstructRoute(n,e,x,c,u);for(let a=0;a<A;a+=1){p=m[a];const c=p.angle;if(g=getDirectionChange(P,c),(!f||!$)&&g>i.maxDirectionChange)continue;const h=align(x.clone().translate(p.gridOffsetX||0,p.gridOffsetY||0),l,o),v=getKey(h);if(t.isClose(v)||!r.isAccessible(h))continue;if(y.indexOf(v)>=0&&!h.equals(u)&&getDirectionChange(c,getDirectionAngle(h,u,A,l,i))>i.maxDirectionChange)continue;const b=C+p.cost+($?0:i.penalties[g]);(!t.isOpen(v)||b<s[v])&&(e[v]=h,n[v]=x,s[v]=b,t.add(v,b+getCost(h,d)))}b-=1}}return i.fallbackRoute?call(i.fallbackRoute,this,c,u,i):null}const router=function(t,e,n){const r=resolveOptions(e),i=getSourceBBox(n,r),o=getTargetBBox(n,r),s=getSourceEndpoint(n,r),a=new ObstacleMap(r).build(n.graph.model,n.cell),l=t.map((t=>Point.create(t))),c=[];let u,h,d=s;for(let e=0,f=l.length;e<=f;e+=1){let f=null;if(u=h||i,h=l[e],null==h){h=o;const t=n.cell;if((null==t.getSourceCellId()||null==t.getTargetCellId())&&"function"==typeof r.draggingRouter){const t=u===i?s:u,e=h.getOrigin();f=call(r.draggingRouter,n,t,e,r)}}if(null==f&&(f=findRoute(n,u,h,a,r)),null===f)return call(r.fallbackRouter,this,t,r,n);const p=f[0];p&&p.equals(d)&&f.shift(),d=f[f.length-1]||d,c.push(...f)}return c},manhattan=function(t,e,n){return call(router,this,t,Object.assign(Object.assign({},defaults$1),e),n)},defaults={maxDirectionChange:45,directions(){const t=resolve(this.step,this),e=resolve(this.cost,this),n=Math.ceil(Math.sqrt(t*t<<1));return[{cost:e,offsetX:t,offsetY:0},{cost:n,offsetX:t,offsetY:t},{cost:e,offsetX:0,offsetY:t},{cost:n,offsetX:-t,offsetY:t},{cost:e,offsetX:-t,offsetY:0},{cost:n,offsetX:-t,offsetY:-t},{cost:e,offsetX:0,offsetY:-t},{cost:n,offsetX:t,offsetY:-t}]},fallbackRoute(t,e,n){const r=t.theta(e),i=[];let o={x:e.x,y:t.y},s={x:t.x,y:e.y};if(r%180>90){const t=o;o=s,s=t}const a=r%90<45?o:s,l=new Line(t,a),c=90*Math.ceil(r/90),u=Point.fromPolar(l.squaredLength(),Angle.toRad(c+135),a),h=new Line(e,u),d=l.intersectsWithLine(h),f=d||e,p=360/n.directions.length,g=(d?f:t).theta(e),m=Angle.normalize(g+p/2),A=p*Math.floor(m/p);return n.previousDirectionAngle=A,f&&i.push(f.round()),i.push(e),i}},metro=function(t,e,n){return call(manhattan,this,t,Object.assign(Object.assign({},defaults),e),n)},er=function(t,e,n){const r=e.offset||32,i=null==e.min?16:e.min;let o=0,s=e.direction;const a=n.sourceBBox,l=n.targetBBox,c=a.getCenter(),u=l.getCenter();if("number"==typeof r&&(o=r),null==s){let t=l.left-a.right,e=l.top-a.bottom;t>=0&&e>=0?s=t>=e?"L":"T":t<=0&&e>=0?(t=a.left-l.right,s=t>=0&&t>=e?"R":"T"):t>=0&&e<=0?(e=a.top-l.bottom,s=e>=0?t>=e?"L":"B":"L"):(t=a.left-l.right,e=a.top-l.bottom,s=t>=0&&e>=0?t>=e?"R":"B":t<=0&&e>=0?"B":t>=0&&e<=0||Math.abs(t)>Math.abs(e)?"R":"B")}let h,d,f;"H"===s?s=u.x-c.x>=0?"L":"R":"V"===s&&(s=u.y-c.y>=0?"T":"B"),"center"===r&&("L"===s?o=(l.left-a.right)/2:"R"===s?o=(a.left-l.right)/2:"T"===s?o=(l.top-a.bottom)/2:"B"===s&&(o=(a.top-l.bottom)/2));const p="L"===s||"R"===s;if(p){if(u.y===c.y)return[...t];f="L"===s?1:-1,h="x",d="width"}else{if(u.x===c.x)return[...t];f="T"===s?1:-1,h="y",d="height"}const g=c.clone(),m=u.clone();if(g[h]+=f*(a[d]/2+o),m[h]-=f*(l[d]/2+o),p){const t=g.x,e=m.x,n=a.width/2+i,r=l.width/2+i;u.x>c.x?e<=t&&(g.x=Math.max(e,c.x+n),m.x=Math.min(t,u.x-r)):e>=t&&(g.x=Math.min(e,c.x-n),m.x=Math.max(t,u.x+r))}else{const t=g.y,e=m.y,n=a.height/2+i,r=l.height/2+i;u.y>c.y?e<=t&&(g.y=Math.max(e,c.y+n),m.y=Math.min(t,u.y-r)):e>=t&&(g.y=Math.min(e,c.y-n),m.y=Math.max(t,u.y+r))}return[g.toJSON(),...t,m.toJSON()]};function rollup(t,e){if(null!=e&&!1!==e){const n="boolean"==typeof e?0:e;if(n>0){const e=Point.create(t[1]).move(t[2],n),r=Point.create(t[1]).move(t[0],n);return[e.toJSON(),...t,r.toJSON()]}{const e=t[1];return[Object.assign({},e),...t,Object.assign({},e)]}}return t}const loop$1=function(t,e,n){const r=e.width||50,i=(e.height||80)/2,o=e.angle||"auto",s=n.sourceAnchor,a=n.targetAnchor,l=n.sourceBBox,c=n.targetBBox;if(s.equals(a)){const t=t=>{const e=Angle.toRad(t),n=Math.sin(e),o=Math.cos(e),a=new Point(s.x+o*r,s.y+n*r),l=new Point(a.x-o*i,a.y-n*i),c=l.clone().rotate(-90,a),u=l.clone().rotate(90,a);return[c.toJSON(),a.toJSON(),u.toJSON()]},n=t=>{const e=s.clone().move(t,-1),n=new Line(e,t);return!l.containsPoint(t)&&!l.intersectsWithLine(n)},a=[0,90,180,270,45,135,225,315];if("number"==typeof o)return rollup(t(o),e.merge);const c=l.getCenter();if(c.equals(s))return rollup(t(0),e.merge);const u=c.angleBetween(s,c.clone().translate(1,0));let h=t(u);if(n(h[1]))return rollup(h,e.merge);for(let r=1,i=a.length;r<i;r+=1)if(h=t(u+a[r]),n(h[1]))return rollup(h,e.merge);return rollup(h,e.merge)}{const t=new Line(s,a);let o=t.parallel(-r),u=o.getCenter(),h=o.start.clone().move(o.end,i),d=o.end.clone().move(o.start,i);const f=t.parallel(-1),p=new Line(f.start,u),g=new Line(f.end,u);if((l.containsPoint(u)||c.containsPoint(u)||l.intersectsWithLine(p)||l.intersectsWithLine(g)||c.intersectsWithLine(p)||c.intersectsWithLine(g))&&(o=t.parallel(r),u=o.getCenter(),h=o.start.clone().move(o.end,i),d=o.end.clone().move(o.start,i)),e.merge){const t=new Line(s,a),e=new Line(u,t.center).setLength(Number.MAX_SAFE_INTEGER),r=l.intersectsWithLine(e),i=c.intersectsWithLine(e),o=r?Array.isArray(r)?r:[r]:[];i&&(Array.isArray(i)?o.push(...i):o.push(i));const h=t.center.closest(o);h?(n.sourceAnchor=h.clone(),n.targetAnchor=h.clone()):(n.sourceAnchor=t.center.clone(),n.targetAnchor=t.center.clone())}return rollup([h.toJSON(),u.toJSON(),d.toJSON()],e.merge)}},routers=Object.freeze({__proto__:null,normal:normal$1,oneSide,orth,metro,manhattan,er,loop:loop$1});var Router;!function(t){t.presets=routers,t.registry=Registry.create({type:"router"}),t.registry.register(t.presets,!0)}(Router||(Router={}));const normal=function(t,e,n,r={}){const i=[t,...n,e],o=new Polyline(i),s=new Path$1(o);return r.raw?s:s.serialize()},loop=function(t,e,n,r={}){const i=3===n.length?0:1,o=Point.create(n[0+i]),s=Point.create(n[2+i]),a=Point.create(n[1+i]);if(!Point.equals(t,e)){const n=new Point((t.x+e.x)/2,(t.y+e.y)/2),r=n.angleBetween(Point.create(t).rotate(90,n),a);r>1&&(o.rotate(180-r,n),s.rotate(180-r,n),a.rotate(180-r,n))}const l=`\n     M ${t.x} ${t.y}\n     Q ${o.x} ${o.y} ${a.x} ${a.y}\n     Q ${s.x} ${s.y} ${e.x} ${e.y}\n  `;return r.raw?Path$1.parse(l):l},rounded=function(t,e,n,r={}){const i=new Path$1;i.appendSegment(Path$1.createSegment("M",t));const o=1/3,s=2/3,a=r.radius||10;let l,c;for(let r=0,u=n.length;r<u;r+=1){const u=Point.create(n[r]),h=n[r-1]||t,d=n[r+1]||e;l=c||u.distance(h)/2,c=u.distance(d)/2;const f=-Math.min(a,l),p=-Math.min(a,c),g=u.clone().move(h,f).round(),m=u.clone().move(d,p).round(),A=new Point(o*g.x+s*u.x,s*u.y+o*g.y),y=new Point(o*m.x+s*u.x,s*u.y+o*m.y);i.appendSegment(Path$1.createSegment("L",g)),i.appendSegment(Path$1.createSegment("C",A,y,m))}return i.appendSegment(Path$1.createSegment("L",e)),r.raw?i:i.serialize()},smooth=function(t,e,n,r={}){let i,o=r.direction;if(n&&0!==n.length){const r=[t,...n,e],o=Curve.throughPoints(r);i=new Path$1(o)}else if(i=new Path$1,i.appendSegment(Path$1.createSegment("M",t)),o||(o=Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)?"H":"V"),"H"===o){const n=(t.x+e.x)/2;i.appendSegment(Path$1.createSegment("C",n,t.y,n,e.y,e.x,e.y))}else{const n=(t.y+e.y)/2;i.appendSegment(Path$1.createSegment("C",t.x,n,e.x,n,e.x,e.y))}return r.raw?i:i.serialize()},CLOSE_PROXIMITY_PADDING=1,F13=1/3,F23=2/3;function setupUpdating(t){let e=t.graph._jumpOverUpdateList;if(null==e&&(e=t.graph._jumpOverUpdateList=[],t.graph.on("cell:mouseup",(()=>{const e=t.graph._jumpOverUpdateList;for(let t=0;t<e.length;t+=1)e[t].update()})),t.graph.on("model:reseted",(()=>{e=t.graph._jumpOverUpdateList=[]}))),e.indexOf(t)<0){e.push(t);const n=()=>e.splice(e.indexOf(t),1);t.cell.once("change:connector",n),t.cell.once("removed",n)}}function createLines(t,e,n=[]){const r=[t,...n,e],i=[];return r.forEach(((t,e)=>{const n=r[e+1];null!=n&&i.push(new Line(t,n))})),i}function findLineIntersections(t,e){const n=[];return e.forEach((e=>{const r=t.intersectsWithLine(e);r&&n.push(r)})),n}function getDistence(t,e){return new Line(t,e).squaredLength()}function createJumps(t,e,n){return e.reduce(((r,i,o)=>{if(skippedPoints.includes(i))return r;const s=r.pop()||t,a=Point.create(i).move(s.start,-n);let l=Point.create(i).move(s.start,+n);const c=e[o+1];if(null!=c){const t=l.distance(c);t<=n&&(l=c.move(s.start,t),skippedPoints.push(c))}else if(a.distance(s.end)<2*n+CLOSE_PROXIMITY_PADDING)return r.push(s),r;if(l.distance(s.start)<2*n+CLOSE_PROXIMITY_PADDING)return r.push(s),r;const u=new Line(a,l);return jumppedLines.push(u),r.push(new Line(s.start,a),u,new Line(l,s.end)),r}),[])}function buildPath(t,e,n,r){const i=new Path$1;let o;return o=Path$1.createSegment("M",t[0].start),i.appendSegment(o),t.forEach(((s,a)=>{if(jumppedLines.includes(s)){let t,r,a,l;if("arc"===n){t=-90,r=s.start.diff(s.end),(r.x<0||0===r.x&&r.y<0)&&(t+=180);const e=s.getCenter(),n=new Line(e,s.end).rotate(t,e);let c;c=new Line(s.start,e),a=c.pointAt(2/3).rotate(t,s.start),l=n.pointAt(1/3).rotate(-t,n.end),o=Path$1.createSegment("C",a,l,n.end),i.appendSegment(o),c=new Line(e,s.end),a=n.pointAt(1/3).rotate(t,n.end),l=c.pointAt(1/3).rotate(-t,s.end),o=Path$1.createSegment("C",a,l,s.end),i.appendSegment(o)}else if("gap"===n)o=Path$1.createSegment("M",s.end),i.appendSegment(o);else if("cubic"===n){t=s.start.theta(s.end);const n=.6*e;let c=1.35*e;r=s.start.diff(s.end),(r.x<0||0===r.x&&r.y<0)&&(c*=-1),a=new Point(s.start.x+n,s.start.y+c).rotate(t,s.start),l=new Point(s.end.x-n,s.end.y+c).rotate(t,s.end),o=Path$1.createSegment("C",a,l,s.end),i.appendSegment(o)}}else{const e=t[a+1];0===r||!e||jumppedLines.includes(e)?(o=Path$1.createSegment("L",s.end),i.appendSegment(o)):buildRoundedSegment(r,i,s.end,s.start,e.end)}})),i}function buildRoundedSegment(t,e,n,r,i){const o=n.distance(r)/2,s=n.distance(i)/2,a=-Math.min(t,o),l=-Math.min(t,s),c=n.clone().move(r,a).round(),u=n.clone().move(i,l).round(),h=new Point(F13*c.x+F23*n.x,F23*n.y+F13*c.y),d=new Point(F13*u.x+F23*n.x,F23*n.y+F13*u.y);let f;f=Path$1.createSegment("L",c),e.appendSegment(f),f=Path$1.createSegment("C",h,d,u),e.appendSegment(f)}let jumppedLines,skippedPoints;const jumpover=function(t,e,n,r={}){jumppedLines=[],skippedPoints=[],setupUpdating(this);const i=r.size||5,o=r.type||"arc",s=r.radius||0,a=r.ignoreConnectors||["smooth"],l=this.graph,c=l.model.getEdges();if(1===c.length)return buildPath(createLines(t,e,n),i,o,s);const u=this.cell,h=c.indexOf(u),d=l.options.connecting.connector||{},f=c.filter(((t,e)=>{const n=t.getConnector()||d;return!(a.includes(n.name)||e>h&&"jumpover"===n.name)})),p=f.map((t=>l.renderer.findViewByCell(t))),g=createLines(t,e,n),m=p.map((t=>null==t?[]:t===this?g:createLines(t.sourcePoint,t.targetPoint,t.routePoints))),A=[];g.forEach((t=>{const e=f.reduce(((e,n,r)=>{if(n!==u){const n=findLineIntersections(t,m[r]);e.push(...n)}return e}),[]).sort(((e,n)=>getDistence(t.start,e)-getDistence(t.start,n)));e.length>0?A.push(...createJumps(t,e,i)):A.push(t)}));const y=buildPath(A,i,o,s);return jumppedLines=[],skippedPoints=[],r.raw?y:y.serialize()},connectors=Object.freeze({__proto__:null,normal,loop,rounded,smooth,jumpover});var Connector;!function(t){t.presets=connectors,t.registry=Registry.create({type:"connector"}),t.registry.register(t.presets,!0)}(Connector||(Connector={}));class Animation{constructor(t){this.cell=t,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(t,e,n={},r="/"){const i=this.cell.getPropByPath(t),o=defaults$3(n,Animation.defaultOptions),s=this.getTiming(o.timing),a=this.getInterp(o.interp,i,e);let l=0;const c=Array.isArray(t)?t.join(r):t,u=Array.isArray(t)?t:t.split(r),h=()=>{const t=(new Date).getTime();0===l&&(l=t);let e=(t-l)/o.duration;e<1?this.ids[c]=requestAnimationFrame$1(h):e=1;const r=a(s(e));this.cell.setPropByPath(u,r),n.progress&&n.progress(Object.assign({progress:e,currentValue:r},this.getArgs(c))),1===e&&(this.cell.notify("transition:end",this.getArgs(c)),this.cell.notify("transition:complete",this.getArgs(c)),n.complete&&n.complete(this.getArgs(c)),this.cell.notify("transition:finish",this.getArgs(c)),n.finish&&n.finish(this.getArgs(c)),this.clean(c))};return setTimeout((()=>{this.stop(t,void 0,r),this.cache[c]={startValue:i,targetValue:e,options:o},this.ids[c]=requestAnimationFrame$1(h),this.cell.notify("transition:begin",this.getArgs(c)),this.cell.notify("transition:start",this.getArgs(c)),n.start&&n.start(this.getArgs(c))}),n.delay),this.stop.bind(this,t,r,n)}stop(t,e={},n="/"){const r=Array.isArray(t)?t:t.split(n);return Object.keys(this.ids).filter((t=>isEqual(r,t.split(n).slice(0,r.length)))).forEach((t=>{cancelAnimationFrame$1(this.ids[t]);const n=this.cache[t],r=this.getArgs(t),i=Object.assign(Object.assign({},n.options),e),o=i.jumpedToEnd;o&&null!=n.targetValue&&(this.cell.setPropByPath(t,n.targetValue),this.cell.notify("transition:end",Object.assign({},r)),this.cell.notify("transition:complete",Object.assign({},r)),i.complete&&i.complete(Object.assign({},r)));const s=Object.assign({jumpedToEnd:o},r);this.cell.notify("transition:stop",Object.assign({},s)),i.stop&&i.stop(Object.assign({},s)),this.cell.notify("transition:finish",Object.assign({},r)),i.finish&&i.finish(Object.assign({},r)),this.clean(t)})),this}clean(t){delete this.ids[t],delete this.cache[t]}getTiming(t){return"string"==typeof t?Timing[t]:t}getInterp(t,e,n){return t?t(e,n):"number"==typeof n?Interp.number(e,n):"string"==typeof n?"#"===n[0]?Interp.color(e,n):Interp.unit(e,n):Interp.object(e,n)}getArgs(t){const e=this.cache[t];return{path:t,startValue:e.startValue,targetValue:e.targetValue,cell:this.cell}}}(Animation||(Animation={})).defaultOptions={delay:10,duration:100,timing:"linear"};var __decorate$s=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class Store extends Basecoat{constructor(t={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(cloneDeep(t)),this.changed={}}mutate(t,e={}){const n=!0===e.unset,r=!0===e.silent,i=[],o=this.changing;this.changing=!0,o||(this.previous=cloneDeep(this.data),this.changed={});const s=this.data,a=this.previous,l=this.changed;if(Object.keys(t).forEach((e=>{const r=e,o=t[r];isEqual(s[r],o)||i.push(r),isEqual(a[r],o)?delete l[r]:l[r]=o,n?delete s[r]:s[r]=o})),!r&&i.length>0&&(this.pending=!0,this.pendingOptions=e,i.forEach((t=>{this.emit("change:*",{key:t,options:e,store:this,current:s[t],previous:a[t]})}))),o)return this;if(!r)for(;this.pending;)this.pending=!1,this.emit("changed",{current:s,previous:a,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(t,e){if(null==t)return this.data;const n=this.data[t];return null==n?e:n}getPrevious(t){if(this.previous){const e=this.previous[t];return null==e?void 0:e}}set(t,e,n){return null!=t&&("object"==typeof t?this.mutate(t,e):this.mutate({[t]:e},n)),this}remove(t,e){const n=void 0,r={};let i;if("string"==typeof t)r[t]=n,i=e;else if(Array.isArray(t))t.forEach((t=>r[t]=n)),i=e;else{for(const t in this.data)r[t]=n;i=t}return this.mutate(r,Object.assign(Object.assign({},i),{unset:!0})),this}getByPath(t){return getByPath(this.data,t,"/")}setByPath(t,e,n={}){const r="/",i=Array.isArray(t)?[...t]:t.split(r),o=Array.isArray(t)?t.join(r):t,s=i[0],a=i.length;if(n.propertyPath=o,n.propertyValue=e,n.propertyPathArray=i,1===a)this.set(s,e,n);else{const o={};let l=o,c=s;for(let t=1;t<a;t+=1){const e=i[t],n=Number.isFinite(Number(e));l=l[c]=n?[]:{},c=e}setByPath(o,i,e,r);const u=cloneDeep(this.data);n.rewrite&&unsetByPath(u,t,r);const h=merge(u,o);this.set(s,h[s],n)}return this}removeByPath(t,e){const n=Array.isArray(t)?t:t.split("/"),r=n[0];if(1===n.length)this.remove(r,e);else{const t=n.slice(1),i=cloneDeep(this.get(r));i&&unsetByPath(i,t),this.set(r,i,e)}return this}hasChanged(t){return null==t?Object.keys(this.changed).length>0:t in this.changed}getChanges(t){if(null==t)return this.hasChanged()?cloneDeep(this.changed):null;const e=this.changing?this.previous:this.data,n={};let r;for(const i in t){const o=t[i];isEqual(e[i],o)||(n[i]=o,r=!0)}return r?cloneDeep(n):null}toJSON(){return cloneDeep(this.data)}clone(){return new(0,this.constructor)(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}__decorate$s([Basecoat.dispose()],Store.prototype,"dispose",null);var __decorate$r=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$j=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},ShareRegistry;class Cell extends Basecoat{constructor(t={}){super();const e=this.constructor.getDefaults(!0),n=merge({},this.preprocess(e),this.preprocess(t));this.id=n.id||uuid(),this.store=new Store(n),this.animation=new Animation(this),this.setup(),this.init(),this.postprocess(t)}static config(t){const{markup:e,propHooks:n,attrHooks:r}=t,i=__rest$j(t,["markup","propHooks","attrHooks"]);null!=e&&(this.markup=e),n&&(this.propHooks=this.propHooks.slice(),Array.isArray(n)?this.propHooks.push(...n):"function"==typeof n?this.propHooks.push(n):Object.keys(n).forEach((t=>{const e=n[t];"function"==typeof e&&this.propHooks.push(e)}))),r&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),r)),this.defaults=merge({},this.defaults,i)}static getMarkup(){return this.markup}static getDefaults(t){return t?this.defaults:cloneDeep(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(t,e){return this.propHooks.reduce(((e,n)=>n?call(n,t,e):e),e)}get[Symbol.toStringTag](){return Cell.toStringTag}init(){}get model(){return this._model}set model(t){this._model!==t&&(this._model=t)}preprocess(t,e){const n=t.id,r=this.constructor.applyPropHooks(this,t);return null==n&&!0!==e&&(r.id=uuid()),r}postprocess(t){}setup(){this.store.on("change:*",(t=>{const{key:e,current:n,previous:r,options:i}=t;this.notify("change:*",{key:e,options:i,current:n,previous:r,cell:this}),this.notify(`change:${e}`,{options:i,current:n,previous:r,cell:this}),"source"!==e&&"target"!==e||this.notify("change:terminal",{type:e,current:n,previous:r,options:i,cell:this})})),this.store.on("changed",(({options:t})=>this.notify("changed",{options:t,cell:this})))}notify(t,e){this.trigger(t,e);const n=this.model;return n&&(n.notify(`cell:${t}`,e),this.isNode()?n.notify(`node:${t}`,Object.assign(Object.assign({},e),{node:this})):this.isEdge()&&n.notify(`edge:${t}`,Object.assign(Object.assign({},e),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(t){return this.store===t.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(t,e){return null==t?this.store.get():this.store.get(t,e)}setProp(t,e,n){if("string"==typeof t)this.store.set(t,e,n);else{const n=this.preprocess(t,!0);this.store.set(merge({},this.getProp(),n),e),this.postprocess(t)}return this}removeProp(t,e){return"string"==typeof t||Array.isArray(t)?this.store.removeByPath(t,e):this.store.remove(e),this}hasChanged(t){return null==t?this.store.hasChanged():this.store.hasChanged(t)}getPropByPath(t){return this.store.getByPath(t)}setPropByPath(t,e,n={}){return this.model&&("children"===t?this._children=e?e.map((t=>this.model.getCell(t))).filter((t=>null!=t)):null:"parent"===t&&(this._parent=e?this.model.getCell(e):null)),this.store.setByPath(t,e,n),this}removePropByPath(t,e={}){const n=Array.isArray(t)?t:t.split("/");return"attrs"===n[0]&&(e.dirty=!0),this.store.removeByPath(n,e),this}prop(t,e,n){return null==t?this.getProp():"string"==typeof t||Array.isArray(t)?1===arguments.length?this.getPropByPath(t):null==e?this.removePropByPath(t,n||{}):this.setPropByPath(t,e,n||{}):this.setProp(t,e||{})}previous(t){return this.store.getPrevious(t)}get zIndex(){return this.getZIndex()}set zIndex(t){null==t?this.removeZIndex():this.setZIndex(t)}getZIndex(){return this.store.get("zIndex")}setZIndex(t,e={}){return this.store.set("zIndex",t,e),this}removeZIndex(t={}){return this.store.remove("zIndex",t),this}toFront(t={}){const e=this.model;if(e){let n,r=e.getMaxZIndex();t.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0}),n.unshift(this)):n=[this],r=r-n.length+1;const i=e.total();let o=e.indexOf(this)!==i-n.length;o||(o=n.some(((t,e)=>t.getZIndex()!==r+e))),o&&this.batchUpdate("to-front",(()=>{r+=n.length,n.forEach(((e,n)=>{e.setZIndex(r+n,t)}))}))}return this}toBack(t={}){const e=this.model;if(e){let n,r=e.getMinZIndex();t.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0}),n.unshift(this)):n=[this];let i=0!==e.indexOf(this);i||(i=n.some(((t,e)=>t.getZIndex()!==r+e))),i&&this.batchUpdate("to-back",(()=>{r-=n.length,n.forEach(((e,n)=>{e.setZIndex(r+n,t)}))}))}return this}get markup(){return this.getMarkup()}set markup(t){null==t?this.removeMarkup():this.setMarkup(t)}getMarkup(){let t=this.store.get("markup");return null==t&&(t=this.constructor.getMarkup()),t}setMarkup(t,e={}){return this.store.set("markup",t,e),this}removeMarkup(t={}){return this.store.remove("markup",t),this}get attrs(){return this.getAttrs()}set attrs(t){null==t?this.removeAttrs():this.setAttrs(t)}getAttrs(){const t=this.store.get("attrs");return t?Object.assign({},t):{}}setAttrs(t,e={}){if(null==t)this.removeAttrs(e);else{const n=t=>this.store.set("attrs",t,e);if(!0===e.overwrite)n(t);else{const r=this.getAttrs();n(!1===e.deep?Object.assign(Object.assign({},r),t):merge({},r,t))}}return this}replaceAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{deep:!1}))}removeAttrs(t={}){return this.store.remove("attrs",t),this}getAttrDefinition(t){if(!t)return null;const e=this.constructor.getAttrHooks()||{};let n=e[t]||Attr.registry.get(t);if(!n){const r=camelCase(t);n=e[r]||Attr.registry.get(r)}return n||null}getAttrByPath(t){return null==t||""===t?this.getAttrs():this.getPropByPath(this.prefixAttrPath(t))}setAttrByPath(t,e,n={}){return this.setPropByPath(this.prefixAttrPath(t),e,n),this}removeAttrByPath(t,e={}){return this.removePropByPath(this.prefixAttrPath(t),e),this}prefixAttrPath(t){return Array.isArray(t)?["attrs"].concat(t):`attrs/${t}`}attr(t,e,n){return null==t?this.getAttrByPath():"string"==typeof t||Array.isArray(t)?1===arguments.length?this.getAttrByPath(t):null==e?this.removeAttrByPath(t,n||{}):this.setAttrByPath(t,e,n||{}):this.setAttrs(t,e||{})}get visible(){return this.isVisible()}set visible(t){this.setVisible(t)}setVisible(t,e={}){return this.store.set("visible",t,e),this}isVisible(){return!1!==this.store.get("visible")}show(t={}){return this.isVisible()||this.setVisible(!0,t),this}hide(t={}){return this.isVisible()&&this.setVisible(!1,t),this}toggleVisible(t,e={}){const n="boolean"==typeof t?e:t;return("boolean"==typeof t?t:!this.isVisible())?this.show(n):this.hide(n),this}get data(){return this.getData()}set data(t){this.setData(t)}getData(){return this.store.get("data")}setData(t,e={}){if(null==t)this.removeData(e);else{const n=t=>this.store.set("data",t,e);if(!0===e.overwrite)n(t);else{const r=this.getData();n(!1===e.deep?"object"==typeof t?Object.assign(Object.assign({},r),t):t:merge({},r,t))}}return this}replaceData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{deep:!1}))}removeData(t={}){return this.store.remove("data",t),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const t=this.getParentId();if(t&&this.model){const e=this.model.getCell(t);return this._parent=e,e}return null}getChildren(){const t=this.store.get("children");if(t&&t.length&&this.model){const e=t.map((t=>{var e;return null===(e=this.model)||void 0===e?void 0:e.getCell(t)})).filter((t=>null!=t));return this._children=e,[...e]}return null}hasParent(){return null!=this.parent}isParentOf(t){return null!=t&&t.getParent()===this}isChildOf(t){return null!=t&&this.getParent()===t}eachChild(t,e){return this.children&&this.children.forEach(t,e),this}filterChild(t,e){return this.children?this.children.filter(t,e):[]}getChildCount(){return null==this.children?0:this.children.length}getChildIndex(t){return null==this.children?-1:this.children.indexOf(t)}getChildAt(t){return null!=this.children&&t>=0?this.children[t]:null}getAncestors(t={}){const e=[];let n=this.getParent();for(;n;)e.push(n),n=!1!==t.deep?n.getParent():null;return e}getDescendants(t={}){if(!1!==t.deep){if(t.breadthFirst){const t=[],e=this.getChildren()||[];for(;e.length>0;){const n=e.shift(),r=n.getChildren();t.push(n),r&&e.push(...r)}return t}{const e=this.getChildren()||[];return e.forEach((n=>{e.push(...n.getDescendants(t))})),e}}return this.getChildren()||[]}isDescendantOf(t,e={}){if(null==t)return!1;if(!1!==e.deep){let e=this.getParent();for(;e;){if(e===t)return!0;e=e.getParent()}return!1}return this.isChildOf(t)}isAncestorOf(t,e={}){return null!=t&&t.isDescendantOf(this,e)}contains(t){return this.isAncestorOf(t)}getCommonAncestor(...t){return Cell.getCommonAncestor(this,...t)}setParent(t,e={}){return this._parent=t,t?this.store.set("parent",t.id,e):this.store.remove("parent",e),this}setChildren(t,e={}){return this._children=t,null!=t?this.store.set("children",t.map((t=>t.id)),e):this.store.remove("children",e),this}unembed(t,e={}){const n=this.children;if(null!=n&&null!=t){const r=this.getChildIndex(t);-1!==r&&(n.splice(r,1),t.setParent(null,e),this.setChildren(n,e))}return this}embed(t,e={}){return t.addTo(this,e),this}addTo(t,e={}){return Cell.isCell(t)?t.addChild(this,e):t.addCell(this,e),this}insertTo(t,e,n={}){return t.insertChild(this,e,n),this}addChild(t,e={}){return this.insertChild(t,void 0,e)}insertChild(t,e,n={}){if(null!=t&&t!==this){const r=t.getParent(),i=this!==r;let o=e;if(null==o&&(o=this.getChildCount(),i||(o-=1)),r){const e=r.getChildren();if(e){const i=e.indexOf(t);i>=0&&(t.setParent(null,n),e.splice(i,1),r.setChildren(e,n))}}let s=this.children;if(null==s?(s=[],s.push(t)):s.splice(o,0,t),t.setParent(this,n),this.setChildren(s,n),i&&this.model){const t=this.model.getIncomingEdges(this),e=this.model.getOutgoingEdges(this);t&&t.forEach((t=>t.updateParent(n))),e&&e.forEach((t=>t.updateParent(n)))}this.model&&this.model.addCell(t,n)}return this}removeFromParent(t={}){const e=this.getParent();if(null!=e){const n=e.getChildIndex(this);e.removeChildAt(n,t)}return this}removeChild(t,e={}){const n=this.getChildIndex(t);return this.removeChildAt(n,e)}removeChildAt(t,e={}){const n=this.getChildAt(t);return null!=this.children&&null!=n&&(this.unembed(n,e),n.remove(e)),n}remove(t={}){return this.batchUpdate("remove",(()=>{const e=this.getParent();e&&e.removeChild(this,t),!1!==t.deep&&this.eachChild((e=>e.remove(t))),this.model&&this.model.removeCell(this,t)})),this}transition(t,e,n={},r="/"){return this.animation.start(t,e,n,r)}stopTransition(t,e,n="/"){return this.animation.stop(t,e,n),this}getTransitions(){return this.animation.get()}translate(t,e,n){return this}scale(t,e,n,r){return this}addTools(t,e,n){const r=Array.isArray(t)?t:[t],i="string"==typeof e?e:null,o="object"==typeof e?e:"object"==typeof n?n:{};if(o.reset)return this.setTools({name:i,items:r,local:o.local},o);let s=cloneDeep(this.getTools());return null==s||null==i||s.name===i?(null==s&&(s={}),s.items||(s.items=[]),s.name=i,s.items=[...s.items,...r],this.setTools(Object.assign({},s),o)):void 0}setTools(t,e={}){return null==t?this.removeTools():this.store.set("tools",Cell.normalizeTools(t),e),this}getTools(){return this.store.get("tools")}removeTools(t={}){return this.store.remove("tools",t),this}hasTools(t){const e=this.getTools();return null!=e&&(null==t||e.name===t)}hasTool(t){const e=this.getTools();return null!=e&&e.items.some((e=>"string"==typeof e?e===t:e.name===t))}removeTool(t,e={}){const n=cloneDeep(this.getTools());if(n){let r=!1;const i=n.items.slice(),o=t=>{i.splice(t,1),r=!0};if("number"==typeof t)o(t);else for(let e=i.length-1;e>=0;e-=1){const n=i[e];("string"==typeof n?n===t:n.name===t)&&o(e)}r&&(n.items=i,this.setTools(n,e))}return this}getBBox(t){return new Rectangle}getConnectionPoint(t,e){return new Point}toJSON(t={}){const e=Object.assign({},this.store.get()),n=Object.prototype.toString,r=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!e.shape){const t=this.constructor;throw new Error(`Unable to serialize ${r} missing "shape" prop, check the ${r} "${t.name||n.call(t)}"`)}const i=!0===t.diff,o=e.attrs||{},s=this.constructor.getDefaults(!0),a=i?this.preprocess(s,!0):s,l=a.attrs||{},c={};Object.keys(e).forEach((t=>{const o=e[t];if(null!=o&&!Array.isArray(o)&&"object"==typeof o&&!isPlainObject(o))throw new Error(`Can only serialize ${r} with plain-object props, but got a "${n.call(o)}" type of key "${t}" on ${r} "${this.id}"`);"attrs"!==t&&"shape"!==t&&i&&isEqual(o,a[t])&&delete e[t]})),Object.keys(o).forEach((t=>{const e=o[t],n=l[t];Object.keys(e).forEach((r=>{const i=e[r],o=n?n[r]:null;null==i||"object"!=typeof i||Array.isArray(i)?null!=n&&isEqual(o,i)||(null==c[t]&&(c[t]={}),c[t][r]=i):Object.keys(i).forEach((e=>{const s=i[e];null!=n&&null!=o&&isObject(o)&&isEqual(o[e],s)||(null==c[t]&&(c[t]={}),null==c[t][r]&&(c[t][r]={}),c[t][r][e]=s)}))}))}));const u=Object.assign(Object.assign({},e),{attrs:isEmpty(c)?void 0:c});null==u.attrs&&delete u.attrs;const h=u;return 0===h.angle&&delete h.angle,cloneDeep(h)}clone(t={}){if(!t.deep){const e=Object.assign({},this.store.get());return t.keepId||delete e.id,delete e.parent,delete e.children,new(0,this.constructor)(e)}return Cell.deepClone(this)[this.id]}findView(t){return t.renderer.findViewByCell(this)}startBatch(t,e={},n=this.model){return this.notify("batch:start",{name:t,data:e,cell:this}),n&&n.startBatch(t,Object.assign(Object.assign({},e),{cell:this})),this}stopBatch(t,e={},n=this.model){return n&&n.stopBatch(t,Object.assign(Object.assign({},e),{cell:this})),this.notify("batch:stop",{name:t,data:e,cell:this}),this}batchUpdate(t,e,n){const r=this.model;this.startBatch(t,n,r);const i=e();return this.stopBatch(t,n,r),i}dispose(){this.removeFromParent(),this.store.dispose()}}Cell.defaults={},Cell.attrHooks={},Cell.propHooks=[],__decorate$r([Basecoat.dispose()],Cell.prototype,"dispose",null),(Cell||(Cell={})).normalizeTools=function(t){return"string"==typeof t?{items:[t]}:Array.isArray(t)?{items:t}:t.items?t:{items:[t]}},function(t){t.toStringTag=`X6.${t.name}`,t.isCell=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.isNode&&"function"==typeof e.isEdge&&"function"==typeof e.prop&&"function"==typeof e.attr}}(Cell||(Cell={})),function(t){t.getCommonAncestor=function(...t){const e=t.filter((t=>null!=t)).map((t=>t.getAncestors())).sort(((t,e)=>t.length-e.length));return e.shift().find((t=>e.every((e=>e.includes(t)))))||null},t.getCellsBBox=function(t,e={}){let n=null;for(let r=0,i=t.length;r<i;r+=1){const i=t[r];let o=i.getBBox(e);if(o){if(i.isNode()){const t=i.getAngle();null!=t&&0!==t&&(o=o.bbox(t))}n=null==n?o:n.union(o)}}return n},t.deepClone=function(e){const n=[e,...e.getDescendants({deep:!0})];return t.cloneCells(n)},t.cloneCells=function(t){const e=uniq(t),n=e.reduce(((t,e)=>(t[e.id]=e.clone(),t)),{});return e.forEach((t=>{const e=n[t.id];if(e.isEdge()){const t=e.getSourceCellId(),r=e.getTargetCellId();t&&n[t]&&e.setSource(Object.assign(Object.assign({},e.getSource()),{cell:n[t].id})),r&&n[r]&&e.setTarget(Object.assign(Object.assign({},e.getTarget()),{cell:n[r].id}))}const r=t.getParent();r&&n[r.id]&&e.setParent(n[r.id]);const i=t.getChildren();if(i&&i.length){const t=i.reduce(((t,e)=>(n[e.id]&&t.push(n[e.id]),t)),[]);t.length>0&&e.setChildren(t)}})),n}}(Cell||(Cell={})),function(t){t.config({propHooks(e){var{tools:n}=e,r=__rest$j(e,["tools"]);return n&&(r.tools=t.normalizeTools(n)),r}})}(Cell||(Cell={})),function(t){let e,n;t.exist=function(t,r){return r?null!=e&&e.exist(t):null!=n&&n.exist(t)},t.setEdgeRegistry=function(t){e=t},t.setNodeRegistry=function(t){n=t}}(ShareRegistry||(ShareRegistry={}));class PortManager{constructor(t){this.ports=[],this.groups={},this.init(cloneDeep(t))}getPorts(){return this.ports}getGroup(t){return null!=t?this.groups[t]:null}getPortsByGroup(t){return this.ports.filter((e=>e.group===t||null==e.group&&null==t))}getPortsLayoutByGroup(t,e){const n=this.getPortsByGroup(t),r=t?this.getGroup(t):null,i=r?r.position:null,o=i?i.name:null;let s;if(null!=o){const t=PortLayout.registry.get(o);if(null==t)return PortLayout.registry.onNotFound(o);s=t}else s=PortLayout.presets.left;return s(n.map((t=>t&&t.position&&t.position.args||{})),e,i&&i.args||{}).map(((t,r)=>{const i=n[r];return{portLayout:t,portId:i.id,portSize:i.size,portAttrs:i.attrs,labelSize:i.label.size,labelLayout:this.getPortLabelLayout(i,Point.create(t.position),e)}}))}init(t){const{groups:e,items:n}=t;null!=e&&Object.keys(e).forEach((t=>{this.groups[t]=this.parseGroup(e[t])})),Array.isArray(n)&&n.forEach((t=>{this.ports.push(this.parsePort(t))}))}parseGroup(t){return Object.assign(Object.assign({},t),{label:this.getLabel(t,!0),position:this.getPortPosition(t.position,!0)})}parsePort(t){const e=Object.assign({},t),n=this.getGroup(t.group)||{};return e.markup=e.markup||n.markup,e.attrs=merge({},n.attrs,e.attrs),e.position=this.createPosition(n,e),e.label=merge({},n.label,this.getLabel(e)),e.zIndex=this.getZIndex(n,e),e.size=Object.assign(Object.assign({},n.size),e.size),e}getZIndex(t,e){return"number"==typeof e.zIndex?e.zIndex:"number"==typeof t.zIndex||"auto"===t.zIndex?t.zIndex:"auto"}createPosition(t,e){return merge({name:"left",args:{}},t.position,{args:e.args})}getPortPosition(t,e=!1){if(null==t){if(e)return{name:"left",args:{}}}else{if("string"==typeof t)return{name:t,args:{}};if(Array.isArray(t))return{name:"absolute",args:{x:t[0],y:t[1]}};if("object"==typeof t)return t}return{args:{}}}getPortLabelPosition(t,e=!1){if(null==t){if(e)return{name:"left",args:{}}}else{if("string"==typeof t)return{name:t,args:{}};if("object"==typeof t)return t}return{args:{}}}getLabel(t,e=!1){const n=t.label||{};return n.position=this.getPortLabelPosition(n.position,e),n}getPortLabelLayout(t,e,n){const r=t.label.position.args||{},i=PortLabelLayout.registry.get(t.label.position.name||"left")||PortLabelLayout.presets.left;return i?i(e,n,r):null}}var __rest$i=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Node$1 extends Cell{constructor(t={}){super(t),this.initPorts()}get[Symbol.toStringTag](){return Node$1.toStringTag}preprocess(t,e){const{x:n,y:r,width:i,height:o}=t,s=__rest$i(t,["x","y","width","height"]);if(null!=n||null!=r){const t=s.position;s.position=Object.assign(Object.assign({},t),{x:null!=n?n:t?t.x:0,y:null!=r?r:t?t.y:0})}if(null!=i||null!=o){const t=s.size;s.size=Object.assign(Object.assign({},t),{width:null!=i?i:t?t.width:0,height:null!=o?o:t?t.height:0})}return super.preprocess(s,e)}isNode(){return!0}size(t,e,n){return void 0===t?this.getSize():"number"==typeof t?this.setSize(t,e,n):this.setSize(t,e)}getSize(){const t=this.store.get("size");return t?Object.assign({},t):{width:1,height:1}}setSize(t,e,n){return"object"==typeof t?this.resize(t.width,t.height,e):this.resize(t,e,n),this}resize(t,e,n={}){this.startBatch("resize",n);const r=n.direction;if(r){const i=this.getSize();switch(r){case"left":case"right":e=i.height;break;case"top":case"bottom":t=i.width}let o={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[r];const s=Angle.normalize(this.getAngle()||0);n.absolute&&(o+=Math.floor((s+45)/90),o%=4);const a=this.getBBox();let l;l=0===o?a.getBottomLeft():1===o?a.getCorner():2===o?a.getTopRight():a.getOrigin();const c=l.clone().rotate(-s,a.getCenter()),u=Math.sqrt(t*t+e*e)/2;let h=o*Math.PI/2;h+=Math.atan(o%2==0?e/t:t/e),h-=Angle.toRad(s);const d=Point.fromPolar(u,h,c).clone().translate(t/-2,e/-2);this.store.set("size",{width:t,height:e},n),this.setPosition(d.x,d.y,n)}else this.store.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this}scale(t,e,n,r={}){const i=this.getBBox().scale(t,e,null==n?void 0:n);return this.startBatch("scale",r),this.setPosition(i.x,i.y,r),this.resize(i.width,i.height,r),this.stopBatch("scale"),this}position(t,e,n){return"number"==typeof t?this.setPosition(t,e,n):this.getPosition(t)}getPosition(t={}){if(t.relative){const t=this.getParent();if(null!=t&&t.isNode()){const e=this.getPosition(),n=t.getPosition();return{x:e.x-n.x,y:e.y-n.y}}}const e=this.store.get("position");return e?Object.assign({},e):{x:0,y:0}}setPosition(t,e,n={}){let r,i,o;if("object"==typeof t?(r=t.x,i=t.y,o=e||{}):(r=t,i=e,o=n||{}),o.relative){const t=this.getParent();if(null!=t&&t.isNode()){const e=t.getPosition();r+=e.x,i+=e.y}}if(o.deep){const t=this.getPosition();this.translate(r-t.x,i-t.y,o)}else this.store.set("position",{x:r,y:i},o);return this}translate(t=0,e=0,n={}){if(0===t&&0===e)return this;n.translateBy=n.translateBy||this.id;const r=this.getPosition();if(null!=n.restrict&&n.translateBy===this.id){const i=this.getBBox({deep:!0}),o=n.restrict,s=r.x-i.x,a=r.y-i.y,l=Math.max(o.x+s,Math.min(o.x+o.width+s-i.width,r.x+t)),c=Math.max(o.y+a,Math.min(o.y+o.height+a-i.height,r.y+e));t=l-r.x,e=c-r.y}const i={x:r.x+t,y:r.y+e};return n.tx=t,n.ty=e,n.transition?("object"!=typeof n.transition&&(n.transition={}),this.transition("position",i,Object.assign(Object.assign({},n.transition),{interp:Interp.object})),this.eachChild((r=>{var i;(null===(i=n.exclude)||void 0===i?void 0:i.includes(r))||r.translate(t,e,n)}))):(this.startBatch("translate",n),this.store.set("position",i,n),this.eachChild((r=>{var i;(null===(i=n.exclude)||void 0===i?void 0:i.includes(r))||r.translate(t,e,n)})),this.stopBatch("translate",n)),this}angle(t,e){return null==t?this.getAngle():this.rotate(t,e)}getAngle(){return this.store.get("angle",0)}rotate(t,e={}){const n=this.getAngle();if(e.center){const r=this.getSize(),i=this.getPosition(),o=this.getBBox().getCenter();o.rotate(n-t,e.center);const s=o.x-r.width/2-i.x,a=o.y-r.height/2-i.y;this.startBatch("rotate",{angle:t,options:e}),this.setPosition(i.x+s,i.y+a,e),this.rotate(t,Object.assign(Object.assign({},e),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",e.absolute?t:(n+t)%360,e);return this}getBBox(t={}){if(t.deep){const t=this.getDescendants({deep:!0,breadthFirst:!0});return t.push(this),Cell.getCellsBBox(t)}return Rectangle.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(t,e){const n=this.getBBox(),r=n.getCenter(),i=t.getTerminal(e);if(null==i)return r;const o=i.port;if(!o||!this.hasPort(o))return r;const s=this.getPort(o);if(!s||!s.group)return r;const a=this.getPortsPosition(s.group),l=Point.create(a[o].position).translate(n.getOrigin()),c=this.getAngle();return c&&l.rotate(-c,r),l}fit(t={}){const e=(this.getChildren()||[]).filter((t=>t.isNode()));if(0===e.length)return this;this.startBatch("fit-embeds",t),t.deep&&e.forEach((e=>e.fit(t)));let{x:n,y:r,width:i,height:o}=Cell.getCellsBBox(e);const s=normalizeSides(t.padding);return n-=s.left,r-=s.top,i+=s.left+s.right,o+=s.bottom+s.top,this.store.set({position:{x:n,y:r},size:{width:i,height:o}},t),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(t){this.setPortContainerMarkup(t)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||Markup.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(t,e={}){return this.store.set("portContainerMarkup",Markup.clone(t),e),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(t){this.setPortMarkup(t)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||Markup.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(t,e={}){return this.store.set("portMarkup",Markup.clone(t),e),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(t){this.setPortLabelMarkup(t)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||Markup.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(t,e={}){return this.store.set("portLabelMarkup",Markup.clone(t),e),this}get ports(){const t=this.store.get("ports",{items:[]});return null==t.items&&(t.items=[]),t}getPorts(){return cloneDeep(this.ports.items)}getPortsByGroup(t){return this.getPorts().filter((e=>e.group===t))}getPort(t){return cloneDeep(this.ports.items.find((e=>e.id&&e.id===t)))}getPortAt(t){return this.ports.items[t]||null}hasPorts(){return this.ports.items.length>0}hasPort(t){return-1!==this.getPortIndex(t)}getPortIndex(t){const e="string"==typeof t?t:t.id;return null!=e?this.ports.items.findIndex((t=>t.id===e)):-1}getPortsPosition(t){const e=this.getSize();return this.port.getPortsLayoutByGroup(t,new Rectangle(0,0,e.width,e.height)).reduce(((t,e)=>{const n=e.portLayout;return t[e.portId]={position:Object.assign({},n.position),angle:n.angle||0},t}),{})}getPortProp(t,e){return this.getPropByPath(this.prefixPortPath(t,e))}setPortProp(t,e,n,r){if("string"==typeof e||Array.isArray(e)){const i=this.prefixPortPath(t,e);return this.setPropByPath(i,n,r)}const i=this.prefixPortPath(t);return this.setPropByPath(i,e,n)}removePortProp(t,e,n){return"string"==typeof e||Array.isArray(e)?this.removePropByPath(this.prefixPortPath(t,e),n):this.removePropByPath(this.prefixPortPath(t),e)}portProp(t,e,n,r){return null==e?this.getPortProp(t):"string"==typeof e||Array.isArray(e)?2===arguments.length?this.getPortProp(t,e):null==n?this.removePortProp(t,e,r):this.setPortProp(t,e,n,r):this.setPortProp(t,e,n)}prefixPortPath(t,e){const n=this.getPortIndex(t);if(-1===n)throw new Error(`Unable to find port with id: "${t}"`);return null==e||""===e?["ports","items",`${n}`]:Array.isArray(e)?["ports","items",`${n}`,...e]:`ports/items/${n}/${e}`}addPort(t,e){const n=[...this.ports.items];return n.push(t),this.setPropByPath("ports/items",n,e),this}addPorts(t,e){return this.setPropByPath("ports/items",[...this.ports.items,...t],e),this}insertPort(t,e,n){const r=[...this.ports.items];return r.splice(t,0,e),this.setPropByPath("ports/items",r,n),this}removePort(t,e={}){return this.removePortAt(this.getPortIndex(t),e)}removePortAt(t,e={}){if(t>=0){const n=[...this.ports.items];n.splice(t,1),e.rewrite=!0,this.setPropByPath("ports/items",n,e)}return this}removePorts(t,e){let n;if(Array.isArray(t)){if(n=e||{},t.length){n.rewrite=!0;const e=[...this.ports.items].filter((e=>!t.some((t=>e.id===("string"==typeof t?t:t.id)))));this.setPropByPath("ports/items",e,n)}}else n=t||{},n.rewrite=!0,this.setPropByPath("ports/items",[],n);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(t,e){return this.port.getPortsLayoutByGroup(t,e)}initPorts(){this.updatePortData(),this.on("change:ports",(()=>{this.processRemovedPort(),this.updatePortData()}))}processRemovedPort(){const t={};this.ports.items.forEach((e=>{e.id&&(t[e.id]=!0)}));const e={};(this.store.getPrevious("ports")||{items:[]}).items.forEach((n=>{n.id&&!t[n.id]&&(e[n.id]=!0)}));const n=this.model;n&&!isEmpty(e)&&(n.getConnectedEdges(this,{incoming:!0}).forEach((t=>{const n=t.getTargetPortId();n&&e[n]&&t.remove()})),n.getConnectedEdges(this,{outgoing:!0}).forEach((t=>{const n=t.getSourcePortId();n&&e[n]&&t.remove()})))}validatePorts(){const t={},e=[];return this.ports.items.forEach((n=>{"object"!=typeof n&&e.push(`Invalid port ${n}.`),null==n.id&&(n.id=this.generatePortId()),t[n.id]&&e.push("Duplicitied port id."),t[n.id]=!0})),e}generatePortId(){return uuid()}updatePortData(){const t=this.validatePorts();if(t.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(t.join(" "));const e=this.port?this.port.getPorts():null;this.port=new PortManager(this.ports);const n=this.port.getPorts(),r=e?n.filter((t=>e.find((e=>e.id===t.id))?null:t)):[...n],i=e?e.filter((t=>n.find((e=>e.id===t.id))?null:t)):[];r.length>0&&this.notify("ports:added",{added:r,cell:this,node:this}),i.length>0&&this.notify("ports:removed",{removed:i,cell:this,node:this})}}Node$1.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(t){t.toStringTag=`X6.${t.name}`,t.isNode=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.isNode&&"function"==typeof e.isEdge&&"function"==typeof e.prop&&"function"==typeof e.attr&&"function"==typeof e.size&&"function"==typeof e.position}}(Node$1||(Node$1={})),(Node$1||(Node$1={})).config({propHooks(t){var{ports:e}=t,n=__rest$i(t,["ports"]);return e&&(n.ports=Array.isArray(e)?{items:e}:e),n}}),function(t){t.registry=Registry.create({type:"node",process(e,n){if(ShareRegistry.exist(e,!0))throw new Error(`Node with name '${e}' was registered by anthor Edge`);if("function"==typeof n)return n.config({shape:e}),n;let r=t;const{inherit:i}=n,o=__rest$i(n,["inherit"]);if(i)if("string"==typeof i){const t=this.get(i);null==t?this.onNotFound(i,"inherited"):r=t}else r=i;null==o.constructorName&&(o.constructorName=e);const s=r.define.call(r,o);return s.config({shape:e}),s}}),ShareRegistry.setNodeRegistry(t.registry)}(Node$1||(Node$1={})),function(t){let e=0;t.define=function(n){const{constructorName:r,overwrite:i}=n,o=__rest$i(n,["constructorName","overwrite"]),s=createClass((a=r||o.shape)?pascalCase(a):(e+=1,`CustomNode${e}`),this);var a;return s.config(o),o.shape&&t.registry.register(o.shape,s,i),s},t.create=function(e){const n=e.shape||"rect",r=t.registry.get(n);return r?new r(e):t.registry.onNotFound(n)}}(Node$1||(Node$1={}));var __rest$h=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Base$1 extends Node$1{get label(){return this.getLabel()}set label(t){this.setLabel(t)}getLabel(){return this.getAttrByPath("text/text")}setLabel(t,e){return null==t?this.removeLabel():this.setAttrByPath("text/text",t,e),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}!function(t){t.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},t.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},t.config({attrs:{text:Object.assign({},t.labelAttr)},propHooks(t){const{label:e}=t,n=__rest$h(t,["label"]);return e&&setByPath(n,"attrs/text/text",e),n},visible:!0})}(Base$1||(Base$1={}));var __rest$g=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function getMarkup$1(t,e=!1){return`<g class="rotatable"><g class="scalable"><${t}/></g>${e?"":"<text/>"}</g>`}function getName(t){return`basic.${t}`}function getImageUrlHook(t="xlink:href"){return e=>{const{imageUrl:n,imageWidth:r,imageHeight:i}=e,o=__rest$g(e,["imageUrl","imageWidth","imageHeight"]);if(null!=n||null!=r||null!=i){const e=()=>{if(o.attrs){const e=o.attrs.image;null!=n&&(e[t]=n),null!=r&&(e.width=r),null!=i&&(e.height=i),o.attrs.image=e}};o.attrs?(null==o.attrs.image&&(o.attrs.image={}),e()):(o.attrs={image:{}},e())}return o}}function createShape$1(t,e,n={}){const r=getName(t),i={constructorName:r,attrs:{".":{fill:"#ffffff",stroke:"none"},[t]:{fill:"#ffffff",stroke:"#000000"}}};return n.ignoreMarkup||(i.markup=getMarkup$1(t,!0===n.noText)),(n.parent||Base$1).define(merge(i,e,{shape:r}))}createShape$1("rect",{attrs:{rect:{width:100,height:60}}}),createShape$1("circle",{width:60,height:60,attrs:{circle:{r:30,cx:30,cy:30}}}),createShape$1("ellipse",{width:60,height:40,attrs:{ellipse:{rx:30,ry:20,cx:30,cy:20}}}),createShape$1("polygon",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),createShape$1("polyline",{width:60,height:40,attrs:{text:{refY:null,refDy:16}}}),createShape$1("image",{attrs:{text:{refY:null,refDy:16}},propHooks:getImageUrlHook()});var __rest$f=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Path=createShape$1("path",{width:60,height:60,attrs:{text:{ref:"path",refY:null,refDy:16}},propHooks(t){const{d:e}=t,n=__rest$f(t,["d"]);return null!=e&&setByPath(n,"attrs/path/d",e),n}});createShape$1("rhombus",{d:"M 30 0 L 60 30 30 60 0 30 z",attrs:{text:{refY:.5,refDy:null}}},{parent:Path,ignoreMarkup:!0}),createShape$1("cylinder",{width:40,height:40,attrs:{path:{fill:"#FFFFFF",stroke:"#cbd2d7",strokeWidth:3,d:["M 0 10 C 10 5, 30 5, 40 10 C 30 15, 10 15, 0 10","L 0 20","C 10 25, 30 25, 40 20","L 40 10"].join(" ")},text:{refY:.7,refDy:null,fill:"#435460"}}},{parent:Path,ignoreMarkup:!0});var __rest$e=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Edge$1 extends Cell{constructor(t={}){super(t)}get[Symbol.toStringTag](){return Edge$1.toStringTag}preprocess(t,e){const{source:n,sourceCell:r,sourcePort:i,sourcePoint:o,target:s,targetCell:a,targetPort:l,targetPoint:c}=t,u=__rest$e(t,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),h=t=>"string"==typeof t||"number"==typeof t;if(null!=n)if(Cell.isCell(n))u.source={cell:n.id};else if(h(n))u.source={cell:n};else if(Point.isPoint(n))u.source=n.toJSON();else if(Array.isArray(n))u.source={x:n[0],y:n[1]};else{const t=n.cell;u.source=Cell.isCell(t)?Object.assign(Object.assign({},n),{cell:t.id}):n}if(null!=r||null!=i){let t=u.source;if(null!=r){const e=h(r)?r:r.id;t?t.cell=e:t=u.source={cell:e}}null!=i&&t&&(t.port=i)}else null!=o&&(u.source=Point.create(o).toJSON());if(null!=s)if(Cell.isCell(s))u.target={cell:s.id};else if(h(s))u.target={cell:s};else if(Point.isPoint(s))u.target=s.toJSON();else if(Array.isArray(s))u.target={x:s[0],y:s[1]};else{const t=s.cell;u.target=Cell.isCell(t)?Object.assign(Object.assign({},s),{cell:t.id}):s}if(null!=a||null!=l){let t=u.target;if(null!=a){const e=h(a)?a:a.id;t?t.cell=e:t=u.target={cell:e}}null!=l&&t&&(t.port=l)}else null!=c&&(u.target=Point.create(c).toJSON());return super.preprocess(u,e)}setup(){super.setup(),this.on("change:labels",(t=>this.onLabelsChanged(t))),this.on("change:vertices",(t=>this.onVertexsChanged(t)))}isEdge(){return!0}disconnect(t={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},t),this}get source(){return this.getSource()}set source(t){this.setSource(t)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(t,e,n={}){return this.setTerminal("source",t,e,n)}get target(){return this.getTarget()}set target(t){this.setTarget(t)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(t,e,n={}){return this.setTerminal("target",t,e,n)}getTerminal(t){return Object.assign({},this.store.get(t))}setTerminal(t,e,n,r={}){if(Cell.isCell(e))return this.store.set(t,merge({},n,{cell:e.id}),r),this;const i=e;return Point.isPoint(e)||null!=i.x&&null!=i.y?(this.store.set(t,merge({},n,{x:i.x,y:i.y}),r),this):(this.store.set(t,cloneDeep(e),r),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(t){const e=this[t];if(Point.isPointLike(e))return Point.create(e);const n=this.getTerminalCell(t);return n?n.getConnectionPoint(this,t):new Point}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(t){if(this.model){const e="source"===t?this.getSourceCellId():this.getTargetCellId();if(e)return this.model.getCell(e)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(t){let e=this;const n={};for(;e&&e.isEdge();){if(n[e.id])return null;n[e.id]=!0,e=e.getTerminalCell(t)}return e&&e.isNode()?e:null}get router(){return this.getRouter()}set router(t){null==t?this.removeRouter():this.setRouter(t)}getRouter(){return this.store.get("router")}setRouter(t,e,n){return"object"==typeof t?this.store.set("router",t,e):this.store.set("router",{name:t,args:e},n),this}removeRouter(t={}){return this.store.remove("router",t),this}get connector(){return this.getConnector()}set connector(t){null==t?this.removeConnector():this.setConnector(t)}getConnector(){return this.store.get("connector")}setConnector(t,e,n){return"object"==typeof t?this.store.set("connector",t,e):this.store.set("connector",{name:t,args:e},n),this}removeConnector(t={}){return this.store.remove("connector",t)}get strategy(){return this.getStrategy()}set strategy(t){null==t?this.removeStrategy():this.setStrategy(t)}getStrategy(){return this.store.get("strategy")}setStrategy(t,e,n){return"object"==typeof t?this.store.set("strategy",t,e):this.store.set("strategy",{name:t,args:e},n),this}removeStrategy(t={}){return this.store.remove("strategy",t)}getDefaultLabel(){const t=this.constructor;return cloneDeep(this.store.get("defaultLabel")||t.defaultLabel||{})}get labels(){return this.getLabels()}set labels(t){this.setLabels(t)}getLabels(){return[...this.store.get("labels",[])].map((t=>this.parseLabel(t)))}setLabels(t,e={}){return this.store.set("labels",Array.isArray(t)?t:[t],e),this}insertLabel(t,e,n={}){const r=this.getLabels(),i=r.length;let o=null!=e&&Number.isFinite(e)?e:i;return o<0&&(o=i+o+1),r.splice(o,0,this.parseLabel(t)),this.setLabels(r,n)}appendLabel(t,e={}){return this.insertLabel(t,-1,e)}getLabelAt(t){const e=this.getLabels();return null!=t&&Number.isFinite(t)?this.parseLabel(e[t]):null}setLabelAt(t,e,n={}){if(null!=t&&Number.isFinite(t)){const r=this.getLabels();r[t]=this.parseLabel(e),this.setLabels(r,n)}return this}removeLabelAt(t,e={}){const n=this.getLabels(),r=null!=t&&Number.isFinite(t)?t:-1,i=n.splice(r,1);return this.setLabels(n,e),i.length?i[0]:null}parseLabel(t){return"string"==typeof t?this.constructor.parseStringLabel(t):t}onLabelsChanged({previous:t,current:e}){const n=t&&e?e.filter((e=>t.find((t=>e===t||isEqual(e,t)))?null:e)):e?[...e]:[],r=t&&e?t.filter((t=>e.find((e=>t===e||isEqual(t,e)))?null:t)):t?[...t]:[];n.length>0&&this.notify("labels:added",{added:n,cell:this,edge:this}),r.length>0&&this.notify("labels:removed",{removed:r,cell:this,edge:this})}get vertexMarkup(){return this.getVertexMarkup()}set vertexMarkup(t){this.setVertexMarkup(t)}getDefaultVertexMarkup(){return this.store.get("defaultVertexMarkup")||Markup.getEdgeVertexMarkup()}getVertexMarkup(){return this.store.get("vertexMarkup")||this.getDefaultVertexMarkup()}setVertexMarkup(t,e={}){return this.store.set("vertexMarkup",Markup.clone(t),e),this}get vertices(){return this.getVertices()}set vertices(t){this.setVertices(t)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(t,e={}){const n=Array.isArray(t)?t:[t];return this.store.set("vertices",n.map((t=>Point.toJSON(t))),e),this}insertVertex(t,e,n={}){const r=this.getVertices(),i=r.length;let o=null!=e&&Number.isFinite(e)?e:i;return o<0&&(o=i+o+1),r.splice(o,0,Point.toJSON(t)),this.setVertices(r,n)}appendVertex(t,e={}){return this.insertVertex(t,-1,e)}getVertexAt(t){return null!=t&&Number.isFinite(t)?this.getVertices()[t]:null}setVertexAt(t,e,n={}){if(null!=t&&Number.isFinite(t)){const r=this.getVertices();r[t]=e,this.setVertices(r,n)}return this}removeVertexAt(t,e={}){const n=this.getVertices(),r=null!=t&&Number.isFinite(t)?t:-1;return n.splice(r,1),this.setVertices(n,e)}onVertexsChanged({previous:t,current:e}){const n=t&&e?e.filter((e=>t.find((t=>Point.equals(e,t)))?null:e)):e?[...e]:[],r=t&&e?t.filter((t=>e.find((e=>Point.equals(t,e)))?null:t)):t?[...t]:[];n.length>0&&this.notify("vertexs:added",{added:n,cell:this,edge:this}),r.length>0&&this.notify("vertexs:removed",{removed:r,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||Markup.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}get toolMarkup(){return this.getToolMarkup()}set toolMarkup(t){this.setToolMarkup(t)}getDefaultToolMarkup(){return this.store.get("defaultToolMarkup")||Markup.getEdgeToolMarkup()}getToolMarkup(){return this.store.get("toolMarkup")||this.getDefaultToolMarkup()}setToolMarkup(t,e={}){return this.store.set("toolMarkup",t,e),this}get doubleToolMarkup(){return this.getDoubleToolMarkup()}set doubleToolMarkup(t){this.setDoubleToolMarkup(t)}getDefaultDoubleToolMarkup(){return this.store.get("defaultDoubleToolMarkup")}getDoubleToolMarkup(){return this.store.get("doubleToolMarkup")||this.getDefaultDoubleToolMarkup()}setDoubleToolMarkup(t,e={}){return this.store.set("doubleToolMarkup",t,e),this}get arrowheadMarkup(){return this.getArrowheadMarkup()}set arrowheadMarkup(t){this.setArrowheadMarkup(t)}getDefaultArrowheadMarkup(){return this.store.get("defaultArrowheadMarkup")||Markup.getEdgeArrowheadMarkup()}getArrowheadMarkup(){return this.store.get("arrowheadMarkup")||this.getDefaultArrowheadMarkup()}setArrowheadMarkup(t,e={}){return this.store.set("arrowheadMarkup",t,e),this}translate(t,e,n={}){return n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints((n=>({x:(n.x||0)+t,y:(n.y||0)+e})),n)}scale(t,e,n,r={}){return this.applyToPoints((r=>Point.create(r).scale(t,e,n).toJSON()),r)}applyToPoints(t,e={}){const n={},r=this.getSource(),i=this.getTarget();Point.isPointLike(r)&&(n.source=t(r)),Point.isPointLike(i)&&(n.target=t(i));const o=this.getVertices();return o.length>0&&(n.vertices=o.map(t)),this.store.set(n,e),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const t=[this.getSourcePoint(),...this.getVertices().map((t=>Point.create(t))),this.getTargetPoint()];return new Polyline(t)}updateParent(t){let e=null;const n=this.getSourceCell(),r=this.getTargetCell(),i=this.getParent();return n&&r&&(e=n===r||n.isDescendantOf(r)?r:r.isDescendantOf(n)?n:Cell.getCommonAncestor(n,r)),!i||e&&e.id===i.id||i.unembed(this,t),e&&e.embed(this,t),e}hasLoop(t={}){const e=this.getSource(),n=this.getTarget(),r=e.cell,i=n.cell;if(!r||!i)return!1;let o=r===i;if(!o&&t.deep&&this._model){const e=this.getSourceCell(),n=this.getTargetCell();e&&n&&(o=e.isAncestorOf(n,t)||n.isAncestorOf(e,t))}return o}getFragmentAncestor(){const t=[this,this.getSourceNode(),this.getTargetNode()].filter((t=>null!=t));return this.getCommonAncestor(...t)}isFragmentDescendantOf(t){const e=this.getFragmentAncestor();return!!e&&(e.id===t.id||e.isDescendantOf(t))}}Edge$1.defaults={},(Edge$1||(Edge$1={})).equalTerminals=function(t,e){return t.cell===e.cell&&(t.port===e.port||null==t.port&&null==e.port)},function(t){t.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},t.parseStringLabel=function(t){return{attrs:{label:{text:t}}}}}(Edge$1||(Edge$1={})),function(t){t.toStringTag=`X6.${t.name}`,t.isEdge=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.isNode&&"function"==typeof e.isEdge&&"function"==typeof e.prop&&"function"==typeof e.attr&&"function"==typeof e.disconnect&&"function"==typeof e.getSource&&"function"==typeof e.getTarget}}(Edge$1||(Edge$1={})),function(t){t.registry=Registry.create({type:"edge",process(e,n){if(ShareRegistry.exist(e,!1))throw new Error(`Edge with name '${e}' was registered by anthor Node`);if("function"==typeof n)return n.config({shape:e}),n;let r=t;const{inherit:i="edge"}=n,o=__rest$e(n,["inherit"]);if("string"==typeof i){const t=this.get(i||"edge");null==t&&i?this.onNotFound(i,"inherited"):r=t}else r=i;null==o.constructorName&&(o.constructorName=e);const s=r.define.call(r,o);return s.config({shape:e}),s}}),ShareRegistry.setEdgeRegistry(t.registry)}(Edge$1||(Edge$1={})),function(t){let e=0;t.define=function(n){const{constructorName:r,overwrite:i}=n,o=__rest$e(n,["constructorName","overwrite"]),s=createClass((a=r||o.shape)?pascalCase(a):(e+=1,`CustomEdge${e}`),this);var a;return s.config(o),o.shape&&t.registry.register(o.shape,s,i),s},t.create=function(e){const n=e.shape||"edge",r=t.registry.get(n);return r?new r(e):t.registry.onNotFound(n)}}(Edge$1||(Edge$1={})),function(t){const e="basic.edge";t.config({shape:e,propHooks(e){const{label:n,vertices:r}=e,i=__rest$e(e,["label","vertices"]);if(n){null==i.labels&&(i.labels=[]);const e="string"==typeof n?t.parseStringLabel(n):n;i.labels.push(e)}return r&&Array.isArray(r)&&(i.vertices=r.map((t=>Point.create(t).toJSON()))),i}}),t.registry.register(e,t)}(Edge$1||(Edge$1={}));var __rest$d=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class EdgeView extends CellView{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.markerCache={}}get[Symbol.toStringTag](){return EdgeView.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const t=this.sourceView;if(!t){const t=this.cell.getSource();return new Rectangle(t.x,t.y)}const e=this.sourceMagnet;return t.isEdgeElement(e)?new Rectangle(this.sourceAnchor.x,this.sourceAnchor.y):t.getBBoxOfElement(e||t.container)}get targetBBox(){const t=this.targetView;if(!t){const t=this.cell.getTarget();return new Rectangle(t.x,t.y)}const e=this.targetMagnet;return t.isEdgeElement(e)?new Rectangle(this.targetAnchor.x,this.targetAnchor.y):t.getBBoxOfElement(e||t.container)}isEdgeView(){return!0}confirmUpdate(t,e={}){let n=t;if(this.hasAction(n,"source")){if(!this.updateTerminalProperties("source"))return n;n=this.removeAction(n,"source")}if(this.hasAction(n,"target")){if(!this.updateTerminalProperties("target"))return n;n=this.removeAction(n,"target")}const r=this.graph,i=this.sourceView,o=this.targetView;return r&&(i&&!r.renderer.isViewMounted(i)||o&&!r.renderer.isViewMounted(o))?n:this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","vertices","labels","tools","widget"]),n):(n=this.handleAction(n,"vertices",(()=>this.renderVertexMarkers())),n=this.handleAction(n,"update",(()=>this.update(null,e))),n=this.handleAction(n,"labels",(()=>this.onLabelsChange(e))),n=this.handleAction(n,"tools",(()=>{this.renderTools(),this.updateToolsPosition()})),n=this.handleAction(n,"widget",(()=>this.renderExternalTools())),n)}onLabelsChange(t={}){this.shouldRerenderLabels(t)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(t={}){const e=this.cell.previous("labels");if(null==e)return!0;if("propertyPathArray"in t&&"propertyValue"in t){const n=t.propertyPathArray||[],r=n.length;if(r>1&&e[n[1]]){if(2===r)return"object"==typeof t.propertyValue&&has(t.propertyValue,"markup");if("markup"!==n[2])return!1}}return!0}render(){return this.empty(),this.containers={},this.renderMarkup(),this.renderLabels(),this.update(),this.renderExternalTools(),this}renderMarkup(){const t=this.cell.markup;if(t)return"string"==typeof t?this.renderStringMarkup(t):this.renderJSONMarkup(t);throw new TypeError("Invalid edge markup.")}renderJSONMarkup(t){const e=this.parseJSONMarkup(t,this.container);this.selectors=e.selectors,this.container.append(e.fragment)}renderStringMarkup(t){const e=this.containers,n=Vector.createVectors(t);n.forEach((t=>{const n=t.attr("class");n&&(e[camelCase(n)]=t.node)})),this.renderTools(),this.renderVertexMarkers(),this.renderArrowheadMarkers(),append(this.container,n.map((t=>t.node)))}renderLabels(){const t=this.cell,e=t.getLabels(),n=e.length;let r=this.containers.labels;if(this.labelCache={},this.labelSelectors={},n<=0)return r&&r.parentNode&&r.parentNode.removeChild(r),this;r?this.empty(r):(r=createSvgElement("g"),this.addClass(this.prefixClassName("edge-labels"),r),this.containers.labels=r);for(let n=0,i=e.length;n<i;n+=1){const i=this.normalizeLabelMarkup(this.parseLabelMarkup(e[n].markup));let o,s;if(i)o=i.node,s=i.selectors;else{const e=t.getDefaultLabel(),n=this.normalizeLabelMarkup(this.parseLabelMarkup(e.markup));o=n.node,s=n.selectors}o.setAttribute("data-index",`${n}`),r.appendChild(o);const a=this.rootSelector;if(s[a])throw new Error("Ambiguous label root selector.");s[a]=o,this.labelCache[n]=o,this.labelSelectors[n]=s}return null==r.parentNode&&this.container.appendChild(r),this.updateLabels(),this.customizeLabels(),this}parseLabelMarkup(t){return t?"string"==typeof t?this.parseLabelStringMarkup(t):this.parseJSONMarkup(t):null}parseLabelStringMarkup(t){const e=Vector.createVectors(t),n=document.createDocumentFragment();for(let t=0,r=e.length;t<r;t+=1)n.appendChild(e[t].node);return{fragment:n,selectors:{}}}normalizeLabelMarkup(t){if(null==t)return;const e=t.fragment;if(!(e instanceof DocumentFragment&&e.hasChildNodes()))throw new Error("Invalid label markup.");let n;const r=e.childNodes;return n=r.length>1||"G"!==r[0].nodeName.toUpperCase()?Vector.create("g").append(e):Vector.create(r[0]),n.addClass(this.prefixClassName("edge-label")),{node:n.node,selectors:t.selectors}}updateLabels(){if(this.containers.labels){const t=this.cell,e=t.labels,n=this.can("edgeLabelMovable"),r=t.getDefaultLabel();for(let t=0,i=e.length;t<i;t+=1){const i=this.labelCache[t],o=this.labelSelectors[t];i.setAttribute("cursor",n?"move":"default");const s=e[t],a=merge({},r.attrs,s.attrs);this.updateAttrs(i,a,{selectors:o,rootBBox:s.size?Rectangle.fromSize(s.size):void 0})}}}mergeLabelAttrs(t,e,n){if(null===e)return null;if(void 0===e){if(null===n)return null;if(void 0===n)return;return t?n:merge({},n)}return t?merge({},n,e):void 0}customizeLabels(){if(this.containers.labels){const t=this.cell,e=t.labels;for(let n=0,r=e.length;n<r;n+=1)this.graph.hook.onEdgeLabelRendered({edge:t,label:e[n],container:this.labelCache[n],selectors:this.labelSelectors[n]})}}renderTools(){const t=this.containers.tools;if(null==t)return this;const e=this.cell.toolMarkup,n=this.$(t).empty();if(Markup.isStringMarkup(e)){let t=template(e);const r=Vector.create(t());if(n.append(r.node),this.toolCache=r.node,this.options.doubleTools){let e;const i=this.cell.doubleToolMarkup;Markup.isStringMarkup(i)?(t=template(i),e=Vector.create(t())):e=r.clone(),n.append(e.node),this.tool2Cache=e.node}}return this}renderExternalTools(){const t=this.cell.getTools();return this.addTools(t),this}renderVertexMarkers(){const t=this.containers.vertices;if(null==t)return this;const e=this.cell.vertexMarkup,n=this.$(t).empty();if(Markup.isStringMarkup(e)){const t=template(e);this.cell.getVertices().forEach(((e,r)=>{n.append(Vector.create(t(Object.assign({index:r},e))).node)}))}return this}renderArrowheadMarkers(){const t=this.containers.arrowheads;if(null==t)return this;const e=this.cell.arrowheadMarkup,n=this.$(t).empty();if(Markup.isStringMarkup(e)){const t=template(e),r=Vector.create(t({end:"source"})).node,i=Vector.create(t({end:"target"})).node;this.containers.sourceArrowhead=r,this.containers.targetArrowhead=i,n.append(r,i)}return this}update(t,e={}){this.cleanCache(),this.updateConnection(e);const n=this.cell.getAttrs();return null!=n&&this.updateAttrs(this.container,n,{attrs:t===n?null:t,selectors:this.selectors}),this.updateConnectionPath(),this.updateLabelPositions(),this.updateToolsPosition(),this.updateArrowheadMarkers(),this.updateTools(e),this}removeRedundantLinearVertices(t={}){const e=this.cell,n=e.getVertices(),r=[this.sourceAnchor,...n,this.targetAnchor],i=r.length,o=new Polyline(r);o.simplify({threshold:.01});const s=o.points.map((t=>t.toJSON())),a=s.length;return i===a?0:(e.setVertices(s.slice(1,a-1),t),i-a)}updateConnectionPath(){const t=this.containers;if(t.connection){const e=this.getConnectionPathData();t.connection.setAttribute("d",e)}if(t.connectionWrap){const e=this.getConnectionPathData();t.connectionWrap.setAttribute("d",e)}t.sourceMarker&&t.targetMarker&&this.translateAndAutoOrientArrows(t.sourceMarker,t.targetMarker)}getTerminalView(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalAnchor(t){switch(t){case"source":return Point.create(this.sourceAnchor);case"target":return Point.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalConnectionPoint(t){switch(t){case"source":return Point.create(this.sourcePoint);case"target":return Point.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalMagnet(t,e={}){switch(t){case"source":{if(e.raw)return this.sourceMagnet;const t=this.sourceView;return t?this.sourceMagnet||t.container:null}case"target":{if(e.raw)return this.targetMagnet;const t=this.targetView;return t?this.targetMagnet||t.container:null}default:throw new Error(`Unknown terminal type '${t}'`)}}updateConnection(t={}){const e=this.cell;if(t.translateBy&&e.isFragmentDescendantOf(t.translateBy)){const e=t.tx||0,n=t.ty||0;this.routePoints=new Polyline(this.routePoints).translate(e,n).points,this.translateConnectionPoints(e,n),this.path.translate(e,n)}else{const t=e.getVertices(),n=this.findAnchors(t);this.sourceAnchor=n.source,this.targetAnchor=n.target,this.routePoints=this.findRoutePoints(t);const r=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=r.source,this.targetPoint=r.target;const i=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,i.source||this.sourcePoint,i.target||this.targetPoint)}this.cleanCache()}findAnchors(t){const e=this.cell,n=t[0],r=t[t.length-1];return e.target.priority&&!e.source.priority?this.findAnchorsOrdered("target",r,"source",n):this.findAnchorsOrdered("source",n,"target",r)}findAnchorsOrdered(t,e,n,r){let i,o;const s=this.cell,a=s[t],l=s[n],c=this.getTerminalView(t),u=this.getTerminalView(n),h=this.getTerminalMagnet(t),d=this.getTerminalMagnet(n);if(c){let n;n=e?Point.create(e):u?d:Point.create(l),i=this.getAnchor(a.anchor,c,h,n,t)}else i=Point.create(a);if(u){const t=Point.create(r||i);o=this.getAnchor(l.anchor,u,d,t,n)}else o=Point.isPointLike(l)?Point.create(l):new Point;return{[t]:i,[n]:o}}getAnchor(t,e,n,r,i){const o=e.isEdgeElement(n),s=this.graph.options.connecting;let a,l="string"==typeof t?{name:t}:t;if(!l){const t=o?("source"===i?s.sourceEdgeAnchor:s.targetEdgeAnchor)||s.edgeAnchor:("source"===i?s.sourceAnchor:s.targetAnchor)||s.anchor;l="string"==typeof t?{name:t}:t}if(!l)throw new Error("Anchor should be specified.");const c=l.name;if(o){const t=EdgeAnchor.registry.get(c);if("function"!=typeof t)return EdgeAnchor.registry.onNotFound(c);a=call(t,this,e,n,r,l.args||{},i)}else{const t=NodeAnchor.registry.get(c);if("function"!=typeof t)return NodeAnchor.registry.onNotFound(c);a=call(t,this,e,n,r,l.args||{},i)}return a?a.round(this.POINT_ROUNDING):new Point}findRoutePoints(t=[]){const e=this.graph.options.connecting.router||Router.presets.normal,n=this.cell.getRouter()||e;let r;if("function"==typeof n)r=call(n,this,t,{},this);else{const e="string"==typeof n?n:n.name,i="string"==typeof n?{}:n.args||{},o=e?Router.registry.get(e):Router.presets.normal;if("function"!=typeof o)return Router.registry.onNotFound(e);r=call(o,this,t,i,this)}return null==r?t.map((t=>Point.create(t))):r.map((t=>Point.create(t)))}findConnectionPoints(t,e,n){const r=this.cell,i=this.graph.options.connecting,o=r.getSource(),s=r.getTarget(),a=this.sourceView,l=this.targetView,c=t[0],u=t[t.length-1];let h,d;if(a&&!a.isEdgeElement(this.sourceMagnet)){const t=this.sourceMagnet||a.container,r=new Line(c||n,e);h=this.getConnectionPoint(o.connectionPoint||i.sourceConnectionPoint||i.connectionPoint,a,t,r,"source")}else h=e;if(l&&!l.isEdgeElement(this.targetMagnet)){const t=this.targetMagnet||l.container,r=s.connectionPoint||i.targetConnectionPoint||i.connectionPoint,o=new Line(u||e,n);d=this.getConnectionPoint(r,l,t,o,"target")}else d=n;return{source:h,target:d}}getConnectionPoint(t,e,n,r,i){const o=r.end;if(null==t)return o;const s="string"==typeof t?t:t.name,a="string"==typeof t?{}:t.args,l=ConnectionPoint.registry.get(s);if("function"!=typeof l)return ConnectionPoint.registry.onNotFound(s);const c=call(l,this,r,e,n,a||{},i);return c?c.round(this.POINT_ROUNDING):o}updateMarkerAttr(t){const e=this.cell.getAttrs(),n=`.${t}-marker`,r=e&&e[n];r&&this.updateAttrs(this.container,{},{attrs:{[n]:r},selectors:this.selectors})}findMarkerPoints(t,e,n){const r=t=>{const e=this.cell.getAttrs(),n=Object.keys(e);for(let r=0,i=n.length;r<i;r+=1){const i=e[n[r]];if(i[`${t}Marker`]||i[`${t}-marker`]){const t=i.strokeWidth||i["stroke-width"];if(t)return parseFloat(t);break}}return null},i=t[0],o=t[t.length-1],s=this.containers.sourceMarker,a=this.containers.targetMarker,l=this.markerCache;let c,u;if(s){if(this.updateMarkerAttr("source"),l.sourceBBox=l.sourceBBox||getBBox(s),l.sourceBBox.width>0){const t=scale(s);c=e.clone().move(i||n,l.sourceBBox.width*t.sx*-1)}}else{const t=r("source");t&&(c=e.clone().move(i||n,-t))}if(a){if(this.updateMarkerAttr("target"),l.targetBBox=l.targetBBox||getBBox(a),l.targetBBox.width>0){const t=scale(a);u=n.clone().move(o||e,l.targetBBox.width*t.sx*-1)}}else{const t=r("target");t&&(u=n.clone().move(o||e,-t))}return l.sourcePoint=c||e.clone(),l.targetPoint=u||n.clone(),{source:c,target:u}}findPath(t,e,n){const r=this.cell.getConnector()||this.graph.options.connecting.connector;let i,o,s;if("string"==typeof r?i=r:(i=r.name,o=r.args),i){const t=Connector.registry.get(i);if("function"!=typeof t)return Connector.registry.onNotFound(i);s=t}else s=Connector.presets.normal;const a=call(s,this,e,n,t,Object.assign(Object.assign({},o),{raw:!0}),this);return"string"==typeof a?Path$1.parse(a):a}translateConnectionPoints(t,e){const n=this.markerCache;n.sourcePoint&&n.sourcePoint.translate(t,e),n.targetPoint&&n.targetPoint.translate(t,e),this.sourcePoint.translate(t,e),this.targetPoint.translate(t,e),this.sourceAnchor.translate(t,e),this.targetAnchor.translate(t,e)}updateLabelPositions(){if(null==this.containers.labels)return this;if(!this.path)return this;const t=this.cell,e=t.getLabels();if(0===e.length)return this;const n=t.getDefaultLabel(),r=this.normalizeLabelPosition(n.position);for(let t=0,n=e.length;t<n;t+=1){const n=this.normalizeLabelPosition(e[t].position),i=merge({},r,n),o=this.getLabelTransformationMatrix(i);this.labelCache[t].setAttribute("transform",matrixToTransformString(o))}return this}updateToolsPosition(){if(null==this.containers.tools)return this;let t="",e=this.options.toolsOffset;const n=this.getConnectionLength();if(null!=n){n<this.options.shortLength&&(t="scale(.5)",e/=2);let r=this.getPointAtLength(e);null!=r&&attr(this.toolCache,"transform",`translate(${r.x},${r.y}) ${t}`),this.options.doubleTools&&n>=this.options.longLength?(r=this.getPointAtLength(n-(this.options.doubleToolsOffset||e)),null!=r&&attr(this.tool2Cache,"transform",`translate(${r.x},${r.y}) ${t}`),attr(this.tool2Cache,"visibility","visible")):this.options.doubleTools&&attr(this.tool2Cache,"visibility","hidden")}return this}updateArrowheadMarkers(){const t=this.containers.arrowheads;if(null==t)return this;if("none"===t.style.display)return this;const e=this.containers.sourceArrowhead,n=this.containers.targetArrowhead;if(e&&n){const t=(this.getConnectionLength()||0)<this.options.shortLength?.5:1;scale(e,t),scale(n,t),this.translateAndAutoOrientArrows(e,n)}return this}updateTerminalProperties(t){const e=this.graph,n=this.cell[t],r=n&&n.cell,i=`${t}View`;if(!r)return this[i]=null,this.updateTerminalMagnet(t),!0;const o=e.getCellById(r);if(!o)throw new Error(`Edge's ${t} node with id "${r}" not exists`);const s=o.findView(e);return!!s&&(this[i]=s,this.updateTerminalMagnet(t),!0)}updateTerminalMagnet(t){const e=`${t}Magnet`,n=this.getTerminalView(t);if(n){let r=n.getMagnetFromEdgeTerminal(this.cell[t]);r===n.container&&(r=null),this[e]=r}else this[e]=null}translateAndAutoOrientArrows(t,e){const n=this.routePoints;t&&translateAndAutoOrient(t,this.sourcePoint,n[0]||this.targetPoint,this.graph.view.stage),e&&translateAndAutoOrient(e,this.targetPoint,n[n.length-1]||this.sourcePoint,this.graph.view.stage)}getLabelPositionAngle(t){const e=this.cell.getLabelAt(t);return e&&e.position&&"object"==typeof e.position&&e.position.angle||0}getLabelPositionArgs(t){const e=this.cell.getLabelAt(t);if(e&&e.position&&"object"==typeof e.position)return e.position.options}getDefaultLabelPositionArgs(){const t=this.cell.getDefaultLabel();if(t&&t.position&&"object"==typeof t.position)return t.position.options}mergeLabelPositionArgs(t,e){return null===t?null:void 0===t?null===e?null:e:merge({},e,t)}addLabel(t,e,n,r){let i,o,s,a=0;"number"!=typeof t?(i=t.x,o=t.y,"number"==typeof e?(a=e,s=n):s=e):(i=t,o=e,"number"==typeof n?(a=n,s=r):s=n);const l=this.getDefaultLabelPositionArgs(),c=this.mergeLabelPositionArgs(s,l),u={position:this.getLabelPosition(i,o,a,c)};return this.cell.insertLabel(u,-1,s),-1}addVertex(t,e,n){const r="number"!=typeof t,i=r?t.x:t,o=r?t.y:e,s=r?e:n,a={x:i,y:o},l=this.getVertexIndex(i,o);return this.cell.insertVertex(a,l,s),l}sendToken(t,e,n){let r,i,o,s,a="linear";"object"==typeof e?(r=e.duration,i=!0===e.reversed,o=e.selector,!1===e.rotate?s="":!0===e.rotate?s="auto":null!=e.rotate&&(s=`${e.rotate}`),e.timing&&(a=e.timing)):(r=e,i=!1,o=null),r=r||1e3;const l={dur:`${r}ms`,repeatCount:"1",calcMode:a,fill:"freeze"};if(s&&(l.rotate=s),i&&(l.keyPoints="1;0",l.keyTimes="0;1"),"object"==typeof e){const t=__rest$d(e,["duration","reversed","selector","rotate","timing"]);Object.keys(t).forEach((e=>{l[e]=t[e]}))}let c;if(c="string"==typeof o?this.findOne(o,this.container,this.selectors):this.containers.connection?this.containers.connection:this.container.querySelector("path"),!(c instanceof SVGPathElement))throw new Error("Token animation requires a valid connection path.");const u="string"==typeof t?this.findOne(t):t;if(null==u)throw new Error("Token animation requires a valid token element.");const h=u.parentNode,d=()=>{h||remove(u)},f=Vector.create(u);h||f.appendTo(this.graph.view.stage);const p=l.complete;l.complete=t=>{d(),n&&n(),p&&p(t)};const g=f.animateAlongPath(l,c);return()=>{d(),g()}}getConnection(){return null!=this.path?this.path.clone():null}getConnectionPathData(){if(null==this.path)return"";const t=this.cache.pathCache;return has(t,"data")||(t.data=this.path.serialize()),t.data||""}getConnectionSubdivisions(){if(null==this.path)return null;const t=this.cache.pathCache;return has(t,"segmentSubdivisions")||(t.segmentSubdivisions=this.path.getSegmentSubdivisions()),t.segmentSubdivisions}getConnectionLength(){if(null==this.path)return 0;const t=this.cache.pathCache;return has(t,"length")||(t.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),t.length}getPointAtLength(t){return null==this.path?null:this.path.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(t){return null==this.path?null:(isPercentage(t)&&(t=parseFloat(t)/100),this.path.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(t){return null==this.path?null:this.path.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(t){return null==this.path?null:this.path.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(t){return null==this.path?null:this.path.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(t){return null==this.path?null:this.path.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(t){return null==this.path?null:this.path.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(t,e,n,r){const i={distance:0};let o,s=0;"number"==typeof n?(s=n,o=r):o=n,null!=o&&(i.options=o);const a=o&&o.absoluteOffset,l=!(o&&o.absoluteDistance),c=o&&o.absoluteDistance&&o.reverseDistance,u=this.path,h={segmentSubdivisions:this.getConnectionSubdivisions()},d=new Point(t,e),f=u.closestPointT(d,h),p=this.getConnectionLength()||0;let g,m,A=u.lengthAtT(f,h);if(l&&(A=p>0?A/p:0),c&&(A=-1*(p-A)||1),i.distance=A,a||(g=u.tangentAtT(f)),g)m=g.pointOffset(d);else{const t=u.pointAtT(f),e=d.diff(t);m={x:e.x,y:e.y}}return i.offset=m,i.angle=s,i}normalizeLabelPosition(t){return"number"==typeof t?{distance:t}:t}getLabelTransformationMatrix(t){const e=this.normalizeLabelPosition(t),n=e.options||{},r=e.angle||0,i=e.distance,o=i>0&&i<=1;let s=0;const a={x:0,y:0},l=e.offset;l&&("number"==typeof l?s=l:(null!=l.x&&(a.x=l.x),null!=l.y&&(a.y=l.y)));const c=0!==a.x||0!==a.y||0===s,u=n.keepGradient,h=n.ensureLegibility,d=this.path,f={segmentSubdivisions:this.getConnectionSubdivisions()},p=o?i*this.getConnectionLength():i,g=d.tangentAtLength(p,f);let m,A=r;if(g){if(c)m=g.start,m.translate(a);else{const t=g.clone();t.rotate(-90,g.start),t.setLength(s),m=t.end}u&&(A=g.angle()+r,h&&(A=Angle.normalize((A+90)%180-90)))}else m=d.start,c&&m.translate(a);return createSVGMatrix().translate(m.x,m.y).rotate(A)}getLabelCoordinates(t){const e=this.getLabelTransformationMatrix(t);return new Point(e.e,e.f)}getVertexIndex(t,e){const n=this.cell.getVertices(),r=this.getClosestPointLength(new Point(t,e));let i=0;if(null!=r)for(const t=n.length;i<t;i+=1){const t=this.getClosestPointLength(n[i]);if(null!=t&&r<t)break}return i}getEventArgs(t,e,n){const r=this,i=r.cell;return null==e||null==n?{e:t,view:r,edge:i,cell:i}:{e:t,x:e,y:n,view:r,edge:i,cell:i}}notifyUnhandledMouseDown(t,e,n){this.notify("edge:unhandled:mousedown",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(t,e,n){super.onMouseDown(t,e,n),this.notify("edge:mousedown",this.getEventArgs(t,e,n))}notifyMouseMove(t,e,n){super.onMouseMove(t,e,n),this.notify("edge:mousemove",this.getEventArgs(t,e,n))}notifyMouseUp(t,e,n){super.onMouseUp(t,e,n),this.notify("edge:mouseup",this.getEventArgs(t,e,n))}onClick(t,e,n){super.onClick(t,e,n),this.notify("edge:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){super.onDblClick(t,e,n),this.notify("edge:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){super.onContextMenu(t,e,n),this.notify("edge:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){switch(this.notifyMouseDown(t,e,n),t.target.getAttribute("class")){case"vertex":return void this.startVertexDragging(t,e,n);case"vertex-remove":case"vertex-remove-area":return void this.handleVertexRemoving(t,e,n);case"connection":case"connection-wrap":return void this.handleVertexAdding(t,e,n);case"arrowhead":return void this.startArrowheadDragging(t,e,n);case"source-marker":case"target-marker":return void this.notifyUnhandledMouseDown(t,e,n)}this.startEdgeDragging(t,e,n)}onMouseMove(t,e,n){const r=this.getEventData(t);switch(r.action){case"drag-vertex":this.dragVertex(t,e,n);break;case"drag-label":this.dragLabel(t,e,n);break;case"drag-arrowhead":this.dragArrowhead(t,e,n);break;case"drag-edge":this.dragEdge(t,e,n)}return this.notifyMouseMove(t,e,n),r}onMouseUp(t,e,n){const r=this.getEventData(t);switch(r.action){case"drag-vertex":this.stopVertexDragging(t,e,n);break;case"drag-label":this.stopLabelDragging(t,e,n);break;case"drag-arrowhead":this.stopArrowheadDragging(t,e,n);break;case"drag-edge":this.stopEdgeDragging(t,e,n)}return this.notifyMouseUp(t,e,n),this.checkMouseleave(t),r}onMouseOver(t){super.onMouseOver(t),this.notify("edge:mouseover",this.getEventArgs(t))}onMouseOut(t){super.onMouseOut(t),this.notify("edge:mouseout",this.getEventArgs(t))}onMouseEnter(t){super.onMouseEnter(t),this.notify("edge:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("edge:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,r){super.onMouseWheel(t,e,n,r),this.notify("edge:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,n)))}onCustomEvent(t,e,n,r){if(findParentByClass(t.target,"edge-tool",this.container)){if(t.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===e)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,n,r)))}this.notifyMouseDown(t,n,r)}else this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,n,r))),super.onCustomEvent(t,e,n,r)}onLabelMouseDown(t,e,n){this.notifyMouseDown(t,e,n),this.startLabelDragging(t,e,n),this.getEventData(t).stopPropagation&&t.stopPropagation()}startEdgeDragging(t,e,n){this.can("edgeMovable")?this.setEventData(t,{x:e,y:n,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(t,e,n)}dragEdge(t,e,n){const r=this.getEventData(t);r.moving||(r.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(e-r.x,n-r.y,{ui:!0}),this.setEventData(t,{x:e,y:n}),this.notify("edge:moving",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(t,e,n){const r=this.getEventData(t);r.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:t,x:e,y:n,view:this,cell:this.cell,edge:this.cell})),r.moving=!1}prepareArrowheadDragging(t,e){const n=this.getTerminalMagnet(t),r={action:"drag-arrowhead",x:e.x,y:e.y,isNewEdge:!0===e.isNewEdge,terminalType:t,initialMagnet:n,initialTerminal:clone(this.cell[t]),fallbackAction:e.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(t),options:e.options};return this.beforeArrowheadDragging(r),r}createValidateConnectionArgs(t){const e=[];let n;e[4]=t,e[5]=this;let r=0,i=0;"source"===t?(r=2,n="target"):(i=2,n="source");const o=this.cell[n],s=o.cell;if(s){let t;const n=e[r]=this.graph.renderer.findViewByCell(s);n&&(t=n.getMagnetFromEdgeTerminal(o),t===n.container&&(t=void 0)),e[r+1]=t}return(t,n)=>(e[i]=t,e[i+1]=t.container===n?void 0:n,e)}beforeArrowheadDragging(t){t.zIndex=this.cell.zIndex,this.cell.toFront();const e=this.container.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(t)}afterArrowheadDragging(t){null!=t.zIndex&&(this.cell.setZIndex(t.zIndex,{ui:!0}),t.zIndex=null),this.container.style.pointerEvents=t.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(t)}arrowheadDragging(t,e,n,r){r.x=e,r.y=n,r.currentTarget!==t&&(r.currentMagnet&&r.currentView&&r.currentView.unhighlight(r.currentMagnet,{type:"magnetAdsorbed"}),r.currentView=this.graph.renderer.findViewByElem(t),r.currentView?(r.currentMagnet=r.currentView.findMagnet(t),r.currentMagnet&&this.graph.hook.validateConnection(...r.getValidateConnectionArgs(r.currentView,r.currentMagnet),r.currentView.getEdgeTerminal(r.currentMagnet,e,n,this.cell,r.terminalType))?r.currentView.highlight(r.currentMagnet,{type:"magnetAdsorbed"}):r.currentMagnet=null):r.currentMagnet=null),r.currentTarget=t,this.cell.prop(r.terminalType,{x:e,y:n},Object.assign(Object.assign({},r.options),{ui:!0}))}arrowheadDragged(t,e,n){const r=t.currentView,i=t.currentMagnet;if(!i||!r)return;r.unhighlight(i,{type:"magnetAdsorbed"});const o=t.terminalType,s=r.getEdgeTerminal(i,e,n,this.cell,o);this.cell.setTerminal(o,s,{ui:!0})}snapArrowhead(t,e,n){const r=this.graph,{snap:i,allowEdge:o}=r.options.connecting,s="object"==typeof i&&i.radius||50,a={x:t-s,y:e-s,width:2*s,height:2*s},l=r.renderer.findViewsInArea(a);if(o){const t=r.renderer.findEdgeViewsInArea(a).filter((t=>t!==this));l.push(...t)}const c=n.closestView||null,u=n.closestMagnet||null;let h;n.closestView=null,n.closestMagnet=null;let d=Number.MAX_SAFE_INTEGER;const f=new Point(t,e);let p;l.forEach((i=>{"false"!==i.container.getAttribute("magnet")&&(h=i.cell.getBBox().getCenter().distance(f),h<s&&h<d&&(u===i.container||r.hook.validateConnection(...n.getValidateConnectionArgs(i,null),i.getEdgeTerminal(i.container,t,e,this.cell,n.terminalType)))&&(d=h,n.closestView=i,n.closestMagnet=i.container)),i.container.querySelectorAll("[magnet]").forEach((o=>{if("false"!==o.getAttribute("magnet")){const a=i.getBBoxOfElement(o);h=f.distance(a.getCenter()),h<s&&h<d&&(u===o||r.hook.validateConnection(...n.getValidateConnectionArgs(i,o),i.getEdgeTerminal(o,t,e,this.cell,n.terminalType)))&&(d=h,n.closestView=i,n.closestMagnet=o)}}))}));const g=n.terminalType,m=n.closestView,A=n.closestMagnet,y=u!==A;if(c&&y&&c.unhighlight(u,{type:"magnetAdsorbed"}),m){if(!y)return;m.highlight(A,{type:"magnetAdsorbed"}),p=m.getEdgeTerminal(A,t,e,this.cell,g)}else p={x:t,y:e};this.cell.setTerminal(g,p,{},Object.assign(Object.assign({},n.options),{ui:!0}))}snapArrowheadEnd(t){const e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(n,{type:"magnetAdsorbed"}),t.currentMagnet=e.findMagnet(n)),t.closestView=null,t.closestMagnet=null}finishEmbedding(t){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(t.zIndex=null)}fallbackConnection(t){"remove"===t.fallbackAction?this.cell.remove({ui:!0}):this.cell.prop(t.terminalType,t.initialTerminal,{ui:!0})}notifyConnectionEvent(t,e){const n=t.terminalType,r=t.initialTerminal,i=this.cell[n];if(i&&!Edge$1.equalTerminals(r,i)){const o=this.graph,s=r,a=s.cell?o.getCellById(s.cell):null,l=s.port,c=a?o.findViewByCell(a):null,u=a||t.isNewEdge?null:Point.create(r).toJSON(),h=i,d=h.cell?o.getCellById(h.cell):null,f=h.port,p=d?o.findViewByCell(d):null,g=d?null:Point.create(i).toJSON();this.notify("edge:connected",{e,previousCell:a,previousPort:l,previousView:c,previousPoint:u,currentCell:d,currentView:p,currentPort:f,currentPoint:g,previousMagnet:t.initialMagnet,currentMagnet:t.currentMagnet,edge:this.cell,view:this,type:n,isNew:t.isNewEdge})}}highlightAvailableMagnets(t){const e=this.graph,n=e.model.getCells();t.marked={};for(let r=0,i=n.length;r<i;r+=1){const i=e.renderer.findViewByCell(n[r]);if(!i)continue;const o=Array.prototype.slice.call(i.container.querySelectorAll("[magnet]"));"false"!==i.container.getAttribute("magnet")&&o.push(i.container);const s=o.filter((n=>e.hook.validateConnection(...t.getValidateConnectionArgs(i,n),i.getEdgeTerminal(n,t.x,t.y,this.cell,t.terminalType))));if(s.length>0){for(let t=0,e=s.length;t<e;t+=1)i.highlight(s[t],{type:"magnetAvailable"});i.highlight(null,{type:"nodeAvailable"}),t.marked[i.cell.id]=s}}}unhighlightAvailableMagnets(t){const e=t.marked||{};Object.keys(e).forEach((t=>{const n=this.graph.renderer.findViewByCell(t);n&&(e[t].forEach((t=>{n.unhighlight(t,{type:"magnetAvailable"})})),n.unhighlight(null,{type:"nodeAvailable"}))})),t.marked=null}startArrowheadDragging(t,e,n){if(!this.can("arrowheadMovable"))return void this.notifyUnhandledMouseDown(t,e,n);const r=t.target.getAttribute("data-terminal"),i=this.prepareArrowheadDragging(r,{x:e,y:n});this.setEventData(t,i)}dragArrowhead(t,e,n){const r=this.getEventData(t);this.graph.options.connecting.snap?this.snapArrowhead(e,n,r):this.arrowheadDragging(this.getEventTarget(t),e,n,r)}stopArrowheadDragging(t,e,n){const r=this.graph,i=this.getEventData(t);r.options.connecting.snap?this.snapArrowheadEnd(i):this.arrowheadDragged(i,e,n),r.hook.validateEdge(this.cell,i.terminalType,i.initialTerminal)?(this.finishEmbedding(i),this.notifyConnectionEvent(i,t)):this.fallbackConnection(i),this.afterArrowheadDragging(i)}startLabelDragging(t,e,n){if(this.can("edgeLabelMovable")){const e=parseInt(t.currentTarget.getAttribute("data-index"),10),n=this.getLabelPositionAngle(e),r=this.getLabelPositionArgs(e),i=this.getDefaultLabelPositionArgs(),o=this.mergeLabelPositionArgs(r,i);this.setEventData(t,{index:e,positionAngle:n,positionArgs:o,stopPropagation:!0,action:"drag-label"})}else this.setEventData(t,{stopPropagation:!0});this.graph.view.delegateDragEvents(t,this)}dragLabel(t,e,n){const r=this.getEventData(t),i=this.cell.getLabelAt(r.index),o=merge({},i,{position:this.getLabelPosition(e,n,r.positionAngle,r.positionArgs)});this.cell.setLabelAt(r.index,o)}stopLabelDragging(t,e,n){}handleVertexAdding(t,e,n){if(!this.can("vertexAddable"))return void this.notifyUnhandledMouseDown(t,e,n);const r=this.addVertex({x:e,y:n},{ui:!0});this.setEventData(t,{index:r,action:"drag-vertex"})}handleVertexRemoving(t,e,n){if(!this.can("vertexDeletable"))return void this.notifyUnhandledMouseDown(t,e,n);const r=parseInt(t.target.getAttribute("idx"),10);this.cell.removeVertexAt(r)}startVertexDragging(t,e,n){if(!this.can("vertexMovable"))return void this.notifyUnhandledMouseDown(t,e,n);const r=parseInt(t.target.getAttribute("idx"),10);this.setEventData(t,{index:r,action:"drag-vertex"})}dragVertex(t,e,n){const r=this.getEventData(t);this.cell.setVertexAt(r.index,{x:e,y:n},{ui:!0})}stopVertexDragging(t,e,n){}}!function(t){t.toStringTag=`X6.${t.name}`,t.isEdgeView=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.isNodeView&&"function"==typeof e.isEdgeView&&"function"==typeof e.confirmUpdate&&"function"==typeof e.update&&"function"==typeof e.getConnection}}(EdgeView||(EdgeView={})),EdgeView.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],vertices:["vertices","update"],vertexMarkup:["vertices"],toolMarkup:["tools"],tools:["widget"]},shortLength:105,longLength:155,toolsOffset:40,doubleTools:!1,doubleToolsOffset:65,sampleInterval:50}),EdgeView.registry.register("edge",EdgeView,!0);class NodeView extends CellView{constructor(){super(...arguments),this.scalableNode=null,this.rotatableNode=null,this.scalableSelector="scalable",this.rotatableSelector="rotatable",this.defaultPortMarkup=Markup.getPortMarkup(),this.defaultPortLabelMarkup=Markup.getPortLabelMarkup(),this.defaultPortContainerMarkup=Markup.getPortContainerMarkup(),this.portsCache={}}get[Symbol.toStringTag](){return NodeView.toStringTag}getContainerClassName(){const t=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||t.push(this.prefixClassName("node-immovable")),t.join(" ")}updateClassName(t){const e=t.target;if(e.hasAttribute("magnet")){const t=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?removeClass(e,t):addClass(e,t)}else{const t=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(t):this.addClass(t)}}isNodeView(){return!0}confirmUpdate(t,e={}){let n=t;return this.hasAction(n,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(n,"render")?(this.render(),n=this.removeAction(n,["render","update","resize","translate","rotate","ports","tools"])):(n=this.handleAction(n,"resize",(()=>this.resize(e)),"update"),n=this.handleAction(n,"update",(()=>this.update()),"ports"),n=this.handleAction(n,"translate",(()=>this.translate())),n=this.handleAction(n,"rotate",(()=>this.rotate())),n=this.handleAction(n,"ports",(()=>this.renderPorts())),n=this.handleAction(n,"tools",(()=>this.renderTools()))),n}update(t){this.cleanCache(),this.removePorts();const e=this.cell,n=e.getSize(),r=e.getAttrs();this.updateAttrs(this.container,r,{attrs:t===r?null:t,rootBBox:new Rectangle(0,0,n.width,n.height),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode}),this.renderPorts()}renderMarkup(){const t=this.cell.markup;if(t)return"string"==typeof t?this.renderStringMarkup(t):this.renderJSONMarkup(t);throw new TypeError("Invalid node markup.")}renderJSONMarkup(t){const e=this.parseJSONMarkup(t,this.container),n=t=>Array.isArray(t)?t[0]:t;this.selectors=e.selectors,this.rotatableNode=n(this.selectors[this.rotatableSelector]),this.scalableNode=n(this.selectors[this.scalableSelector]),this.container.appendChild(e.fragment)}renderStringMarkup(t){append(this.container,Vector.toNodes(Vector.createVectors(t))),this.rotatableNode=findOne(this.container,`.${this.rotatableSelector}`),this.scalableNode=findOne(this.container,`.${this.scalableSelector}`),this.selectors={},this.rootSelector&&(this.selectors[this.rootSelector]=this.container)}render(){return this.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransform(),this.renderTools(),this}resize(t={}){if(this.scalableNode)return this.updateSize(t);this.cell.getAngle()&&this.rotate(),this.update()}translate(){if(this.rotatableNode)return this.updateTranslation();this.updateTransform()}rotate(){if(this.rotatableNode)return this.updateRotation(),void this.update();this.updateTransform()}getTranslationString(){const t=this.cell.getPosition();return`translate(${t.x},${t.y})`}getRotationString(){const t=this.cell.getAngle();if(t){const e=this.cell.getSize();return`rotate(${t},${e.width/2},${e.height/2})`}}updateTransform(){let t=this.getTranslationString();const e=this.getRotationString();e&&(t+=` ${e}`),this.container.setAttribute("transform",t)}updateRotation(){if(null!=this.rotatableNode){const t=this.getRotationString();null!=t?this.rotatableNode.setAttribute("transform",t):this.rotatableNode.removeAttribute("transform")}}updateTranslation(){this.container.setAttribute("transform",this.getTranslationString())}updateSize(t={}){const e=this.cell,n=e.getSize(),r=e.getAngle(),i=this.scalableNode;let o=!1;i.getElementsByTagName("path").length>0&&(o=!0);const s=getBBox(i,{recursive:o});i.setAttribute("transform",`scale(${n.width/(s.width||1)},${n.height/(s.height||1)})`);const a=this.rotatableNode;if(null!=a){const o=a.getAttribute("transform");if(o){a.setAttribute("transform",`${o} rotate(${-r},${n.width/2},${n.height/2})`);const s=getBBox(i,{target:this.graph.view.stage});e.prop("position",{x:s.x,y:s.y},Object.assign({updated:!0},t)),this.translate(),this.rotate()}}this.update()}findPortElem(t,e){const n=t?this.portsCache[t]:null;return n?this.findOne(e,n.portContentElement,n.portContentSelectors||{}):null}initializePorts(){this.cleanPortsCache()}refreshPorts(){this.removePorts(),this.cleanPortsCache(),this.renderPorts()}cleanPortsCache(){this.portsCache={}}removePorts(){Object.keys(this.portsCache).forEach((t=>{remove(this.portsCache[t].portElement)}))}renderPorts(){const t=this.getPortsContainer(),e=[];t.childNodes.forEach((t=>{e.push(t)}));const n=groupBy(this.cell.getParsedPorts(),"zIndex");n.auto&&n.auto.forEach((n=>{const r=this.getPortElement(n);t.append(r),e.push(r)})),Object.keys(n).forEach((t=>{if("auto"!==t){const r=parseInt(t,10);this.appendPorts(n[t],r,e)}})),this.updatePorts()}getPortsContainer(){return this.rotatableNode||this.container}appendPorts(t,e,n){const r=t.map((t=>this.getPortElement(t)));n[e]||e<0?before(n[Math.max(e,0)],r):append(this.getPortsContainer(),r)}getPortElement(t){const e=this.portsCache[t.id];return e?e.portElement:this.createPortElement(t)}createPortElement(t){let e=Markup.renderMarkup(this.getPortContainerMarkup());const n=e.elem;if(null==n)throw new Error("Invalid port container markup.");e=Markup.renderMarkup(this.getPortMarkup(t));const r=e.elem,i=e.selectors;if(null==r)throw new Error("Invalid port markup.");this.setAttrs({port:t.id,"port-group":t.group},r),e=Markup.renderMarkup(this.getPortLabelMarkup(t.label));const o=e.elem,s=e.selectors;if(null==o)throw new Error("Invalid port label markup.");let a;if(i&&s){for(const t in s)if(i[t]&&t!==this.rootSelector)throw new Error("Selectors within port must be unique.");a=Object.assign(Object.assign({},i),s)}else a=i||s;let l="x6-port";return t.group&&(l+=` x6-port-${t.group}`),addClass(n,l),addClass(r,"x6-port-body"),addClass(o,"x6-port-label"),n.appendChild(r),n.appendChild(o),this.portsCache[t.id]={portElement:n,portSelectors:a,portLabelElement:o,portLabelSelectors:s,portContentElement:r,portContentSelectors:i},this.graph.hook.onPortRendered({port:t,node:this.cell,container:n,selectors:a,labelContainer:o,labelSelectors:s,contentContainer:r,contentSelectors:i}),n}updatePorts(){this.updatePortGroup();const t=this.cell.getParsedGroups();Object.keys(t).forEach((t=>this.updatePortGroup(t)))}updatePortGroup(t){const e=Rectangle.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(t,e);for(let t=0,e=n.length;t<e;t+=1){const e=n[t],r=this.portsCache[e.portId]||{},i=e.portLayout;if(this.applyPortTransform(r.portElement,i),null!=e.portAttrs){const t={selectors:r.portSelectors||{}};e.portSize&&(t.rootBBox=Rectangle.fromSize(e.portSize)),this.updateAttrs(r.portElement,e.portAttrs,t)}const o=e.labelLayout;if(o&&(this.applyPortTransform(r.portLabelElement,o,-(i.angle||0)),o.attrs)){const t={selectors:r.portLabelSelectors||{}};e.labelSize&&(t.rootBBox=Rectangle.fromSize(e.labelSize)),this.updateAttrs(r.portLabelElement,o.attrs,t)}}}applyPortTransform(t,e,n=0){const r=e.angle,i=e.position;transform(t,createSVGMatrix().rotate(n).translate(i.x||0,i.y||0).rotate(r||0),{absolute:!0})}getPortContainerMarkup(){return this.cell.getPortContainerMarkup()||this.defaultPortContainerMarkup}getPortMarkup(t){return t.markup||this.cell.portMarkup||this.defaultPortMarkup}getPortLabelMarkup(t){return t.markup||this.cell.portLabelMarkup||this.defaultPortLabelMarkup}getEventArgs(t,e,n){const r=this,i=r.cell;return null==e||null==n?{e:t,view:r,node:i,cell:i}:{e:t,x:e,y:n,view:r,node:i,cell:i}}notifyMouseDown(t,e,n){super.onMouseDown(t,e,n),this.notify("node:mousedown",this.getEventArgs(t,e,n))}notifyMouseMove(t,e,n){super.onMouseMove(t,e,n),this.notify("node:mousemove",this.getEventArgs(t,e,n))}notifyMouseUp(t,e,n){super.onMouseUp(t,e,n),this.notify("node:mouseup",this.getEventArgs(t,e,n))}onClick(t,e,n){super.onClick(t,e,n),this.notify("node:click",this.getEventArgs(t,e,n))}onDblClick(t,e,n){super.onDblClick(t,e,n),this.notify("node:dblclick",this.getEventArgs(t,e,n))}onContextMenu(t,e,n){super.onContextMenu(t,e,n),this.notify("node:contextmenu",this.getEventArgs(t,e,n))}onMouseDown(t,e,n){this.isPropagationStopped(t)||(this.notifyMouseDown(t,e,n),this.startNodeDragging(t,e,n))}onMouseMove(t,e,n){const r=this.getEventData(t),i=r.action;if("magnet"===i)this.dragMagnet(t,e,n);else{if("move"===i){const i=r.targetView||this;i.dragNode(t,e,n),i.notify("node:moving",{e:t,x:e,y:n,view:i,cell:i.cell,node:i.cell})}this.notifyMouseMove(t,e,n)}this.setEventData(t,r)}onMouseUp(t,e,n){const r=this.getEventData(t),i=r.action;"magnet"===i?this.stopMagnetDragging(t,e,n):(this.notifyMouseUp(t,e,n),"move"===i&&(r.targetView||this).stopNodeDragging(t,e,n));const o=r.targetMagnet;o&&this.onMagnetClick(t,o,e,n),this.checkMouseleave(t)}onMouseOver(t){super.onMouseOver(t),this.notify("node:mouseover",this.getEventArgs(t))}onMouseOut(t){super.onMouseOut(t),this.notify("node:mouseout",this.getEventArgs(t))}onMouseEnter(t){this.updateClassName(t),super.onMouseEnter(t),this.notify("node:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("node:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,n,r){super.onMouseWheel(t,e,n,r),this.notify("node:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,n)))}onMagnetClick(t,e,n,r){this.graph.view.getMouseMovedCount(t)>this.graph.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:e},this.getEventArgs(t,n,r)))}onMagnetDblClick(t,e,n,r){this.notify("node:magnet:dblclick",Object.assign({magnet:e},this.getEventArgs(t,n,r)))}onMagnetContextMenu(t,e,n,r){this.notify("node:magnet:contextmenu",Object.assign({magnet:e},this.getEventArgs(t,n,r)))}onMagnetMouseDown(t,e,n,r){this.startMagnetDragging(t,n,r)}onCustomEvent(t,e,n,r){this.notify("node:customevent",Object.assign({name:e},this.getEventArgs(t,n,r))),super.onCustomEvent(t,e,n,r)}prepareEmbedding(t){const e=this.getEventData(t).cell||this.cell,n=this.graph.findViewByCell(e),r=this.graph.snapToGrid(t.clientX,t.clientY);this.notify("node:embed",{e:t,node:e,view:n,cell:e,x:r.x,y:r.y,currentParent:e.getParent()})}processEmbedding(t,e){const n=e.cell||this.cell,r=e.graph||this.graph,i=r.options.embedding,o=i.findParent;let s="function"==typeof o?call(o,r,{view:this,node:this.cell}).filter((t=>Cell.isCell(t)&&this.cell.id!==t.id&&!t.isDescendantOf(this.cell))):r.model.getNodesUnderNode(n,{by:o});if(i.frontOnly&&s.length>0){const t=groupBy(s,"zIndex"),e=max(Object.keys(t));e&&(s=t[e])}s=s.filter((t=>t.visible));let a=null;const l=e.candidateEmbedView,c=i.validate;for(let t=s.length-1;t>=0;t-=1){const e=s[t];if(l&&l.cell.id===e.id){a=l;break}{const t=e.findView(r);if(call(c,r,{child:this.cell,parent:t.cell,childView:this,parentView:t})){a=t;break}}}this.clearEmbedding(e),a&&a.highlight(null,{type:"embedding"}),e.candidateEmbedView=a;const u=r.snapToGrid(t.clientX,t.clientY);this.notify("node:embedding",{e:t,cell:n,node:n,view:r.findViewByCell(n),x:u.x,y:u.y,currentParent:n.getParent(),candidateParent:a?a.cell:null})}clearEmbedding(t){const e=t.candidateEmbedView;e&&(e.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null)}finalizeEmbedding(t,e){const n=e.cell||this.cell,r=e.graph||this.graph,i=r.findViewByCell(n),o=n.getParent(),s=e.candidateEmbedView;if(s?(s.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null,null!=o&&o.id===s.cell.id||s.cell.insertChild(n,void 0,{ui:!0})):o&&o.unembed(n,{ui:!0}),r.model.getConnectedEdges(n,{deep:!0}).forEach((t=>{t.updateParent({ui:!0})})),i&&s){const e=r.snapToGrid(t.clientX,t.clientY);i.notify("node:embedded",{e:t,cell:n,x:e.x,y:e.y,node:n,view:r.findViewByCell(n),previousParent:o,currentParent:n.getParent()})}}getDelegatedView(){let t=this.cell,e=this;for(;e&&!t.isEdge();){if(!t.hasParent()||e.can("stopDelegateOnDragging"))return e;t=t.getParent(),e=this.graph.renderer.findViewByCell(t)}return null}startMagnetDragging(t,e,n){if(!this.can("magnetConnectable"))return;t.stopPropagation();const r=t.currentTarget,i=this.graph;this.setEventData(t,{targetMagnet:r}),i.hook.validateMagnet(this,r,t)?(i.options.magnetThreshold<=0&&this.startConnectting(t,r,e,n),this.setEventData(t,{action:"magnet"}),this.stopPropagation(t)):((hasClass(r,"x6-port-body")||jquery(r).closest(".x6-port-body").length>0)&&this.stopPropagation(t),this.onMouseDown(t,e,n)),i.view.delegateDragEvents(t,this)}startConnectting(t,e,n,r){this.graph.model.startBatch("add-edge");const i=this.createEdgeFromMagnet(e,n,r);i.notifyMouseDown(t,n,r),i.setEventData(t,i.prepareArrowheadDragging("target",{x:n,y:r,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(t,{edgeView:i})}createEdgeFromMagnet(t,e,n){const r=this.graph,i=r.model,o=r.hook.getDefaultEdge(this,t);return o.setSource(Object.assign(Object.assign({},o.getSource()),this.getEdgeTerminal(t,e,n,o,"source"))),o.setTarget(Object.assign(Object.assign({},o.getTarget()),{x:e,y:n})),o.addTo(i,{async:!1,ui:!0}),o.findView(r)}dragMagnet(t,e,n){const r=this.getEventData(t),i=r.edgeView;if(i)i.onMouseMove(t,e,n),this.autoScrollGraph(t.clientX,t.clientY);else{const i=this.graph,o=i.options.magnetThreshold,s=this.getEventTarget(t),a=r.targetMagnet;if("onleave"===o){if(a===s||a.contains(s))return}else if(i.view.getMouseMovedCount(t)<=o)return;this.startConnectting(t,a,e,n)}}stopMagnetDragging(t,e,n){const r=this.eventData(t).edgeView;r&&(r.onMouseUp(t,e,n),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(t,e,n){this.notify("node:unhandled:mousedown",{e:t,x:e,y:n,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(t,e,n,r,i){let o=[i];const s=this.graph.selection.widget;if(s&&s.options.movable){const t=this.graph.getSelectedCells();t.includes(i)&&(o=t.filter((t=>t.isNode())))}o.forEach((i=>{this.notify(t,{e,x:n,y:r,cell:i,node:i,view:i.findView(this.graph)})}))}startNodeDragging(t,e,n){const r=this.getDelegatedView();if(null==r||!r.can("nodeMovable"))return this.notifyUnhandledMouseDown(t,e,n);this.setEventData(t,{targetView:r,action:"move"});const i=Point.create(r.cell.getPosition());r.setEventData(t,{moving:!1,offset:i.diff(e,n),restrict:this.graph.hook.getRestrictArea(r)})}dragNode(t,e,n){const r=this.cell,i=this.graph,o=i.getGridSize(),s=this.getEventData(t),a=s.offset,l=s.restrict;s.moving||(s.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",t,e,n,this.cell)),this.autoScrollGraph(t.clientX,t.clientY);const c=Util$3.snapToGrid(e+a.x,o),u=Util$3.snapToGrid(n+a.y,o);r.setPosition(c,u,{restrict:l,deep:!0,ui:!0}),i.options.embedding.enabled&&(s.embedding||(this.prepareEmbedding(t),s.embedding=!0),this.processEmbedding(t,s))}stopNodeDragging(t,e,n){const r=this.getEventData(t);r.embedding&&this.finalizeEmbedding(t,r),r.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",t,e,n,this.cell)),r.moving=!1,r.embedding=!1}autoScrollGraph(t,e){const n=this.graph.scroller.widget;n&&n.autoScroll(t,e)}}!function(t){t.toStringTag=`X6.${t.name}`,t.isNodeView=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.isNodeView&&"function"==typeof e.isEdgeView&&"function"==typeof e.confirmUpdate&&"function"==typeof e.update&&"function"==typeof e.findPortElem&&"function"==typeof e.resize&&"function"==typeof e.rotate&&"function"==typeof e.translate}}(NodeView||(NodeView={})),NodeView.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),NodeView.registry.register("node",NodeView,!0);const viewName=getName("text");class Text extends(createShape$1("text",{view:viewName,attrs:{text:{fontSize:18,fill:"#000000",stroke:null,refX:.5,refY:.5}}},{noText:!0})){}!function(t){class e extends NodeView{confirmUpdate(t,e={}){let n=super.confirmUpdate(t,e);return this.hasAction(n,"scale")&&(this.resize(),n=this.removeAction(n,"scale")),n}}t.View=e,e.config({actions:{attrs:["scale"]}}),NodeView.registry.register(viewName,e)}(Text||(Text={}));class Collection extends Basecoat{constructor(t,e={}){super(),this.length=0,this.comparator=e.comparator||"zIndex",this.clean(),t&&this.reset(t,{silent:!0})}toJSON(){return this.cells.map((t=>t.toJSON()))}add(t,e,n){let r,i;"number"==typeof e?(r=e,i=Object.assign({merge:!1},n)):(r=this.length,i=Object.assign({merge:!1},e)),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);const o=Array.isArray(t)?t:[t],s=this.comparator&&"number"!=typeof e&&!1!==i.sort,a=this.comparator||null;let l=!1;const c=[],u=[];return o.forEach((t=>{const e=this.get(t);e?i.merge&&!t.isSameStore(e)&&(e.setProp(t.getProp(),n),u.push(e),s&&!l&&(l=null==a||"function"==typeof a?e.hasChanged():"string"==typeof a?e.hasChanged(a):a.some((t=>e.hasChanged(t))))):(c.push(t),this.reference(t))})),c.length&&(s&&(l=!0),this.cells.splice(r,0,...c),this.length=this.cells.length),l&&this.sort({silent:!0}),i.silent||(c.forEach(((t,e)=>{const n={cell:t,index:r+e,options:i};this.trigger("added",n),i.dryrun||t.notify("added",Object.assign({},n))})),l&&this.trigger("sorted"),(c.length||u.length)&&this.trigger("updated",{added:c,merged:u,removed:[],options:i})),this}remove(t,e={}){const n=Array.isArray(t)?t:[t],r=this.removeCells(n,e);return!e.silent&&r.length>0&&this.trigger("updated",{options:e,removed:r,added:[],merged:[]}),Array.isArray(t)?r:r[0]}removeCells(t,e){const n=[];for(let r=0;r<t.length;r+=1){const i=this.get(t[r]);if(null==i)continue;const o=this.cells.indexOf(i);this.cells.splice(o,1),this.length-=1,delete this.map[i.id],n.push(i),this.unreference(i),e.dryrun||i.remove(),e.silent||(this.trigger("removed",{cell:i,index:o,options:e}),e.dryrun||i.notify("removed",{cell:i,index:o,options:e}))}return n}reset(t,e={}){const n=this.cells.slice();if(n.forEach((t=>this.unreference(t))),this.clean(),this.add(t,Object.assign({silent:!0},e)),!e.silent){const t=this.cells.slice();this.trigger("reseted",{options:e,previous:n,current:t});const r=[],i=[];t.forEach((t=>{n.some((e=>e.id===t.id))||r.push(t)})),n.forEach((e=>{t.some((t=>t.id===e.id))||i.push(e)})),this.trigger("updated",{options:e,added:r,removed:i,merged:[]})}return this}push(t,e){return this.add(t,this.length,e)}pop(t){const e=this.at(this.length-1);return this.remove(e,t)}unshift(t,e){return this.add(t,0,e)}shift(t){const e=this.at(0);return this.remove(e,t)}get(t){return null==t?null:this.map["string"==typeof t||"number"==typeof t?t:t.id]||null}has(t){return null!=this.get(t)}at(t){return t<0&&(t+=this.length),this.cells[t]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(t){return this.cells.indexOf(t)}toArray(){return this.cells.slice()}sort(t={}){return null!=this.comparator&&(this.cells=sortBy(this.cells,this.comparator),t.silent||this.trigger("sorted")),this}clone(){return new(0,this.constructor)(this.cells.slice(),{comparator:this.comparator})}reference(t){this.map[t.id]=t,t.on("*",this.notifyCellEvent,this)}unreference(t){t.off("*",this.notifyCellEvent,this),delete this.map[t.id]}notifyCellEvent(t,e){const n=e.cell;this.trigger(`cell:${t}`,e),n&&(n.isNode()?this.trigger(`node:${t}`,Object.assign(Object.assign({},e),{node:n})):n.isEdge()&&this.trigger(`edge:${t}`,Object.assign(Object.assign({},e),{edge:n})))}clean(){this.length=0,this.cells=[],this.map={}}}class Model extends Basecoat{constructor(t=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new Collection(t),this.setup()}get[Symbol.toStringTag](){return Model.toStringTag}notify(t,e){this.trigger(t,e);const n=this.graph;return n&&n.trigger("sorted"===t||"reseted"===t||"updated"===t?`model:${t}`:t,e),this}setup(){const t=this.collection;t.on("sorted",(()=>this.notify("sorted",null))),t.on("updated",(t=>this.notify("updated",t))),t.on("cell:change:zIndex",(()=>this.sortOnChangeZ())),t.on("added",(({cell:t})=>{this.onCellAdded(t)})),t.on("removed",(t=>{const e=t.cell;this.onCellRemoved(e,t.options),this.notify("cell:removed",t),e.isNode()?this.notify("node:removed",Object.assign(Object.assign({},t),{node:e})):e.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},t),{edge:e}))})),t.on("reseted",(t=>{this.onReset(t.current),this.notify("reseted",t)})),t.on("edge:change:source",(({edge:t})=>this.onEdgeTerminalChanged(t,"source"))),t.on("edge:change:target",(({edge:t})=>{this.onEdgeTerminalChanged(t,"target")}))}sortOnChangeZ(){this.collection.sort()}onCellAdded(t){const e=t.id;t.isEdge()?(t.updateParent(),this.edges[e]=!0,this.onEdgeTerminalChanged(t,"source"),this.onEdgeTerminalChanged(t,"target")):this.nodes[e]=!0}onCellRemoved(t,e){const n=t.id;if(t.isEdge()){delete this.edges[n];const e=t.getSource(),r=t.getTarget();if(e&&e.cell){const t=this.outgoings[e.cell],r=t?t.indexOf(n):-1;r>=0&&(t.splice(r,1),0===t.length&&delete this.outgoings[e.cell])}if(r&&r.cell){const t=this.incomings[r.cell],e=t?t.indexOf(n):-1;e>=0&&(t.splice(e,1),0===t.length&&delete this.incomings[r.cell])}}else delete this.nodes[n];e.clear||(e.disconnectEdges?this.disconnectConnectedEdges(t,e):this.removeConnectedEdges(t,e)),t.model===this&&(t.model=null)}onReset(t){this.nodes={},this.edges={},this.outgoings={},this.incomings={},t.forEach((t=>this.onCellAdded(t)))}onEdgeTerminalChanged(t,e){const n="source"===e?this.outgoings:this.incomings,r=t.previous(e);if(r&&r.cell){const e=Cell.isCell(r.cell)?r.cell.id:r.cell,i=n[e],o=i?i.indexOf(t.id):-1;o>=0&&(i.splice(o,1),0===i.length&&delete n[e])}const i=t.getTerminal(e);if(i&&i.cell){const e=Cell.isCell(i.cell)?i.cell.id:i.cell,r=n[e]||[];-1===r.indexOf(t.id)&&r.push(t.id),n[e]=r}}prepareCell(t,e){return t.model||e&&e.dryrun||(t.model=this),null==t.zIndex&&t.setZIndex(this.getMaxZIndex()+1,{silent:!0}),t}resetCells(t,e={}){return t.map((t=>this.prepareCell(t,Object.assign(Object.assign({},e),{dryrun:!0})))),this.collection.reset(t,e),t.map((t=>this.prepareCell(t,{options:e}))),this}clear(t={}){const e=this.getCells();if(0===e.length)return this;const n=Object.assign(Object.assign({},t),{clear:!0});return this.batchUpdate("clear",(()=>{const t=e.sort(((t,e)=>(t.isEdge()?1:2)-(e.isEdge()?1:2)));for(;t.length>0;){const e=t.shift();e&&e.remove(n)}}),n),this}addNode(t,e={}){const n=Node$1.isNode(t)?t:this.createNode(t);return this.addCell(n,e),n}createNode(t){return Node$1.create(t)}addEdge(t,e={}){const n=Edge$1.isEdge(t)?t:this.createEdge(t);return this.addCell(n,e),n}createEdge(t){return Edge$1.create(t)}addCell(t,e={}){return Array.isArray(t)?this.addCells(t,e):(this.collection.has(t)||this.addings.has(t)||(this.addings.set(t,!0),this.collection.add(this.prepareCell(t,e),e),t.eachChild((t=>this.addCell(t,e))),this.addings.delete(t)),this)}addCells(t,e={}){const n=t.length;if(0===n)return this;const r=Object.assign(Object.assign({},e),{position:n-1,maxPosition:n-1});return this.startBatch("add",Object.assign(Object.assign({},r),{cells:t})),t.forEach((t=>{this.addCell(t,r),r.position-=1})),this.stopBatch("add",Object.assign(Object.assign({},r),{cells:t})),this}removeCell(t,e={}){const n="string"==typeof t?this.getCell(t):t;return n&&this.has(n)?this.collection.remove(n,e):null}updateCellId(t,e){this.startBatch("update",{id:e}),t.prop("id",e);const n=t.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(t).forEach((n=>{const r=n.getSourceCell(),i=n.getTargetCell();r===t&&n.setSource(Object.assign(Object.assign({},n.getSource()),{cell:e})),i===t&&n.setTarget(Object.assign(Object.assign({},n.getTarget()),{cell:e}))})),this.removeCell(t),this.stopBatch("update",{id:e}),n}removeCells(t,e={}){return t.length?this.batchUpdate("remove",(()=>t.map((t=>this.removeCell(t,e))))):[]}removeConnectedEdges(t,e={}){const n=this.getConnectedEdges(t);return n.forEach((t=>{t.remove(e)})),n}disconnectConnectedEdges(t,e={}){const n="string"==typeof t?t:t.id;this.getConnectedEdges(t).forEach((t=>{const r=t.getSourceCell(),i=t.getTargetCell();r&&r.id===n&&t.setSource({x:0,y:0},e),i&&i.id===n&&t.setTarget({x:0,y:0},e)}))}has(t){return this.collection.has(t)}total(){return this.collection.length}indexOf(t){return this.collection.indexOf(t)}getCell(t){return this.collection.get(t)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const t=this.collection.first();return t&&t.getZIndex()||0}getMaxZIndex(){const t=this.collection.last();return t&&t.getZIndex()||0}getCellsFromCache(t){return t?Object.keys(t).map((t=>this.getCell(t))).filter((t=>null!=t)):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(t){const e=this.outgoings["string"==typeof t?t:t.id];return e?e.map((t=>this.getCell(t))).filter((t=>t&&t.isEdge())):null}getIncomingEdges(t){const e=this.incomings["string"==typeof t?t:t.id];return e?e.map((t=>this.getCell(t))).filter((t=>t&&t.isEdge())):null}getConnectedEdges(t,e={}){const n=[],r="string"==typeof t?this.getCell(t):t;if(null==r)return n;const i={},o=e.indirect;let s=e.incoming,a=e.outgoing;null==s&&null==a&&(s=a=!0);const l=(t,e)=>{const r=e?this.getOutgoingEdges(t):this.getIncomingEdges(t);if(null!=r&&r.forEach((t=>{i[t.id]||(n.push(t),i[t.id]=!0,o&&(s&&l(t,!1),a&&l(t,!0)))})),o&&t.isEdge()){const r=e?t.getTargetCell():t.getSourceCell();r&&r.isEdge()&&(i[r.id]||(n.push(r),l(r,e)))}};if(a&&l(r,!0),s&&l(r,!1),e.deep){const t=r.getDescendants({deep:!0}),o={};t.forEach((t=>{t.isNode()&&(o[t.id]=!0)}));const l=(t,r)=>{const s=r?this.getOutgoingEdges(t.id):this.getIncomingEdges(t.id);null!=s&&s.forEach((t=>{if(!i[t.id]){const r=t.getSourceCell(),s=t.getTargetCell();if(!e.enclosed&&r&&o[r.id]&&s&&o[s.id])return;n.push(t),i[t.id]=!0}}))};t.forEach((t=>{t.isEdge()||(a&&l(t,!0),s&&l(t,!1))}))}return n}isBoundary(t,e){const n="string"==typeof t?this.getCell(t):t,r=e?this.getIncomingEdges(n):this.getOutgoingEdges(n);return null==r||0===r.length}getBoundaryNodes(t){const e=[];return Object.keys(this.nodes).forEach((n=>{if(this.isBoundary(n,t)){const t=this.getCell(n);t&&e.push(t)}})),e}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(t){return this.isBoundary(t,!0)}isLeaf(t){return this.isBoundary(t,!1)}getNeighbors(t,e={}){let n=e.incoming,r=e.outgoing;null==n&&null==r&&(n=r=!0);const i=this.getConnectedEdges(t,e).reduce(((i,o)=>{const s=o.hasLoop(e),a=o.getSourceCell(),l=o.getTargetCell();return n&&a&&a.isNode()&&!i[a.id]&&(!s&&(a===t||e.deep&&a.isDescendantOf(t))||(i[a.id]=a)),r&&l&&l.isNode()&&!i[l.id]&&(!s&&(l===t||e.deep&&l.isDescendantOf(t))||(i[l.id]=l)),i}),{});if(t.isEdge()){if(n){const e=t.getSourceCell();e&&e.isNode()&&!i[e.id]&&(i[e.id]=e)}if(r){const e=t.getTargetCell();e&&e.isNode()&&!i[e.id]&&(i[e.id]=e)}}return Object.keys(i).map((t=>i[t]))}isNeighbor(t,e,n={}){let r=n.incoming,i=n.outgoing;return null==r&&null==i&&(r=i=!0),this.getConnectedEdges(t,n).some((t=>{const n=t.getSourceCell(),o=t.getTargetCell();return!(!r||!n||n.id!==e.id)||!(!i||!o||o.id!==e.id)}))}getSuccessors(t,e={}){const n=[];return this.search(t,((r,i)=>{r!==t&&this.matchDistance(i,e.distance)&&n.push(r)}),Object.assign(Object.assign({},e),{outgoing:!0})),n}isSuccessor(t,e,n={}){let r=!1;return this.search(t,((i,o)=>{if(i===e&&i!==t&&this.matchDistance(o,n.distance))return r=!0,!1}),Object.assign(Object.assign({},n),{outgoing:!0})),r}getPredecessors(t,e={}){const n=[];return this.search(t,((r,i)=>{r!==t&&this.matchDistance(i,e.distance)&&n.push(r)}),Object.assign(Object.assign({},e),{incoming:!0})),n}isPredecessor(t,e,n={}){let r=!1;return this.search(t,((i,o)=>{if(i===e&&i!==t&&this.matchDistance(o,n.distance))return r=!0,!1}),Object.assign(Object.assign({},n),{incoming:!0})),r}matchDistance(t,e){return null==e||("function"==typeof e?e(t):!(!Array.isArray(e)||!e.includes(t))||t===e)}getCommonAncestor(...t){const e=[];return t.forEach((t=>{t&&(Array.isArray(t)?e.push(...t):e.push(t))})),Cell.getCommonAncestor(...e)}getSubGraph(t,e={}){const n=[],r={},i=[],o=[],s=t=>{r[t.id]||(n.push(t),r[t.id]=t,t.isEdge()&&o.push(t),t.isNode()&&i.push(t))};return t.forEach((t=>{s(t),e.deep&&t.getDescendants({deep:!0}).forEach((t=>s(t)))})),o.forEach((t=>{const e=t.getSourceCell(),o=t.getTargetCell();e&&!r[e.id]&&(n.push(e),r[e.id]=e,e.isNode()&&i.push(e)),o&&!r[o.id]&&(n.push(o),r[o.id]=o,o.isNode()&&i.push(o))})),i.forEach((t=>{this.getConnectedEdges(t,e).forEach((t=>{const e=t.getSourceCell(),i=t.getTargetCell();!r[t.id]&&e&&r[e.id]&&i&&r[i.id]&&(n.push(t),r[t.id]=t)}))})),n}cloneSubGraph(t,e={}){const n=this.getSubGraph(t,e);return this.cloneCells(n)}cloneCells(t){return Cell.cloneCells(t)}getNodesFromPoint(t,e){const n="number"==typeof t?{x:t,y:e||0}:t;return this.getNodes().filter((t=>t.getBBox().containsPoint(n)))}getNodesInArea(t,e,n,r,i){const o="number"==typeof t?new Rectangle(t,e,n,r):Rectangle.create(t),s="number"==typeof t?i:e,a=s&&s.strict;return this.getNodes().filter((t=>{const e=t.getBBox();return a?o.containsRect(e):o.isIntersectWithRect(e)}))}getEdgesInArea(t,e,n,r,i){const o="number"==typeof t?new Rectangle(t,e,n,r):Rectangle.create(t),s="number"==typeof t?i:e,a=s&&s.strict;return this.getEdges().filter((t=>{const e=t.getBBox();return 0===e.width?e.inflate(1,0):0===e.height&&e.inflate(0,1),a?o.containsRect(e):o.isIntersectWithRect(e)}))}getNodesUnderNode(t,e={}){const n=t.getBBox();return(null==e.by||"bbox"===e.by?this.getNodesInArea(n):this.getNodesFromPoint(n[e.by])).filter((e=>t.id!==e.id&&!e.isDescendantOf(t)))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(t,e={}){return Cell.getCellsBBox(t,e)}search(t,e,n={}){n.breadthFirst?this.breadthFirstSearch(t,e,n):this.depthFirstSearch(t,e,n)}breadthFirstSearch(t,e,n={}){const r=[],i={},o={};for(r.push(t),o[t.id]=0;r.length>0;){const t=r.shift();null==t||i[t.id]||(i[t.id]=!0,!1!==call(e,this,t,o[t.id])&&this.getNeighbors(t,n).forEach((e=>{o[e.id]=o[t.id]+1,r.push(e)})))}}depthFirstSearch(t,e,n={}){const r=[],i={},o={};for(r.push(t),o[t.id]=0;r.length>0;){const t=r.pop();if(null==t||i[t.id])continue;if(i[t.id]=!0,!1===call(e,this,t,o[t.id]))continue;const s=this.getNeighbors(t,n),a=r.length;s.forEach((e=>{o[e.id]=o[t.id]+1,r.splice(a,0,e)}))}}getShortestPath(t,e,n={}){const r={};this.getEdges().forEach((t=>{const e=t.getSourceCellId(),i=t.getTargetCellId();e&&i&&(r[e]||(r[e]=[]),r[i]||(r[i]=[]),r[e].push(i),n.directed||r[i].push(e))}));const i=Dijkstra.run(r,"string"==typeof t?t:t.id,n.weight),o=[];let s="string"==typeof e?e:e.id;for(i[s]&&o.push(s);s=i[s];)o.unshift(s);return o}translate(t,e,n){return this.getCells().filter((t=>!t.hasParent())).forEach((r=>r.translate(t,e,n))),this}resize(t,e,n){return this.resizeCells(t,e,this.getCells(),n)}resizeCells(t,e,n,r={}){const i=this.getCellsBBox(n);if(i){const o=Math.max(t/i.width,0),s=Math.max(e/i.height,0),a=i.getOrigin();n.forEach((t=>t.scale(o,s,a,r)))}return this}toJSON(t={}){return Model.toJSON(this.getCells(),t)}parseJSON(t){return Model.fromJSON(t)}fromJSON(t,e={}){const n=this.parseJSON(t);return this.resetCells(n,e),this}startBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)+1,this.notify("batch:start",{name:t,data:e}),this}stopBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)-1,this.notify("batch:stop",{name:t,data:e}),this}batchUpdate(t,e,n={}){this.startBatch(t,n);const r=e();return this.stopBatch(t,n),r}hasActiveBatch(t=Object.keys(this.batches)){return(Array.isArray(t)?t:[t]).some((t=>this.batches[t]>0))}}!function(t){t.toStringTag=`X6.${t.name}`,t.isModel=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.addNode&&"function"==typeof e.addEdge&&null!=e.collection}}(Model||(Model={})),function(t){t.toJSON=function(t,e={}){return{cells:t.map((t=>t.toJSON(e)))}},t.fromJSON=function(t){const e=[];return Array.isArray(t)?e.push(...t):(t.cells&&e.push(...t.cells),t.nodes&&t.nodes.forEach((t=>{null==t.shape&&(t.shape="rect"),e.push(t)})),t.edges&&t.edges.forEach((t=>{null==t.shape&&(t.shape="edge"),e.push(t)}))),e.map((t=>{const e=t.shape;if(e){if(Node$1.registry.exist(e))return Node$1.create(t);if(Edge$1.registry.exist(e))return Edge$1.create(t)}throw new Error("The `shape` should be specified when creating a node/edge instance")}))}}(Model||(Model={}));const contentSelector=".text-block-content",registryName=getName("text-block");class TextBlock extends Node$1{get content(){return this.getContent()}set content(t){this.setContent(t)}getContent(){return this.store.get("content","")}setContent(t,e={}){this.store.set("content",t,e)}setup(){super.setup(),this.store.on("change:*",(t=>{const e=t.key;"content"===e?this.updateContent(this.getContent()):"size"===e&&this.updateSize(this.getSize())})),this.updateSize(this.getSize()),this.updateContent(this.getContent())}updateSize(t){Platform.SUPPORT_FOREIGNOBJECT&&this.setAttrs({foreignObject:Object.assign({},t),[contentSelector]:{style:Object.assign({},t)}})}updateContent(t){this.setAttrs(Platform.SUPPORT_FOREIGNOBJECT?{[contentSelector]:{html:t?sanitizeHTML(t):""}}:{[contentSelector]:{text:t}})}}function getMarkup(t,e="body"){return[{tagName:t,selector:e},{tagName:"text",selector:"label"}]}function createShape(t,e,n={}){const r={constructorName:t,markup:getMarkup(t,n.selector),attrs:{[t]:Object.assign({},Base$1.bodyAttr)}};return(n.parent||Base$1).define(merge(r,e,{shape:t}))}!function(t){t.config({type:registryName,view:registryName,markup:['<g class="rotatable">','<g class="scalable"><rect/></g>',Platform.SUPPORT_FOREIGNOBJECT?["<foreignObject>",'<body xmlns="http://www.w3.org/1999/xhtml">',`<div class="${contentSelector.substr(1)}" />`,"</body>","</foreignObject>"].join(""):`<text class="${contentSelector.substr(1)}"/>`,"</g>"].join(""),attrs:{".":{fill:"#ffffff",stroke:"none"},rect:{fill:"#ffffff",stroke:"#000000",width:80,height:100},text:{fill:"#000000",fontSize:14,fontFamily:"Arial, helvetica, sans-serif"},body:{style:{background:"transparent",position:"static",margin:0,padding:0}},foreignObject:{style:{overflow:"hidden"}},[contentSelector]:{refX:.5,refY:.5,yAlign:"middle",xAlign:"middle",style:{textAlign:"center",verticalAlign:"middle",display:"table-cell",padding:"0 5px",margin:0}}}}),Node$1.registry.register(registryName,t)}(TextBlock||(TextBlock={})),function(t){const e="content";class n extends NodeView{confirmUpdate(t,n={}){let r=super.confirmUpdate(t,n);return this.hasAction(r,e)&&(this.updateContent(),r=this.removeAction(r,e)),r}update(t){if(Platform.SUPPORT_FOREIGNOBJECT)super.update(t);else{const e=this.cell,n=Object.assign({},t||e.getAttrs());delete n[contentSelector],super.update(n),t&&!has(t,contentSelector)||this.updateContent(t)}}updateContent(t){if(Platform.SUPPORT_FOREIGNOBJECT)super.update(t);else{const e=this.cell,n=(t||e.getAttrs())[contentSelector],r=breakText(e.getContent(),e.getSize(),n,{svgDocument:this.graph.view.svg}),i={[contentSelector]:merge({},n,{text:r})};super.update(i)}}}t.View=n,function(t){t.config({bootstrap:["render",e],actions:Platform.SUPPORT_FOREIGNOBJECT?{}:{size:e,content:e}}),NodeView.registry.register(registryName,t)}(n=t.View||(t.View={}))}(TextBlock||(TextBlock={})),Base$1.define({shape:"empty"}),createShape("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}}),Node$1.define({shape:"rect-headered",markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}],attrs:{body:Object.assign(Object.assign({},Base$1.bodyAttr),{refWidth:"100%",refHeight:"100%"}),header:Object.assign(Object.assign({},Base$1.bodyAttr),{refWidth:"100%",height:30,stroke:"#000000"}),headerText:Object.assign(Object.assign({},Base$1.labelAttr),{refX:"50%",refY:15,fontSize:16}),bodyText:Object.assign(Object.assign({},Base$1.labelAttr),{refY2:15})}}),createShape("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});const CYLINDER_TILT=10;Base$1.define({shape:"cylinder",overwrite:!0,markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],attrs:{body:Object.assign(Object.assign({},Base$1.bodyAttr),{lateral:CYLINDER_TILT}),top:Object.assign(Object.assign({},Base$1.bodyAttr),{refCx:"50%",refRx:"50%",cy:CYLINDER_TILT,ry:CYLINDER_TILT})},attrHooks:{lateral:{set(t,{refBBox:e}){const n=isPercentage(t);n&&(t=parseFloat(t)/100);const r=e.x,i=e.y,o=e.width,s=e.height,a=n?s*t:t,l=.551784,c=l*(o/2),u=l*a,h=r+o/2,d=r+o,f=i+a,p=f-a,g=i+s-a,m=i+s;return{d:["M",r,f,"L",r,g,"C",r,g+u,h-c,m,h,m,"C",h+c,m,d,g+u,d,g,"L",d,f,"C",d,f-u,h+c,p,h,p,"C",h-c,p,r,f-u,r,f,"Z"].join(" ")}}}},knob:{enabled:!0,position:({node:t})=>({x:0,y:t.attr("body/lateral")}),onMouseMove({node:t,data:e,deltaY:n}){if(0!==n){const r=t.getBBox(),i=t.attr("body/lateral");null==e.round&&(e.round=i);const o=clamp$1(e.round+n,0,r.height/2);o!==i&&t.attr({body:{lateral:o},top:{cy:o,ry:o}})}}}}),createShape("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var __rest$c=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Poly extends Base$1{get points(){return this.getPoints()}set points(t){this.setPoints(t)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(t,e){return null==t?this.removePoints():this.setAttrByPath("body/refPoints",Poly.pointsToString(t),e),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}!function(t){function e(t){return"string"==typeof t?t:t.map((t=>Array.isArray(t)?t.join(","):Point.isPointLike(t)?`${t.x}, ${t.y}`:"")).join(" ")}t.pointsToString=e,t.config({propHooks(t){const{points:n}=t,r=__rest$c(t,["points"]);if(n){const t=e(n);t&&setByPath(r,"attrs/body/refPoints",t)}return r}})}(Poly||(Poly={})),createShape("polygon",{},{parent:Poly}),createShape("polyline",{},{parent:Poly});var __rest$b=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};Base$1.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(t){const{path:e}=t,n=__rest$b(t,["path"]);return e&&setByPath(n,"attrs/body/refD",e),n}});var __rest$a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};Base$1.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},Platform.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:ns.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Base$1.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(t){const{text:e}=t,n=__rest$a(t,["text"]);return e&&setByPath(n,"attrs/label/text",e),n},attrHooks:{text:{set(t,{cell:e,view:n,refBBox:r,elem:i,attrs:o}){if(!(i instanceof HTMLElement)){const s=o.style||{},a={text:t,width:-5,height:"100%"},l=Object.assign({textVerticalAnchor:"middle"},s);return call(Attr.presets.textWrap.set,this,a,{cell:e,view:n,elem:i,refBBox:r,attrs:l}),{fill:s.color||null}}i.textContent=t},position(t,{refBBox:e,elem:n}){if(n instanceof SVGElement)return e.getCenter()}}}}),createShape("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:getImageUrlHook()},{selector:"image"}),createShape("image-bordered",{markup:[{tagName:"rect",selector:"background",attrs:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{background:{refWidth:-1,refHeight:-1,x:.5,y:.5,fill:"#ffffff"},border:{refWidth:"100%",refHeight:"100%",stroke:"#333333",strokeWidth:2},image:{refWidth:-1,refHeight:-1,x:.5,y:.5}},propHooks:getImageUrlHook()}),createShape("image-embedded",{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}],attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{refWidth:"30%",refHeight:-20,x:10,y:10,preserveAspectRatio:"xMidYMin"}},propHooks:getImageUrlHook()}),createShape("image-inscribed",{propHooks:getImageUrlHook(),markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attrs:{fill:"none"}},{tagName:"text",selector:"label"}],attrs:{border:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",stroke:"#333333",strokeWidth:2},background:{refRx:"50%",refRy:"50%",refCx:"50%",refCy:"50%",fill:"#ffffff"},image:{refWidth:"68%",refHeight:"68%",refX:"16%",refY:"16%",preserveAspectRatio:"xMidYMid"}}});const Edge=Edge$1.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});Edge$1.define({shape:"shadow-edge",markup:[{tagName:"path",selector:"shadow",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}},shadow:{connection:!0,refX:3,refY:6,stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{name:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none",offsetX:-5},sourceMarker:{name:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z",offsetX:-5}}}}),Edge$1.define({shape:"double-edge",markup:[{tagName:"path",selector:"outline",attrs:{fill:"none"}},{tagName:"path",selector:"line",attrs:{fill:"none",cursor:"pointer"}}],attrs:{line:{connection:!0,stroke:"#dddddd",strokeWidth:4,strokeLinejoin:"round",targetMarker:{tagName:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}});class HTML extends Base$1{get html(){return this.getHTML()}set html(t){this.setHTML(t)}getHTML(){return this.store.get("html")}setHTML(t,e={}){return null==t?this.removeHTML(e):this.store.set("html",t,e),this}removeHTML(t={}){return this.store.remove("html",t)}}!function(t){class e extends NodeView{init(){super.init(),this.cell.on("change:*",(()=>{this.graph.hook.shouldUpdateHTMLComponent(this.cell)&&this.renderHTMLComponent()}))}confirmUpdate(t){const n=super.confirmUpdate(t);return this.handleAction(n,e.action,(()=>this.renderHTMLComponent()))}renderHTMLComponent(){const t=this.selectors.foContent;if(t){const e=this.$(t).empty(),n=this.graph.hook.getHTMLComponent(this.cell);n&&("string"==typeof n?e.html(n):e.append(n))}}}t.View=e,function(t){t.action="html",t.config({bootstrap:[t.action],actions:{html:t.action}}),NodeView.registry.register("html-view",t)}(e=t.View||(t.View={}))}(HTML||(HTML={})),function(t){t.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Markup.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Node$1.registry.register("html",t)}(HTML||(HTML={})),(HTML||(HTML={})).componentRegistry=Registry.create({type:"html componnet"});var __decorate$q=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class AutoSave extends Disablable{constructor(t){super(),this.delay=10,this.throttle=2,this.threshold=5,this.changeCount=0,this.timestamp=0,this.options=Object.assign(Object.assign({},AutoSave.defaultOptions),t),this.graph.model.on("cell:change:*",this.onModelChanged,this)}get graph(){return this.options.graph}onModelChanged(){if(this.disabled)return;const t=((new Date).getTime()-this.timestamp)/1e3;t>this.delay||this.changeCount>=this.threshold&&t>this.throttle?(this.save(),this.reset()):this.changeCount+=1}save(){this.trigger("save")}reset(){this.changeCount=0,this.timestamp=(new Date).getTime()}dispose(){this.graph.model.off("cell:change:*",this.onModelChanged,this)}}__decorate$q([Disablable.dispose()],AutoSave.prototype,"dispose",null),(AutoSave||(AutoSave={})).defaultOptions={delay:10,throttle:2,threshold:5};class Base extends Disposable{constructor(t){super(),this.graph=t,this.init()}get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}init(){}}var __decorate$p=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Decorator$1;class GraphView extends View{constructor(t){super(),this.graph=t;const{selectors:e,fragment:n}=Markup.parseJSONMarkup(GraphView.markup);this.background=e.background,this.grid=e.grid,this.svg=e.svg,this.defs=e.defs,this.viewport=e.viewport,this.primer=e.primer,this.stage=e.stage,this.decorator=e.decorator,this.overlay=e.overlay,this.container=this.options.container,this.restore=GraphView.snapshoot(this.container),this.$(this.container).addClass(this.prefixClassName("graph")).append(n),this.delegateEvents()}get model(){return this.graph.model}get options(){return this.graph.options}delegateEvents(){return super.delegateEvents(this.constructor.events),this}guard(t,e){return"mousedown"===t.type&&2===t.button||!(!this.options.guard||!this.options.guard(t,e))||(t.data&&void 0!==t.data.guarded?t.data.guarded:!(e&&e.cell&&Cell.isCell(e.cell)||this.svg===t.target||this.container===t.target||jquery.contains(this.svg,t.target)))}findView(t){return this.graph.renderer.findViewByElem(t)}onDblClick(t){this.options.preventDefaultDblClick&&t.preventDefault();const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const r=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onDblClick(e,r.x,r.y):this.graph.trigger("blank:dblclick",{e,x:r.x,y:r.y})}onClick(t){if(this.getMouseMovedCount(t)<=this.options.clickThreshold){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const r=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onClick(e,r.x,r.y):this.graph.trigger("blank:click",{e,x:r.x,y:r.y})}}isPreventDefaultContextMenu(t,e){let n=this.options.preventDefaultContextMenu;return"function"==typeof n&&(n=call(n,this.graph,{view:e})),n}onContextMenu(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.isPreventDefaultContextMenu(e,n)&&t.preventDefault(),this.guard(e,n))return;const r=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onContextMenu(e,r.x,r.y):this.graph.trigger("blank:contextmenu",{e,x:r.x,y:r.y})}delegateDragEvents(t,e){null==t.data&&(t.data={}),this.setEventData(t,{currentView:e||null,mouseMovedCount:0,startPosition:{x:t.clientX,y:t.clientY}}),this.delegateDocumentEvents(this.constructor.documentEvents,t.data),this.undelegateEvents()}getMouseMovedCount(t){return this.getEventData(t).mouseMovedCount||0}onMouseDown(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;this.options.preventDefaultMouseDown&&e.preventDefault();const r=this.graph.snapToGrid(e.clientX,e.clientY);n?n.onMouseDown(e,r.x,r.y):(this.options.preventDefaultBlankAction&&e.preventDefault(),this.graph.trigger("blank:mousedown",{e,x:r.x,y:r.y})),this.delegateDragEvents(e,n)}onMouseMove(t){const e=this.getEventData(t),n=e.startPosition;if(n&&n.x===t.clientX&&n.y===t.clientY)return;if(null==e.mouseMovedCount&&(e.mouseMovedCount=0),e.mouseMovedCount+=1,e.mouseMovedCount<=this.options.moveThreshold)return;const r=this.normalizeEvent(t),i=this.graph.snapToGrid(r.clientX,r.clientY),o=e.currentView;o?o.onMouseMove(r,i.x,i.y):this.graph.trigger("blank:mousemove",{e:r,x:i.x,y:i.y}),this.setEventData(r,e)}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY),r=this.getEventData(t).currentView;r?r.onMouseUp(e,n.x,n.y):this.graph.trigger("blank:mouseup",{e,x:n.x,y:n.y}),t.isPropagationStopped()||this.onClick(jquery.Event(t,{type:"click",data:t.data})),t.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(!this.guard(e,n))if(n)n.onMouseOver(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseover",{e})}}onMouseOut(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(!this.guard(e,n))if(n)n.onMouseOut(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseout",{e})}}onMouseEnter(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const r=this.graph.renderer.findViewByElem(e.relatedTarget);if(n){if(r===n)return;n.onMouseEnter(e)}else{if(r)return;this.graph.trigger("graph:mouseenter",{e})}}onMouseLeave(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const r=this.graph.renderer.findViewByElem(e.relatedTarget);if(n){if(r===n)return;n.onMouseLeave(e)}else{if(r)return;this.graph.trigger("graph:mouseleave",{e})}}onMouseWheel(t){const e=this.normalizeEvent(t),n=this.findView(e.target);if(this.guard(e,n))return;const r=e.originalEvent,i=this.graph.snapToGrid(r.clientX,r.clientY),o=Math.max(-1,Math.min(1,r.wheelDelta||-r.detail));n?n.onMouseWheel(e,i.x,i.y,o):this.graph.trigger("blank:mousewheel",{e,delta:o,x:i.x,y:i.y})}onCustomEvent(t){const e=t.currentTarget,n=e.getAttribute("event")||e.getAttribute("data-event");if(n){const r=this.findView(e);if(r){const e=this.normalizeEvent(t);if(this.guard(e,r))return;const i=this.graph.snapToGrid(e.clientX,e.clientY);r.onCustomEvent(e,n,i.x,i.y)}}}handleMagnetEvent(t,e){const n=t.currentTarget,r=n.getAttribute("magnet");if(r&&"false"!==r.toLowerCase()){const r=this.findView(n);if(r){const i=this.normalizeEvent(t);if(this.guard(i,r))return;const o=this.graph.snapToGrid(i.clientX,i.clientY);call(e,this.graph,r,i,n,o.x,o.y)}}}onMagnetMouseDown(t){this.handleMagnetEvent(t,((t,e,n,r,i)=>{t.onMagnetMouseDown(e,n,r,i)}))}onMagnetDblClick(t){this.handleMagnetEvent(t,((t,e,n,r,i)=>{t.onMagnetDblClick(e,n,r,i)}))}onMagnetContextMenu(t){const e=this.normalizeEvent(t),n=this.findView(e.target);this.isPreventDefaultContextMenu(e,n)&&e.preventDefault(),this.handleMagnetEvent(e,((t,e,n,r,i)=>{t.onMagnetContextMenu(e,n,r,i)}))}onLabelMouseDown(t){const e=this.findView(t.currentTarget);if(e){const n=this.normalizeEvent(t);if(this.guard(n,e))return;const r=this.graph.snapToGrid(n.clientX,n.clientY);e.onLabelMouseDown(n,r.x,r.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}__decorate$p([View.dispose()],GraphView.prototype,"dispose",null),function(t){const e=`${Config.prefixCls}-graph`;t.markup=[{ns:ns.xhtml,tagName:"div",selector:"background",className:`${e}-background`},{ns:ns.xhtml,tagName:"div",selector:"grid",className:`${e}-grid`},{ns:ns.svg,tagName:"svg",selector:"svg",className:`${e}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":ns.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${e}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${e}-svg-primer`},{tagName:"g",selector:"stage",className:`${e}-svg-stage`},{tagName:"g",selector:"decorator",className:`${e}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${e}-svg-overlay`}]}]}],t.snapshoot=function(t){const e=t.cloneNode();return t.childNodes.forEach((t=>e.appendChild(t))),()=>{for(empty(t);t.attributes.length>0;)t.removeAttribute(t.attributes[0].name);for(let n=0,r=e.attributes.length;n<r;n+=1){const r=e.attributes[n];t.setAttribute(r.name,r.value)}e.childNodes.forEach((e=>t.appendChild(e)))}}}(GraphView||(GraphView={})),function(t){const e=Config.prefixCls;t.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${e}-cell`]:"onMouseEnter",[`mouseleave  .${e}-cell`]:"onMouseLeave",[`mouseenter  .${e}-cell-tools`]:"onMouseEnter",[`mouseleave  .${e}-cell-tools`]:"onMouseLeave",[`mousedown   .${e}-cell [event]`]:"onCustomEvent",[`touchstart  .${e}-cell [event]`]:"onCustomEvent",[`mousedown   .${e}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${e}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${e}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${e}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${e}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${e}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${e}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${e}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${e}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${e}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${e}-cell image`]:"onImageDragStart",[`mousedown   .${e}-edge .${e}-edge-label`]:"onLabelMouseDown",[`touchstart  .${e}-edge .${e}-edge-label`]:"onLabelMouseDown"},t.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(GraphView||(GraphView={})),(Decorator$1||(Decorator$1={})).checkScroller=function(t,e){return(n,r,i)=>{const o=i.value;i.value=function(...n){if(null==this.scroller.widget){const n=`Shoule enable scroller to use method '${r}'`;if(!1!==t)throw console.error(n),new Error(n);return!1!==e&&console.warn(n),this}return o.call(this,...n)}}};const content=".x6-graph {\n  position: relative;\n  outline: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n@keyframes halo-pie-visibility {\n  0% {\n    visibility: hidden;\n  }\n  100% {\n    visibility: visible;\n  }\n}\n@keyframes halo-pie-opening {\n  0% {\n    transform: scale(0.4) rotate(-20deg);\n  }\n  100% {\n    transform: scale(1) rotate(0);\n  }\n}\n.x6-widget-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: 0 0;\n  background-size: 20px 20px;\n  cursor: pointer;\n  user-select: none;\n  pointer-events: auto;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-handle.hidden {\n  display: none;\n}\n.x6-widget-handle-selected {\n  background-color: rgba(0, 0, 0, 0.1);\n  border-radius: 3px;\n}\n.x6-widget-handle-remove {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%20M4.152%2C14.598C1.273%2C11.719%2C1.273%2C7.035%2C4.153%2C4.154%20c2.88-2.88%2C7.563-2.88%2C10.443%2C0c2.881%2C2.88%2C2.881%2C7.562%2C0%2C10.443C11.716%2C17.477%2C7.032%2C17.477%2C4.152%2C14.598L4.152%2C14.598z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n  cursor: pointer;\n}\n.x6-widget-handle-remove:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15.386%2C3.365c-3.315-3.314-8.707-3.313-12.021%2C0c-3.314%2C3.315-3.314%2C8.706%2C0%2C12.02%20c3.314%2C3.314%2C8.707%2C3.314%2C12.021%2C0S18.699%2C6.68%2C15.386%2C3.365L15.386%2C3.365z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M12.157%2C11.371L7.38%2C6.593C7.162%2C6.375%2C6.809%2C6.375%2C6.592%2C6.592c-0.218%2C0.219-0.218%2C0.572%2C0%2C0.79%20l4.776%2C4.776c0.218%2C0.219%2C0.571%2C0.219%2C0.79%2C0C12.375%2C11.941%2C12.375%2C11.588%2C12.157%2C11.371L12.157%2C11.371z%22%2F%3E%3Cpath%20fill%3D%22%23FFFFFF%22%20d%3D%22M11.369%2C6.593l-4.777%2C4.778c-0.217%2C0.217-0.217%2C0.568%2C0%2C0.787c0.219%2C0.219%2C0.571%2C0.217%2C0.788%2C0l4.777-4.777%20c0.218-0.218%2C0.218-0.571%2C0.001-0.789C11.939%2C6.375%2C11.587%2C6.375%2C11.369%2C6.593L11.369%2C6.593z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-rotate {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n}\n.x6-widget-handle-rotate:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.374%2C17.592c-4.176%2C0-7.57-3.401-7.57-7.575c0-4.175%2C3.395-7.574%2C7.57-7.574c0.28%2C0%2C0.56%2C0.018%2C0.837%2C0.05%20V1.268c0-0.158%2C0.099-0.3%2C0.239-0.36c0.151-0.058%2C0.315-0.026%2C0.428%2C0.086l2.683%2C2.688c0.152%2C0.154%2C0.152%2C0.399%2C0%2C0.553l-2.68%2C2.693%20c-0.115%2C0.112-0.279%2C0.147-0.431%2C0.087c-0.141-0.063-0.239-0.205-0.239-0.361V5.296C9.934%2C5.243%2C9.654%2C5.22%2C9.374%2C5.22%20c-2.646%2C0-4.796%2C2.152-4.796%2C4.797s2.154%2C4.798%2C4.796%2C4.798c2.645%2C0%2C4.798-2.153%2C4.798-4.798c0-0.214%2C0.174-0.391%2C0.391-0.391h1.991%20c0.217%2C0%2C0.394%2C0.177%2C0.394%2C0.391C16.947%2C14.19%2C13.549%2C17.592%2C9.374%2C17.592L9.374%2C17.592z%20M9.374%2C17.592%22%2F%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-resize {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%236A6C8A%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');\n  cursor: se-resize;\n}\n.x6-widget-handle-resize:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3Csvg%20height%3D%2224px%22%20version%3D%221.1%22%20viewBox%3D%220%200%2024%2024%22%20width%3D%2224px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asketch%3D%22http%3A%2F%2Fwww.bohemiancoding.com%2Fsketch%2Fns%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%2F%3E%3Cdesc%2F%3E%3Cdefs%2F%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20id%3D%22miu%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%3E%3Cg%20id%3D%22Artboard-1%22%20transform%3D%22translate(-251.000000%2C%20-443.000000)%22%3E%3Cg%20id%3D%22slice%22%20transform%3D%22translate(215.000000%2C%20119.000000)%22%2F%3E%3Cpath%20d%3D%22M252%2C448%20L256%2C448%20L256%2C444%20L252%2C444%20L252%2C448%20Z%20M257%2C448%20L269%2C448%20L269%2C446%20L257%2C446%20L257%2C448%20Z%20M257%2C464%20L269%2C464%20L269%2C462%20L257%2C462%20L257%2C464%20Z%20M270%2C444%20L270%2C448%20L274%2C448%20L274%2C444%20L270%2C444%20Z%20M252%2C462%20L252%2C466%20L256%2C466%20L256%2C462%20L252%2C462%20Z%20M270%2C462%20L270%2C466%20L274%2C466%20L274%2C462%20L270%2C462%20Z%20M254%2C461%20L256%2C461%20L256%2C449%20L254%2C449%20L254%2C461%20Z%20M270%2C461%20L272%2C461%20L272%2C449%20L270%2C449%20L270%2C461%20Z%22%20fill%3D%22%23FD6EB6%22%20id%3D%22editor-crop-glyph%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E');\n}\n.x6-widget-handle-clone {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.85%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n}\n.x6-widget-handle-clone:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.852%2C0.875h-9.27c-0.853%2C0-1.547%2C0.694-1.547%2C1.547v10.816h1.547V2.422h9.27V0.875z%20M15.172%2C3.965h-8.5%20c-0.849%2C0-1.547%2C0.698-1.547%2C1.547v10.816c0%2C0.849%2C0.698%2C1.547%2C1.547%2C1.547h8.5c0.849%2C0%2C1.543-0.698%2C1.543-1.547V5.512%20C16.715%2C4.663%2C16.021%2C3.965%2C15.172%2C3.965L15.172%2C3.965z%20M15.172%2C16.328h-8.5V5.512h8.5V16.328z%20M15.172%2C16.328%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-link {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}\n.x6-widget-handle-link:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M9.884%2C9.838c0.54-0.551%2C1.005-0.955%2C1.384-1.201c0.463-0.308%2C0.749-0.352%2C0.887-0.352h1.34v1.367%20c0%2C0.104%2C0.061%2C0.2%2C0.154%2C0.242s0.204%2C0.027%2C0.284-0.038l3.168-2.669c0.06-0.051%2C0.096-0.125%2C0.096-0.203S17.16%2C6.83%2C17.101%2C6.781%20l-3.168-2.677c-0.08-0.067-0.19-0.081-0.284-0.038c-0.094%2C0.045-0.154%2C0.139-0.154%2C0.242v1.414h-1.343%20c-1.24%2C0.014-2.215%2C0.67-2.927%2C1.242c-0.797%2C0.65-1.533%2C1.447-2.245%2C2.217c-0.361%2C0.391-0.7%2C0.759-1.044%2C1.1%20c-0.541%2C0.549-1.011%2C0.951-1.395%2C1.199c-0.354%2C0.231-0.678%2C0.357-0.921%2C0.357h-1.8c-0.146%2C0-0.266%2C0.12-0.266%2C0.265v2.029%20c0%2C0.148%2C0.12%2C0.268%2C0.266%2C0.268h1.8l0%2C0c1.255-0.014%2C2.239-0.667%2C2.958-1.24c0.82-0.661%2C1.572-1.475%2C2.297-2.256%20C9.225%2C10.524%2C9.555%2C10.169%2C9.884%2C9.838z%22%2F%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-fork {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%236A6C8A%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20C7.552%2C9.82%2C7.602%2C9.589%2C7.602%2C9.344c0-0.25-0.051-0.487-0.129-0.71l4.097-2.364c0.393%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.014%2C0.149%2C0.021%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.982%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.014%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n  cursor: move;\n}\n.x6-widget-handle-fork:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20fill%3D%22%23FD6EB6%22%20d%3D%22M13.307%2C11.593c-0.69%2C0-1.299%2C0.33-1.693%2C0.835l-4.136-2.387%20c0.075-0.22%2C0.125-0.452%2C0.125-0.697c0-0.25-0.051-0.487-0.129-0.71l4.097-2.365c0.394%2C0.536%2C1.022%2C0.888%2C1.737%2C0.888%20c1.193%2C0%2C2.16-0.967%2C2.16-2.159s-0.967-2.159-2.16-2.159c-1.191%2C0-2.158%2C0.967-2.158%2C2.159c0%2C0.076%2C0.015%2C0.148%2C0.022%2C0.223%20L6.848%2C7.716C6.469%2C7.39%2C5.981%2C7.185%2C5.442%2C7.185c-1.191%2C0-2.158%2C0.967-2.158%2C2.159s0.967%2C2.159%2C2.158%2C2.159%20c0.545%2C0%2C1.037-0.208%2C1.417-0.541l4.319%2C2.493c-0.013%2C0.098-0.029%2C0.194-0.029%2C0.296c0%2C1.193%2C0.967%2C2.159%2C2.158%2C2.159%20c1.193%2C0%2C2.16-0.966%2C2.16-2.159C15.467%2C12.559%2C14.5%2C11.593%2C13.307%2C11.593z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-unlink {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-unlink:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20version%3D%221.1%22%20id%3D%22Layer_1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2218.75px%22%20height%3D%2218.75px%22%20viewBox%3D%220%200%2018.75%2018.75%22%20enable-background%3D%22new%200%200%2018.75%2018.75%22%20xml%3Aspace%3D%22preserve%22%3E%3Cg%3E%3Cg%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M12.285%2C9.711l-2.104-0.302L9.243%2C8.568L6.669%2C7.095C6.948%2C6.6%2C6.995%2C6.026%2C6.845%2C5.474%20c-0.191-0.698-0.695-1.36-1.438-1.786C4.068%2C2.922%2C2.464%2C3.214%2C1.82%2C4.338C1.536%2C4.836%2C1.489%2C5.414%2C1.64%2C5.97%20c0.189%2C0.698%2C0.694%2C1.36%2C1.438%2C1.787c0.328%2C0.187%2C0.67%2C0.31%2C1.01%2C0.372c0.002%2C0%2C0.006%2C0.002%2C0.008%2C0.004%20c0.027%2C0.004%2C0.057%2C0.009%2C0.088%2C0.011c2.12%2C0.316%2C3.203%2C0.915%2C3.73%2C1.337c-0.527%2C0.424-1.61%2C1.021-3.731%2C1.339%20c-0.029%2C0.003-0.058%2C0.007-0.087%2C0.012c-0.002%2C0.002-0.004%2C0.002-0.007%2C0.003c-0.341%2C0.062-0.684%2C0.187-1.013%2C0.374%20c-0.74%2C0.425-1.246%2C1.089-1.437%2C1.787c-0.149%2C0.555-0.105%2C1.133%2C0.181%2C1.632c0.011%2C0.018%2C0.021%2C0.033%2C0.033%2C0.049l0.883%2C0.783%20c0.765%2C0.366%2C1.775%2C0.328%2C2.67-0.184c0.744-0.425%2C1.248-1.088%2C1.439-1.786c0.148-0.552%2C0.104-1.126-0.176-1.62l2.573-1.473%20c0.573%2C0.287%2C2.299%2C1.292%2C2.299%2C1.292s3.602%2C1.445%2C4.241%2C1.812c0.773%2C0.191%2C0.566-0.151%2C0.566-0.151L12.285%2C9.711z%20M5.571%2C6.482%20C5.279%2C6.993%2C4.425%2C7.076%2C3.705%2C6.664C3.282%2C6.424%2C2.966%2C6.039%2C2.856%2C5.64C2.81%2C5.464%2C2.778%2C5.203%2C2.917%2C4.963%20c0.291-0.51%2C1.146-0.593%2C1.866-0.182C5.21%2C5.027%2C5.521%2C5.4%2C5.632%2C5.807C5.679%2C5.98%2C5.708%2C6.242%2C5.571%2C6.482z%20M5.632%2C13.159%20c-0.111%2C0.406-0.422%2C0.778-0.848%2C1.025c-0.719%2C0.409-1.576%2C0.327-1.867-0.184c-0.137-0.239-0.106-0.499-0.06-0.676%20c0.108-0.398%2C0.426-0.781%2C0.847-1.022c0.72-0.412%2C1.574-0.329%2C1.866%2C0.181C5.708%2C12.723%2C5.679%2C12.983%2C5.632%2C13.159z%20M16.181%2C5.139%20c-0.448%2C0.258-4.435%2C1.9-4.435%2C1.9s-1.556%2C0.855-2.104%2C1.13l0.937%2C0.843l2.057-0.229l4.11-3.638%20C16.745%2C5.146%2C17.013%2C4.664%2C16.181%2C5.139z%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%20');\n}\n.x6-widget-handle-direction {\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%236A6C8A%3Bstroke%3A%236A6C8A%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%236A6C8A%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E\");\n}\n.x6-widget-handle-direction:hover {\n  background-image: url(\"data:image/svg+xml;charset=UTF-8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20%20PUBLIC%20'-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN'%20%20'http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd'%3E%3Csvg%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%20512%20512%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%20512%20512%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%09.st0%7Bfill%3A%23FD6EB6%3Bstroke%3A%23FD6EB6%3Bstroke-width%3A30%7D%0A%09.dot%7Bfill%3A%23FD6EB6%3B%7D%0A%3C%2Fstyle%3E%3Cg%3E%3Cg%20id%3D%22XMLID_475_%22%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M133.1%2C277.1c1.8%2C0%2C3.7-0.6%2C5.4-1.7c4.1-3%2C5-8.7%2C2-12.8c-3-4.1-8.7-5-12.8-2c0%2C0%2C0%2C0%2C0%2C0%20%20%20%20%20c-4.1%2C3-5%2C8.7-2%2C12.8C127.5%2C275.8%2C130.3%2C277.1%2C133.1%2C277.1z%22%20id%3D%22XMLID_489_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M138.5%2C359.6c-4.1-3-9.8-2.1-12.8%2C2c-3%2C4.1-2.1%2C9.8%2C2%2C12.8c1.6%2C1.2%2C3.5%2C1.7%2C5.4%2C1.7%20%20%20%20%20c2.8%2C0%2C5.6-1.3%2C7.4-3.7C143.5%2C368.3%2C142.6%2C362.6%2C138.5%2C359.6z%22%20id%3D%22XMLID_726_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C327.7c-4.8%2C1.6-7.4%2C6.7-5.9%2C11.5c1.3%2C3.9%2C4.8%2C6.3%2C8.7%2C6.3c0.9%2C0%2C1.9-0.1%2C2.8-0.4%20%20%20%20%20c4.8-1.6%2C7.4-6.7%2C5.9-11.5C118%2C328.8%2C112.9%2C326.2%2C108.1%2C327.7z%22%20id%3D%22XMLID_776_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M108.1%2C307.3c0.9%2C0.3%2C1.9%2C0.4%2C2.8%2C0.4c3.8%2C0%2C7.4-2.4%2C8.7-6.3c1.6-4.8-1.1-9.9-5.9-11.5%20%20%20%20%20c-4.8-1.6-9.9%2C1.1-11.5%2C5.9C100.7%2C300.6%2C103.3%2C305.7%2C108.1%2C307.3z%22%20id%3D%22XMLID_777_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M169.2%2C265.4c2.4%2C0%2C4.7-1%2C6.5-2.6c1.7-1.7%2C2.7-4.1%2C2.7-6.5c0-2.4-1-4.8-2.7-6.5%20%20%20%20%20c-1.7-1.7-4.1-2.7-6.5-2.7s-4.7%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.5C164.4%2C264.4%2C166.8%2C265.4%2C169.2%2C265.4z%22%20id%3D%22XMLID_797_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M247.7%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C243.7%2C265.4%2C247.7%2C261.3%2C247.7%2C256.3z%22%20id%3D%22XMLID_798_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M213%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C208.9%2C265.4%2C213%2C261.3%2C213%2C256.3z%22%20id%3D%22XMLID_799_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M317.2%2C256.3c0-5-4.1-9.1-9.1-9.1c-5%2C0-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20C313.1%2C265.4%2C317.2%2C261.3%2C317.2%2C256.3z%22%20id%3D%22XMLID_800_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M282.5%2C256.3c0-5-4.1-9.1-9.1-9.1s-9.1%2C4.1-9.1%2C9.1c0%2C5%2C4.1%2C9.1%2C9.1%2C9.1%20%20%20%20%20S282.5%2C261.3%2C282.5%2C256.3z%22%20id%3D%22XMLID_801_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M401.1%2C185.2c0.9%2C0%2C1.9-0.1%2C2.8-0.5c4.8-1.6%2C7.4-6.7%2C5.9-11.5c-1.6-4.8-6.7-7.4-11.5-5.8%20%20%20%20%20c-4.8%2C1.6-7.4%2C6.7-5.8%2C11.5C393.6%2C182.8%2C397.2%2C185.2%2C401.1%2C185.2z%22%20id%3D%22XMLID_802_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M403.9%2C205.2c-4.8-1.6-9.9%2C1-11.5%2C5.9l0%2C0c-1.6%2C4.8%2C1.1%2C9.9%2C5.9%2C11.5%20%20%20%20%20c0.9%2C0.3%2C1.9%2C0.5%2C2.8%2C0.5c3.9%2C0%2C7.4-2.5%2C8.7-6.3c0%2C0%2C0%2C0%2C0%2C0C411.3%2C211.9%2C408.7%2C206.8%2C403.9%2C205.2z%22%20id%3D%22XMLID_803_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C237.2L373.5%2C237.2c-4.1%2C3-5%2C8.7-2%2C12.8c1.8%2C2.4%2C4.6%2C3.7%2C7.4%2C3.7%20%20%20%20%20c1.8%2C0%2C3.7-0.6%2C5.4-1.8c4.1-3%2C4.9-8.7%2C2-12.8C383.3%2C235.1%2C377.6%2C234.2%2C373.5%2C237.2z%22%20id%3D%22XMLID_804_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M373.5%2C152.9c1.6%2C1.2%2C3.5%2C1.8%2C5.4%2C1.8c2.8%2C0%2C5.6-1.3%2C7.4-3.8c3-4.1%2C2.1-9.8-2-12.7%20%20%20%20%20c-4.1-3-9.8-2.1-12.7%2C2C368.5%2C144.2%2C369.4%2C149.9%2C373.5%2C152.9z%22%20id%3D%22XMLID_805_%22%2F%3E%0A%3Cpath%20class%3D%22dot%22%20d%3D%22M342.8%2C247.1c-2.4%2C0-4.8%2C1-6.5%2C2.7c-1.7%2C1.7-2.7%2C4-2.7%2C6.5c0%2C2.4%2C1%2C4.7%2C2.7%2C6.4%20%20%20%20%20c1.7%2C1.7%2C4%2C2.7%2C6.5%2C2.7c2.4%2C0%2C4.7-1%2C6.5-2.7c1.7-1.7%2C2.7-4%2C2.7-6.4c0-2.4-1-4.8-2.7-6.5C347.6%2C248.1%2C345.2%2C247.1%2C342.8%2C247.1z%22%20id%3D%22XMLID_806_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M342.8%2C124.7H206.6l36.4-36.4c3.6-3.6%2C3.6-9.3%2C0-12.9c-3.6-3.6-9.3-3.6-12.9%2C0l-51.5%2C51.5%20%20%20%20%20c-1.9%2C1.9-2.8%2C4.4-2.7%2C6.9c-0.1%2C2.5%2C0.7%2C5%2C2.7%2C6.9l51.5%2C51.5c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7%20%20%20%20%20c3.6-3.6%2C3.6-9.3%2C0-12.9l-36.4-36.4h136.1c0%2C0%2C0.1%2C0%2C0.1%2C0c0.6%2C0%2C1.2-0.1%2C1.8-0.2c0.2%2C0%2C0.4-0.1%2C0.6-0.1c0.1%2C0%2C0.2%2C0%2C0.3-0.1%20%20%20%20%20c3.2-1%2C5.6-3.6%2C6.3-6.9c0.1-0.6%2C0.2-1.2%2C0.2-1.8c0-0.6-0.1-1.2-0.2-1.8C351%2C127.8%2C347.3%2C124.7%2C342.8%2C124.7z%22%20id%3D%22XMLID_807_%22%2F%3E%0A%3Cpath%20class%3D%22st0%22%20d%3D%22M322.1%2C371.3l-51.5-51.5c-3.6-3.6-9.3-3.6-12.9%2C0c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9l36.9%2C36.9H169.2%20%20%20%20%20c-2.8%2C0-5.4%2C1.3-7%2C3.3c-0.1%2C0.1-0.2%2C0.2-0.3%2C0.4c-0.1%2C0.1-0.2%2C0.2-0.2%2C0.3c-0.1%2C0.1-0.1%2C0.2-0.2%2C0.4c-0.1%2C0.1-0.2%2C0.3-0.2%2C0.4%20%20%20%20%20c0%2C0.1-0.1%2C0.2-0.1%2C0.2c-0.1%2C0.2-0.2%2C0.4-0.3%2C0.6c0%2C0%2C0%2C0%2C0%2C0.1c-0.4%2C1.1-0.7%2C2.2-0.7%2C3.4c0%2C1.5%2C0.4%2C2.9%2C1%2C4.2c0%2C0%2C0%2C0.1%2C0.1%2C0.1%20%20%20%20%20c0.1%2C0.1%2C0.1%2C0.2%2C0.2%2C0.3c0.4%2C0.7%2C0.9%2C1.3%2C1.4%2C1.8c0.4%2C0.4%2C0.7%2C0.7%2C1.2%2C1c0.1%2C0.1%2C0.1%2C0.1%2C0.2%2C0.2c0%2C0%2C0.1%2C0%2C0.1%2C0.1%20%20%20%20%20c1.4%2C0.9%2C3.1%2C1.5%2C5%2C1.5h124.4l-36%2C36c-3.6%2C3.6-3.6%2C9.3%2C0%2C12.9c1.8%2C1.8%2C4.1%2C2.7%2C6.5%2C2.7c2.3%2C0%2C4.7-0.9%2C6.5-2.7l51.5-51.5%20%20%20%20%20c1.9-1.9%2C2.8-4.4%2C2.7-6.9C324.8%2C375.7%2C324%2C373.2%2C322.1%2C371.3z%22%20id%3D%22XMLID_808_%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E\");\n}\n.x6-widget-handle-surround .x6-widget-handle-animate .x6-widget-handle {\n  transition: background-size 80ms, width 80ms, height 80ms, top 150ms, left 150ms, bottom 150ms, right 150ms;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-se {\n  right: -25px;\n  bottom: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-nw {\n  top: -21px;\n  left: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-n {\n  top: -22px;\n  left: 50%;\n  margin-left: -10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-e {\n  top: -webkit-calc(40%);\n  top: calc(50% - 10px);\n  right: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-ne {\n  top: -21px;\n  right: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-w {\n  top: 50%;\n  left: -25px;\n  margin-top: -10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-sw {\n  bottom: -25px;\n  left: -25px;\n}\n.x6-widget-handle-surround .x6-widget-handle-pos-s {\n  bottom: -24px;\n  left: 50%;\n  margin-left: -10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle {\n  width: 15px;\n  height: 15px;\n  font-size: 15px;\n  background-size: 15px 15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-se {\n  right: -19px;\n  bottom: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-nw {\n  top: -19px;\n  left: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-n {\n  top: -19px;\n  margin-left: -7.5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-e {\n  top: -webkit-calc(42%);\n  top: calc(50% - 8px);\n  right: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-ne {\n  top: -19px;\n  right: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-w {\n  left: -19px;\n  margin-top: -8px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-sw {\n  bottom: -19px;\n  left: -19px;\n}\n.x6-widget-handle-surround .x6-widget-handle-small .x6-widget-handle-pos-s {\n  bottom: -19px;\n  margin-left: -7.5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle {\n  width: 10px;\n  height: 10px;\n  font-size: 10px;\n  background-size: 10px 10px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-se {\n  right: -15px;\n  bottom: -13px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-nw {\n  top: -13px;\n  left: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-n {\n  top: -13px;\n  margin-left: -5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-e {\n  top: -webkit-calc(45%);\n  top: calc(50% - 5px);\n  right: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-ne {\n  top: -13px;\n  right: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-w {\n  left: -15px;\n  margin-top: -5px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-sw {\n  bottom: -13px;\n  left: -15px;\n}\n.x6-widget-handle-surround .x6-widget-handle-tiny .x6-widget-handle-pos-s {\n  bottom: -13px;\n  margin-left: -5px;\n}\n.x6-widget-handle-toolbar {\n  position: absolute;\n  top: -50px;\n  display: table-row;\n  padding: 7px 5px;\n}\n.x6-widget-handle-toolbar::after {\n  position: absolute;\n  top: 100%;\n  left: 10px;\n  width: 0;\n  height: 0;\n  margin-top: 4px;\n  border-right: 10px solid transparent;\n  border-left: 10px solid transparent;\n  content: '';\n}\n.x6-widget-handle-toolbar .x6-widget-handle {\n  position: relative;\n  display: table-cell;\n  min-width: 20px;\n  margin: 0 2px;\n  background-position: 3px 3px;\n  background-size: 16px 16px;\n}\n.x6-widget-handle-toolbar .x6-widget-handle::after {\n  position: absolute;\n  bottom: -11px;\n  width: 100%;\n  content: '';\n}\n.x6-widget-handle-pie {\n  position: absolute;\n  top: -webkit-calc(0%);\n  top: calc(50% - 50px);\n  right: -50px;\n  z-index: 1;\n  display: none;\n  width: 100px;\n  height: 100px;\n  margin: -2px -2px 0 0;\n  border-radius: 50%;\n  cursor: default;\n  pointer-events: visiblePainted;\n}\n.x6-widget-handle-pie .x6-widget-handle {\n  width: 1px;\n  height: auto;\n  pointer-events: visiblePainted;\n}\n.x6-widget-handle-pie-slice-svg {\n  width: 100%;\n  height: 100%;\n  overflow: visible !important;\n}\n.x6-widget-handle-pie-slice-img,\n.x6-widget-handle-pie-slice-txt {\n  display: none;\n  pointer-events: none;\n}\n.x6-widget-handle-pie[data-pie-toggle-position='e'] {\n  top: calc(50% - 50px);\n  right: -50px;\n  left: auto;\n}\n.x6-widget-handle-pie[data-pie-toggle-position='w'] {\n  top: calc(50% - 50px);\n  right: auto;\n  left: -52px;\n}\n.x6-widget-handle-pie[data-pie-toggle-position='n'] {\n  top: -50px;\n  right: auto;\n  bottom: auto;\n  left: calc(50% - 52px);\n}\n.x6-widget-handle-pie[data-pie-toggle-position='s'] {\n  top: auto;\n  right: auto;\n  bottom: -52px;\n  left: calc(50% - 52px);\n}\n.x6-widget-handle-pie-opened {\n  display: block;\n  animation: halo-pie-visibility 0.1s, halo-pie-opening 0.1s;\n  animation-timing-function: step-end, ease;\n  animation-delay: 0s, 0.1s;\n}\n.x6-widget-handle-pie-toggle {\n  position: absolute;\n  top: -webkit-calc(35%);\n  top: calc(50% - 15px);\n  right: -15px;\n  z-index: 2;\n  display: block;\n  box-sizing: border-box;\n  width: 30px;\n  height: 30px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: 20px 20px;\n  border-radius: 50%;\n  cursor: pointer;\n  user-select: none;\n  pointer-events: visiblePainted;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-handle-pie-toggle-pos-e {\n  top: -webkit-calc(35%);\n  top: calc(50% - 15px);\n  right: -15px;\n  bottom: auto;\n  left: auto;\n}\n.x6-widget-handle-pie-toggle-pos-w {\n  top: -webkit-calc(35%);\n  top: calc(50% - 15px);\n  right: auto;\n  bottom: auto;\n  left: -15px;\n}\n.x6-widget-handle-pie-toggle-pos-n {\n  top: -15px;\n  right: auto;\n  bottom: auto;\n  left: -webkit-calc(35%);\n  left: calc(50% - 15px);\n}\n.x6-widget-handle-pie-toggle-pos-s {\n  top: auto;\n  right: auto;\n  bottom: -15px;\n  left: -webkit-calc(35%);\n  left: calc(50% - 15px);\n}\n.x6-widget-handle-pie-toggle-opened {\n  transition: 0.1s background-image;\n}\n.x6-widget-handle-toolbar {\n  position: static;\n  display: inline-block;\n  margin-top: -50px;\n  margin-left: 45px;\n  white-space: nowrap;\n  vertical-align: top;\n  background-color: #f5f5f5;\n  border-bottom: 3px solid #333;\n  border-radius: 5px;\n  box-shadow: 0 1px 2px #222;\n}\n.x6-widget-handle-toolbar::after {\n  top: -12px;\n  left: 55px;\n  margin-top: 0;\n  border-top: 6px solid #333;\n  border-right: 10px solid transparent;\n  border-left: 10px solid transparent;\n}\n.x6-widget-handle-toolbar .x6-widget-handle {\n  display: inline-block;\n  vertical-align: top;\n}\n.x6-widget-handle-toolbar .x6-widget-handle:hover::after {\n  border-bottom: 4px solid #fc6cb8;\n}\n.x6-widget-handle-toolbar .x6-widget-handle-rotate {\n  position: absolute;\n  top: 100%;\n  right: 100%;\n  margin-top: 3px;\n  margin-right: 6px;\n}\n.x6-widget-handle-toolbar .x6-widget-handle-remove:hover::after,\n.x6-widget-handle-toolbar .x6-widget-handle-rotate:hover::after {\n  border-bottom: none;\n}\n.x6-widget-handle-toolbar .x6-widget-handle + .x6-widget-handle {\n  margin-left: 4px;\n}\n.x6-widget-handle-pie {\n  box-sizing: content-box;\n  background-color: #f5f5f5;\n  border: 2px solid #404040;\n}\n.x6-widget-handle-pie-slice {\n  fill: transparent;\n  stroke: #e9e9e9;\n  stroke-width: 1;\n}\n.x6-widget-handle-pie-slice:hover {\n  fill: #fff;\n}\n.x6-widget-handle-pie-slice-img {\n  display: block;\n}\n.x6-widget-handle-selected .x6-widget-handle-pie-slice {\n  fill: #fff;\n}\n.x6-widget-handle-pie-toggle {\n  background-color: #f6f6f6;\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%236A6C8A%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');\n  background-size: 16px 16px;\n  border: 2px solid #3b425f;\n}\n.x6-widget-handle-pie-toggle:hover {\n  background-color: #fff;\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20%3F%3E%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%3Csvg%20height%3D%2216px%22%20id%3D%22Layer_1%22%20style%3D%22enable-background%3Anew%200%200%2016%2016%3B%22%20version%3D%221.1%22%20viewBox%3D%220%200%2016%2016%22%20width%3D%2216px%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Cpath%20fill%3D%22%23FD6EB6%22%20d%3D%22M15%2C6h-5V1c0-0.55-0.45-1-1-1H7C6.45%2C0%2C6%2C0.45%2C6%2C1v5H1C0.45%2C6%2C0%2C6.45%2C0%2C7v2c0%2C0.55%2C0.45%2C1%2C1%2C1h5v5c0%2C0.55%2C0.45%2C1%2C1%2C1h2%20c0.55%2C0%2C1-0.45%2C1-1v-5h5c0.55%2C0%2C1-0.45%2C1-1V7C16%2C6.45%2C15.55%2C6%2C15%2C6z%22%2F%3E%3C%2Fsvg%3E');\n  border-color: #fd6eb6;\n}\n.x6-widget-handle-pie-toggle-opened {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%236a6c8a%22%20%2F%3E%3C%2Fsvg%3E');\n}\n.x6-widget-handle-pie-toggle-opened:hover {\n  background-image: url('data:image/svg+xml;charset=utf8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%3Csvg%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20id%3D%22Layer_1%22%20xml%3Aspace%3D%22preserve%22%3E%3Cmetadata%20id%3D%22metadata9%22%3E%3Crdf%3ARDF%3E%3Ccc%3AWork%20rdf%3Aabout%3D%22%22%3E%3Cdc%3Aformat%3Eimage%2Fsvg%2Bxml%3C%2Fdc%3Aformat%3E%3Cdc%3Atype%20rdf%3Aresource%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Fdcmitype%2FStillImage%22%20%2F%3E%3Cdc%3Atitle%3E%3C%2Fdc%3Atitle%3E%3C%2Fcc%3AWork%3E%3C%2Frdf%3ARDF%3E%3C%2Fmetadata%3E%3Cdefs%20id%3D%22defs7%22%20%2F%3E%3Cpath%20d%3D%22M%2015%2C6%2010%2C6%20C%201.0301983%2C6.00505%2015.002631%2C6.011353%206%2C6%20L%201%2C6%20C%200.45%2C6%200%2C6.45%200%2C7%20l%200%2C2%20c%200%2C0.55%200.45%2C1%201%2C1%20l%205%2C0%20c%208.988585%2C-0.019732%20-5.02893401%2C-0.018728%204%2C0%20l%205%2C0%20c%200.55%2C0%201%2C-0.45%201%2C-1%20L%2016%2C7%20C%2016%2C6.45%2015.55%2C6%2015%2C6%20z%22%20id%3D%22path3%22%20style%3D%22fill%3A%23FD6EB6%22%20%2F%3E%3C%2Fsvg%3E');\n}\n.x6-widget-dnd {\n  position: absolute;\n  top: -10000px;\n  left: -10000px;\n  z-index: 999999;\n  display: none;\n  cursor: move;\n  opacity: 0.7;\n  pointer-events: 'cursor';\n}\n.x6-widget-dnd.dragging {\n  display: inline-block;\n}\n.x6-widget-dnd.dragging * {\n  pointer-events: none !important;\n}\n.x6-widget-dnd .x6-graph {\n  background: transparent;\n  box-shadow: none;\n}\n.x6-widget-halo {\n  position: absolute;\n  pointer-events: none;\n}\n.x6-widget-halo-content {\n  position: absolute;\n  top: 100%;\n  padding: 6px;\n  font-size: 10px;\n  line-height: 14px;\n  text-align: center;\n  border-radius: 6px;\n}\n.x6-widget-halo-handles + .x6-widget-halo-content {\n  right: -20px;\n  left: -20px;\n  margin-top: 30px;\n}\n.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {\n  margin-top: 25px;\n}\n.x6-widget-halo-handles.x6-widget-handle-small + .x6-widget-halo-content {\n  margin-top: 20px;\n}\n.x6-widget-halo-handles.x6-widget-handle-pie + .x6-widget-halo-content {\n  right: 0;\n  left: 0;\n  margin-top: 10px;\n}\n.x6-widget-halo-content {\n  color: #fff;\n  background-color: #6a6b8a;\n}\n.x6-widget-halo.type-node .x6-widget-handle-toolbar .x6-widget-handle-remove {\n  position: absolute;\n  right: 100%;\n  bottom: 100%;\n  margin-right: 6px;\n  margin-bottom: 3px;\n}\n.x6-widget-halo.type-edge .x6-widget-handle-surround .x6-widget-handle-remove {\n  background-color: #fff;\n  border-radius: 50%;\n}\n.x6-widget-halo.type-edge .x6-widget-handle-toolbar {\n  margin-top: -60px;\n  margin-left: -18px;\n}\n.x6-widget-halo.type-edge .x6-widget-handle-toolbar::after {\n  top: -22px;\n  left: -9px;\n}\n.x6-widget-minimap {\n  position: relative;\n  display: table-cell;\n  box-sizing: border-box;\n  overflow: hidden;\n  text-align: center;\n  vertical-align: middle;\n  background-color: #fff;\n  user-select: none;\n}\n.x6-widget-minimap .x6-graph {\n  display: inline-block;\n  box-shadow: 0 0 4px 0 #eee;\n  cursor: pointer;\n}\n.x6-widget-minimap .x6-graph > svg {\n  pointer-events: none;\n  shape-rendering: optimizeSpeed;\n}\n.x6-widget-minimap .x6-graph .x6-node * {\n  /* stylelint-disable-next-line */\n  vector-effect: initial;\n}\n.x6-widget-minimap-viewport {\n  position: absolute;\n  box-sizing: content-box !important;\n  margin: -2px 0 0 -2px;\n  border: 2px solid #31d0c6;\n  cursor: move;\n}\n.x6-widget-minimap-viewport-zoom {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  box-sizing: border-box;\n  width: 12px;\n  height: 12px;\n  margin: 0 -6px -6px 0;\n  background-color: #fff;\n  border: 2px solid #31d0c6;\n  border-radius: 50%;\n  cursor: nwse-resize;\n}\n.x6-graph-scroller {\n  position: relative;\n  box-sizing: border-box;\n  overflow: scroll;\n  outline: none;\n}\n.x6-graph-scroller-content {\n  position: relative;\n}\n.x6-graph-scroller-background {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-scroller .x6-graph {\n  position: absolute;\n  display: inline-block;\n  margin: 0;\n  box-shadow: none;\n}\n.x6-graph-scroller .x6-graph > svg {\n  display: block;\n}\n.x6-graph-scroller.x6-graph-scroller-paged .x6-graph {\n  box-shadow: 0 0 4px 0 #eee;\n}\n.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='false'] {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph-scroller.x6-graph-scroller-pannable[data-panning='true'] {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-graph-pagebreak {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-pagebreak-vertical {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  box-sizing: border-box;\n  width: 1px;\n  border-left: 1px dashed #bdbdbd;\n}\n.x6-graph-pagebreak-horizontal {\n  position: absolute;\n  right: 0;\n  left: 0;\n  box-sizing: border-box;\n  height: 1px;\n  border-top: 1px dashed #bdbdbd;\n}\n.x6-widget-selection {\n  position: absolute;\n  display: none;\n  width: 0;\n  height: 0;\n  touch-action: none;\n}\n.x6-widget-selection-rubberband {\n  display: block;\n  overflow: visible;\n  opacity: 0.3;\n}\n.x6-widget-selection-selected {\n  display: block;\n}\n.x6-widget-selection-box {\n  cursor: move;\n}\n.x6-widget-selection-inner[data-selection-length='0'],\n.x6-widget-selection-inner[data-selection-length='1'] {\n  display: none;\n}\n.x6-widget-selection-content {\n  position: absolute;\n  top: 100%;\n  right: -20px;\n  left: -20px;\n  margin-top: 30px;\n  padding: 6px;\n  line-height: 14px;\n  text-align: center;\n  border-radius: 6px;\n}\n.x6-widget-selection-content:empty {\n  display: none;\n}\n.x6-widget-selection-rubberband {\n  background-color: #3498db;\n  border: 2px solid #2980b9;\n}\n.x6-widget-selection-box {\n  box-sizing: content-box !important;\n  margin-top: -4px;\n  margin-left: -4px;\n  padding-right: 4px;\n  padding-bottom: 4px;\n  border: 2px dashed #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-inner {\n  box-sizing: content-box !important;\n  margin-top: -8px;\n  margin-left: -8px;\n  padding-right: 12px;\n  padding-bottom: 12px;\n  border: 2px solid #feb663;\n  box-shadow: 2px 2px 5px #d3d3d3;\n}\n.x6-widget-selection-content {\n  color: #fff;\n  font-size: 10px;\n  background-color: #6a6b8a;\n}\n.x6-widget-snapline {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  pointer-events: none;\n}\n.x6-widget-snapline-vertical,\n.x6-widget-snapline-horizontal {\n  stroke: #2ecc71;\n  stroke-width: 1px;\n}\n.x6-widget-stencil {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-widget-stencil::after {\n  position: absolute;\n  top: 0;\n  display: block;\n  width: 100%;\n  height: 20px;\n  padding: 8px 0;\n  line-height: 20px;\n  text-align: center;\n  opacity: 0;\n  transition: top 0.1s linear, opacity 0.1s linear;\n  content: ' ';\n  pointer-events: none;\n}\n.x6-widget-stencil-content {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  height: auto;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.x6-widget-stencil .x6-node [magnet]:not([magnet='passive']) {\n  pointer-events: none;\n}\n.x6-widget-stencil-group {\n  padding: 0;\n  padding-bottom: 8px;\n  overflow: hidden;\n  user-select: none;\n}\n.x6-widget-stencil-group.collapsed {\n  height: auto;\n  padding-bottom: 0;\n}\n.x6-widget-stencil-group-title {\n  position: relative;\n  margin-top: 0;\n  margin-bottom: 0;\n  padding: 4px;\n  cursor: pointer;\n}\n.x6-widget-stencil-title,\n.x6-widget-stencil-group > .x6-widget-stencil-group-title {\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  user-select: none;\n}\n.x6-widget-stencil .unmatched {\n  opacity: 0.3;\n}\n.x6-widget-stencil .x6-node.unmatched {\n  display: none;\n}\n.x6-widget-stencil-group.unmatched {\n  display: none;\n}\n.x6-widget-stencil-search-text {\n  position: relative;\n  z-index: 1;\n  box-sizing: border-box;\n  width: 100%;\n  height: 30px;\n  max-height: 30px;\n  line-height: 30px;\n  outline: 0;\n}\n.x6-widget-stencil.not-found::after {\n  opacity: 1;\n  content: attr(data-not-found-text);\n}\n.x6-widget-stencil.not-found.searchable::after {\n  top: 30px;\n}\n.x6-widget-stencil.not-found.searchable.collapsable::after {\n  top: 50px;\n}\n.x6-widget-stencil {\n  color: #333;\n  background: #f5f5f5;\n}\n.x6-widget-stencil-content {\n  position: absolute;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-content {\n  top: 32px;\n}\n.x6-widget-stencil.searchable > .x6-widget-stencil-content {\n  top: 80px;\n}\n.x6-widget-stencil.not-found::after {\n  position: absolute;\n}\n.x6-widget-stencil.not-found.searchable.collapsable::after {\n  top: 80px;\n}\n.x6-widget-stencil.not-found.searchable::after {\n  top: 60px;\n}\n.x6-widget-stencil-group {\n  height: auto;\n  margin-bottom: 1px;\n  padding: 0;\n  transition: none;\n}\n.x6-widget-stencil-group .x6-graph {\n  background: transparent;\n  box-shadow: none;\n}\n.x6-widget-stencil-group.collapsed {\n  height: auto;\n  max-height: 31px;\n}\n.x6-widget-stencil-title,\n.x6-widget-stencil-group > .x6-widget-stencil-group-title {\n  position: relative;\n  left: 0;\n  box-sizing: border-box;\n  width: 100%;\n  height: 32px;\n  padding: 0 5px 0 8px;\n  color: #666;\n  font-weight: 700;\n  font-size: 12px;\n  line-height: 32px;\n  cursor: default;\n  transition: all 0.3;\n}\n.x6-widget-stencil-title:hover,\n.x6-widget-stencil-group > .x6-widget-stencil-group-title:hover {\n  color: #444;\n}\n.x6-widget-stencil-title {\n  background: #e9e9e9;\n}\n.x6-widget-stencil-group > .x6-widget-stencil-group-title {\n  background: #ededed;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title {\n  padding-left: 32px;\n  cursor: pointer;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {\n  position: absolute;\n  top: 6px;\n  left: 8px;\n  display: block;\n  width: 18px;\n  height: 18px;\n  margin: 0;\n  padding: 0;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-position: 0 0;\n  border: none;\n  content: ' ';\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title::before,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title::before {\n  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48L2c+PC9zdmc+');\n  opacity: 0.4;\n  transition: all 0.3s;\n}\n.x6-widget-stencil.collapsable > .x6-widget-stencil-title:hover::before,\n.x6-widget-stencil-group.collapsable > .x6-widget-stencil-group-title:hover::before {\n  opacity: 0.6;\n}\n.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title::before,\n.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title::before {\n  background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj48cGF0aCBkPSJNOS4zNzUuNUM0LjY4Ny41Ljg3NSA0LjMxMy44NzUgOWMwIDQuNjg4IDMuODEyIDguNSA4LjUgOC41IDQuNjg3IDAgOC41LTMuODEyIDguNS04LjUgMC00LjY4Ny0zLjgxMy04LjUtOC41LTguNXptMCAxNS44ODZDNS4zMDMgMTYuMzg2IDEuOTkgMTMuMDcyIDEuOTkgOXMzLjMxMi03LjM4NSA3LjM4NS03LjM4NVMxNi43NiA0LjkyOCAxNi43NiA5YzAgNC4wNzItMy4zMTMgNy4zODYtNy4zODUgNy4zODZ6Ii8+PHBhdGggZD0iTTEyLjc1MyA4LjQ0M0g1Ljk5N2EuNTU4LjU1OCAwIDAwMCAxLjExNmg2Ljc1NmEuNTU4LjU1OCAwIDAwMC0xLjExNnoiLz48cGF0aCBkPSJNOC44MTcgNS42MjN2Ni43NTZhLjU1OC41NTggMCAwMDEuMTE2IDBWNS42MjNhLjU1OC41NTggMCAxMC0xLjExNiAweiIvPjwvZz48L3N2Zz4=');\n  opacity: 0.4;\n}\n.x6-widget-stencil.collapsable.collapsed > .x6-widget-stencil-title:hover::before,\n.x6-widget-stencil-group.collapsable.collapsed > .x6-widget-stencil-group-title:hover::before {\n  opacity: 0.6;\n}\n.x6-widget-stencil input[type='search'] {\n  -webkit-appearance: textfield;\n}\n.x6-widget-stencil input[type='search']::-webkit-search-cancel-button,\n.x6-widget-stencil input[type='search']::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n.x6-widget-stencil-search-text {\n  display: block;\n  width: 90%;\n  margin: 8px 5%;\n  padding-left: 8px;\n  color: #333;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  border-radius: 12px;\n  outline: 0;\n}\n.x6-widget-stencil-search-text:focus {\n  outline: 0;\n}\n.x6-widget-stencil::after {\n  color: #808080;\n  font-weight: 600;\n  font-size: 12px;\n  background: 0 0;\n}\n.x6-widget-transform {\n  position: absolute;\n  box-sizing: content-box !important;\n  margin: -5px 0 0 -5px;\n  padding: 4px;\n  border: 1px dashed #000;\n  border-radius: 5px;\n  user-select: none;\n  pointer-events: none;\n}\n.x6-widget-transform > div {\n  position: absolute;\n  box-sizing: border-box;\n  background-color: #fff;\n  border: 1px solid #000;\n  transition: background-color 0.2s;\n  pointer-events: auto;\n  -webkit-user-drag: none;\n  user-drag: none;\n  /* stylelint-disable-line */\n}\n.x6-widget-transform > div:hover {\n  background-color: #d3d3d3;\n}\n.x6-widget-transform-cursor-n {\n  cursor: n-resize;\n}\n.x6-widget-transform-cursor-s {\n  cursor: s-resize;\n}\n.x6-widget-transform-cursor-e {\n  cursor: e-resize;\n}\n.x6-widget-transform-cursor-w {\n  cursor: w-resize;\n}\n.x6-widget-transform-cursor-ne {\n  cursor: ne-resize;\n}\n.x6-widget-transform-cursor-nw {\n  cursor: nw-resize;\n}\n.x6-widget-transform-cursor-se {\n  cursor: se-resize;\n}\n.x6-widget-transform-cursor-sw {\n  cursor: sw-resize;\n}\n.x6-widget-transform-resize {\n  width: 10px;\n  height: 10px;\n  border-radius: 6px;\n}\n.x6-widget-transform-resize[data-position='top-left'] {\n  top: -5px;\n  left: -5px;\n}\n.x6-widget-transform-resize[data-position='top-right'] {\n  top: -5px;\n  right: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom-left'] {\n  bottom: -5px;\n  left: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom-right'] {\n  right: -5px;\n  bottom: -5px;\n}\n.x6-widget-transform-resize[data-position='top'] {\n  top: -5px;\n  left: 50%;\n  margin-left: -5px;\n}\n.x6-widget-transform-resize[data-position='bottom'] {\n  bottom: -5px;\n  left: 50%;\n  margin-left: -5px;\n}\n.x6-widget-transform-resize[data-position='left'] {\n  top: 50%;\n  left: -5px;\n  margin-top: -5px;\n}\n.x6-widget-transform-resize[data-position='right'] {\n  top: 50%;\n  right: -5px;\n  margin-top: -5px;\n}\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='top'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='bottom'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='left'],\n.x6-widget-transform.prevent-aspect-ratio .x6-widget-transform-resize[data-position='right'] {\n  display: none;\n}\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='bottom'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='left'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='right'],\n.x6-widget-transform.no-orth-resize .x6-widget-transform-resize[data-position='top'] {\n  display: none;\n}\n.x6-widget-transform.no-resize .x6-widget-transform-resize {\n  display: none;\n}\n.x6-widget-transform-rotate {\n  top: -20px;\n  left: -20px;\n  width: 12px;\n  height: 12px;\n  border-radius: 6px;\n  cursor: crosshair;\n}\n.x6-widget-transform.no-rotate .x6-widget-transform-rotate {\n  display: none;\n}\n.x6-widget-transform-active {\n  border-color: transparent;\n  pointer-events: all;\n}\n.x6-widget-transform-active > div {\n  display: none;\n}\n.x6-widget-transform-active > .x6-widget-transform-active-handle {\n  display: block;\n  background-color: #808080;\n}\n.x6-widget-knob {\n  position: absolute;\n  box-sizing: border-box;\n  width: 16px;\n  height: 16px;\n  margin-top: -8px;\n  margin-left: -8px;\n  cursor: pointer;\n  user-select: none;\n}\n.x6-widget-knob::before,\n.x6-widget-knob::after {\n  position: absolute;\n  transform: rotate(45deg);\n  content: '';\n}\n.x6-widget-knob::before {\n  top: 4px;\n  left: 4px;\n  box-sizing: border-box;\n  width: 8px;\n  height: 8px;\n  background-color: #fff;\n}\n.x6-widget-knob::after {\n  top: 5px;\n  left: 5px;\n  box-sizing: border-box;\n  width: 6px;\n  height: 6px;\n  background-color: #fca000;\n}\n.x6-graph-print {\n  position: relative;\n}\n.x6-graph-print .x6-graph-print-ready {\n  display: none;\n}\n.x6-graph-print .x6-graph-print-preview {\n  overflow: hidden !important;\n  background: #fff !important;\n}\n@media print {\n  html,\n  html > body.x6-graph-printing {\n    position: relative !important;\n    width: 100% !important;\n    height: 100% !important;\n    margin: 0 !important;\n    padding: 0 !important;\n  }\n  html > body.x6-graph-printing > * {\n    display: none !important;\n  }\n  html > body.x6-graph-printing > .x6-graph-print {\n    display: block !important;\n  }\n  .x6-graph-print {\n    top: 0 !important;\n    left: 0 !important;\n    margin: 0 !important;\n    padding: 0 !important;\n    overflow: hidden !important;\n    page-break-after: always;\n    background: #fff !important;\n  }\n  .x6-graph-print .x6-graph-print-ready {\n    display: none;\n  }\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n";var __decorate$o=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class CSSManager extends Base{init(){CSSManager.ensure()}dispose(){CSSManager.clean()}}__decorate$o([CSSManager.dispose()],CSSManager.prototype,"dispose",null),function(t){let e,n=0;t.ensure=function(){if(n+=1,!(n>1||Platform.isApplyingHMR())){e=document.createElement("style"),e.setAttribute("type","text/css"),e.textContent=content;const t=document.querySelector("head");t&&t.insertBefore(e,t.firstChild)}},t.clean=function(){n-=1,n>0||(e&&e.parentNode&&e.parentNode.removeChild(e),e=null)}}(CSSManager||(CSSManager={}));var __rest$9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},ClassNames$1;class Handle{get handleClassName(){return ClassNames$1.handle}get pie(){return Object.assign(Object.assign({},Handle.defaultPieOptions),this.handleOptions.pie)}initHandles(){if(this.handles=[],this.handleOptions.handles&&this.handleOptions.handles.forEach((t=>this.addHandle(t))),"pie"===this.handleOptions.type){if(this.pie.toggles){const t=ClassNames$1.pieToggle;this.$pieToggles={},this.pie.toggles.forEach((e=>{const n=this.$("<div/>");this.applyAttrs(n,e.attrs),n.addClass(t).addClass(`${t}-pos-${e.position||"e"}`).attr("data-name",e.name).appendTo(this.container),this.$pieToggles[e.name]=n}))}this.setPieIcons()}if(this.$handleContainer){const t=this.handleOptions.type||"surround";this.$handleContainer.addClass(ClassNames$1.wrap).addClass(ClassNames$1.animate).addClass(`${ClassNames$1.handle}-${t}`)}this.delegateEvents({[`mousedown .${ClassNames$1.handle}`]:"onHandleMouseDown",[`touchstart .${ClassNames$1.handle}`]:"onHandleMouseDown",[`mousedown .${ClassNames$1.pieToggle}`]:"onPieToggleMouseDown",[`touchstart .${ClassNames$1.pieToggle}`]:"onPieToggleMouseDown"})}onHandleMouseDown(t){const e=this.$(t.currentTarget).closest(`.${ClassNames$1.handle}`).attr("data-action");e&&(t.preventDefault(),t.stopPropagation(),this.setEventData(t,{action:e,clientX:t.clientX,clientY:t.clientY,startX:t.clientX,startY:t.clientY}),"mousedown"===t.type&&2===t.button?this.triggerHandleAction(e,"contextmenu",t):(this.triggerHandleAction(e,"mousedown",t),this.delegateDocumentEvents({mousemove:"onHandleMouseMove",touchmove:"onHandleMouseMove",mouseup:"onHandleMouseUp",touchend:"onHandleMouseUp",touchcancel:"onHandleMouseUp"},t.data)))}onHandleMouseMove(t){const e=this.getEventData(t).action;e&&this.triggerHandleAction(e,"mousemove",t)}onHandleMouseUp(t){const e=this.getEventData(t).action;e&&(this.triggerHandleAction(e,"mouseup",t),this.undelegateDocumentEvents())}triggerHandleAction(t,e,n,r){n.preventDefault(),n.stopPropagation();const i=this.normalizeEvent(n),o=this.getEventData(i),s=this.graph.snapToGrid(i.clientX,i.clientY),a=this.graph.snapToGrid(o.clientX,o.clientY);this.trigger(`action:${t}:${e}`,Object.assign({e:i,dx:s.x-a.x,dy:s.y-a.y,x:s.x,y:s.y,offsetX:n.clientX-o.startX,offsetY:n.clientY-o.startY},r)),o.clientX=n.clientX,o.clientY=n.clientY}onPieToggleMouseDown(t){t.stopPropagation();const e=this.$(t.target).closest(`.${ClassNames$1.pieToggle}`).attr("data-name");this.isOpen(e)||this.isOpen()&&this.toggleState(),this.toggleState(e)}setPieIcons(){"pie"===this.handleOptions.type&&this.$handleContainer.find(`.${ClassNames$1.handle}`).each(((t,e)=>{const n=this.$(e),r=n.attr("data-action"),i=ClassNames$1.pieSlice,o=this.getHandle(r);if(!o||!o.icon){const t=window.getComputedStyle(e,":before").getPropertyValue("content");if(t&&"none"!==t){const e=n.find(`.${i}-txt`);e.length&&Vector.create(e[0]).text(t.replace(/['"]/g,""))}const r=n.css("background-image");if(r){const t=r.match(/url\(['"]?([^'"]+)['"]?\)/);if(t){const e=t[1],r=n.find(`.${i}-img`);r.length>0&&Vector.create(r[0]).attr("xlink:href",e)}}}}))}getHandleIdx(t){return this.handles.findIndex((e=>e.name===t))}hasHandle(t){return this.getHandleIdx(t)>=0}getHandle(t){return this.handles.find((e=>e.name===t))}renderHandle(t){const e=this.$("<div/>").addClass(`${ClassNames$1.handle} ${ClassNames$1.handle}-${t.name}`).attr("data-action",t.name).prop("draggable",!1);if("pie"===this.handleOptions.type){const n=this.getHandleIdx(t.name),r=this.pie,i=r.outerRadius,o=r.innerRadius,s=(i+o)/2,a=new Point(i,i),l=Angle.toRad(r.sliceAngle),c=n*l+Angle.toRad(r.startAngle),u=createSlicePathData(o,i,c,c+l),h=Vector.create("svg").addClass(`${ClassNames$1.pieSlice}-svg`),d=Vector.create("path").addClass(ClassNames$1.pieSlice).attr("d",u).translate(i,i),f=Point.fromPolar(s,-c-l/2,a).toJSON(),p=r.iconSize,g=Vector.create("image").attr(f).addClass(`${ClassNames$1.pieSlice}-img`);f.y=f.y+p-2;const m=Vector.create("text",{"font-size":p}).attr(f).addClass(`${ClassNames$1.pieSlice}-txt`);g.attr({width:p,height:p}),g.translate(-p/2,-p/2),m.translate(-p/2,-p/2),h.append([d,g,m]),e.append(h.node)}else e.addClass(`${ClassNames$1.handle}-pos-${t.position}`),t.content&&("string"==typeof t.content?e.html(t.content):e.append(t.content));return this.updateHandleIcon(e,t.icon),this.applyAttrs(e,t.attrs),e}addHandle(t){if(!this.hasHandle(t.name)){this.handles.push(t);const e=t.events;e&&Object.keys(e).forEach((n=>{const r=e[n],i=`action:${t.name}:${n}`;"string"==typeof r?this.on(i,this[r],this):this.on(i,r)})),this.$handleContainer&&this.$handleContainer.append(this.renderHandle(t))}return this}addHandles(t){return t.forEach((t=>this.addHandle(t))),this}removeHandles(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this}removeHandle(t){const e=this.getHandleIdx(t),n=this.handles[e];return n&&(n.events&&Object.keys(n.events).forEach((e=>{this.off(`action:${t}:${e}`)})),this.getHandleElem(t).remove(),this.handles.splice(e,1)),this}changeHandle(t,e){const n=this.getHandle(t);return n&&(this.removeHandle(t),this.addHandle(Object.assign(Object.assign({},n),e))),this}toggleHandle(t,e){const n=this.getHandle(t);if(n){const r=this.getHandleElem(t),i=`${ClassNames$1.handle}-selected`;void 0===e&&(e=!r.hasClass(i)),r.toggleClass(i,e);const o=e?n.iconSelected:n.icon;o&&this.updateHandleIcon(r,o)}return this}selectHandle(t){return this.toggleHandle(t,!0)}deselectHandle(t){return this.toggleHandle(t,!1)}deselectAllHandles(){return this.handles.forEach((t=>this.deselectHandle(t.name))),this}getHandleElem(t){return this.$handleContainer.find(`.${ClassNames$1.handle}-${t}`)}updateHandleIcon(t,e){if("pie"===this.handleOptions.type){const n=t.find(`.${ClassNames$1.pieSliceImg}`);this.$(n[0]).attr("xlink:href",e||"")}else t.css("background-image",e?`url(${e})`:"")}isRendered(){return null!=this.$handleContainer}isOpen(t){return!!this.isRendered()&&(t?this.$pieToggles[t].hasClass(ClassNames$1.pieToggleOpened):this.$handleContainer.hasClass(`${ClassNames$1.pieOpended}`))}toggleState(t){if(this.isRendered()){const e=this.$handleContainer;if(Object.keys(this.$pieToggles).forEach((t=>{this.$pieToggles[t].removeClass(ClassNames$1.pieToggleOpened)})),this.isOpen())this.trigger("pie:close",{name:t}),e.removeClass(ClassNames$1.pieOpended);else{if(this.trigger("pie:open",{name:t}),t){const n=this.pie.toggles,r=n&&n.find((e=>e.name===t));r&&e.attr({"data-pie-toggle-name":r.name,"data-pie-toggle-position":r.position}),this.$pieToggles[t].addClass(ClassNames$1.pieToggleOpened)}e.addClass(ClassNames$1.pieOpended)}}}applyAttrs(t,e){if(e){const n=View.$(t);Object.keys(e).forEach((t=>{const r=n.find(t).addBack().filter(t),i=e[t],{class:o}=i,s=__rest$9(i,["class"]);o&&r.addClass(o),r.attr(s)}))}}}(Handle||(Handle={})).defaultPieOptions={innerRadius:20,outerRadius:50,sliceAngle:45,startAngle:0,iconSize:14,toggles:[{name:"default",position:"e"}]},function(t){t.handle=View.prototype.prefixClassName("widget-handle"),t.wrap=`${t.handle}-wrap`,t.animate=`${t.handle}-animate`,t.pieOpended=`${t.handle}-pie-opened`,t.pieToggle=`${t.handle}-pie-toggle`,t.pieToggleOpened=`${t.handle}-pie-toggle-opened`,t.pieSlice=`${t.handle}-pie-slice`,t.pieSliceImg=`${t.handle}-pie-slice-img`}(ClassNames$1||(ClassNames$1={}));var __decorate$n=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$8=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Private$4;class Widget extends View{constructor(t){super();const e=t,{view:n,cell:r,node:i,edge:o,graph:s}=e,a=__rest$8(e,["view","cell","node","edge","graph"]);n?(this.view=n,this.cell=n.cell,this.graph=n.graph,this.model=this.graph.model):(r||o||i)&&s&&(this.cell=i||o||r,this.view=s.renderer.findViewByCell(this.cell),this.graph=s,this.model=this.graph.model);const l=this.constructor;!1!==t.clearAll&&l.removeInstances(this.graph),l.register(this),this.init(a)}static ensureCache(){return this.instanceCache.has(this)||this.instanceCache.set(this,{}),this.instanceCache.get(this)}static register(t,e){null==e&&(e=t.graph);const n=this.ensureCache();let r=n[e.view.cid];null==r&&(r=n[e.view.cid]={}),r[t.cid]=t}static unregister(t,e){null==e&&(e=t.graph);const n=this.ensureCache();n[e.view.cid]&&delete n[e.view.cid][t.cid]}static removeInstances(t){const e=this.ensureCache()[t.view.cid];e&&Object.keys(e).forEach((t=>{const n=e[t];n&&n.remove()}))}static getInstances(t){return this.ensureCache()[t.view.cid]||{}}init(t){}render(){return this}startListening(){!1!==this.options.clearOnBlankMouseDown&&this.graph.on("blank:mousedown",this.remove,this)}stopListening(){!1!==this.options.clearOnBlankMouseDown&&this.graph.off("blank:mousedown",this.remove,this)}remove(){return this.stopListening(),this.constructor.unregister(this),super.remove()}dispose(){this.remove()}}Widget.instanceCache=new WeakMap,__decorate$n([View.dispose()],Widget.prototype,"dispose",null);class Knob extends Widget{get node(){return this.cell}get metadata(){const t=this.cell.prop("knob");return Array.isArray(t)?null!=this.options.index?t[this.options.index]:null:t}init(t){this.options=Object.assign({},t),this.render(),this.startListening()}startListening(){this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.model.on("reseted",this.remove,this),this.node.on("removed",this.remove,this),this.view.on("node:resize:mousedown",this.onTransform,this),this.view.on("node:rotate:mousedown",this.onTransform,this),this.view.on("node:resize:mouseup",this.onTransformed,this),this.view.on("node:rotate:mouseup",this.onTransformed,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.model.off("reseted",this.remove,this),this.node.off("removed",this.remove,this),this.view.off("node:resize:mousedown",this.onTransform,this),this.view.off("node:rotate:mousedown",this.onTransform,this),this.view.off("node:resize:mouseup",this.onTransformed,this),this.view.off("node:rotate:mouseup",this.onTransformed,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}render(){return this.container=document.createElement("div"),addClass(this.container,this.prefixClassName("widget-knob")),this.options.className&&addClass(this.container,this.options.className),this.view.addClass(Private$4.KNOB),this.graph.container.appendChild(this.container),this.update(),this}remove(){return this.view.removeClass(Private$4.KNOB),super.remove()}update(){if(this.metadata){const{update:t,position:e}=this.metadata,n={knob:this,cell:this.cell,node:this.node};if(e){const t=e.call(this.graph,Object.assign({},n));if(t){const e=this.graph.matrix(),n=this.node.getBBox(),r=Angle.normalize(this.node.getAngle()),i=Point.create(t);0!==r&&i.rotate(-r,{x:n.width/2,y:n.height/2}),i.translate(n).scale(e.a,e.d).translate(e.e,e.f),this.container.style.left=`${i.x}px`,this.container.style.top=`${i.y}px`}}t&&t.call(this.graph,Object.assign({},n))}}hide(){this.container.style.display="none"}show(){this.container.style.display=""}onTransform(){this.hide()}onTransformed(){this.show()}onKnobMouseDown({knob:t}){this.cid!==t.cid&&this.hide()}onKnobMouseUp(){this.show()}notify(t,e){if(this.view){const n=this.view.normalizeEvent(e),r=this.graph.snapToGrid(n.clientX,n.clientY);this.view.notify(`cell:${t}`,{e:n,view:this.view,node:this.node,cell:this.cell,x:r.x,y:r.y,knob:this}),this.cell.isNode()?this.view.notify(`node:${t}`,{e:n,view:this.view,node:this.node,cell:this.cell,x:r.x,y:r.y,knob:this}):this.cell.isEdge()&&this.view.notify(`edge:${t}`,{e:n,view:this.view,edge:this.cell,cell:this.cell,x:r.x,y:r.y,knob:this})}}onMouseDown(t){t.stopPropagation(),this.setEventData(t,{knobbing:!1,originX:t.clientX,originY:t.clientY,clientX:t.clientX,clientY:t.clientY}),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(Private$4.documentEvents,t.data),this.metadata&&this.metadata.onMouseDown&&this.metadata.onMouseDown.call(this.graph,{e:t,data:this.getEventData(t),knob:this,cell:this.cell,node:this.node}),this.notify("knob:mousedown",t)}onMouseMove(t){const e=this.getEventData(t),n=this.graph.findViewByCell(this.node);if(e.knobbing||(e.knobbing=!0,n&&(n.addClass(Private$4.KNOBBING),this.notify("knob",t)),this.model.startBatch("knob",{cid:this.cid})),e.clientX=t.clientX,e.clientY=t.clientY,this.metadata&&this.metadata.onMouseMove){const n=this.graph.matrix(),r=(t.clientX-e.originX)/n.a,i=(t.clientY-e.originY)/n.d,o=this.node.getAngle(),s=new Point(r,i).rotate(o);this.metadata.onMouseMove.call(this.graph,{e:t,data:e,deltaX:s.x,deltaY:s.y,knob:this,cell:this.cell,node:this.node})}this.notify("knobbing",t),this.notify("knob:mousemove",t)}onMouseUp(t){this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const e=this.getEventData(t),n=this.graph.findViewByCell(this.node);e.knobbing&&(n&&n.removeClass(Private$4.KNOBBING),this.metadata&&this.metadata.onMouseUp&&this.metadata.onMouseUp.call(this.graph,{e:t,data:e,knob:this,cell:this.cell,node:this.node}),this.model.stopBatch("knob",{cid:this.cid}),this.notify("knobbed",t)),this.notify("knob:mouseup",t)}}!function(t){t.KNOB="has-widget-knob",t.KNOBBING="node-knobbing",t.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"}}(Private$4||(Private$4={}));var __decorate$m=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ClassName,Util$2;!function(t){t.root="widget-minimap",t.viewport=`${t.root}-viewport`,t.zoom=`${t.viewport}-zoom`}(ClassName||(ClassName={}));class MiniMap extends View{constructor(t){super(),this.options=Object.assign(Object.assign({},Util$2.defaultOptions),t),this.updateViewport=debounce$1(this.updateViewport.bind(this),0),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(ClassName.root));const e=document.createElement("div");this.container.appendChild(e),this.$viewport=this.$("<div>").addClass(this.prefixClassName(ClassName.viewport)),this.options.scalable&&(this.zoomHandle=this.$("<div>").addClass(this.prefixClassName(ClassName.zoom)).appendTo(this.$viewport).get(0)),this.$container.append(this.$viewport).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.options.container&&this.options.container.appendChild(this.container),this.sourceGraph=this.graph;const n=Object.assign(Object.assign({},this.options.graphOptions),{container:e,model:this.sourceGraph.model,frozen:!0,async:this.sourceGraph.isAsync(),interacting:!1,grid:!1,background:!1,rotating:!1,resizing:!1,embedding:!1,selecting:!1,snapline:!1,clipboard:!1,history:!1,scroller:!1});this.targetGraph=this.options.createGraph?this.options.createGraph(n):new Graph(n),this.targetGraph.renderer.unfreeze(),this.updatePaper(this.sourceGraph.options.width,this.sourceGraph.options.height),this.startListening()}get graph(){return this.options.graph}get scroller(){return this.graph.scroller.widget}get graphContainer(){return this.scroller?this.scroller.container:this.graph.container}get $graphContainer(){return this.scroller?this.scroller.$container:this.$(this.graph.container)}startListening(){this.scroller?this.$graphContainer.on(`scroll${this.getEventNamespace()}`,this.updateViewport):(this.sourceGraph.on("translate",this.onTransform,this),this.sourceGraph.on("scale",this.onTransform,this),this.sourceGraph.on("model:updated",this.onModelUpdated,this)),this.sourceGraph.on("resize",this.updatePaper,this),this.delegateEvents({mousedown:"startAction",touchstart:"startAction",[`mousedown .${this.prefixClassName("graph")}`]:"scrollTo",[`touchstart .${this.prefixClassName("graph")}`]:"scrollTo"})}stopListening(){this.scroller?this.$graphContainer.off(this.getEventNamespace()):(this.sourceGraph.off("translate",this.onTransform,this),this.sourceGraph.off("scale",this.onTransform,this),this.sourceGraph.off("model:updated",this.onModelUpdated,this)),this.sourceGraph.off("resize",this.updatePaper,this),this.undelegateEvents()}onRemove(){this.targetGraph.view.remove(),this.stopListening(),this.targetGraph.dispose()}onTransform(t){(t.ui||this.targetGraphTransforming)&&this.updateViewport()}onModelUpdated(){this.targetGraph.zoomToFit()}updatePaper(t,e){let n,r;"object"==typeof t?(n=t.width,r=t.height):(n=t,r=e);const i=this.sourceGraph.options,o=this.sourceGraph.transform.getScale();n/=o.sx,r/=o.sy,this.ratio=Math.min((this.options.width-2*this.options.padding)/n,(this.options.height-2*this.options.padding)/r);const s=this.ratio,a=i.x*s/o.sx,l=i.y*s/o.sy;return n*=s,r*=s,this.targetGraph.resizeGraph(n,r),this.targetGraph.translate(a,l),this.scroller?this.targetGraph.scale(s,s):this.targetGraph.zoomToFit(),this.updateViewport(),this}updateViewport(){const t=this.sourceGraph.transform.getScale(),e=this.targetGraph.transform.getScale();let n=null;n=this.scroller?this.scroller.clientToLocalPoint(0,0):this.graph.graphToLocal(0,0);const r=this.$(this.targetGraph.container).position(),i=this.targetGraph.translate();i.ty=i.ty||0,this.geometry={top:r.top+n.y*e.sy+i.ty,left:r.left+n.x*e.sx+i.tx,width:this.$graphContainer.innerWidth()*e.sx/t.sx,height:this.$graphContainer.innerHeight()*e.sy/t.sy},this.$viewport.css(this.geometry)}startAction(t){const e=this.normalizeEvent(t),n=e.target===this.zoomHandle?"zooming":"panning",{tx:r,ty:i}=this.sourceGraph.translate(),o={action:n,clientX:e.clientX,clientY:e.clientY,scrollLeft:this.graphContainer.scrollLeft,scrollTop:this.graphContainer.scrollTop,zoom:this.sourceGraph.zoom(),scale:this.sourceGraph.transform.getScale(),geometry:this.geometry,translateX:r,translateY:i};this.targetGraphTransforming=!0,this.delegateDocumentEvents(Util$2.documentEvents,o)}doAction(t){const e=this.normalizeEvent(t),n=e.clientX,r=e.clientY,i=e.data;switch(i.action){case"panning":{const t=this.sourceGraph.transform.getScale(),e=(n-i.clientX)*t.sx,o=(r-i.clientY)*t.sy;this.scroller?(this.graphContainer.scrollLeft=i.scrollLeft+e/this.ratio,this.graphContainer.scrollTop=i.scrollTop+o/this.ratio):this.sourceGraph.translate(i.translateX-e/this.ratio,i.translateY-o/this.ratio);break}case"zooming":{const t=1+(i.clientX-n)/i.geometry.width/i.scale.sx;i.frameId&&cancelAnimationFrame(i.frameId),i.frameId=requestAnimationFrame((()=>{this.sourceGraph.zoom(t*i.zoom,{absolute:!0,minScale:this.options.minScale,maxScale:this.options.maxScale})}));break}}}stopAction(){this.undelegateDocumentEvents(),this.targetGraphTransforming=!1}scrollTo(t){const e=this.normalizeEvent(t);let n,r;const i=this.targetGraph.translate();if(i.ty=i.ty||0,null==e.offsetX){const t=this.$(this.targetGraph.container).offset();n=e.pageX-t.left,r=e.pageY-t.top}else n=e.offsetX,r=e.offsetY;this.sourceGraph.centerPoint((n-i.tx)/this.ratio,(r-i.ty)/this.ratio)}dispose(){this.remove()}}__decorate$m([View.dispose()],MiniMap.prototype,"dispose",null),function(t){t.defaultOptions={width:300,height:200,padding:10,scalable:!0,minScale:.01,maxScale:16,graphOptions:{},createGraph:t=>new Graph(t)},t.documentEvents={mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"}}(Util$2||(Util$2={}));var __decorate$l=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$7=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Snapline extends View{constructor(t){super();const{graph:e}=t,n=__rest$7(t,["graph"]);this.graph=e,this.options=Object.assign({tolerance:10},n),this.offset={x:0,y:0},this.render(),this.parseFilter(),this.disabled||this.startListening()}get model(){return this.graph.model}get containerClassName(){return this.prefixClassName("widget-snapline")}get verticalClassName(){return`${this.containerClassName}-vertical`}get horizontalClassName(){return`${this.containerClassName}-horizontal`}get disabled(){return!0!==this.options.enabled||!0!==this.graph.options.snapline.enabled}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.snapline.enabled=!0,this.startListening())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.snapline.enabled=!1,this.stopListening())}setFilter(t){this.options.filter=t,this.parseFilter()}render(){const t=this.containerWrapper=new Vector("svg"),e=this.horizontal=new Vector("path"),n=this.vertical=new Vector("path");t.addClass(this.containerClassName),e.addClass(this.horizontalClassName),n.addClass(this.verticalClassName),t.setAttribute("width","100%"),t.setAttribute("height","100%"),e.setAttribute("display","none"),n.setAttribute("display","none"),t.append([e,n]),this.options.className&&t.addClass(this.options.className),this.container=this.containerWrapper.node}startListening(){this.stopListening(),this.graph.on("node:mousedown",this.captureCursorOffset,this),this.graph.on("node:mousemove",this.snapOnMoving,this),this.model.on("batch:stop",this.onBatchStop,this),this.delegateDocumentEvents({mouseup:"hide",touchend:"hide"})}stopListening(){this.graph.off("node:mousedown",this.captureCursorOffset,this),this.graph.off("node:mousemove",this.snapOnMoving,this),this.model.off("batch:stop",this.onBatchStop,this),this.undelegateDocumentEvents()}parseFilter(){this.filterShapes={},this.filterCells={},this.filterFunction=null;const t=this.options.filter;Array.isArray(t)?t.forEach((t=>{"string"==typeof t?this.filterShapes[t]=!0:this.filterCells[t.id]=!0})):"function"==typeof t&&(this.filterFunction=t)}onBatchStop({name:t,data:e}){"resize"===t&&this.snapOnResizing(e.cell,e)}captureCursorOffset({view:t,x:e,y:n}){const r=t.getDelegatedView();if(r&&this.isNodeMovable(r)){const r=t.cell.getPosition();this.offset={x:e-r.x,y:n-r.y}}}isNodeMovable(t){return t&&t.cell.isNode()&&t.can("nodeMovable")}snapOnResizing(t,e){if(this.options.resizing&&!e.snapped&&e.ui&&e.direction&&e.trueDirection){const n=this.graph.renderer.findViewByCell(t);if(n&&n.cell.isNode()){const r=t.getBBox(),i=r.bbox(t.getAngle()),o=i.getTopLeft(),s=i.getBottomRight(),a=Angle.normalize(t.getAngle()),l=this.options.tolerance||0;let c,u,h,d,f,p;const g={vertical:0,horizontal:0},m=e.direction,A=e.trueDirection,y=e.relativeDirection;g.vertical=-1!==A.indexOf("right")?s.x:o.x,g.horizontal=-1!==A.indexOf("bottom")?s.y:o.y,this.model.getNodes().some((e=>{if(this.isIgnored(t,e))return!1;const n=e.getBBox().bbox(e.getAngle()),r=n.getTopLeft(),o=n.getBottomRight(),a={vertical:[r.x,o.x],horizontal:[r.y,o.y]},m={};return Object.keys(a).forEach((t=>{const e=t,n=a[e].map((t=>({position:t,distance:Math.abs(t-g[e])}))).filter((t=>t.distance<=l));m[e]=sortBy(n,(t=>t.distance))})),null==c&&m.vertical.length>0&&(c=m.vertical[0].position,u=Math.min(i.y,n.y),h=Math.max(s.y,o.y)-u),null==d&&m.horizontal.length>0&&(d=m.horizontal[0].position,f=Math.min(i.x,n.x),p=Math.max(s.x,o.x)-f),null!=c&&null!=d})),this.hide();let v=0,b=0;null==d&&null==c||(null!=c&&(v=-1!==A.indexOf("right")?c-s.x:o.x-c),null!=d&&(b=-1!==A.indexOf("bottom")?d-s.y:o.y-d));let x=0,w=0;if(a%90==0)90===a||270===a?(x=b,w=v):(x=v,w=b);else{const t=a>=0&&a<90?1:a>=90&&a<180?4:a>=180&&a<270?3:2;null!=d&&null!=c&&(v<b?(b=0,d=void 0):(v=0,c=void 0));const e=Angle.toRad(a%90);v&&(x=3===t?v/Math.cos(e):v/Math.sin(e)),b&&(w=3===t?b/Math.cos(e):b/Math.sin(e));const n=1===t||3===t;switch(y){case"top":case"bottom":w=b?b/(n?Math.cos(e):Math.sin(e)):v/(n?Math.sin(e):Math.cos(e));break;case"left":case"right":x=v?v/(n?Math.cos(e):Math.sin(e)):b/(n?Math.sin(e):Math.cos(e))}}switch(y){case"top":case"bottom":x=0;break;case"left":case"right":w=0}const C=this.graph.getGridSize();let $=Math.max(r.width+x,C),_=Math.max(r.height+w,C);e.minWidth&&e.minWidth>C&&($=Math.max($,e.minWidth)),e.minHeight&&e.minHeight>C&&(_=Math.max(_,e.minHeight)),e.maxWidth&&($=Math.min($,e.maxWidth)),e.maxHeight&&(_=Math.min(_,e.maxHeight)),e.preserveAspectRatio&&(w<x?_=$*(r.height/r.width):$=_*(r.width/r.height)),$===r.width&&_===r.height||(t.resize($,_,{direction:m,relativeDirection:y,trueDirection:A,snapped:!0,snaplines:this.cid,restrict:this.graph.hook.getRestrictArea(n)}),h&&(h+=_-r.height),p&&(p+=$-r.width));const P=t.getBBox().bbox(a);c&&Math.abs(P.x-c)>1&&Math.abs(P.width+P.x-c)>1&&(c=void 0),d&&Math.abs(P.y-d)>1&&Math.abs(P.height+P.y-d)>1&&(d=void 0),this.update({verticalLeft:c,verticalTop:u,verticalHeight:h,horizontalTop:d,horizontalLeft:f,horizontalWidth:p})}}}snapOnMoving({view:t,e,x:n,y:r}){const i=t.getEventData(e).delegatedView||t;if(!this.isNodeMovable(i))return;const o=i.cell,s=o.getSize(),a=o.getPosition(),l=new Rectangle(n-this.offset.x,r-this.offset.y,s.width,s.height),c=o.getAngle(),u=l.getCenter(),h=l.bbox(c),d=h.getTopLeft(),f=h.getBottomRight(),p=this.options.tolerance||0;let g,m,A,y,v,b,x=0,w=0;if(this.model.getNodes().some((t=>{if(this.isIgnored(o,t))return!1;const e=t.getBBox().bbox(t.getAngle()),n=e.getCenter(),r=e.getTopLeft(),i=e.getBottomRight();return null==g&&(Math.abs(n.x-u.x)<p?(g=n.x,x=.5):Math.abs(r.x-d.x)<p?(g=r.x,x=0):Math.abs(r.x-f.x)<p?(g=r.x,x=1):Math.abs(i.x-f.x)<p?(g=i.x,x=1):Math.abs(i.x-d.x)<p&&(g=i.x),null!=g&&(m=Math.min(h.y,e.y),A=Math.max(f.y,i.y)-m)),null==y&&(Math.abs(n.y-u.y)<p?(y=n.y,w=.5):Math.abs(r.y-d.y)<p?y=r.y:Math.abs(r.y-f.y)<p?(y=r.y,w=1):Math.abs(i.y-f.y)<p?(y=i.y,w=1):Math.abs(i.y-d.y)<p&&(y=i.y),null!=y&&(v=Math.min(h.x,e.x),b=Math.max(f.x,i.x)-v)),null!=g&&null!=y})),this.hide(),null!=y||null!=g){null!=y&&(h.y=y-w*h.height),null!=g&&(h.x=g-x*h.width);const t=h.getCenter(),e=t.x-l.width/2-a.x,n=t.y-l.height/2-a.y;0===e&&0===n||(o.translate(e,n,{snapped:!0,restrict:this.graph.hook.getRestrictArea(i)}),b&&(b+=e),A&&(A+=n)),this.update({verticalLeft:g,verticalTop:m,verticalHeight:A,horizontalTop:y,horizontalLeft:v,horizontalWidth:b})}}isIgnored(t,e){return e.id===t.id||e.isDescendantOf(t)||this.filterShapes[e.shape]||this.filterCells[e.id]||this.filterFunction&&call(this.filterFunction,this.graph,e)}update(t){if(t.horizontalTop){const e=this.graph.localToGraph(new Point(t.horizontalLeft,t.horizontalTop)),n=this.graph.localToGraph(new Point(t.horizontalLeft+t.horizontalWidth,t.horizontalTop));this.horizontal.setAttributes({d:`M ${e.x},${e.y} L ${n.x},${n.y}`,display:"inherit"})}else this.horizontal.setAttribute("display","none");if(t.verticalLeft){const e=this.graph.localToGraph(new Point(t.verticalLeft,t.verticalTop)),n=this.graph.localToGraph(new Point(t.verticalLeft,t.verticalTop+t.verticalHeight));this.vertical.setAttributes({d:`M ${e.x},${e.y} L ${n.x},${n.y}`,display:"inherit"})}else this.vertical.setAttribute("display","none");this.show()}resetTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}show(){return this.resetTimer(),null==this.container.parentNode&&this.graph.container.appendChild(this.container),this}hide(){this.resetTimer(),this.vertical.setAttribute("display","none"),this.horizontal.setAttribute("display","none");const t=this.options.clean,e="number"==typeof t?t:!1!==t?3e3:0;return e>0&&(this.timer=window.setTimeout((()=>{null!==this.container.parentNode&&this.unmount()}),e)),this}onRemove(){this.stopListening(),this.hide()}dispose(){this.remove()}}__decorate$l([View.dispose()],Snapline.prototype,"dispose",null);var __decorate$k=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class Renderer extends Base{init(){this.resetUpdates(),this.startListening(),this.resetViews(this.model.getCells()),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()}startListening(){this.model.on("sorted",this.onSortModel,this),this.model.on("reseted",this.onModelReseted,this),this.model.on("batch:stop",this.onBatchStop,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("sorted",this.onSortModel,this),this.model.off("reseted",this.onModelReseted,this),this.model.off("batch:stop",this.onBatchStop,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}resetUpdates(){this.updates={priorities:[{},{},{}],mounted:{},mountedCids:[],unmounted:{},unmountedCids:[],count:0,sort:!1,frozen:!1,freezeKey:null,animationId:null}}onSortModel(){this.model.hasActiveBatch(Renderer.SORT_DELAYING_BATCHES)||this.sortViews()}onModelReseted({options:t}){this.removeZPivots(),this.resetViews(this.model.getCells(),t)}onBatchStop({name:t,data:e}){if(this.isFrozen())return;const n=this.model;if(!this.isAsync()){const r=Renderer.UPDATE_DELAYING_BATCHES;r.includes(t)&&!n.hasActiveBatch(r)&&this.updateViews(e)}const r=Renderer.SORT_DELAYING_BATCHES;r.includes(t)&&!n.hasActiveBatch(r)&&this.sortViews()}onCellAdded({cell:t,options:e}){const n=e.position;this.isAsync()||"number"!=typeof n?this.renderView(t,e):(e.maxPosition===n&&this.freeze({key:"addCells"}),this.renderView(t,e),0===n&&this.unfreeze({key:"addCells"}))}onCellRemoved({cell:t,options:e}){const n=this.findViewByCell(t);n&&this.requestViewUpdate(n,Renderer.FLAG_REMOVE,n.priority,e)}onCellZIndexChanged({cell:t,options:e}){if("approx"===this.options.sorting){const n=this.findViewByCell(t);n&&this.requestViewUpdate(n,Renderer.FLAG_INSERT,n.priority,e)}}onCellVisibleChanged({cell:t,current:e,options:n}){e||this.processEdgeOnTerminalVisibleChanged(t,!1);const r=this.findViewByCell(t);!e&&r?this.removeView(t):e&&null==r&&this.renderView(t,n),e&&this.processEdgeOnTerminalVisibleChanged(t,!0)}processEdgeOnTerminalVisibleChanged(t,e){this.model.getConnectedEdges(t).forEach((n=>{const r=((t,e)=>t.getSourceCellId()!==e.id?t.getSourceCell():t.getTargetCellId()!==e.id?t.getTargetCell():null)(n,t);(null==r||r.isVisible())&&(e?n.show():n.hide())}))}isEdgeTerminalVisible(t,e){const n="source"===e?t.getSourceCellId():t.getTargetCellId(),r=n?this.model.getCell(n):null;return!(r&&!r.isVisible())}requestConnectedEdgesUpdate(t,e={}){if(CellView.isCellView(t)){const n=t.cell,r=this.model.getConnectedEdges(n);for(let t=0,i=r.length;t<i;t+=1){const i=r[t],o=this.findViewByCell(i);if(!o)continue;const s=["update"];i.getTargetCell()===n&&s.push("target"),i.getSourceCell()===n&&s.push("source"),this.scheduleViewUpdate(o,o.getFlag(s),o.priority,e)}}}forcePostponedViewUpdate(t,e){if(!t||!CellView.isCellView(t))return!1;const n=t.cell;if(n.isNode())return!1;const r=t;if(n.isEdge()&&0==(e&t.getFlag(["source","target"]))){let t=0;const e=this.findViewByCell(n.getSourceCell());e&&!this.isViewMounted(e)&&(t=this.dumpView(e),r.updateTerminalMagnet("source"));let i=0;const o=this.findViewByCell(n.getTargetCell());if(o&&!this.isViewMounted(o)&&(i=this.dumpView(o),r.updateTerminalMagnet("target")),0===t&&0===i)return!this.dumpView(r)}return!1}scheduleViewUpdate(t,e,n,r={}){const i=t.cid,o=this.updates;let s=o.priorities[n];s||(s=o.priorities[n]={});const a=s[i]||0;(a&e)!==e&&(a||(o.count+=1),e&Renderer.FLAG_REMOVE&&a&Renderer.FLAG_INSERT?s[i]^=Renderer.FLAG_INSERT:e&Renderer.FLAG_INSERT&&a&Renderer.FLAG_REMOVE&&(s[i]^=Renderer.FLAG_REMOVE),s[i]|=e,this.graph.hook.onViewUpdated(t,e,r))}requestViewUpdate(t,e,n,r={}){this.scheduleViewUpdate(t,e,n,r);const i=this.isAsync();if(this.isFrozen()||i&&!1!==r.async||this.model.hasActiveBatch(Renderer.UPDATE_DELAYING_BATCHES))return;const o=this.updateViews(r);i&&this.graph.trigger("render:done",{stats:o,options:r})}dumpView(t,e={}){if(null==t)return 0;const n=t.cid,r=this.updates.priorities[t.priority],i=this.registerMountedView(t)|r[n];return delete r[n],i?this.updateView(t,i,e):0}dumpViews(t={}){this.checkView(t),this.updateViews(t)}requireView(t,e={}){const n=this.findViewByCell(t);return null==n?null:(this.dumpView(n,e),n)}updateView(t,e,n={}){if(null==t)return 0;if(CellView.isCellView(t)){if(e&Renderer.FLAG_REMOVE)return this.removeView(t.cell),0;e&Renderer.FLAG_INSERT&&(this.insertView(t),e^=Renderer.FLAG_INSERT)}return e?t.confirmUpdate(e,n):0}updateViews(t={}){let e,n=0,r=0,i=Renderer.MIN_PRIORITY;do{e=this.updateViewsBatch(t),n+=1,r+=e.updatedCount,i=Math.min(e.priority,i)}while(!e.empty);return{priority:i,batchCount:n,updatedCount:r}}updateViewsBatch(t={}){const e=this.updates,n=e.priorities,r=t.batchSize||Renderer.UPDATE_BATCH_SIZE;let i=!0,o=Renderer.MIN_PRIORITY,s=0,a=0,l=0,c=0,u=t.checkView||this.options.checkView;"function"!=typeof u&&(u=null);t:for(let h=0,d=n.length;h<d;h+=1){const d=n[h];for(const n in d){if(l>=r){i=!1;break t}const f=View.views[n];if(!f){delete d[n];continue}let p=d[n];if(0==(p&Renderer.FLAG_REMOVE)){const t=n in e.unmounted;if(u&&!call(u,this.graph,{view:f,unmounted:t})){t||(this.registerUnmountedView(f),f.unmount()),e.unmounted[n]|=p,delete d[n],a+=1;continue}t&&(p|=Renderer.FLAG_INSERT,s+=1),p|=this.registerMountedView(f)}const g=f;let m=this.updateView(f,p,t);if(m>0){const t=g.cell;t&&t.isEdge()&&(g.hasAction(m,"source")&&!this.isEdgeTerminalVisible(t,"source")&&(m=g.removeAction(m,"source"),m|=Renderer.FLAG_REMOVE),g.hasAction(m,"target")&&!this.isEdgeTerminalVisible(t,"target")&&(m=g.removeAction(m,"target"),m|=Renderer.FLAG_REMOVE))}m>0&&(d[n]=m,!this.graph.hook.onViewPostponed(g,m,t)||d[n])?(c+=1,i=!1):(o>h&&(o=h),l+=1,delete d[n])}}return{empty:i,priority:o,mountedCount:s,unmountedCount:a,updatedCount:l,postponedCount:c}}updateViewsAsync(t={},e={processed:0,priority:Renderer.MIN_PRIORITY}){const n=this.updates,r=n.animationId;if(r){if(cancelAnimationFrame$1(r),0===e.processed){const e=t.before;"function"==typeof e&&call(e,this.graph,this.graph)}const i=this.updateViewsBatch(t),o=this.checkViewImpl({checkView:t.checkView,mountedBatchSize:Renderer.MOUNT_BATCH_SIZE-i.mountedCount,unmountedBatchSize:Renderer.MOUNT_BATCH_SIZE-i.unmountedCount});let s=e.processed;const a=n.count,l=o.mountedCount,c=o.unmountedCount;i.updatedCount>0&&(s+=i.updatedCount+i.unmountedCount,e.priority=Math.min(i.priority,e.priority),i.empty&&0===l?(i.priority=e.priority,i.mountedCount+=l,i.unmountedCount+=c,this.graph.trigger("render:done",{stats:i,options:t}),e.processed=0,n.count=0):e.processed=s);const u=t.progress;if(a&&"function"==typeof u&&call(u,this.graph,{total:a,done:i.empty,current:s}),n.animationId!==r)return}n.animationId=requestAnimationFrame$1((()=>{this.updateViewsAsync(t,e)}))}registerMountedView(t){const e=t.cid,n=this.updates;if(e in n.mounted)return 0;n.mounted[e]=!0,n.mountedCids.push(e);const r=n.unmounted[e]||0;return delete n.unmounted[e],r}registerUnmountedView(t){const e=t.cid,n=this.updates;if(e in n.unmounted)return 0;n.unmounted[e]|=Renderer.FLAG_INSERT;const r=n.unmounted[e];return n.unmountedCids.push(e),delete n.mounted[e],r}isViewMounted(t){return null!=t&&t.cid in this.updates.mounted}getMountedViews(){return Object.keys(this.updates.mounted).map((t=>CellView.views[t]))}getUnmountedViews(){return Object.keys(this.updates.unmounted).map((t=>CellView.views[t]))}checkMountedViews(t,e){let n=0;if("function"!=typeof t)return n;const r=this.updates,i=r.mounted,o=r.mountedCids,s=null==e?o.length:Math.min(o.length,e);for(let e=0;e<s;e+=1){const r=o[e];if(!(r in i))continue;const s=CellView.views[r];null!=s&&(call(t,this.graph,{view:s,unmounted:!0})?o.push(r):(n+=1,this.registerUnmountedView(s)&&s.unmount()))}return o.splice(0,s),n}checkUnmountedViews(t,e){let n=0;"function"!=typeof t&&(t=null);const r=this.updates,i=r.unmounted,o=r.unmountedCids,s=null==e?o.length:Math.min(o.length,e);for(let e=0;e<s;e+=1){const r=o[e];if(!(r in i))continue;const s=CellView.views[r];if(null==s)continue;if(t&&!call(t,this.graph,{view:s,unmounted:!1})){o.push(r);continue}n+=1;const a=this.registerMountedView(s);a&&this.scheduleViewUpdate(s,a,s.priority,{mounting:!0})}return o.splice(0,s),n}checkViewImpl(t={mountedBatchSize:Number.MAX_SAFE_INTEGER,unmountedBatchSize:Number.MAX_SAFE_INTEGER}){const e=t.checkView||this.options.checkView,n=this.checkMountedViews(e,t.unmountedBatchSize);return{mountedCount:this.checkUnmountedViews(e,n>0?Math.min(this.updates.unmountedCids.length-n,t.mountedBatchSize):t.mountedBatchSize),unmountedCount:n}}checkView(t={}){return this.checkViewImpl(t)}isFrozen(){return!!this.options.frozen}freeze(t={}){const e=t.key,n=this.updates,r=this.options.frozen,i=n.freezeKey;if(e&&e!==i){if(r&&i)return;n.frozen=r,n.freezeKey=e}this.options.frozen=!0;const o=n.animationId;n.animationId=null,this.isAsync()&&null!=o&&cancelAnimationFrame$1(o),this.graph.trigger("freeze",{key:e})}unfreeze(t={}){const e=t.key,n=this.updates,r=n.freezeKey;if(e&&r&&e!==r)return;if(n.freezeKey=null,e&&e===r&&n.frozen)return;const i=()=>{this.options.frozen=n.frozen=!1,n.sort&&(this.sortViews(),n.sort=!1);const r=t.after;r&&call(r,this.graph,this.graph),this.graph.trigger("unfreeze",{key:e})};if(this.isAsync()){this.freeze();const e=t.progress;this.updateViewsAsync(Object.assign(Object.assign({},t),{progress:({done:t,current:n,total:r})=>{e&&call(e,this.graph,{done:t,current:n,total:r}),t&&i()}}))}else this.updateViews(t),i()}isAsync(){return!!this.options.async}setAsync(t){this.options.async=t}onRemove(){this.freeze(),this.removeViews()}resetViews(t=[],e={}){this.resetUpdates(),this.removeViews(),this.freeze({key:"reset"});for(let n=0,r=t.length;n<r;n+=1)this.renderView(t[n],e);this.unfreeze({key:"reset"}),this.sortViews()}removeView(t){const e=this.views[t.id];if(e){const n=e.cid,r=this.updates,i=r.mounted,o=r.unmounted;e.remove(),delete this.views[t.id],delete i[n],delete o[n]}return e}removeViews(){this.views&&Object.keys(this.views).forEach((t=>{const e=this.views[t];e&&this.removeView(e.cell)})),this.views={}}renderView(t,e={}){const n=this.views;let r=0,i=n[t.id];if(t.isVisible()&&(!t.isEdge()||this.isEdgeTerminalVisible(t,"source")&&this.isEdgeTerminalVisible(t,"target"))){if(i)r=Renderer.FLAG_INSERT;else{const e=this.graph.hook.createCellView(t);e&&(i=n[t.id]=e,i.graph=this.graph,r=this.registerUnmountedView(i)|i.getBootstrapFlag())}i&&this.requestViewUpdate(i,r,i.priority,e)}}isExactSorting(){return"exact"===this.options.sorting}sortViews(){this.isExactSorting()&&(this.isFrozen()?this.updates.sort=!0:this.sortViewsExact())}sortElements(t,e){const n=t.map((t=>{const e=t.parentNode,n=e.insertBefore(document.createTextNode(""),t.nextSibling);return t=>{if(e===t)throw new Error("You can't sort elements if any one is a descendant of another.");e.insertBefore(t,n),e.removeChild(n)}}));t.sort(e).forEach(((t,e)=>n[e](t)))}sortViewsExact(){const t=this.view.$(this.view.stage).children("[data-cell-id]").toArray(),e=this.model;this.sortElements(t,((t,n)=>{const r=e.getCell(t.getAttribute("data-cell-id")||""),i=e.getCell(n.getAttribute("data-cell-id")||""),o=r.getZIndex()||0,s=i.getZIndex()||0;return o===s?0:o<s?-1:1}))}addZPivot(t=0){null==this.zPivots&&(this.zPivots={});const e=this.zPivots;let n=e[t];if(n)return n;n=e[t]=document.createComment(`z-index:${t+1}`);let r=-1/0;for(const n in e){const e=+n;e<t&&e>r&&(r=e)}const i=this.view.stage;return i.insertBefore(n,r!==-1/0?e[r].nextSibling:i.firstChild),n}removeZPivots(){this.zPivots&&Object.keys(this.zPivots).forEach((t=>{const e=this.zPivots[t];e&&e.parentNode&&e.parentNode.removeChild(e)})),this.zPivots={}}insertView(t){const e=this.view.stage;switch(this.options.sorting){case"approx":{const n=t.cell.getZIndex(),r=this.addZPivot(n);e.insertBefore(t.container,r);break}default:e.appendChild(t.container)}}findViewByCell(t){if(null==t)return null;const e=Cell.isCell(t)?t.id:t;return this.views[e]}findViewByElem(t){if(null==t)return null;const e="string"==typeof t?this.view.stage.querySelector(t):t instanceof Element?t:t[0];if(e){const t=this.view.findAttr("data-cell-id",e);if(t)return this.views[t]}return null}findViewsFromPoint(t){const e={x:t.x,y:t.y};return this.model.getCells().map((t=>this.findViewByCell(t))).filter((t=>null!=t&&getBBox(t.container,{target:this.view.stage}).containsPoint(e)))}findEdgeViewsInArea(t,e={}){const n=Rectangle.create(t);return this.model.getEdges().map((t=>this.findViewByCell(t))).filter((t=>{if(t){const r=getBBox(t.container,{target:this.view.stage});return 0===r.width?r.inflate(1,0):0===r.height&&r.inflate(0,1),e.strict?n.containsRect(r):n.isIntersectWithRect(r)}return!1}))}findViewsInArea(t,e={}){const n=Rectangle.create(t);return this.model.getNodes().map((t=>this.findViewByCell(t))).filter((t=>{if(t){const r=getBBox(t.container,{target:this.view.stage});return e.strict?n.containsRect(r):n.isIntersectWithRect(r)}return!1}))}dispose(){this.resetUpdates(),this.stopListening()}}__decorate$k([Base.dispose()],Renderer.prototype,"dispose",null),function(t){t.FLAG_INSERT=1<<30,t.FLAG_REMOVE=1<<29,t.MOUNT_BATCH_SIZE=1e3,t.UPDATE_BATCH_SIZE=1e3,t.MIN_PRIORITY=2,t.SORT_DELAYING_BATCHES=["add","to-front","to-back"],t.UPDATE_DELAYING_BATCHES=["translate"]}(Renderer||(Renderer={}));var __decorate$j=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class BackgroundManager extends Base{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(t={}){let e=t.size||"auto auto",n=t.position||"center";const r=this.graph.transform.getScale(),i=this.graph.translate();"object"==typeof n&&(n=`${i.tx+r.sx*(n.x||0)}px ${i.ty+r.sy*(n.y||0)}px`),"object"==typeof e&&(e=Rectangle.fromSize(e).scale(r.sx,r.sy),e=`${e.width}px ${e.height}px`),this.elem.style.backgroundSize=e,this.elem.style.backgroundPosition=n}drawBackgroundImage(t,e={}){if(!(t instanceof HTMLImageElement))return void(this.elem.style.backgroundImage="");const n=this.optionsCache;if(n&&n.image!==e.image)return;let r;const i=e.opacity,o=e.size;let s=e.repeat||"no-repeat";const a=Background.registry.get(s);if("function"==typeof a){const n=e.quality||1;t.width*=n,t.height*=n;const i=a(t,e);if(!(i instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");r=i.toDataURL("image/png"),s=e.repeat&&s!==e.repeat?e.repeat:"repeat","object"==typeof o?(o.width*=i.width/t.width,o.height*=i.height/t.height):void 0===o&&(e.size={width:i.width/n,height:i.height/n})}else r=t.src,void 0===o&&(e.size={width:t.width,height:t.height});null!=n&&"object"==typeof e.size&&e.image===n.image&&e.repeat===n.repeat&&e.quality===n.quality&&(n.size=clone(e.size));const l=this.elem.style;l.backgroundImage=`url(${r})`,l.backgroundRepeat=s,l.opacity=null==i||i>=1?"":`${i}`,this.updateBackgroundImage(e)}updateBackgroundColor(t){this.elem.style.backgroundColor=t||""}updateBackgroundOptions(t){this.graph.options.background=t}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(t){const e=t||{};if(this.updateBackgroundOptions(t),this.updateBackgroundColor(e.color),e.image){this.optionsCache=clone(e);const n=document.createElement("img");n.onload=()=>this.drawBackgroundImage(n,t),n.setAttribute("crossorigin","anonymous"),n.src=e.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}__decorate$j([Base.dispose()],BackgroundManager.prototype,"dispose",null);var __decorate$i=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$6=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Util$1;class Scroller extends View{constructor(t){super(),this.padding={left:0,top:0,right:0,bottom:0},this.options=Util$1.getOptions(t);const e=this.graph.transform.getScale();this.sx=e.sx,this.sy=e.sy;const n=this.options.width||this.graph.options.width,r=this.options.height||this.graph.options.height;this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(Util$1.containerClass)).css({width:n,height:r}),this.options.pageVisible&&this.$container.addClass(this.prefixClassName(Util$1.pagedClass)),this.options.className&&this.$container.addClass(this.options.className);const i=this.graph.container;i.parentNode&&this.$container.insertBefore(i);const o=i.getAttribute("style");if(o){const t={};o.split(";").forEach((e=>{const n=e.trim();if(n){const e=n.split(":");e.length&&(t[e[0].trim()]=e[1]?e[1].trim():"")}})),Object.keys(t).forEach((e=>{"width"!==e&&"height"!==e&&(i.style[e]="",this.container.style[e]=t[e])}))}this.content=document.createElement("div"),this.$content=this.$(this.content).addClass(this.prefixClassName(Util$1.contentClass)).css({width:this.graph.options.width,height:this.graph.options.height}),this.background=document.createElement("div"),this.$background=this.$(this.background).addClass(this.prefixClassName(Util$1.backgroundClass)),this.$content.append(this.background),this.options.pageVisible||this.$content.append(this.graph.view.grid),this.$content.append(i),this.$content.appendTo(this.container),this.startListening(),this.options.pageVisible||this.graph.grid.update(),this.backgroundManager=new Scroller.Background(this),this.options.autoResize||this.update()}get graph(){return this.options.graph}get model(){return this.graph.model}startListening(){const t=this.graph,e=this.model;t.on("scale",this.onScale,this),t.on("resize",this.onResize,this),t.on("before:print",this.storeScrollPosition,this),t.on("before:export",this.storeScrollPosition,this),t.on("after:print",this.restoreScrollPosition,this),t.on("after:export",this.restoreScrollPosition,this),t.on("render:done",this.onRenderDone,this),t.on("unfreeze",this.onUpdate,this),e.on("reseted",this.onUpdate,this),e.on("cell:added",this.onUpdate,this),e.on("cell:removed",this.onUpdate,this),e.on("cell:changed",this.onUpdate,this),e.on("batch:stop",this.onBatchStop,this),this.delegateBackgroundEvents()}stopListening(){const t=this.graph,e=this.model;t.off("scale",this.onScale,this),t.off("resize",this.onResize,this),t.off("beforeprint",this.storeScrollPosition,this),t.off("beforeexport",this.storeScrollPosition,this),t.off("afterprint",this.restoreScrollPosition,this),t.off("afterexport",this.restoreScrollPosition,this),t.off("render:done",this.onRenderDone,this),t.off("unfreeze",this.onUpdate,this),e.off("reseted",this.onUpdate,this),e.off("cell:added",this.onUpdate,this),e.off("cell:removed",this.onUpdate,this),e.off("cell:changed",this.onUpdate,this),e.off("batch:stop",this.onBatchStop,this),this.undelegateBackgroundEvents()}enableAutoResize(){this.options.autoResize=!0}disableAutoResize(){this.options.autoResize=!1}onUpdate(){!this.graph.isAsync()&&this.options.autoResize&&this.update()}onBatchStop(t){!this.graph.isAsync()&&this.options.autoResize&&Renderer.UPDATE_DELAYING_BATCHES.includes(t.name)&&this.update()}delegateBackgroundEvents(t){const e=t||GraphView.events;this.delegatedHandlers=Object.keys(e).reduce(((t,n)=>{const r=e[n];if(-1===n.indexOf(" "))if("function"==typeof r)t[n]=r;else{let e=this.graph.view[r];"function"==typeof e&&(e=e.bind(this.graph.view),t[n]=e)}return t}),{}),this.onBackgroundEvent=this.onBackgroundEvent.bind(this),Object.keys(this.delegatedHandlers).forEach((t=>{this.delegateEvent(t,{guarded:!1},this.onBackgroundEvent)}))}undelegateBackgroundEvents(){Object.keys(this.delegatedHandlers).forEach((t=>{this.undelegateEvent(t,this.onBackgroundEvent)}))}onBackgroundEvent(t){let e=!1;const n=t.target;if(this.options.pageVisible)e=this.options.background?this.background===n:this.content===n;else{const t=this.graph.view;e=t.background===n||t.grid===n}if(e){const e=this.delegatedHandlers[t.type];"function"==typeof e&&e.apply(this.graph,arguments)}}onRenderDone({stats:t}){this.options.autoResize&&t.priority<2&&this.update()}onResize(){this.cachedCenterPoint&&(this.centerPoint(this.cachedCenterPoint.x,this.cachedCenterPoint.y),this.updatePageBreak())}onScale({sx:t,sy:e,ox:n,oy:r}){this.updateScale(t,e),(n||r)&&(this.centerPoint(n,r),this.updatePageBreak()),"function"==typeof(this.options.autoResizeOptions||this.options.fitTocontentOptions)&&this.update()}storeScrollPosition(){this.cachedScrollLeft=this.container.scrollLeft,this.cachedScrollTop=this.container.scrollTop}restoreScrollPosition(){this.container.scrollLeft=this.cachedScrollLeft,this.container.scrollTop=this.cachedScrollTop,this.cachedScrollLeft=null,this.cachedScrollTop=null}storeClientSize(){this.cachedClientSize={width:this.container.clientWidth,height:this.container.clientHeight}}restoreClientSize(){this.cachedClientSize=null}beforeManipulation(){(Platform.IS_IE||Platform.IS_EDGE)&&this.$container.css("visibility","hidden")}afterManipulation(){(Platform.IS_IE||Platform.IS_EDGE)&&this.$container.css("visibility","visible")}updatePageSize(t,e){null!=t&&(this.options.pageWidth=t),null!=e&&(this.options.pageHeight=e),this.updatePageBreak()}updatePageBreak(){if(this.pageBreak&&this.pageBreak.parentNode&&this.pageBreak.parentNode.removeChild(this.pageBreak),this.pageBreak=null,this.options.pageVisible&&this.options.pageBreak){const t=this.graph.options.width,e=this.graph.options.height,n=this.options.pageWidth*this.sx,r=this.options.pageHeight*this.sy;if(t>n||e>r){let i=!1;const o=document.createElement("div");for(let e=1,r=Math.floor(t/n);e<r;e+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-vertical")).css({left:e*n}).appendTo(o),i=!0;for(let t=1,n=Math.floor(e/r);t<n;t+=1)this.$("<div/>").addClass(this.prefixClassName("graph-pagebreak-horizontal")).css({top:t*r}).appendTo(o),i=!0;i&&(addClass(o,this.prefixClassName("graph-pagebreak")),this.$(this.graph.view.grid).after(o),this.pageBreak=o)}}}update(){const t=this.getClientSize();this.cachedCenterPoint=this.clientToLocalPoint(t.width/2,t.height/2);let e=this.options.autoResizeOptions||this.options.fitTocontentOptions;"function"==typeof e&&(e=call(e,this,this));const n=Object.assign({gridWidth:this.options.pageWidth,gridHeight:this.options.pageHeight,allowNewOrigin:"negative"},e);this.graph.fitToContent(this.getFitToContentOptions(n))}getFitToContentOptions(t){const e=this.sx,n=this.sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=n),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=n),"object"==typeof t.padding?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*n,bottom:(t.padding.bottom||0)*n}:"number"==typeof t.padding&&(t.padding*=e),this.options.autoResize||(t.contentArea=Rectangle.create()),t}updateScale(t,e){const n=this.graph.options,r=t/this.sx,i=e/this.sy;this.sx=t,this.sy=e,this.graph.translate(n.x*r,n.y*i),this.graph.resizeGraph(n.width*r,n.height*i)}scrollbarPosition(t,e,n){if(null==t&&null==e)return{left:this.container.scrollLeft,top:this.container.scrollTop};const r={};return"number"==typeof t&&(r.scrollLeft=t),"number"==typeof e&&(r.scrollTop=e),n&&n.animation?this.$container.animate(r,n.animation):this.$container.prop(r),this}scrollToPoint(t,e,n){const r=this.getClientSize(),i=this.graph.matrix(),o={};return"number"==typeof t&&(o.scrollLeft=t-r.width/2+i.e+(this.padding.left||0)),"number"==typeof e&&(o.scrollTop=e-r.height/2+i.f+(this.padding.top||0)),n&&n.animation?this.$container.animate(o,n.animation):this.$container.prop(o),this}scrollToContent(t){const e=this.sx,n=this.sy,r=this.graph.getContentArea().getCenter();return this.scrollToPoint(r.x*e,r.y*n,t)}scrollToCell(t,e){const n=this.sx,r=this.sy,i=t.getBBox().getCenter();return this.scrollToPoint(i.x*n,i.y*r,e)}center(t){return this.centerPoint(t)}centerPoint(t,e,n){const r=this.graph.matrix(),i=r.a,o=r.d,s=-r.e,a=-r.f,l=s+this.graph.options.width,c=a+this.graph.options.height;let u;if(this.storeClientSize(),"number"==typeof t||"number"==typeof e){u=n;const r=this.getVisibleArea().getCenter();"number"==typeof t?t*=i:t=r.x,"number"==typeof e?e*=o:e=r.y}else u=t,t=(s+l)/2,e=(a+c)/2;if(u&&u.padding)return this.positionPoint({x:t,y:e},"50%","50%",u);const h=this.getPadding(),d=this.getClientSize(),f=d.width/2,p=d.height/2,g=f-h.right+t-l,m=p-h.top-e+a,A=p-h.bottom+e-c;this.addPadding(Math.max(f-h.left-t+s,0),Math.max(g,0),Math.max(m,0),Math.max(A,0));const y=this.scrollToPoint(t,e,u||void 0);return this.restoreClientSize(),y}centerContent(t){return this.positionContent("center",t)}centerCell(t,e){return this.positionCell(t,"center",e)}positionContent(t,e){const n=this.graph.getContentArea(e);return this.positionRect(n,t,e)}positionCell(t,e,n){const r=t.getBBox();return this.positionRect(r,e,n)}positionRect(t,e,n){const r=Rectangle.create(t);switch(e){case"center":return this.positionPoint(r.getCenter(),"50%","50%",n);case"top":return this.positionPoint(r.getTopCenter(),"50%",0,n);case"top-right":return this.positionPoint(r.getTopRight(),"100%",0,n);case"right":return this.positionPoint(r.getRightMiddle(),"100%","50%",n);case"bottom-right":return this.positionPoint(r.getBottomRight(),"100%","100%",n);case"bottom":return this.positionPoint(r.getBottomCenter(),"50%","100%",n);case"bottom-left":return this.positionPoint(r.getBottomLeft(),0,"100%",n);case"left":return this.positionPoint(r.getLeftMiddle(),0,"50%",n);case"top-left":return this.positionPoint(r.getTopLeft(),0,0,n);default:return this}}positionPoint(t,e,n,r={}){const{padding:i}=r,o=__rest$6(r,["padding"]),s=normalizeSides(i),a=Rectangle.fromSize(this.getClientSize()),l=a.clone().moveAndExpand({x:s.left,y:s.top,width:-s.right-s.left,height:-s.top-s.bottom});(e=normalizePercentage(e,Math.max(0,l.width)))<0&&(e=l.width+e),(n=normalizePercentage(n,Math.max(0,l.height)))<0&&(n=l.height+n);const c=l.getTopLeft().translate(e,n),u=a.getCenter().diff(c),h=this.zoom(),d=u.scale(1/h,1/h),f=Point.create(t).translate(d);return this.centerPoint(f.x,f.y,o)}zoom(t,e){if(null==t)return this.sx;let n,r;e=e||{};const i=this.getClientSize(),o=this.clientToLocalPoint(i.width/2,i.height/2);let s=t,a=t;return e.absolute||(s+=this.sx,a+=this.sy),e.scaleGrid&&(s=Math.round(s/e.scaleGrid)*e.scaleGrid,a=Math.round(a/e.scaleGrid)*e.scaleGrid),e.maxScale&&(s=Math.min(e.maxScale,s),a=Math.min(e.maxScale,a)),e.minScale&&(s=Math.max(e.minScale,s),a=Math.max(e.minScale,a)),s=this.graph.transform.clampScale(s),a=this.graph.transform.clampScale(a),e.center?(n=e.center.x-(e.center.x-o.x)/(s/this.sx),r=e.center.y-(e.center.y-o.y)/(a/this.sy)):(n=o.x,r=o.y),this.beforeManipulation(),this.graph.transform.scale(s,a),this.centerPoint(n,r),this.afterManipulation(),this}zoomToRect(t,e={}){const n=Rectangle.create(t),r=this.graph;e.contentArea=n,null==e.viewportArea&&(e.viewportArea={x:r.options.x,y:r.options.y,width:this.$container.width(),height:this.$container.height()}),this.beforeManipulation(),r.transform.scaleContentToFitImpl(e,!1);const i=n.getCenter();return this.centerPoint(i.x,i.y),this.afterManipulation(),this}zoomToFit(t={}){return this.zoomToRect(this.graph.getContentArea(t),t)}transitionToPoint(t,e,n){let r,i;"object"==typeof t?(n=e,e=t.y,t=t.x):e=e,null==n&&(n={});const o=this.sx,s=Math.max(n.scale||o,1e-6),a=this.getClientSize(),l=new Point(t,e),c=this.clientToLocalPoint(a.width/2,a.height/2);if(o===s){const t=c.diff(l).scale(o,o).round();r=`translate(${t.x}px,${t.y}px)`}else{const t=s/(o-s)*l.distance(c),e=c.clone().move(l,t),n=this.localToBackgroundPoint(e).round();r=`scale(${s/o})`,i=`${n.x}px ${n.y}px`}const u=n.onTransitionEnd;return this.$container.addClass(Util$1.transitionClassName),this.$content.off(Util$1.transitionEventName).on(Util$1.transitionEventName,(n=>{this.syncTransition(s,{x:t,y:e}),"function"==typeof u&&call(u,this,n.originalEvent)})).css({transform:r,transformOrigin:i,transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timing}),this}syncTransition(t,e){return this.beforeManipulation(),this.graph.scale(t),this.removeTransition(),this.centerPoint(e.x,e.y),this.afterManipulation(),this}removeTransition(){return this.$container.removeClass(Util$1.transitionClassName),this.$content.off(Util$1.transitionEventName).css({transform:"",transformOrigin:"",transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:""}),this}transitionToRect(t,e={}){const n=Rectangle.create(t),r=e.maxScale||1/0,i=e.minScale||Number.MIN_VALUE,o=e.scaleGrid||null,s=e.visibility||1,a=e.center?Point.create(e.center):n.getCenter(),l=this.getClientSize(),c=l.width*s,u=l.height*s;let h=new Rectangle(a.x-c/2,a.y-u/2,c,u).getMaxUniformScaleToFit(n,a);return h=Math.min(h,r),o&&(h=Math.floor(h/o)*o),h=Math.max(i,h),this.transitionToPoint(a,Object.assign({scale:h},e))}startPanning(t){const e=this.normalizeEvent(t);this.clientX=e.clientX,this.clientY=e.clientY,this.trigger("pan:start",{e}),this.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),this.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(t){const e=this.normalizeEvent(t),n=e.clientX-this.clientX;this.container.scrollTop-=e.clientY-this.clientY,this.container.scrollLeft-=n,this.clientX=e.clientX,this.clientY=e.clientY,this.trigger("panning",{e})}stopPanning(t){this.$(document.body).off(".panning"),this.$(window).off(".panning"),this.trigger("pan:stop",{e:t})}clientToLocalPoint(t,e){let n="object"==typeof t?t.x:t,r="object"==typeof t?t.y:e;const i=this.graph.matrix();return n+=this.container.scrollLeft-this.padding.left-i.e,r+=this.container.scrollTop-this.padding.top-i.f,new Point(n/i.a,r/i.d)}localToBackgroundPoint(t,e){const n="object"==typeof t?Point.create(t):new Point(t,e),r=this.graph.matrix(),i=this.padding;return transformPoint(n,r).translate(i.left,i.top)}resize(t,e){let n=null!=t?t:this.container.offsetWidth,r=null!=e?e:this.container.offsetHeight;"number"==typeof n&&(n=Math.round(n)),"number"==typeof r&&(r=Math.round(r)),this.options.width=n,this.options.height=r,this.$container.css({width:n,height:r}),this.update()}getClientSize(){return this.cachedClientSize?this.cachedClientSize:{width:this.container.clientWidth,height:this.container.clientHeight}}autoScroll(t,e){const n=10,r=this.container,i=r.getBoundingClientRect();let o=0,s=0;return t<=i.left+n&&(o=-10),e<=i.top+n&&(s=-10),t>=i.right-n&&(o=n),e>=i.bottom-n&&(s=n),0!==o&&(r.scrollLeft+=o),0!==s&&(r.scrollTop+=s),{scrollerX:o,scrollerY:s}}addPadding(t,e,n,r){let i=this.getPadding();this.padding={left:Math.round(i.left+(t||0)),top:Math.round(i.top+(n||0)),bottom:Math.round(i.bottom+(r||0)),right:Math.round(i.right+(e||0))},i=this.padding,this.$content.css({width:i.left+this.graph.options.width+i.right,height:i.top+this.graph.options.height+i.bottom});const o=this.graph.container;return o.style.left=`${this.padding.left}px`,o.style.top=`${this.padding.top}px`,this}getPadding(){const t=this.options.padding;return normalizeSides("function"==typeof t?call(t,this,this):t)}getVisibleArea(){const t=this.graph.matrix(),e=this.getClientSize(),n=transformRectangle({x:this.container.scrollLeft||0,y:this.container.scrollTop||0,width:e.width,height:e.height},t.inverse());return n.x-=(this.padding.left||0)/this.sx,n.y-=(this.padding.top||0)/this.sy,n}isCellVisible(t,e={}){const n=t.getBBox(),r=this.getVisibleArea();return e.strict?r.containsRect(n):r.isIntersectWithRect(n)}isPointVisible(t){return this.getVisibleArea().containsPoint(t)}lock(){return this.$container.css("overflow","hidden"),this}unlock(){return this.$container.css("overflow","scroll"),this}onRemove(){this.stopListening()}dispose(){this.$(this.graph.container).insertBefore(this.$container),this.remove()}}function notify(t,e,n,r={}){if(n){const i=n.graph,o=i.view.normalizeEvent(e),s=i.snapToGrid(o.clientX,o.clientY);n.notify(t,Object.assign({e:o,view:n,node:n.cell,cell:n.cell,x:s.x,y:s.y},r))}}__decorate$i([View.dispose()],Scroller.prototype,"dispose",null),(Scroller||(Scroller={})).Background=class extends BackgroundManager{constructor(t){super(t.graph),this.scroller=t,t.options.background&&this.draw(t.options.background)}get elem(){return this.scroller.background}init(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}updateBackgroundOptions(t){this.scroller.options.background=t}},function(t){t.containerClass="graph-scroller",t.panningClass=`${t.containerClass}-panning`,t.pannableClass=`${t.containerClass}-pannable`,t.pagedClass=`${t.containerClass}-paged`,t.contentClass=`${t.containerClass}-content`,t.backgroundClass=`${t.containerClass}-background`,t.transitionClassName="transition-in-progress",t.transitionEventName="transitionend.graph-scroller-transition",t.defaultOptions={padding(){const t=this.getClientSize(),e=Math.max(this.options.minVisibleWidth||0,1)||1,n=Math.max(this.options.minVisibleHeight||0,1)||1,r=Math.max(t.width-e,0),i=Math.max(t.height-n,0);return{left:r,top:i,right:r,bottom:i}},minVisibleWidth:50,minVisibleHeight:50,pageVisible:!1,pageBreak:!1,autoResize:!0},t.getOptions=function(e){const n=merge({},t.defaultOptions,e);return null==n.pageWidth&&(n.pageWidth=e.graph.options.width),null==n.pageHeight&&(n.pageHeight=e.graph.options.height),n}}(Util$1||(Util$1={}));var __decorate$h=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Private$3,Private$2;class Selection extends View{constructor(t){super(),this.options=merge({},Private$3.defaultOptions,t),this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new Collection([],{comparator:Private$3.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.initHandles(),this.startListening()}get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(Private$3.classNames.box)}get $boxes(){return this.$container.children(`.${this.boxClassName}`)}get handleOptions(){return this.options}startListening(){const t=this.graph,e=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),t.on("scale",this.onGraphTransformed,this),t.on("translate",this.onGraphTransformed,this),t.model.on("updated",this.onModelUpdated,this),e.on("added",this.onCellAdded,this),e.on("removed",this.onCellRemoved,this),e.on("reseted",this.onReseted,this),e.on("updated",this.onCollectionUpdated,this),e.on("node:change:position",this.onNodePositionChanged,this),e.on("cell:changed",this.onCellChanged,this)}stopListening(){const t=this.graph,e=this.collection;this.undelegateEvents(),t.off("scale",this.onGraphTransformed,this),t.off("translate",this.onGraphTransformed,this),t.model.off("updated",this.onModelUpdated,this),e.off("added",this.onCellAdded,this),e.off("removed",this.onCellRemoved,this),e.off("reseted",this.onReseted,this),e.off("updated",this.onCollectionUpdated,this),e.off("node:change:position",this.onNodePositionChanged,this),e.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes({async:!1})}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:t,options:e}){const{showNodeSelectionBox:n,pointerEvents:r}=this.options,{ui:i,selection:o,translateBy:s}=e;let a=!this.translating;if(a=a&&(!0!==n||"none"===r),a=a&&i&&!o,a=a&&s&&t.id===s,a){this.translating=!0;const n=t.position(),r=t.previous("position"),i=n.x-r.x,o=n.y-r.y;0===i&&0===o||this.translateSelectedNodes(i,o,t,e),this.translating=!1}}onModelUpdated({removed:t}){t&&t.length&&this.unselect(t)}isEmpty(){return this.length<=0}isSelected(t){return this.collection.has(t)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(t,e={}){e.dryrun=!0;const n=this.filter(Array.isArray(t)?t:[t]);return this.collection.add(n,e),this}unselect(t,e={}){return e.dryrun=!0,this.collection.remove(Array.isArray(t)?t:[t],e),this}reset(t,e={}){if(t){if(e.batch){const n=this.filter(Array.isArray(t)?t:[t]);return this.collection.reset(n,Object.assign(Object.assign({},e),{ui:!0})),this}const n=this.cells,r=this.filter(Array.isArray(t)?t:[t]),i={},o={};n.forEach((t=>i[t.id]=t)),r.forEach((t=>o[t.id]=t));const s=[],a=[];return r.forEach((t=>{i[t.id]||s.push(t)})),n.forEach((t=>{o[t.id]||a.push(t)})),a.length&&this.unselect(a,Object.assign(Object.assign({},e),{ui:!0})),s.length&&this.select(s,Object.assign(Object.assign({},e),{ui:!0})),0===a.length&&0===s.length&&this.updateContainer(),this}return this.clean(e)}clean(t={}){return this.length&&(!1===t.batch?this.unselect(this.cells,t):this.collection.reset([],Object.assign(Object.assign({},t),{ui:!0}))),this}setFilter(t){this.options.filter=t}setContent(t){this.options.content=t}startSelecting(t){let e,n;t=this.normalizeEvent(t),this.clean();const r=this.graph.container;if(null!=t.offsetX&&null!=t.offsetY&&r.contains(t.target))e=t.offsetX,n=t.offsetY;else{const i=this.$(r).offset();e=t.clientX-i.left+window.pageXOffset+r.scrollLeft,n=t.clientY-i.top+window.pageYOffset+r.scrollTop}this.$container.css({top:n,left:e,width:1,height:1}),this.setEventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,offsetX:e,offsetY:n,scrollerX:0,scrollerY:0}),this.delegateDocumentEvents(Private$3.documentEvents,t.data)}filter(t){const e=this.options.filter;return Array.isArray(e)?t.filter((t=>!e.includes(t)&&!e.includes(t.shape))):"function"==typeof e?t.filter((t=>call(e,this.graph,t))):t}stopSelecting(t){const e=this.graph,n=this.getEventData(t);switch(n.action){case"selecting":{let t=this.$container.width(),n=this.$container.height();const r=this.$container.offset(),i=e.pageToLocal(r.left,r.top),o=e.transform.getScale();t/=o.sx,n/=o.sy;const s=new Rectangle(i.x,i.y,t,n),a=this.getCellViewsInArea(s).map((t=>t.cell));this.reset(a,{batch:!0}),this.hideRubberband();break}case"translating":{const r=e.snapToGrid(t.clientX,t.clientY);this.options.following||this.updateSelectedNodesPosition({dx:n.clientX-n.originX,dy:n.clientY-n.originY}),this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",t,r.x,r.y);break}default:this.clean()}}onMouseUp(t){this.getEventData(t).action&&(this.stopSelecting(t),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(t){this.options.following||t.stopPropagation();const e=this.normalizeEvent(t);this.options.movable&&this.startTranslating(e);const n=this.getCellViewFromElem(e.target);this.setEventData(e,{activeView:n});const r=this.graph.snapToGrid(e.clientX,e.clientY);this.notifyBoxEvent("box:mousedown",e,r.x,r.y),this.delegateDocumentEvents(Private$3.documentEvents,e.data)}startTranslating(t){this.graph.model.startBatch("move-selection");const e=this.graph.snapToGrid(t.clientX,t.clientY);this.setEventData(t,{action:"translating",clientX:e.x,clientY:e.y,originX:e.x,originY:e.y})}getSelectionOffset(t,e){let n=t.x-e.clientX,r=t.y-e.clientY;const i=this.graph.hook.getRestrictArea();if(i){const o=this.collection.toArray(),s=Cell.getCellsBBox(o,{deep:!0})||Rectangle.create(),a=i.x-s.x,l=i.y-s.y,c=i.x+i.width-(s.x+s.width),u=i.y+i.height-(s.y+s.height);if(n<a&&(n=a),r<l&&(r=l),c<n&&(n=c),u<r&&(r=u),!this.options.following){const i=t.x-e.originX,o=t.y-e.originY;n=i<=a||i>=c?0:n,r=o<=l||o>=u?0:r}}return{dx:n,dy:r}}updateSelectedNodesPosition(t){const{dx:e,dy:n}=t;if(e||n)if(this.translateSelectedNodes(e,n),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const t=this.graph.transform.getScale();this.$boxes.add(this.$selectionContainer).css({left:"+="+e*t.sx,top:"+="+n*t.sy})}}autoScrollGraph(t,e){const n=this.graph.scroller.widget;return n?n.autoScroll(t,e):{scrollerX:0,scrollerY:0}}adjustSelection(t){const e=this.normalizeEvent(t),n=this.getEventData(e);switch(n.action){case"selecting":{const t=n;!0!==t.moving&&(this.$container.appendTo(this.graph.container),this.showRubberband(),t.moving=!0);const{scrollerX:r,scrollerY:i}=this.autoScrollGraph(e.clientX,e.clientY);t.scrollerX+=r,t.scrollerY+=i;const o=e.clientX-t.clientX+t.scrollerX,s=e.clientY-t.clientY+t.scrollerY,a=parseInt(this.$container.css("left"),10),l=parseInt(this.$container.css("top"),10);this.$container.css({left:o<0?t.offsetX+o:a,top:s<0?t.offsetY+s:l,width:Math.abs(o),height:Math.abs(s)});break}case"translating":{const r=this.graph.snapToGrid(e.clientX,e.clientY),i=n,o=this.getSelectionOffset(r,i);this.options.following?this.updateSelectedNodesPosition(o):this.updateContainerPosition(o),o.dx&&(i.clientX=r.x),o.dy&&(i.clientY=r.y),this.notifyBoxEvent("box:mousemove",t,r.x,r.y);break}}this.boxesUpdated=!1}translateSelectedNodes(t,e,n,r){const i={},o=[];if(n&&(i[n.id]=!0),this.collection.toArray().forEach((t=>{t.getDescendants({deep:!0}).forEach((t=>{i[t.id]=!0}))})),r&&r.translateBy){const t=this.graph.getCellById(r.translateBy);t&&(i[t.id]=!0,t.getDescendants({deep:!0}).forEach((t=>{i[t.id]=!0})),o.push(t))}this.collection.toArray().forEach((n=>{if(!i[n.id]){const s=Object.assign(Object.assign({},r),{selection:this.cid,exclude:o});n.translate(t,e,s),this.graph.model.getConnectedEdges(n).forEach((n=>{i[n.id]||(n.translate(t,e,s),i[n.id]=!0)}))}}))}getCellViewsInArea(t){const e=this.graph,n={strict:this.options.strict};let r=[];return this.options.rubberNode&&(r=r.concat(this.options.useCellGeometry?e.model.getNodesInArea(t,n).map((t=>e.renderer.findViewByCell(t))).filter((t=>null!=t)):e.renderer.findViewsInArea(t,n))),this.options.rubberEdge&&(r=r.concat(this.options.useCellGeometry?e.model.getEdgesInArea(t,n).map((t=>e.renderer.findViewByCell(t))).filter((t=>null!=t)):e.renderer.findEdgeViewsInArea(t,n))),r}notifyBoxEvent(t,e,n,r){const i=this.getEventData(e).activeView;this.trigger(t,{e,view:i,x:n,y:r,cell:i.cell})}getSelectedClassName(t){return this.prefixClassName((t.isNode()?"node":"edge")+"-selected")}addCellSelectedClassName(t){const e=this.graph.renderer.findViewByCell(t);e&&e.addClass(this.getSelectedClassName(t))}removeCellUnSelectedClassName(t){const e=this.graph.renderer.findViewByCell(t);e&&e.removeClass(this.getSelectedClassName(t))}destroySelectionBox(t){this.removeCellUnSelectedClassName(t),this.canShowSelectionBox(t)&&(this.$container.find(`[data-cell-id="${t.id}"]`).remove(),0===this.$boxes.length&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(t){t.forEach((t=>this.removeCellUnSelectedClassName(t))),this.hide(),this.$boxes.remove(),this.boxCount=0}hide(){this.$container.removeClass(this.prefixClassName(Private$3.classNames.rubberband)).removeClass(this.prefixClassName(Private$3.classNames.selected))}showRubberband(){this.$container.addClass(this.prefixClassName(Private$3.classNames.rubberband))}hideRubberband(){this.$container.removeClass(this.prefixClassName(Private$3.classNames.rubberband))}showSelected(){this.$container.removeAttr("style").addClass(this.prefixClassName(Private$3.classNames.selected))}createContainer(){this.container=document.createElement("div"),this.$container=this.$(this.container),this.$container.addClass(this.prefixClassName(Private$3.classNames.root)),this.options.className&&this.$container.addClass(this.options.className),this.$selectionContainer=this.$("<div/>").addClass(this.prefixClassName(Private$3.classNames.inner)),this.$selectionContent=this.$("<div/>").addClass(this.prefixClassName(Private$3.classNames.content)),this.$selectionContainer.append(this.$selectionContent),this.$selectionContainer.attr("data-selection-length",this.collection.length),this.$container.prepend(this.$selectionContainer),this.$handleContainer=this.$selectionContainer}updateContainerPosition(t){(t.dx||t.dy)&&this.$selectionContainer.css({left:`+=${t.dx}`,top:`+=${t.dy}`})}updateContainer(){const t={x:1/0,y:1/0},e={x:0,y:0};this.collection.toArray().filter((t=>this.canShowSelectionBox(t))).forEach((n=>{const r=this.graph.renderer.findViewByCell(n);if(r){const n=r.getBBox({useCellGeometry:this.options.useCellGeometry});t.x=Math.min(t.x,n.x),t.y=Math.min(t.y,n.y),e.x=Math.max(e.x,n.x+n.width),e.y=Math.max(e.y,n.y+n.height)}})),this.$selectionContainer.css({position:"absolute",pointerEvents:"none",left:t.x,top:t.y,width:e.x-t.x,height:e.y-t.y}).attr("data-selection-length",this.collection.length);const n=this.options.content;if(n)if("function"==typeof n){const t=call(n,this.graph,this,this.$selectionContent[0]);t&&this.$selectionContent.html(t)}else this.$selectionContent.html(n);this.collection.length>0&&!this.container.parentNode?this.$container.appendTo(this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(t){return t.isNode()&&!0===this.options.showNodeSelectionBox||t.isEdge()&&!0===this.options.showEdgeSelectionBox}createSelectionBox(t){if(this.addCellSelectedClassName(t),this.canShowSelectionBox(t)){const e=this.graph.renderer.findViewByCell(t);if(e){const n=e.getBBox({useCellGeometry:this.options.useCellGeometry}),r=this.boxClassName;this.$("<div/>").addClass(r).addClass(`${r}-${t.isNode()?"node":"edge"}`).attr("data-cell-id",t.id).css({position:"absolute",left:n.x,top:n.y,width:n.width,height:n.height,pointerEvents:this.options.pointerEvents||"auto"}).appendTo(this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(t={}){this.collection.length>0&&(this.boxesUpdated=!0,this.graph.renderer.requestViewUpdate(this,1,2,t))}confirmUpdate(){return this.boxCount&&(this.hide(),this.$boxes.each(((t,e)=>{const n=this.$(e).remove().attr("data-cell-id"),r=this.collection.get(n);r&&this.createSelectionBox(r)})),this.updateContainer()),0}getCellViewFromElem(t){const e=t.getAttribute("data-cell-id");if(e){const t=this.collection.get(e);if(t)return this.graph.renderer.findViewByCell(t)}return null}onCellRemoved({cell:t}){this.destroySelectionBox(t),this.updateContainer()}onReseted({previous:t,current:e}){this.destroyAllSelectionBoxes(t),e.forEach((t=>{this.listenCellRemoveEvent(t),this.createSelectionBox(t)})),this.updateContainer()}onCellAdded({cell:t}){this.listenCellRemoveEvent(t),this.createSelectionBox(t),this.updateContainer()}listenCellRemoveEvent(t){t.off("removed",this.onCellRemoved,this),t.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:t,removed:e,options:n}){t.forEach((t=>{this.trigger("cell:selected",{cell:t,options:n}),this.graph.trigger("cell:selected",{cell:t,options:n}),t.isNode()?(this.trigger("node:selected",{cell:t,options:n,node:t}),this.graph.trigger("node:selected",{cell:t,options:n,node:t})):t.isEdge()&&(this.trigger("edge:selected",{cell:t,options:n,edge:t}),this.graph.trigger("edge:selected",{cell:t,options:n,edge:t}))})),e.forEach((t=>{this.trigger("cell:unselected",{cell:t,options:n}),this.graph.trigger("cell:unselected",{cell:t,options:n}),t.isNode()?(this.trigger("node:unselected",{cell:t,options:n,node:t}),this.graph.trigger("node:unselected",{cell:t,options:n,node:t})):t.isEdge()&&(this.trigger("edge:unselected",{cell:t,options:n,edge:t}),this.graph.trigger("edge:unselected",{cell:t,options:n,edge:t}))}));const r={added:t,removed:e,options:n,selected:this.cells.filter((t=>!!this.graph.getCellById(t.id)))};this.trigger("selection:changed",r),this.graph.trigger("selection:changed",r)}deleteSelectedCells(){const t=this.collection.toArray();this.clean(),this.graph.model.removeCells(t,{selection:this.cid})}startRotate({e:t}){const e=this.collection.toArray(),n=Cell.getCellsBBox(e).getCenter(),r=this.graph.snapToGrid(t.clientX,t.clientY),i=e.reduce(((t,e)=>(t[e.id]=Angle.normalize(e.getAngle()),t)),{});this.setEventData(t,{center:n,angles:i,start:r.theta(n)})}doRotate({e:t}){const e=this.getEventData(t),n=this.graph.options.rotating.grid,r="function"==typeof n?call(n,this.graph,null):n,i=this.graph.snapToGrid(t.clientX,t.clientY),o=e.start-i.theta(e.center);e.rotated||(e.rotated=!0),Math.abs(o)>.001&&(this.collection.toArray().forEach((t=>{const n=Util$3.snapToGrid(e.angles[t.id]+o,r||15);t.rotate(n,{absolute:!0,center:e.center,selection:this.cid})})),this.updateSelectionBoxes())}stopRotate({e:t}){const e=this.getEventData(t);e.rotated&&(e.rotated=!1,this.collection.toArray().forEach((e=>{notify("node:rotated",t,this.graph.findViewByCell(e))})))}startResize({e:t}){const e=this.graph.getGridSize(),n=this.collection.toArray(),r=Cell.getCellsBBox(n),i=n.map((t=>t.getBBox())),o=i.reduce(((t,e)=>e.width<t?e.width:t),1/0),s=i.reduce(((t,e)=>e.height<t?e.height:t),1/0);this.setEventData(t,{bbox:r,cells:this.graph.model.getSubGraph(n),minWidth:e*r.width/o,minHeight:e*r.height/s})}doResize({e:t,dx:e,dy:n}){const r=this.eventData(t),i=r.bbox,o=i.width,s=i.height,a=Math.max(o+e,r.minWidth),l=Math.max(s+n,r.minHeight);r.resized||(r.resized=!0),(Math.abs(o-a)>.001||Math.abs(s-l)>.001)&&(this.graph.model.resizeCells(a,l,r.cells,{selection:this.cid}),i.width=a,i.height=l,this.updateSelectionBoxes())}stopResize({e:t}){const e=this.eventData(t);e.resized&&(e.resized=!1,this.collection.toArray().forEach((e=>{notify("node:resized",t,this.graph.findViewByCell(e))})))}dispose(){this.clean(),this.remove()}}__decorate$h([View.dispose()],Selection.prototype,"dispose",null),applyMixins(Selection,Handle),function(t){const e="widget-selection";t.classNames={root:e,inner:`${e}-inner`,box:`${e}-box`,content:`${e}-content`,rubberband:`${e}-rubberband`,selected:`${e}-selected`},t.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},t.defaultOptions={movable:!0,following:!0,strict:!1,useCellGeometry:!1,content:t=>template('<%= length %> node<%= length > 1 ? "s":"" %> selected.')({length:t.length}),handles:[{name:"remove",position:"nw",events:{mousedown:"deleteSelectedCells"}},{name:"rotate",position:"sw",events:{mousedown:"startRotate",mousemove:"doRotate",mouseup:"stopRotate"}},{name:"resize",position:"se",events:{mousedown:"startResize",mousemove:"doResize",mouseup:"stopResize"}}]},t.depthComparator=function(t){return t.getAncestors().length}}(Private$3||(Private$3={}));class Transform extends Widget{get node(){return this.cell}get containerClassName(){return this.prefixClassName("widget-transform")}get resizeClassName(){return`${this.containerClassName}-resize`}get rotateClassName(){return`${this.containerClassName}-rotate`}init(t){this.options=Object.assign(Object.assign({},Private$2.defaultOptions),t),this.render(),this.startListening()}startListening(){this.delegateEvents({[`mousedown .${this.resizeClassName}`]:"startResizing",[`touchstart .${this.resizeClassName}`]:"startResizing",[`mousedown .${this.rotateClassName}`]:"startRotating",[`touchstart .${this.rotateClassName}`]:"startRotating"}),this.model.on("*",this.update,this),this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this),this.node.on("removed",this.remove,this),this.model.on("reseted",this.remove,this),this.view.on("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.on("cell:knob:mouseup",this.onKnobMouseUp,this),super.startListening()}stopListening(){this.undelegateEvents(),this.model.off("*",this.update,this),this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this),this.node.off("removed",this.remove,this),this.model.off("reseted",this.remove,this),this.view.off("cell:knob:mousedown",this.onKnobMouseDown,this),this.view.off("cell:knob:mouseup",this.onKnobMouseUp,this),super.stopListening()}renderHandles(){this.container=document.createElement("div"),this.$container=this.$(this.container);const t=this.$("<div/>").prop("draggable",!1),e=t.clone().addClass(this.rotateClassName),n=Private$2.POSITIONS.map((e=>t.clone().addClass(this.resizeClassName).attr("data-position",e)));this.empty(),this.$container.append(n,e)}render(){return this.renderHandles(),this.view.addClass(Private$2.NODE_CLS),this.$container.addClass(this.containerClassName).toggleClass("no-orth-resize",this.options.preserveAspectRatio||!this.options.orthogonalResizing).toggleClass("no-resize",!this.options.resizable).toggleClass("no-rotate",!this.options.rotatable),this.options.className&&this.$container.addClass(this.options.className),this.graph.container.appendChild(this.container),this.update()}update(){const t=this.graph.matrix(),e=this.node.getBBox();e.x*=t.a,e.x+=t.e,e.y*=t.d,e.y+=t.f,e.width*=t.a,e.height*=t.d;const n=Angle.normalize(this.node.getAngle());return this.$container.css({transform:0!==n?`rotate(${n}deg)`:"",width:e.width,height:e.height,left:e.x,top:e.y}),this.updateResizerDirections(),this}remove(){return this.view.removeClass(Private$2.NODE_CLS),super.remove()}onKnobMouseDown(){this.startHandle()}onKnobMouseUp(){this.stopHandle()}updateResizerDirections(){const t=Angle.normalize(this.node.getAngle()),e=Math.floor(t*(Private$2.DIRECTIONS.length/360));if(e!==this.prevShift){const t=Private$2.DIRECTIONS.slice(e).concat(Private$2.DIRECTIONS.slice(0,e)),n=t=>`${this.containerClassName}-cursor-${t}`;this.$container.find(`.${this.resizeClassName}`).removeClass(Private$2.DIRECTIONS.map((t=>n(t))).join(" ")).each(((e,r)=>{this.$(r).addClass(n(t[e]))})),this.prevShift=e}}getTrueDirection(t){const e=Angle.normalize(this.node.getAngle());let n=Private$2.POSITIONS.indexOf(t);return n+=Math.floor(e*(Private$2.POSITIONS.length/360)),n%=Private$2.POSITIONS.length,Private$2.POSITIONS[n]}toValidResizeDirection(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t}startResizing(t){t.stopPropagation(),this.model.startBatch("resize",{cid:this.cid});const e=this.$(t.target).attr("data-position"),n=this.graph.findViewByCell(this.node);this.prepareResizing(t,e),this.startAction(t),notify("node:resize:mousedown",t,n)}prepareResizing(t,e){const n=this.getTrueDirection(e);let r=0,i=0;e.split("-").forEach((t=>{r={left:-1,right:1}[t]||r,i={top:-1,bottom:1}[t]||i}));const o=this.toValidResizeDirection(e),s={"top-right":"bottomLeft","top-left":"bottomRight","bottom-left":"topRight","bottom-right":"topLeft"}[o],a=Angle.normalize(this.node.getAngle());this.setEventData(t,{selector:s,direction:o,trueDirection:n,relativeDirection:e,angle:a,resizeX:r,resizeY:i,action:"resizing"})}startRotating(t){t.stopPropagation(),this.model.startBatch("rotate",{cid:this.cid});const e=this.graph.findViewByCell(this.node),n=this.node.getBBox().getCenter(),r=this.normalizeEvent(t),i=this.graph.snapToGrid(r.clientX,r.clientY);this.setEventData(t,{center:n,action:"rotating",angle:Angle.normalize(this.node.getAngle()),start:Point.create(i).theta(n)}),this.startAction(t),notify("node:rotate:mousedown",t,e)}onMouseMove(t){const e=this.graph.findViewByCell(this.node);let n=this.getEventData(t);if(n.action){const r=this.normalizeEvent(t);let i=r.clientX,o=r.clientY;const s=this.graph.scroller.widget,a=this.options.restrictedResizing;if(!0===a||"number"==typeof a){const t=!0===a?0:a,e=s?Math.max(t,8):t,n=this.graph.container.getBoundingClientRect();i=clamp$1(i,n.left+e,n.right-e),o=clamp$1(o,n.top+e,n.bottom-e)}else this.options.autoScrollOnResizing&&s&&s.autoScroll(i,o);const l=this.graph.snapToGrid(i,o),c=this.graph.getGridSize(),u=this.node,h=this.options;if("resizing"===n.action){n=n,n.resized||(e&&(e.addClass("node-resizing"),notify("node:resize",t,e)),n.resized=!0);const r=u.getBBox(),i=Point.create(l).rotate(n.angle,r.getCenter()).diff(r[n.selector]);let o=n.resizeX?i.x*n.resizeX:r.width,s=n.resizeY?i.y*n.resizeY:r.height;const a=o,d=s;if(o=Util$3.snapToGrid(o,c),s=Util$3.snapToGrid(s,c),o=Math.max(o,h.minWidth||c),s=Math.max(s,h.minHeight||c),o=Math.min(o,h.maxWidth||1/0),s=Math.min(s,h.maxHeight||1/0),h.preserveAspectRatio){const t=r.width*s/r.height,e=r.height*o/r.width;o<t?s=e:o=t}const f=n.relativeDirection;if(h.allowReverse&&(a<=-o||d<=-s)){let e;"left"===f?a<=-o&&(e="right"):"right"===f?a<=-o&&(e="left"):"top"===f?d<=-s&&(e="bottom"):"bottom"===f?d<=-s&&(e="top"):"top-left"===f?a<=-o&&d<=-s?e="bottom-right":a<=-o?e="top-right":d<=-s&&(e="bottom-left"):"top-right"===f?a<=-o&&d<=-s?e="bottom-left":a<=-o?e="top-left":d<=-s&&(e="bottom-right"):"bottom-left"===f?a<=-o&&d<=-s?e="top-right":a<=-o?e="bottom-right":d<=-s&&(e="top-left"):"bottom-right"===f&&(a<=-o&&d<=-s?e="top-left":a<=-o?e="bottom-left":d<=-s&&(e="top-right"));const n=e;this.stopHandle();const r=this.$container.find(`.${this.resizeClassName}[data-position="${n}"]`);this.startHandle(r[0]),this.prepareResizing(t,n),this.onMouseMove(t)}r.width===o&&r.height===s||(u.resize(o,s,{ui:!0,direction:n.direction,relativeDirection:n.relativeDirection,trueDirection:n.trueDirection,minWidth:h.minWidth,minHeight:h.minHeight,maxWidth:h.maxWidth,maxHeight:h.maxHeight,preserveAspectRatio:!0===h.preserveAspectRatio}),notify("node:resizing",t,e)),notify("node:resize:mousemove",t,e)}else if("rotating"===n.action){n=n,n.rotated||(e&&(e.addClass("node-rotating"),notify("node:rotate",t,e)),n.rotated=!0);const r=u.getAngle(),i=n.start-Point.create(l).theta(n.center);let o=n.angle+i;h.rotateGrid&&(o=Util$3.snapToGrid(o,h.rotateGrid)),o=Angle.normalize(o),r!==o&&(u.rotate(o,{absolute:!0}),notify("node:rotating",t,e)),notify("node:rotate:mousemove",t,e)}}}onMouseUp(t){const e=this.graph.findViewByCell(this.node),n=this.getEventData(t);n.action&&(this.stopAction(t),this.model.stopBatch("resizing"===n.action?"resize":"rotate",{cid:this.cid}),"resizing"===n.action?notify("node:resize:mouseup",t,e):"rotating"===n.action&&notify("node:rotate:mouseup",t,e))}startHandle(t){if(this.handle=t||null,this.$container.addClass(`${this.containerClassName}-active`),t){this.$(t).addClass(`${this.containerClassName}-active-handle`);const e=t.getAttribute("data-position");if(e){const t=Private$2.DIRECTIONS[Private$2.POSITIONS.indexOf(e)];this.$container.addClass(`${this.containerClassName}-cursor-${t}`)}}}stopHandle(){if(this.$container.removeClass(`${this.containerClassName}-active`),this.handle){this.$(this.handle).removeClass(`${this.containerClassName}-active-handle`);const t=this.handle.getAttribute("data-position");if(t){const e=Private$2.DIRECTIONS[Private$2.POSITIONS.indexOf(t)];this.$container.removeClass(`${this.containerClassName}-cursor-${e}`)}this.handle=null}}startAction(t){this.startHandle(t.target),this.graph.view.undelegateEvents(),this.delegateDocumentEvents(Private$2.documentEvents,t.data)}stopAction(t){this.stopHandle(),this.undelegateDocumentEvents(),this.graph.view.delegateEvents();const e=this.graph.findViewByCell(this.node),n=this.getEventData(t);e&&(e.removeClass(`node-${n.action}`),"resizing"===n.action&&n.resized?notify("node:resized",t,e):"rotating"===n.action&&n.rotated&&notify("node:rotated",t,e))}}!function(t){t.NODE_CLS="has-widget-transform",t.DIRECTIONS=["nw","n","ne","e","se","s","sw","w"],t.POSITIONS=["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],t.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp"},t.defaultOptions={minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,rotateGrid:15,rotatable:!0,preserveAspectRatio:!1,orthogonalResizing:!0,restrictedResizing:!1,autoScrollOnResizing:!0,allowReverse:!0}}(Private$2||(Private$2={}));var __rest$5=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Options;(Options||(Options={})).parseOptionGroup=function(t,e,n){const r={};return Object.keys(n||{}).forEach((i=>{const o=n[i];r[i]="function"==typeof o?o.call(t,e):o})),r},function(t){t.get=function(e){const{grid:n}=e,r=__rest$5(e,["grid","panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"]),i=e.container;if(null==i)throw new Error("Ensure the container of the graph is specified and valid");null==r.width&&(r.width=i.clientWidth),null==r.height&&(r.height=i.clientHeight);const o=merge({},t.defaults,r);return o.grid="number"==typeof n?{size:n,visible:!1}:Object.assign(Object.assign({},{size:10,visible:!1}),"boolean"==typeof n?{visible:n}:n),["panning","selecting","embedding","snapline","resizing","rotating","knob","clipboard","history","scroller","minimap","keyboard","mousewheel"].forEach((t=>{const n=e[t];"boolean"==typeof n?o[t].enabled=n:o[t]=Object.assign(Object.assign({},o[t]),n)})),o.background&&o.scroller.enabled&&null==o.scroller.background&&(o.scroller.background=o.background,delete o.background),o}}(Options||(Options={})),(Options||(Options={})).defaults={x:0,y:0,grid:{size:10,visible:!1},scaling:{min:.01,max:16},background:!1,highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:Util$3.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:Util$3.prefix("available-magnet")}}},connecting:{snap:!1,multi:!0,dangling:!0,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",strategy:null,router:"normal",connector:"normal",validateConnection:({type:t,sourceView:e,targetView:n})=>null!=("target"===t?n:e),createEdge:()=>new Edge},transforming:{clearAll:!0,clearOnBlankMouseDown:!0},resizing:{enabled:!1,minWidth:0,minHeight:0,maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,orthogonal:!0,restricted:!1,autoScroll:!0,preserveAspectRatio:!1,allowReverse:!0},rotating:{enabled:!1,grid:15},translating:{restrict:!1},knob:{enabled:!1,clearAll:!0,clearOnBlankMouseDown:!0},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},selecting:{enabled:!1,rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,useCellGeometry:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,content:null,handles:null},panning:{enabled:!1,eventTypes:["leftMouseDown"]},snapline:{enabled:!1},clipboard:{enabled:!1},history:{enabled:!1},scroller:{enabled:!1},keyboard:{enabled:!1},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},async:!1,frozen:!1,sorting:"exact",moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},guard:()=>!1};var __rest$4=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class DefsManager extends Base{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(t){return null!=this.svg.getElementById(t)}filter(t){let e=t.id;const n=t.name;if(e||(e=`filter-${n}-${this.cid}-${hashcode(JSON.stringify(t))}`),!this.isDefined(e)){const r=Filter.registry.get(n);if(null==r)return Filter.registry.onNotFound(n);const i=r(t.args||{}),o=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},t.attrs),{id:e});Vector.create(Markup.sanitize(i),o).appendTo(this.defs)}return e}gradient(t){let e=t.id;const n=t.type;if(e||(e=`gradient-${n}-${this.cid}-${hashcode(JSON.stringify(t))}`),!this.isDefined(e)){const r=`<${n}>${t.stops.map((t=>{const e=null!=t.opacity&&Number.isFinite(t.opacity)?t.opacity:1;return`<stop offset="${t.offset}" stop-color="${t.color}" stop-opacity="${e}"/>`})).join("")}</${n}>`,i=Object.assign({id:e},t.attrs);Vector.create(r,i).appendTo(this.defs)}return e}marker(t){const{id:e,refX:n,refY:r,markerUnits:i,markerOrient:o,tagName:s,children:a}=t,l=__rest$4(t,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let c=e;if(c||(c=`marker-${this.cid}-${hashcode(JSON.stringify(t))}`),!this.isDefined(c)){"path"!==s&&delete l.d;const t=Vector.create("marker",{refX:n,refY:r,id:c,overflow:"visible",orient:null!=o?o:"auto",markerUnits:i||"userSpaceOnUse"},a?a.map((t=>{var{tagName:e}=t,n=__rest$4(t,["tagName"]);return Vector.create(`${e}`||"path",kebablizeAttrs(Object.assign(Object.assign({},l),n)))})):[Vector.create(s||"path",kebablizeAttrs(l))]);this.defs.appendChild(t.node)}return c}remove(t){const e=this.svg.getElementById(t);e&&e.parentNode&&e.parentNode.removeChild(e)}}var __decorate$g=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$3=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class GridManager extends Base{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(t){this.grid.visible!==t&&(this.grid.visible=t,this.update())}getGridSize(){return this.grid.size}setGridSize(t){this.grid.size=Math.max(t,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(t){this.clear(),this.instance=null,Object.assign(this.grid,t),this.patterns=this.resolveGrid(t),this.update()}update(t={}){const e=this.grid.size;if(e<=1||!this.grid.visible)return this.clear();const n=this.graph.matrix(),r=this.getInstance(),i=Array.isArray(t)?t:[t];this.patterns.forEach(((t,o)=>{const s=`pattern_${o}`,a=n.a||1,l=n.d||1,{update:c,markup:u}=t,h=__rest$3(t,["update","markup"]),d=Object.assign(Object.assign(Object.assign({},h),i[o]),{sx:a,sy:l,ox:n.e||0,oy:n.f||0,width:e*a,height:e*l});r.has(s)||r.add(s,Vector.create("pattern",{id:s,patternUnits:"userSpaceOnUse"},Vector.createVectors(u)).node);const f=r.get(s);"function"==typeof c&&c(f.childNodes[0],d);let p=d.ox%d.width;p<0&&(p+=d.width);let g=d.oy%d.height;g<0&&(g+=d.height),attr(f,{x:p,y:g,width:d.width,height:d.height})}));const o=(new XMLSerializer).serializeToString(r.root),s=`url(data:image/svg+xml;base64,${btoa(o)})`;this.elem.style.backgroundImage=s}getInstance(){return this.instance||(this.instance=new Grid),this.instance}resolveGrid(t){if(!t)return[];const e=t.type;if(null==e)return[Object.assign(Object.assign({},Grid.presets.dot),t.args)];const n=Grid.registry.get(e);if(n){let e=t.args||[];return Array.isArray(e)||(e=[e]),Array.isArray(n)?n.map(((t,n)=>Object.assign(Object.assign({},t),e[n]))):[Object.assign(Object.assign({},n),e[0])]}return Grid.registry.onNotFound(e)}dispose(){this.stopListening(),this.clear()}}__decorate$g([Base.dispose()],GridManager.prototype,"dispose",null);class CoordManager extends Base{getClientMatrix(){return createSVGMatrix(this.view.stage.getScreenCTM())}getClientOffset(){const t=this.view.svg.getBoundingClientRect();return new Point(t.left,t.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(t,e){return("number"==typeof t?this.clientToLocalPoint(t,e):this.clientToLocalPoint(t.x,t.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(t,e){return transformPoint(Point.create(t,e),this.graph.matrix())}localToClientPoint(t,e){return transformPoint(Point.create(t,e),this.getClientMatrix())}localToPagePoint(t,e){return("number"==typeof t?this.localToGraphPoint(t,e):this.localToGraphPoint(t)).translate(this.getPageOffset())}localToGraphRect(t,e,n,r){return transformRectangle(Rectangle.create(t,e,n,r),this.graph.matrix())}localToClientRect(t,e,n,r){return transformRectangle(Rectangle.create(t,e,n,r),this.getClientMatrix())}localToPageRect(t,e,n,r){return("number"==typeof t?this.localToGraphRect(t,e,n,r):this.localToGraphRect(t)).translate(this.getPageOffset())}graphToLocalPoint(t,e){return transformPoint(Point.create(t,e),this.graph.matrix().inverse())}clientToLocalPoint(t,e){return transformPoint(Point.create(t,e),this.getClientMatrix().inverse())}clientToGraphPoint(t,e){return transformPoint(Point.create(t,e),this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(t,e){const n=Point.create(t,e).diff(this.getPageOffset());return this.graphToLocalPoint(n)}graphToLocalRect(t,e,n,r){return transformRectangle(Rectangle.create(t,e,n,r),this.graph.matrix().inverse())}clientToLocalRect(t,e,n,r){return transformRectangle(Rectangle.create(t,e,n,r),this.getClientMatrix().inverse())}clientToGraphRect(t,e,n,r){return transformRectangle(Rectangle.create(t,e,n,r),this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(t,e,n,r){const i=Rectangle.create(t,e,n,r),o=this.getPageOffset();return i.x-=o.x,i.y-=o.y,this.graphToLocalRect(i)}}var __decorate$f=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},ModifierKey;class SnaplineManager extends Base{constructor(){super(...arguments),this.widget=this.graph.hook.createSnapline()}dispose(){this.widget.dispose()}}__decorate$f([Base.dispose()],SnaplineManager.prototype,"dispose",null),function(t){function e(t){const e=[],n=[];return Array.isArray(t)?e.push(...t):t.split("|").forEach((t=>{-1===t.indexOf("&")?e.push(t):n.push(...t.split("&"))})),{or:e,and:n}}t.parse=e,t.equals=function(t,n){if(null!=t&&null!=n){const r=e(t),i=e(n),o=r.or.sort(),s=i.or.sort(),a=r.and.sort(),l=i.and.sort(),c=(t,e)=>t.length===e.length&&(0===t.length||t.every(((t,n)=>t===e[n])));return c(o,s)&&c(a,l)}return null==t&&null==n},t.isMatch=function(t,n,r){if(null==n||Array.isArray(n)&&0===n.length)return!r||!0!==t.altKey&&!0!==t.ctrlKey&&!0!==t.metaKey&&!0!==t.shiftKey;const{or:i,and:o}=e(n),s=e=>{const n=`${e.toLowerCase()}Key`;return!0===t[n]};return i.some((t=>s(t)))&&o.every((t=>s(t)))}}(ModifierKey||(ModifierKey={}));var __decorate$e=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class ScrollerManager extends Base{get widgetOptions(){return this.options.scroller}get pannable(){return!!this.widgetOptions&&("object"==typeof this.widgetOptions.pannable?this.widgetOptions.pannable.enabled:!!this.widgetOptions.pannable)}init(){this.widget=this.graph.hook.createScroller(),this.startListening(),this.updateClassName(),this.widget&&this.widget.center()}startListening(){let t=[];const e=this.widgetOptions.pannable;t="object"==typeof e?e.eventTypes||[]:["leftMouseDown"],t.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),t.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.widget.container).on("mousedown",this.onRightMouseDown))}stopListening(){let t=[];const e=this.widgetOptions.pannable;t="object"==typeof e?e.eventTypes||[]:["leftMouseDown"],t.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),t.includes("rightMouseDown")&&this.view.$(this.widget.container).off("mousedown",this.onRightMouseDown)}onRightMouseDown(t){2===t.button&&this.allowPanning(t,!0)&&this.widget&&(this.updateClassName(!0),this.widget.startPanning(t),this.widget.once("pan:stop",(()=>this.updateClassName(!1))))}preparePanning({e:t}){this.widget&&(this.allowPanning(t,!0)||this.allowPanning(t)&&!this.graph.selection.allowRubberband(t,!0))&&(this.updateClassName(!0),this.widget.startPanning(t),this.widget.once("pan:stop",(()=>this.updateClassName(!1))))}allowPanning(t,e){return this.widget&&this.pannable&&ModifierKey.isMatch(t,this.widgetOptions.modifiers,e)&&this.graph.hook.allowPanning(t)}updateClassName(t){if(null==this.widget)return;const e=this.widget.container,n=this.view.prefixClassName("graph-scroller-pannable");this.pannable?(addClass(e,n),e.dataset.panning=(!!t).toString()):removeClass(e,n)}enablePanning(){this.pannable||(this.widgetOptions.pannable=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.pannable=!1,this.updateClassName())}lock(){this.widget&&this.widget.lock()}unlock(){this.widget&&this.widget.unlock()}update(){this.widget&&this.widget.update()}enableAutoResize(){this.widget&&this.widget.enableAutoResize()}disableAutoResize(){this.widget&&this.widget.disableAutoResize()}resize(t,e){this.widget&&this.widget.resize(t,e)}dispose(){this.widget&&this.widget.dispose(),this.stopListening()}}__decorate$e([Base.dispose()],ScrollerManager.prototype,"dispose",null);var __decorate$d=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$2=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class ClipboardManager extends Base{get commonOptions(){return __rest$2(this.instanceOptions,["enabled"])}get instanceOptions(){return this.options.clipboard}get cells(){return this.widget.cells}get disabled(){return!0!==this.instanceOptions.enabled}init(){this.widget=this.graph.hook.createClipboard(),this.widget.deserialize(this.instanceOptions)}enable(){this.disabled&&(this.instanceOptions.enabled=!0)}disable(){this.disabled||(this.instanceOptions.enabled=!1)}copy(t,e={}){this.disabled||(this.widget.copy(t,this.graph,Object.assign(Object.assign({},this.commonOptions),e)),this.graph.trigger("clipboard:changed",{cells:t}))}cut(t,e={}){this.disabled||(this.widget.cut(t,this.graph,Object.assign(Object.assign({},this.commonOptions),e)),this.graph.trigger("clipboard:changed",{cells:t}))}paste(t={},e=this.graph){return this.disabled?[]:this.widget.paste(e,Object.assign(Object.assign({},this.commonOptions),t))}clean(t){this.disabled&&!t||(this.widget.clean(),this.graph.trigger("clipboard:changed",{cells:[]}))}isEmpty(){return this.widget.isEmpty()}dispose(){this.clean(!0)}}__decorate$d([Base.dispose()],ClipboardManager.prototype,"dispose",null);var __decorate$c=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class HighlightManager extends Base{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:t,magnet:e,options:n={}}){const r=this.resolveHighlighter(n);if(!r)return;const i=this.getHighlighterId(e,r);if(!this.highlights[i]){const n=r.highlighter;n.highlight(t,e,Object.assign({},r.args)),this.highlights[i]={cellView:t,magnet:e,highlighter:n,args:r.args}}}onCellUnhighlight({magnet:t,options:e={}}){const n=this.resolveHighlighter(e);if(!n)return;const r=this.getHighlighterId(t,n);this.unhighlight(r)}resolveHighlighter(t){const e=this.options;let n=t.highlighter;if(null==n){const r=t.type;n=r&&e.highlighting[r]||e.highlighting.default}if(null==n)return null;const r="string"==typeof n?{name:n}:n,i=r.name,o=Highlighter.registry.get(i);return null==o?Highlighter.registry.onNotFound(i):(Highlighter.check(i,o),{name:i,highlighter:o,args:r.args||{}})}getHighlighterId(t,e){return ensureId(t),e.name+t.id+JSON.stringify(e.args)}unhighlight(t){const e=this.highlights[t];e&&(e.highlighter.unhighlight(e.cellView,e.magnet,e.args),delete this.highlights[t])}dispose(){Object.keys(this.highlights).forEach((t=>this.unhighlight(t))),this.stopListening()}}__decorate$c([HighlightManager.dispose()],HighlightManager.prototype,"dispose",null);var __decorate$b=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class TransformManager extends Base{constructor(){super(...arguments),this.widgets=new Map}get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get isSelectionEnabled(){return!0===this.options.selecting.enabled}init(){this.startListening(),this.resize()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:t}){if(!this.isSelectionEnabled){const e=this.graph.hook.createTransform(t,{clearAll:!0});e&&this.widgets.set(t,e)}}onNodeSelected({node:t}){if(this.isSelectionEnabled){const e=this.graph.hook.createTransform(t,{clearAll:!1});e&&this.widgets.set(t,e)}}onNodeUnSelected({node:t}){if(this.isSelectionEnabled){const e=this.widgets.get(t);e&&e.dispose(),this.widgets.delete(t)}}getMatrix(){const t=this.viewport.getAttribute("transform");return t!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=t),createSVGMatrix(this.viewportMatrix)}setMatrix(t){const e=createSVGMatrix(t),n=matrixToTransformString(e);this.viewport.setAttribute("transform",n),this.viewportMatrix=e,this.viewportTransformString=n}resize(t,e){let n=void 0===t?this.options.width:t,r=void 0===e?this.options.height:e;this.options.width=n,this.options.height=r,"number"==typeof n&&(n=Math.round(n)),"number"==typeof r&&(r=Math.round(r)),this.container.style.width=null==n?"":`${n}px`,this.container.style.height=null==r?"":`${r}px`;const i=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},i)),this}getComputedSize(){let t=this.options.width,e=this.options.height;return isNumber(t)||(t=this.container.clientWidth),isNumber(e)||(e=this.container.clientHeight),{width:t,height:e}}getScale(){return matrixToScale(this.getMatrix())}scale(t,e=t,n=0,r=0,i={}){if(t=this.clampScale(t),e=this.clampScale(e),n||r){const i=this.getTranslation(),o=i.tx-n*(t-1),s=i.ty-r*(e-1);o===i.tx&&s===i.ty||this.translate(o,s)}const o=this.getMatrix();return o.a=t,o.d=e,this.setMatrix(o),this.graph.trigger("scale",Object.assign({sx:t,sy:e,ox:n,oy:r},i)),this}clampScale(t){const e=this.graph.options.scaling;return clamp$1(t,e.min||.01,e.max||16)}getZoom(){return this.getScale().sx}zoom(t,e){e=e||{};let n=t,r=t;const i=this.getScale(),o=this.getComputedSize();let s=o.width/2,a=o.height/2;if(e.absolute||(n+=i.sx,r+=i.sy),e.scaleGrid&&(n=Math.round(n/e.scaleGrid)*e.scaleGrid,r=Math.round(r/e.scaleGrid)*e.scaleGrid),e.maxScale&&(n=Math.min(e.maxScale,n),r=Math.min(e.maxScale,r)),e.minScale&&(n=Math.max(e.minScale,n),r=Math.max(e.minScale,r)),e.center&&(s=e.center.x,a=e.center.y),n=this.clampScale(n),r=this.clampScale(r),s||a){const t=this.getTranslation(),o=s-n/i.sx*(s-t.tx),l=a-r/i.sy*(a-t.ty);o===t.tx&&l===t.ty||this.translate(o,l,{ui:e.ui})}return this.scale(n,r,0,0,{ui:e.ui}),this}getRotation(){return matrixToRotation(this.getMatrix())}rotate(t,e,n){if(null==e||null==n){const t=getBBox(this.graph.view.stage);e=t.width/2,n=t.height/2}const r=this.getMatrix().translate(e,n).rotate(t).translate(-e,-n);return this.setMatrix(r),this}getTranslation(){return matrixToTranslation(this.getMatrix())}translate(t,e,n={}){const r=this.getMatrix();r.e=t||0,r.f=e||0,this.setMatrix(r);const i=this.getTranslation();return this.options.x=i.tx,this.options.y=i.ty,this.graph.trigger("translate",Object.assign(Object.assign({},i),n)),this}setOrigin(t,e){return this.translate(t||0,e||0)}fitToContent(t,e,n,r){if("object"==typeof t){const i=t;t=i.gridWidth||1,e=i.gridHeight||1,n=i.padding||0,r=i}else t=t||1,e=e||1,n=n||0,null==r&&(r={});const i=normalizeSides(n),o=r.border||0,s=r.contentArea?Rectangle.create(r.contentArea):this.getContentArea(r);o>0&&s.inflate(o);const a=this.getScale(),l=this.getTranslation(),c=a.sx,u=a.sy;s.x*=c,s.y*=u,s.width*=c,s.height*=u;let h=Math.max(Math.ceil((s.width+s.x)/t),1)*t,d=Math.max(Math.ceil((s.height+s.y)/e),1)*e,f=0,p=0;("negative"===r.allowNewOrigin&&s.x<0||"positive"===r.allowNewOrigin&&s.x>=0||"any"===r.allowNewOrigin)&&(f=Math.ceil(-s.x/t)*t,f+=i.left,h+=f),("negative"===r.allowNewOrigin&&s.y<0||"positive"===r.allowNewOrigin&&s.y>=0||"any"===r.allowNewOrigin)&&(p=Math.ceil(-s.y/e)*e,p+=i.top,d+=p),h+=i.right,d+=i.bottom,h=Math.max(h,r.minWidth||0),d=Math.max(d,r.minHeight||0),h=Math.min(h,r.maxWidth||Number.MAX_SAFE_INTEGER),d=Math.min(d,r.maxHeight||Number.MAX_SAFE_INTEGER);const g=this.getComputedSize(),m=h!==g.width||d!==g.height;return(f!==l.tx||p!==l.ty)&&this.translate(f,p),m&&this.resize(h,d),new Rectangle(-f/c,-p/u,h/c,d/u)}scaleContentToFit(t={}){this.scaleContentToFitImpl(t)}scaleContentToFitImpl(t={},e=!0){let n,r;if(t.contentArea){const e=t.contentArea;n=this.graph.localToGraph(e),r=Point.create(e)}else n=this.getContentBBox(t),r=this.graph.graphToLocal(n);if(!n.width||!n.height)return;const i=normalizeSides(t.padding),o=t.minScale||0,s=t.maxScale||Number.MAX_SAFE_INTEGER,a=t.minScaleX||o,l=t.maxScaleX||s,c=t.minScaleY||o,u=t.maxScaleY||s;let h;if(t.viewportArea)h=t.viewportArea;else{const t=this.getComputedSize(),e=this.getTranslation();h={x:e.tx,y:e.ty,width:t.width,height:t.height}}h=Rectangle.create(h).moveAndExpand({x:i.left,y:i.top,width:-i.left-i.right,height:-i.top-i.bottom});const d=this.getScale();let f=h.width/n.width*d.sx,p=h.height/n.height*d.sy;!1!==t.preserveAspectRatio&&(f=p=Math.min(f,p));const g=t.scaleGrid;if(g&&(f=g*Math.floor(f/g),p=g*Math.floor(p/g)),f=clamp$1(f,a,l),p=clamp$1(p,c,u),this.scale(f,p),e){const t=this.options;this.translate(h.x-r.x*f-t.x,h.y-r.y*p-t.y)}}getContentArea(t={}){return t.useCellGeometry?this.model.getAllCellsBBox()||new Rectangle:getBBox(this.graph.view.stage)}getContentBBox(t={}){return this.graph.localToGraph(this.getContentArea(t))}getGraphArea(){const t=Rectangle.fromSize(this.getComputedSize());return this.graph.graphToLocal(t)}zoomToRect(t,e={}){const n=Rectangle.create(t),r=this.graph;e.contentArea=n,null==e.viewportArea&&(e.viewportArea={x:r.options.x,y:r.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(e,!1);const i=n.getCenter();return this.centerPoint(i.x,i.y),this}zoomToFit(t={}){return this.zoomToRect(this.getContentArea(t),t)}centerPoint(t,e){const n=this.getComputedSize(),r=this.getScale(),i=this.getTranslation(),o=n.width/2,s=n.height/2;e=s-(e="number"==typeof e?e:s)*r.sy,i.tx===(t=o-(t="number"==typeof t?t:o)*r.sx)&&i.ty===e||this.translate(t,e)}centerContent(t){const e=this.graph.getContentArea(t).getCenter();this.centerPoint(e.x,e.y)}centerCell(t){return this.positionCell(t,"center")}positionPoint(t,e,n){const r=this.getComputedSize();(e=normalizePercentage(e,Math.max(0,r.width)))<0&&(e=r.width+e),(n=normalizePercentage(n,Math.max(0,r.height)))<0&&(n=r.height+n);const i=this.getTranslation(),o=this.getScale(),s=e-t.x*o.sx,a=n-t.y*o.sy;i.tx===s&&i.ty===a||this.translate(s,a)}positionRect(t,e){const n=Rectangle.create(t);switch(e){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}positionCell(t,e){const n=t.getBBox();return this.positionRect(n,e)}positionContent(t,e){const n=this.graph.getContentArea(e);return this.positionRect(n,t)}dispose(){this.widgets.forEach((t=>t.dispose())),this.widgets.clear(),this.stopListening()}}__decorate$b([TransformManager.dispose()],TransformManager.prototype,"dispose",null);var __decorate$a=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class SelectionManager extends Base{constructor(){super(...arguments),this.movedMap=new WeakMap,this.unselectMap=new WeakMap}get widgetOptions(){return this.options.selecting}get rubberbandDisabled(){return!0!==this.widgetOptions.enabled||!0!==this.widgetOptions.rubberband}get disabled(){return!0!==this.widgetOptions.enabled}get length(){return this.widget.length}get cells(){return this.widget.cells}init(){this.widget=this.graph.hook.createSelection(),this.startListening()}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.widget.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.widget.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e:t}){(this.allowRubberband(t,!0)||this.allowRubberband(t)&&!this.graph.scroller.allowPanning(t,!0)&&!this.graph.panning.allowPanning(t,!0))&&this.startRubberband(t)}onBlankClick(){this.clean()}allowRubberband(t,e){return!this.rubberbandDisabled&&ModifierKey.isMatch(t,this.widgetOptions.modifiers,e)&&this.graph.hook.allowRubberband(t)}allowMultipleSelection(t){return this.isMultiple()&&ModifierKey.isMatch(t,this.widgetOptions.multipleSelectionModifiers)}onCellMouseMove({cell:t}){this.movedMap.set(t,!0)}onCellMouseUp({e:t,cell:e}){const n=this.widgetOptions;let r=this.disabled;!r&&this.movedMap.has(e)&&(r=!1===n.selectCellOnMoved,r||(r=!1===n.selectNodeOnMoved&&e.isNode()),r||(r=!1===n.selectEdgeOnMoved&&e.isEdge())),r||(this.allowMultipleSelection(t)?this.unselectMap.has(e)?this.unselectMap.delete(e):this.isSelected(e)?this.unselect(e):this.select(e):this.reset(e)),this.movedMap.delete(e)}onBoxMouseDown({e:t,cell:e}){this.disabled||this.allowMultipleSelection(t)&&(this.unselect(e),this.unselectMap.set(e,!0))}isEmpty(){return this.length<=0}isSelected(t){return this.widget.isSelected(t)}getCells(t){return(Array.isArray(t)?t:[t]).map((t=>"string"==typeof t?this.graph.getCellById(t):t)).filter((t=>null!=t))}select(t,e={}){const n=this.getCells(t);return n.length&&(this.isMultiple()?this.widget.select(n,e):this.reset(n.slice(0,1),e)),this}unselect(t,e={}){return this.widget.unselect(this.getCells(t),e),this}reset(t,e={}){return this.widget.reset(t?this.getCells(t):[],e),this}clean(t={}){return this.widget.clean(t),this}enable(){return this.disabled&&(this.widgetOptions.enabled=!0),this}disable(){return this.disabled||(this.widgetOptions.enabled=!1),this}startRubberband(t){return this.rubberbandDisabled||this.widget.startSelecting(t),this}enableRubberband(){return this.rubberbandDisabled&&(this.widgetOptions.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.widgetOptions.rubberband=!1),this}isMultiple(){return!1!==this.widgetOptions.multiple}enableMultiple(){return this.widgetOptions.multiple=!0,this}disableMultiple(){return this.widgetOptions.multiple=!1,this}setModifiers(t){return this.widgetOptions.modifiers=t,this}setContent(t){return this.widget.setContent(t),this}setFilter(t){return this.widget.setFilter(t),this}dispose(){this.stopListening(),this.widget.dispose()}}__decorate$a([Base.dispose()],SelectionManager.prototype,"dispose",null);var __decorate$9=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest$1=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Util;class HistoryManager extends Basecoat{constructor(t){super(),this.batchCommands=null,this.batchLevel=0,this.lastBatchIndex=-1,this.freezed=!1,this.handlers=[],this.graph=t.graph,this.model=t.graph.model,this.options=Util.getOptions(t),this.validator=new HistoryManager.Validator({history:this,cancelInvalid:this.options.cancelInvalid}),this.clean(),this.startListening()}get disabled(){return!0!==this.options.enabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}undo(t={}){if(!this.disabled){const e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack.push(e),this.notify("undo",e,t))}return this}redo(t={}){if(!this.disabled){const e=this.redoStack.pop();e&&(this.applyCommand(e,t),this.undoStack.push(e),this.notify("redo",e,t))}return this}cancel(t={}){if(!this.disabled){const e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack=[],this.notify("cancel",e,t))}return this}clean(t={}){return this.undoStack=[],this.redoStack=[],this.notify("clean",null,t),this}canUndo(){return!this.disabled&&this.undoStack.length>0}canRedo(){return!this.disabled&&this.redoStack.length>0}validate(t,...e){return this.validator.validate(t,...e),this}dispose(){this.validator.dispose(),this.clean(),this.stopListening()}startListening(){this.model.on("batch:start",this.initBatchCommand,this),this.model.on("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&this.options.eventNames.forEach(((t,e)=>{this.handlers[e]=this.addCommand.bind(this,t),this.model.on(t,this.handlers[e])})),this.validator.on("invalid",(t=>this.trigger("invalid",t)))}stopListening(){this.model.off("batch:start",this.initBatchCommand,this),this.model.off("batch:stop",this.storeBatchCommand,this),this.options.eventNames&&(this.options.eventNames.forEach(((t,e)=>{this.model.off(t,this.handlers[e])})),this.handlers.length=0),this.validator.off("invalid")}createCommand(t){return{batch:!!t&&t.batch,data:{}}}revertCommand(t,e){this.freezed=!0;const n=Array.isArray(t)?Util.sortBatchCommands(t):[t];for(let t=n.length-1;t>=0;t-=1){const r=n[t],i=Object.assign(Object.assign({},e),pick(r.options,this.options.revertOptionsList||[]));this.executeCommand(r,!0,i)}this.freezed=!1}applyCommand(t,e){this.freezed=!0;const n=Array.isArray(t)?Util.sortBatchCommands(t):[t];for(let t=0;t<n.length;t+=1){const r=n[t],i=Object.assign(Object.assign({},e),pick(r.options,this.options.applyOptionsList||[]));this.executeCommand(r,!1,i)}this.freezed=!1}executeCommand(t,e,n){const r=this.model,i=r.getCell(t.data.id),o=t.event;if(Util.isAddEvent(o)&&e||Util.isRemoveEvent(o)&&!e)i.remove(n);else if(Util.isAddEvent(o)&&!e||Util.isRemoveEvent(o)&&e){const e=t.data;e.node?r.addNode(e.props,n):e.edge&&r.addEdge(e.props,n)}else if(Util.isChangeEvent(o)){const r=t.data,o=r.key;o&&i.prop(o,e?r.prev[o]:r.next[o],n)}else{const r=this.options.executeCommand;r&&call(r,this,t,e,n)}}addCommand(t,e){if(this.freezed||this.disabled)return;const n=e,r=n.options||{};if(r.dryrun)return;if(Util.isAddEvent(t)&&this.options.ignoreAdd||Util.isRemoveEvent(t)&&this.options.ignoreRemove||Util.isChangeEvent(t)&&this.options.ignoreChange)return;const i=this.options.beforeAddCommand;if(null!=i&&!1===call(i,this,t,e))return;"cell:change:*"===t&&(t=`cell:change:${n.key}`);const o=n.cell,s=Model.isModel(o);let a;if(this.batchCommands){a=this.batchCommands[Math.max(this.lastBatchIndex,0)];const e=s&&!a.modelChange||a.data.id!==o.id,n=a.event!==t;if(this.lastBatchIndex>=0&&(e||n)){const e=this.batchCommands.findIndex((e=>(s&&e.modelChange||e.data.id===o.id)&&e.event===t));e<0||Util.isAddEvent(t)||Util.isRemoveEvent(t)?a=this.createCommand({batch:!0}):(a=this.batchCommands[e],this.batchCommands.splice(e,1)),this.batchCommands.push(a),this.lastBatchIndex=this.batchCommands.length-1}}else a=this.createCommand({batch:!1});if(Util.isAddEvent(t)||Util.isRemoveEvent(t)){const e=a.data;return a.event=t,a.options=r,e.id=o.id,e.props=cloneDeep(o.toJSON()),o.isEdge()?e.edge=!0:o.isNode()&&(e.node=!0),this.push(a,r)}if(Util.isChangeEvent(t)){const n=e.key,i=a.data;return a.batch&&a.event||(a.event=t,a.options=r,i.key=n,null==i.prev&&(i.prev={}),i.prev[n]=clone(o.previous(n)),s?a.modelChange=!0:i.id=o.id),null==i.next&&(i.next={}),i.next[n]=clone(o.prop(n)),this.push(a,r)}const l=this.options.afterAddCommand;l&&call(l,this,t,e,a),this.push(a,r)}initBatchCommand(t){this.freezed||(this.batchCommands?this.batchLevel+=1:(this.batchCommands=[this.createCommand({batch:!0})],this.batchLevel=0,this.lastBatchIndex=-1))}storeBatchCommand(t){if(!this.freezed)if(this.batchCommands&&this.batchLevel<=0){const e=this.filterBatchCommand(this.batchCommands);e.length>0&&(this.redoStack=[],this.undoStack.push(e),this.notify("add",e,t)),this.batchCommands=null,this.lastBatchIndex=-1,this.batchLevel=0}else this.batchCommands&&this.batchLevel>0&&(this.batchLevel-=1)}filterBatchCommand(t){let e=t.slice();const n=[];for(;e.length>0;){const t=e.shift(),r=t.event,i=t.data.id;if(null!=r&&(null!=i||t.modelChange)){if(Util.isAddEvent(r)){const t=e.findIndex((t=>Util.isRemoveEvent(t.event)&&t.data.id===i));if(t>=0){e=e.filter(((e,n)=>t<n||e.data.id!==i));continue}}else if(Util.isRemoveEvent(r)){const t=e.findIndex((t=>Util.isAddEvent(t.event)&&t.data.id===i));if(t>=0){e.splice(t,1);continue}}else if(Util.isChangeEvent(r)){const e=t.data;if(isEqual(e.prev,e.next))continue}n.push(t)}}return n}notify(t,e,n){const r=null==e?null:Array.isArray(e)?e:[e];this.emit(t,{cmds:r,options:n}),this.emit("change",{cmds:r,options:n})}push(t,e){this.redoStack=[],t.batch?(this.lastBatchIndex=Math.max(this.lastBatchIndex,0),this.emit("batch",{cmd:t,options:e})):(this.undoStack.push(t),this.notify("add",t,e))}}__decorate$9([Basecoat.dispose()],HistoryManager.prototype,"dispose",null),function(t){class e extends Basecoat{constructor(t){super(),this.map={},this.command=t.history,this.cancelInvalid=!1!==t.cancelInvalid,this.command.on("add",this.onCommandAdded,this)}onCommandAdded({cmds:t}){return Array.isArray(t)?t.every((t=>this.isValidCommand(t))):this.isValidCommand(t)}isValidCommand(t){if(t.options&&!1===t.options.validation)return!0;let e=null;return(t.event&&this.map[t.event]||[]).forEach((n=>{let r=0;const i=o=>{const s=n[r];r+=1;try{if(!s)return void(e=o);s(o,t,i)}catch(o){i(o)}};i(e)})),!e||(this.cancelInvalid&&this.command.cancel(),this.emit("invalid",{err:e}),!1)}validate(t,...e){const n=Array.isArray(t)?t:t.split(/\s+/);return e.forEach((t=>{if("function"!=typeof t)throw new Error(`${n.join(" ")} requires callback functions.`)})),n.forEach((t=>{null==this.map[t]&&(this.map[t]=[]),this.map[t].push(e)})),this}dispose(){this.command.off("add",this.onCommandAdded,this)}}__decorate$9([Basecoat.dispose()],e.prototype,"dispose",null),t.Validator=e}(HistoryManager||(HistoryManager={})),function(t){t.isAddEvent=function(t){return"cell:added"===t},t.isRemoveEvent=function(t){return"cell:removed"===t},t.isChangeEvent=function(t){return null!=t&&t.startsWith("cell:change:")},t.getOptions=function(e){const n=__rest$1(e,["graph"]),r=["cell:added","cell:removed","cell:change:*"],i=["batch:start","batch:stop"],o=e.eventNames?e.eventNames.filter((e=>!(t.isChangeEvent(e)||r.includes(e)||i.includes(e)))):r;return Object.assign(Object.assign({},n),{eventNames:o,applyOptionsList:e.applyOptionsList||["propertyPath"],revertOptionsList:e.revertOptionsList||["propertyPath"]})},t.sortBatchCommands=function(e){const n=[];for(let r=0,i=e.length;r<i;r+=1){const i=e[r];let o=null;if(t.isAddEvent(i.event)){const t=i.data.id;for(let n=0;n<r;n+=1)if(e[n].data.id===t){o=n;break}}null!==o?n.splice(o,0,i):n.push(i)}return n}}(Util||(Util={}));var __decorate$8=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class MiniMapManager extends Base{get widgetOptions(){return this.options.minimap}init(){this.widget=this.graph.hook.createMiniMap()}dispose(){this.widget&&this.widget.dispose()}}__decorate$8([Base.dispose()],MiniMapManager.prototype,"dispose",null);var mousetrap=createCommonjsModule((function(t){!function(e,n){if(e){for(var r,i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},o={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},a={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l=1;l<20;++l)i[111+l]="f"+l;for(l=0;l<=9;++l)i[l+96]=l.toString();g.prototype.bind=function(t,e,n){var r=this;return r._bindMultiple.call(r,t=t instanceof Array?t:[t],e,n),r},g.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},g.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},g.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},g.prototype.stopCallback=function(t,e){if((" "+e.className+" ").indexOf(" mousetrap ")>-1)return!1;if(p(e,this.target))return!1;if("composedPath"in t&&"function"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},g.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},g.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);r=null},g.init=function(){var t=g(n);for(var e in t)"_"!==e.charAt(0)&&(g[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},g.init(),e.Mousetrap=g,t.exports&&(t.exports=g)}function c(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function u(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return i[t.which]?i[t.which]:o[t.which]?o[t.which]:String.fromCharCode(t.which).toLowerCase()}function h(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function d(t,e,n){return n||(n=function(){if(!r)for(var t in r={},i)t>95&&t<112||i.hasOwnProperty(t)&&(r[i[t]]=t);return r}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function f(t,e){var n,r,i,o=[];for(n=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),i=0;i<n.length;++i)a[r=n[i]]&&(r=a[r]),e&&"keypress"!=e&&s[r]&&(r=s[r],o.push("shift")),h(r)&&o.push(r);return{key:r,modifiers:o,action:e=d(r,o,e)}}function p(t,e){return null!==t&&t!==n&&(t===e||p(t.parentNode,e))}function g(t){var e=this;if(t=t||n,!(e instanceof g))return new g(t);e.target=t,e._callbacks={},e._directMap={};var r,i={},o=!1,s=!1,a=!1;function l(t){t=t||{};var e,n=!1;for(e in i)t[e]?n=!0:i[e]=0;n||(a=!1)}function d(t,n,r,o,s,a){var l,c,u,d=[],f=r.type;if(!e._callbacks[t])return[];for("keyup"==f&&h(t)&&(n=[t]),l=0;l<e._callbacks[t].length;++l)c=e._callbacks[t][l],(o||!c.seq||i[c.seq]==c.level)&&f==c.action&&(("keypress"!=f||r.metaKey||r.ctrlKey)&&(u=c.modifiers,n.sort().join(",")!==u.sort().join(","))||((!o&&c.combo==s||o&&c.seq==o&&c.level==a)&&e._callbacks[t].splice(l,1),d.push(c)));return d}function p(t,n,r,i){e.stopCallback(n,n.target||n.srcElement,r,i)||!1===t(n,r)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function m(t){"number"!=typeof t.which&&(t.which=t.keyCode);var n=u(t);n&&("keyup"!=t.type||o!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):o=!1)}function A(t,n,s,c,h){e._directMap[t+":"+s]=n;var g,m=(t=t.replace(/\s+/g," ")).split(" ");m.length>1?function(t,e,n,s){function c(e){return function(){a=e,++i[t],clearTimeout(r),r=setTimeout(l,1e3)}}function h(e){p(n,e,t),"keyup"!==s&&(o=u(e)),setTimeout(l,10)}i[t]=0;for(var d=0;d<e.length;++d){var g=d+1===e.length?h:c(s||f(e[d+1]).action);A(e[d],g,s,t,d)}}(t,m,n,s):(g=f(t,s),e._callbacks[g.key]=e._callbacks[g.key]||[],d(g.key,g.modifiers,{type:g.action},c,t,h),e._callbacks[g.key][c?"unshift":"push"]({callback:n,modifiers:g.modifiers,action:g.action,seq:c,level:h,combo:t}))}e._handleKey=function(t,e,n){var r,i=d(t,e,n),o={},c=0,u=!1;for(r=0;r<i.length;++r)i[r].seq&&(c=Math.max(c,i[r].level));for(r=0;r<i.length;++r)if(i[r].seq){if(i[r].level!=c)continue;u=!0,o[i[r].seq]=1,p(i[r].callback,n,i[r].combo,i[r].seq)}else u||p(i[r].callback,n,i[r].combo);var f="keypress"==n.type&&s;n.type!=a||h(t)||f||l(o),s=u&&"keydown"==n.type},e._bindMultiple=function(t,e,n){for(var r=0;r<t.length;++r)A(t[r],e,n)},c(t,"keypress",m),c(t,"keydown",m),c(t,"keyup",m)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)})),__decorate$7=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class Keyboard extends Disposable{constructor(t){super(),this.options=t;const e=this.graph.scroller.widget;this.container=e?e.container:this.graph.container,t.global?this.target=document:(this.target=this.container,this.disabled||this.target.setAttribute("tabindex","-1"),this.graph.on("cell:mouseup",this.focus,this),this.graph.on("blank:mouseup",this.focus,this)),this.mousetrap=Keyboard.createMousetrap(this)}get graph(){return this.options.graph}get disabled(){return!0!==this.options.enabled}enable(){this.disabled&&(this.options.enabled=!0,this.graph.options.keyboard.enabled=!0,this.target instanceof HTMLElement&&this.target.setAttribute("tabindex","-1"))}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.keyboard.enabled=!1,this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))}on(t,e,n){this.mousetrap.bind(this.getKeys(t),e,n)}off(t,e){this.mousetrap.unbind(this.getKeys(t),e)}focus(t){this.isInputEvent(t.e)||this.target.focus({preventScroll:!0})}getKeys(t){return(Array.isArray(t)?t:[t]).map((t=>this.formatkey(t)))}formatkey(t){const e=t.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command"),n=this.options.format;return n?call(n,this.graph,e):e}isGraphEvent(t){const e=t.srcElement||t.target;return!!e&&(e===this.target||t.currentTarget===this.target||e===document.body||contains(this.container,e))}isInputEvent(t){const e=t.target,n=e&&e.tagName.toLowerCase();return["input","textarea"].includes(n)}isEnabledForEvent(t){const e=!this.disabled&&this.isGraphEvent(t),n=this.isInputEvent(t);if(e){const e=t.keyCode||t.which;if(n&&(8===e||46===e))return!1;if(this.options.guard)return call(this.options.guard,this.graph,t)}return e}dispose(){this.mousetrap.reset()}}__decorate$7([Disposable.dispose()],Keyboard.prototype,"dispose",null),(Keyboard||(Keyboard={})).createMousetrap=function(t){const e=new mousetrap(t.target),n=e.stopCallback;return e.stopCallback=(r,i,o)=>!t.isEnabledForEvent(r)||!!n&&n.call(e,r,i,o),e};var __decorate$6=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class MouseWheel extends Disposable{constructor(t){super(),this.options=t,this.cumulatedFactor=1;const e=this.graph.scroller.widget;this.container=e?e.container:this.graph.container,this.target=this.options.global?document:this.container,this.mousewheelHandle=new MouseWheelHandle(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.options.enabled&&this.enable(!0)}get graph(){return this.options.graph}get disabled(){return!0!==this.options.enabled}enable(t){(this.disabled||t)&&(this.options.enabled=!0,this.graph.options.mousewheel.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.options.enabled=!1,this.graph.options.mousewheel.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(t){const e=t.originalEvent||t,n=this.options.guard;return(null==n||n.call(this.graph,e))&&ModifierKey.isMatch(e,this.options.modifiers)}onMouseWheel(t){const e=t.originalEvent||t,n=this.options.guard;if((null==n||n.call(this.graph,e))&&ModifierKey.isMatch(e,this.options.modifiers)){const e=this.options.factor||1.2;null==this.currentScale&&(this.startPos={x:t.clientX,y:t.clientY},this.currentScale=this.graph.scroller.widget?this.graph.scroller.widget.zoom():this.graph.transform.getScale().sx),this.cumulatedFactor=t.deltaY<0?this.currentScale<.15?(this.currentScale+.01)/this.currentScale:Math.round(this.currentScale*e*20)/20/this.currentScale:this.currentScale<=.15?(this.currentScale-.01)/this.currentScale:Math.round(this.currentScale*(1/e)*20)/20/this.currentScale,this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const n=this.graph.scroller.widget,r=this.currentScale;let i=this.graph.transform.clampScale(r*this.cumulatedFactor);if(i=clamp$1(i,this.options.minScale||Number.MIN_SAFE_INTEGER,this.options.maxScale||Number.MAX_SAFE_INTEGER),i!==r)if(n)if(this.options.zoomAtMousePosition){const t=this.graph.coord.clientToLocalPoint(this.startPos);n.zoom(i,{absolute:!0,center:t.clone()})}else n.zoom(i,{absolute:!0});else if(this.options.zoomAtMousePosition){const t=this.graph.coord.clientToGraphPoint(this.startPos);this.graph.transform.zoom(i,{absolute:!0,center:t.clone(),ui:!0})}else this.graph.transform.zoom(i,{absolute:!0,ui:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}__decorate$6([Disposable.dispose()],MouseWheel.prototype,"dispose",null);var __decorate$5=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class PrintManager extends Base{show(t={}){const e=Object.assign(Object.assign({},PrintManager.defaultOptions),t),n=this.createPrintPages(e);e.ready(n,(t=>this.showPrintWindow(t,e)),{sheetSize:this.getSheetSize(e)})}get className(){return this.view.prefixClassName("graph-print")}showPrintWindow(t,e){if(t){const n=jquery(document.body),r=jquery(this.view.container),i=this.view.prefixClassName("graph-printing");n.addClass(i);const o=r.children().detach();t.forEach((t=>{t.removeClass(`${this.className}-preview`).addClass(`${this.className}-ready`).appendTo(n)}));let s=!1;const a=()=>{s||(s=!0,n.removeClass(i),t.forEach((t=>t.remove())),r.append(o),jquery(`#${this.styleSheetId}`).remove(),this.graph.trigger("after:print",e),jquery(window).off("afterprint",a))};jquery(window).one("afterprint",a),setTimeout(a,200),window.print()}}createPrintPage(t,e){this.graph.trigger("before:print",e);const n=jquery("<div/>").addClass(this.className),r=jquery("<div/>").addClass(this.view.prefixClassName("graph-print-inner")).css("position","relative");e.size&&n.addClass(`${this.className}-size-${e.size}`);const i=Vector.create(this.view.svg).clone(),o=i.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`);r.append(i.node);const s=this.getSheetSize(e),a=this.graph.transform.getGraphArea(),l=this.graph.transform.getScale(),c=this.graph.translate(),u=createSVGMatrix().translate(c.tx/l.sx,c.ty/l.sy),h=this.getPageInfo(a,t,s),d=h.scale,f=h.bbox;return r.css({left:0,top:0}),i.attr({width:f.width*d,height:f.height*d,style:"position:relative",viewBox:[f.x,f.y,f.width,f.height].join(" ")}),o.attr("transform",matrixToTransformString(u)),n.append(r),n.addClass(`${this.className}-preview`),{$page:n,sheetSize:s}}createPrintPages(t){let e;const n=this.getPrintArea(t),r=[];if(t.page){const i=this.getPageSize(n,t.page);this.getPageAreas(n,i).forEach((n=>{e=this.createPrintPage(n,t),r.push(e.$page)}))}else e=this.createPrintPage(n,t),r.push(e.$page);return e&&this.updatePrintStyle({width:e.sheetSize.cssWidth,height:e.sheetSize.cssHeight},t),r}get styleSheetId(){return this.view.prefixClassName("graph-print-style")}updatePrintStyle(t,e){const n=Object.keys(t).reduce(((e,n)=>`${e} ${n}:${t[n]};`),""),r=normalizeSides(e.margin),i=e.marginUnit||"",o=e.sheetUnit||"",s=`\n      @media print {\n        .${this.className}.${this.className}-ready {\n          ${n}\n        }\n\n        @page {\n          margin:\n          ${[r.top+i,r.right+i,r.bottom+i,r.left+i].join(" ")};\n          size: ${e.sheet.width+o} ${e.sheet.height+o};\n\n        .${this.className}.${this.className}-preview {\n          ${n}\n        }\n      }`,a=this.styleSheetId,l=jquery(`#${a}`);l.length?l.html(s):jquery("head").append(`'<style type="text/css" id="${a}">${s}</style>'`)}getPrintArea(t){let e=t.area;if(!e){const n=normalizeSides(t.padding);e=this.graph.getContentArea().moveAndExpand({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom})}return e}getPageSize(t,e){if("object"==typeof e){const n=e,r={width:n.width,height:n.height};return null==r.width&&(r.width=Math.ceil(t.width/(n.columns||1))),null==r.height&&(r.height=Math.ceil(t.height/(n.rows||1))),r}return{width:t.width,height:t.height}}getPageAreas(t,e){const n=[],r=e.width,i=e.height;for(let e=0,o=0;e<t.height&&o<200;e+=i,o+=1)for(let o=0,s=0;o<t.width&&s<200;o+=r,s+=1)n.push(new Rectangle(t.x+o,t.y+e,r,i));return n}getSheetSize(t){const e=t.sheet,n=normalizeSides(t.margin),r=t.marginUnit||"",i=t.sheetUnit||"",o=`calc(${e.width}${i} - ${n.left+n.right}${r})`,s=`calc(${e.height}${i} - ${n.top+n.bottom}${r})`,a=Unit.measure(o,s);return{cssWidth:o,cssHeight:s,width:a.width,height:a.height}}getPageInfo(t,e,n){const r=new Rectangle(e.x-t.x,e.y-t.y,e.width,e.height),i=r.width/r.height,o=n.width/n.height;return{bbox:r,scale:o<i?n.width/r.width:n.height/r.height,fitHorizontal:o<i}}dispose(){}}__decorate$5([Base.dispose()],PrintManager.prototype,"dispose",null),(PrintManager||(PrintManager={})).defaultOptions={page:!1,sheet:{width:210,height:297},sheetUnit:"mm",margin:.4,marginUnit:"in",padding:5,ready:(t,e)=>e(t)};class FormatManager extends Base{toSVG(t,e={}){this.graph.trigger("before:export",e);const n=this.view.svg,r=Vector.create(n).clone();let i=r.node;const o=r.findOne(`.${this.view.prefixClassName("graph-svg-stage")}`),s=e.viewBox||this.graph.graphToLocal(this.graph.getContentBBox()),a=e.preserveDimensions;if(a){const t="boolean"==typeof a?s:a;r.attr({width:t.width,height:t.height})}if(r.removeAttribute("style").attr("viewBox",[s.x,s.y,s.width,s.height].join(" ")),o.removeAttribute("transform"),!1!==e.copyStyles){const t=n.ownerDocument,e=Array.from(n.querySelectorAll("*")),r=Array.from(i.querySelectorAll("*")),o=t.styleSheets.length,s=[];for(let e=o-1;e>=0;e-=1)s[e]=t.styleSheets[e],t.styleSheets[e].disabled=!0;const a={};e.forEach(((t,e)=>{const n=window.getComputedStyle(t,null),r={};Object.keys(n).forEach((t=>{r[t]=n.getPropertyValue(t)})),a[e]=r})),o!==t.styleSheets.length&&s.forEach(((e,n)=>{t.styleSheets[n]=e}));for(let e=0;e<o;e+=1)t.styleSheets[e].disabled=!1;const l={};e.forEach(((t,e)=>{const n=window.getComputedStyle(t,null),r=a[e],i={};Object.keys(n).forEach((t=>{isNumeric(t)||n.getPropertyValue(t)===r[t]||(i[t]=n.getPropertyValue(t))})),l[e]=i})),r.forEach(((t,e)=>{jquery(t).css(l[e])}))}const l=e.stylesheet;if("string"==typeof l){const t=n.ownerDocument.implementation.createDocument(null,"xml",null).createCDATASection(l);r.prepend(Vector.create("style",{type:"text/css"},[t]))}const c=()=>{const n=e.beforeSerialize;if("function"==typeof n){const t=call(n,this.graph,i);t instanceof SVGSVGElement&&(i=t)}const r=(new XMLSerializer).serializeToString(i).replace(/&nbsp;/g,"");this.graph.trigger("after:export",e),t(r)};if(e.serializeImages){const t=r.find("image").map((t=>new Promise((e=>{const n=t.attr("xlink:href")||t.attr("href");DataUri.imageToDataUri(n,((n,r)=>{!n&&r&&t.attr("xlink:href",r),e()}))}))));Promise.all(t).then(c)}else c()}toDataURL(t,e){let n=e.viewBox||this.graph.getContentBBox();const r=normalizeSides(e.padding);e.width&&e.height&&(r.left+r.right>=e.width&&(r.left=r.right=0),r.top+r.bottom>=e.height&&(r.top=r.bottom=0));const i=new Rectangle(-r.left,-r.top,r.left+r.right,r.top+r.bottom);e.width&&e.height&&i.scale((n.width+r.left+r.right)/e.width,(n.height+r.top+r.bottom)/e.height),n=Rectangle.create(n).moveAndExpand(i);const o="number"==typeof e.width&&"number"==typeof e.height?{width:e.width,height:e.height}:n;let s=e.ratio?parseFloat(e.ratio):1;Number.isFinite(s)&&0!==s||(s=1);const a={width:Math.max(Math.round(o.width*s),1),height:Math.max(Math.round(o.height*s),1)};{const t=document.createElement("canvas"),e=t.getContext("2d");t.width=a.width,t.height=a.height;const n=a.width-1,r=a.height-1;e.fillStyle="rgb(1,1,1)",e.fillRect(n,r,1,1);const i=e.getImageData(n,r,1,1).data;if(1!==i[0]||1!==i[1]||1!==i[2])throw new Error("size exceeded")}const l=new Image;l.onload=()=>{const n=document.createElement("canvas");n.width=a.width,n.height=a.height;const r=n.getContext("2d");r.fillStyle=e.backgroundColor||"white",r.fillRect(0,0,a.width,a.height);try{r.drawImage(l,0,0,a.width,a.height);const i=n.toDataURL(e.type,e.quality);t(i)}catch(t){}},this.toSVG((t=>{l.src=`data:image/svg+xml,${encodeURIComponent(t)}`}),Object.assign(Object.assign({},e),{viewBox:n,serializeImages:!0,preserveDimensions:Object.assign({},a)}))}toPNG(t,e={}){this.toDataURL(t,Object.assign(Object.assign({},e),{type:"image/png"}))}toJPEG(t,e={}){this.toDataURL(t,Object.assign(Object.assign({},e),{type:"image/jpeg"}))}}class KnobManager extends Base{constructor(){super(...arguments),this.widgets=new Map}get isSelectionEnabled(){return!0===this.options.selecting.enabled}init(){this.startListening()}startListening(){this.graph.on("node:mouseup",this.onNodeMouseUp,this),this.graph.on("node:selected",this.onNodeSelected,this),this.graph.on("node:unselected",this.onNodeUnSelected,this)}stopListening(){this.graph.off("node:mouseup",this.onNodeMouseUp,this),this.graph.off("node:selected",this.onNodeSelected,this),this.graph.off("node:unselected",this.onNodeUnSelected,this)}onNodeMouseUp({node:t}){if(!this.isSelectionEnabled){const e=this.graph.hook.createKnob(t,{clearAll:!0});e&&this.widgets.set(t,e)}}onNodeSelected({node:t}){if(this.isSelectionEnabled){const e=this.graph.hook.createKnob(t,{clearAll:!1});e&&this.widgets.set(t,e)}}onNodeUnSelected({node:t}){if(this.isSelectionEnabled){const e=this.widgets.get(t);e&&e.forEach((t=>t.dispose())),this.widgets.delete(t)}}}var __decorate$4=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class PanningManager extends Base{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&!0===this.widgetOptions.enabled}init(){this.startListening(),this.updateClassName()}startListening(){const t=this.widgetOptions.eventTypes;t&&(t.includes("leftMouseDown")&&(this.graph.on("blank:mousedown",this.preparePanning,this),this.graph.on("node:unhandled:mousedown",this.preparePanning,this),this.graph.on("edge:unhandled:mousedown",this.preparePanning,this)),t.includes("rightMouseDown")&&(this.onRightMouseDown=this.onRightMouseDown.bind(this),this.view.$(this.graph.container).on("mousedown",this.onRightMouseDown)),t.includes("mouseWheel")&&(this.mousewheelHandle=new MouseWheelHandle(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()))}stopListening(){const t=this.widgetOptions.eventTypes;t&&(t.includes("leftMouseDown")&&(this.graph.off("blank:mousedown",this.preparePanning,this),this.graph.off("node:unhandled:mousedown",this.preparePanning,this),this.graph.off("edge:unhandled:mousedown",this.preparePanning,this)),t.includes("rightMouseDown")&&this.view.$(this.graph.container).off("mousedown",this.onRightMouseDown),t.includes("mouseWheel")&&this.mousewheelHandle&&this.mousewheelHandle.disable())}preparePanning({e:t}){(this.allowPanning(t,!0)||this.allowPanning(t)&&!this.graph.selection.allowRubberband(t,!0))&&this.startPanning(t)}allowPanning(t,e){return this.pannable&&ModifierKey.isMatch(t,this.widgetOptions.modifiers,e)&&this.graph.hook.allowPanning(t)}startPanning(t){const e=this.view.normalizeEvent(t);this.clientX=e.clientX,this.clientY=e.clientY,this.panning=!0,this.updateClassName(),this.view.$(document.body).on({"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),this.view.$(window).on("mouseup.panning",this.stopPanning.bind(this))}pan(t){const e=this.view.normalizeEvent(t),n=e.clientX-this.clientX,r=e.clientY-this.clientY;this.clientX=e.clientX,this.clientY=e.clientY;const i=this.graph.transform.getTranslation();this.graph.transform.translate(i.tx+n,i.ty+r,{ui:!0})}stopPanning(t){this.panning=!1,this.updateClassName(),this.view.$(document.body).off(".panning"),this.view.$(window).off(".panning")}updateClassName(){const t=this.view.container,e=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(addClass(t,e),removeClass(t,n)):(removeClass(t,e),addClass(t,n)):(removeClass(t,e),removeClass(t,n))}onRightMouseDown(t){2===t.button&&this.allowPanning(t,!0)&&this.startPanning(t)}allowMouseWheel(t){return this.pannable&&!t.ctrlKey}onMouseWheel(t,e,n){t.ctrlKey||this.graph.translateBy(-e,-n)}autoPanning(t,e){const n=10,r=this.graph.getGraphArea();let i=0,o=0;t<=r.left+n&&(i=-10),e<=r.top+n&&(o=-10),t>=r.right-n&&(i=n),e>=r.bottom-n&&(o=n),0===i&&0===o||this.graph.translateBy(-i,-o)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}__decorate$4([Base.dispose()],PanningManager.prototype,"dispose",null);var __decorate$3=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s};class SizeManager extends Base{hasScroller(){return null!=this.graph.scroller.widget}getContainer(){return this.hasScroller()?this.graph.scroller.widget.container:this.graph.container}init(){const t=this.options.autoResize;if(t){const e="boolean"==typeof t?this.getContainer():t;SizeSensor.bind(e,(()=>{const t=this.getContainer();this.resize(t.offsetWidth,t.offsetHeight)}))}}resize(t,e){this.hasScroller()?this.resizeScroller(t,e):this.resizeGraph(t,e)}resizeGraph(t,e){this.graph.transform.resize(t,e)}resizeScroller(t,e){this.graph.scroller.resize(t,e)}resizePage(t,e){const n=this.graph.scroller.widget;n&&n.updatePageSize(t,e)}dispose(){SizeSensor.clear(this.getContainer())}}__decorate$3([Base.dispose()],SizeManager.prototype,"dispose",null);var __decorate$2=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__rest=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},Decorator;!function(t){t.hook=function(t,e){return(n,r,i)=>{const o=i.value,s=e||r;i.value=function(...e){const n=this.options[s];if(null!=n){this.getNativeValue=o.bind(this,...e);const r=call(n,this.graph,...e);if(this.getNativeValue=null,null!=r||!0===t&&null===r)return r}return o.call(this,...e)}}},t.after=function(t){return(e,n,r)=>{const i=r.value,o=t||n;r.value=function(...t){let e=i.call(this,...t);const n=this.options[o];return null!=n&&(e=call(n,this.graph,...t)&&e),e}}}}(Decorator||(Decorator={}));class Hook extends Base{createModel(){if(this.options.model)return this.options.model;const t=new Model;return t.graph=this.graph,t}createView(){return new GraphView(this.graph)}createRenderer(){return new Renderer(this.graph)}createDefsManager(){return new DefsManager(this.graph)}createGridManager(){return new GridManager(this.graph)}createCoordManager(){return new CoordManager(this.graph)}createKnobManager(){return new KnobManager(this.graph)}createTransform(t,e){const n=this.getTransformOptions(t);return n.resizable||n.rotatable?new Transform(Object.assign(Object.assign({node:t,graph:this.graph},n),e)):(n.clearAll&&Transform.removeInstances(this.graph),null)}createKnob(t,e){const n=Options.parseOptionGroup(this.graph,t,this.options.knob),r=Object.assign(Object.assign({},n),e);r.clearAll&&Knob.removeInstances(this.graph),r.clearAll=!1;const i=t.prop("knob"),o=[];return(Array.isArray(i)?i:[i]).forEach(((e,i)=>{e&&!1!==e.enabled&&("function"==typeof e.enabled&&!1===e.enabled.call(this.graph,t)||n.enabled&&o.push(new Knob(Object.assign({node:t,index:i,graph:this.graph},r))))})),o}getTransformOptions(t){const e=Options.parseOptionGroup(this.graph,t,this.options.resizing),n=Options.parseOptionGroup(this.graph,t,this.options.rotating),r=Options.parseOptionGroup(this.graph,t,this.options.transforming);return Object.assign(Object.assign({},r),{resizable:e.enabled,minWidth:e.minWidth,maxWidth:e.maxWidth,minHeight:e.minHeight,maxHeight:e.maxHeight,orthogonalResizing:e.orthogonal,restrictedResizing:null!=e.restrict?e.restrict:e.restricted,autoScrollOnResizing:e.autoScroll,preserveAspectRatio:e.preserveAspectRatio,allowReverse:e.allowReverse,rotatable:n.enabled,rotateGrid:n.grid})}createTransformManager(){return new TransformManager(this.graph)}createHighlightManager(){return new HighlightManager(this.graph)}createBackgroundManager(){return new BackgroundManager(this.graph)}createClipboard(){return new Clipboard}createClipboardManager(){return new ClipboardManager(this.graph)}createSnapline(){return new Snapline(Object.assign({graph:this.graph},this.options.snapline))}createSnaplineManager(){return new SnaplineManager(this.graph)}createSelection(){return new Selection(Object.assign({graph:this.graph},this.options.selecting))}createSelectionManager(){return new SelectionManager(this.graph)}allowRubberband(t){return!0}createHistoryManager(){return new HistoryManager(Object.assign({graph:this.graph},this.options.history))}createScroller(){return this.options.scroller.enabled?new Scroller(Object.assign({graph:this.graph},this.options.scroller)):null}createScrollerManager(){return new ScrollerManager(this.graph)}allowPanning(t){return!0}createMiniMap(){const t=this.options.minimap,{enabled:e}=t,n=__rest(t,["enabled"]);return e?new MiniMap(Object.assign({graph:this.graph},n)):null}createMiniMapManager(){return new MiniMapManager(this.graph)}createKeyboard(){return new Keyboard(Object.assign({graph:this.graph},this.options.keyboard))}createMouseWheel(){return new MouseWheel(Object.assign({graph:this.graph},this.options.mousewheel))}createPrintManager(){return new PrintManager(this.graph)}createFormatManager(){return new FormatManager(this.graph)}createPanningManager(){return new PanningManager(this.graph)}createSizeManager(){return new SizeManager(this.graph)}allowConnectToBlank(t){const e=this.options.connecting,n=null!=e.allowBlank?e.allowBlank:e.dangling;if("function"!=typeof n)return!!n;const r=this.graph.findViewByCell(t),i=t.getSourceCell(),o=t.getTargetCell(),s=this.graph.findViewByCell(i),a=this.graph.findViewByCell(o);return call(n,this.graph,{edge:t,edgeView:r,sourceCell:i,targetCell:o,sourceView:s,targetView:a,sourcePort:t.getSourcePortId(),targetPort:t.getTargetPortId(),sourceMagnet:r.sourceMagnet,targetMagnet:r.targetMagnet})}validateEdge(t,e,n){if(!this.allowConnectToBlank(t)){const e=t.getSourceCellId(),n=t.getTargetCellId();if(!e||!n)return!1}const r=this.options.connecting.validateEdge;return!r||call(r,this.graph,{edge:t,type:e,previous:n})}validateMagnet(t,e,n){if("passive"!==e.getAttribute("magnet")){const r=this.options.connecting.validateMagnet;return!r||call(r,this.graph,{e:n,magnet:e,view:t,cell:t.cell})}return!1}getDefaultEdge(t,e){let n;const r=this.options.connecting.createEdge;return r&&(n=call(r,this.graph,{sourceMagnet:e,sourceView:t,sourceCell:t.cell})),null==n&&(n=new Edge),n}validateConnection(t,e,n,r,i,o,s){const a=this.options.connecting,l=a.allowLoop,c=a.allowNode,u=a.allowEdge,h=a.allowPort,d=null!=a.allowMulti?a.allowMulti:a.multi,f=a.validateConnection,p=o?o.cell:null,g="target"===i?n:t,m="target"===i?r:e;let A=!0;const y=a=>{const l="source"===i?s?s.port:null:p?p.getSourcePortId():null,c="target"===i?s?s.port:null:p?p.getTargetPortId():null;return call(a,this.graph,{edge:p,edgeView:o,sourceView:t,targetView:n,sourcePort:l,targetPort:c,sourceMagnet:e,targetMagnet:r,sourceCell:t?t.cell:null,targetCell:n?n.cell:null,type:i})};if(null!=l&&("boolean"==typeof l?l||t!==n||(A=!1):A=y(l)),A&&null!=h&&("boolean"==typeof h?!h&&m&&(A=!1):A=y(h)),A&&null!=u&&("boolean"==typeof u?!u&&EdgeView.isEdgeView(g)&&(A=!1):A=y(u)),A&&null!=c&&null==m&&("boolean"==typeof c?!c&&NodeView.isNodeView(g)&&(A=!1):A=y(c)),A&&null!=d&&o){const t=o.cell,e="source"===i?s:t.getSource(),n="target"===i?s:t.getTarget(),r=s?this.graph.getCellById(s.cell):null;if(e&&n&&e.cell&&n.cell&&r)if("function"==typeof d)A=y(d);else{const t=this.model.getConnectedEdges(r,{outgoing:"source"===i,incoming:"target"===i});t.length&&("withPort"===d?t.some((t=>{const r=t.getSource(),i=t.getTarget();return r&&i&&r.cell===e.cell&&i.cell===n.cell&&null!=r.port&&r.port===e.port&&null!=i.port&&i.port===n.port}))&&(A=!1):d||t.some((t=>{const r=t.getSource(),i=t.getTarget();return r&&i&&r.cell===e.cell&&i.cell===n.cell}))&&(A=!1))}}return A&&null!=f&&(A=y(f)),A}getRestrictArea(t){const e=this.options.translating.restrict,n="function"==typeof e?call(e,this.graph,t):e;return"number"==typeof n?this.graph.transform.getGraphArea().inflate(n):!0===n?this.graph.transform.getGraphArea():n||null}onViewUpdated(t,e,n){e&Renderer.FLAG_INSERT||n.mounting||this.graph.renderer.requestConnectedEdgesUpdate(t,n)}onViewPostponed(t,e,n){return this.graph.renderer.forcePostponedViewUpdate(t,e)}getCellView(t){return null}createCellView(t){const e={graph:this.graph},n=this.getCellView(t);if(n)return new n(t,e);const r=t.view;if(null!=r&&"string"==typeof r){const n=CellView.registry.get(r);return n?new n(t,e):CellView.registry.onNotFound(r)}return t.isNode()?new NodeView(t,e):t.isEdge()?new EdgeView(t,e):null}getHTMLComponent(t){let e=t.getHTML();return"string"==typeof e&&(e=HTML.componentRegistry.get(e)||e),isPlainObject(e)&&(e=e.render),"function"==typeof e?call(e,this.graph,t):e}shouldUpdateHTMLComponent(t){let e=t.getHTML();if("string"==typeof e&&(e=HTML.componentRegistry.get(e)||e),isPlainObject(e)){const n=e.shouldComponentUpdate;return"function"==typeof n?call(n,this.graph,t):!!n}return!1}onEdgeLabelRendered(t){}onPortRendered(t){}onToolItemCreated(t){}}__decorate$2([Decorator.hook()],Hook.prototype,"createModel",null),__decorate$2([Decorator.hook()],Hook.prototype,"createView",null),__decorate$2([Decorator.hook()],Hook.prototype,"createRenderer",null),__decorate$2([Decorator.hook()],Hook.prototype,"createDefsManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createGridManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createCoordManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createKnobManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createTransform",null),__decorate$2([Decorator.hook()],Hook.prototype,"createKnob",null),__decorate$2([Decorator.hook()],Hook.prototype,"createTransformManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createHighlightManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createBackgroundManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createClipboard",null),__decorate$2([Decorator.hook()],Hook.prototype,"createClipboardManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createSnapline",null),__decorate$2([Decorator.hook()],Hook.prototype,"createSnaplineManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createSelection",null),__decorate$2([Decorator.hook()],Hook.prototype,"createSelectionManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"allowRubberband",null),__decorate$2([Decorator.hook()],Hook.prototype,"createHistoryManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createScroller",null),__decorate$2([Decorator.hook()],Hook.prototype,"createScrollerManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"allowPanning",null),__decorate$2([Decorator.hook()],Hook.prototype,"createMiniMap",null),__decorate$2([Decorator.hook()],Hook.prototype,"createMiniMapManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createKeyboard",null),__decorate$2([Decorator.hook()],Hook.prototype,"createMouseWheel",null),__decorate$2([Decorator.hook()],Hook.prototype,"createPrintManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createFormatManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createPanningManager",null),__decorate$2([Decorator.hook()],Hook.prototype,"createSizeManager",null),__decorate$2([Decorator.after()],Hook.prototype,"onViewUpdated",null),__decorate$2([Decorator.after()],Hook.prototype,"onViewPostponed",null),__decorate$2([Decorator.hook()],Hook.prototype,"getCellView",null),__decorate$2([Decorator.hook(!0)],Hook.prototype,"createCellView",null),__decorate$2([Decorator.hook()],Hook.prototype,"getHTMLComponent",null),__decorate$2([Decorator.hook()],Hook.prototype,"shouldUpdateHTMLComponent",null),__decorate$2([Decorator.hook()],Hook.prototype,"onEdgeLabelRendered",null),__decorate$2([Decorator.hook()],Hook.prototype,"onPortRendered",null),__decorate$2([Decorator.hook()],Hook.prototype,"onToolItemCreated",null);var __decorate$1=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},Storage,Private$1;class Graph extends Basecoat{constructor(t){super(),this.options=Options.get(t),this.css=new CSSManager(this),this.hook=new Hook(this),this.view=this.hook.createView(),this.defs=this.hook.createDefsManager(),this.coord=this.hook.createCoordManager(),this.transform=this.hook.createTransformManager(),this.knob=this.hook.createKnobManager(),this.highlight=this.hook.createHighlightManager(),this.grid=this.hook.createGridManager(),this.background=this.hook.createBackgroundManager(),this.model=this.hook.createModel(),this.renderer=this.hook.createRenderer(),this.clipboard=this.hook.createClipboardManager(),this.snapline=this.hook.createSnaplineManager(),this.selection=this.hook.createSelectionManager(),this.history=this.hook.createHistoryManager(),this.scroller=this.hook.createScrollerManager(),this.minimap=this.hook.createMiniMapManager(),this.keyboard=this.hook.createKeyboard(),this.mousewheel=this.hook.createMouseWheel(),this.print=this.hook.createPrintManager(),this.format=this.hook.createFormatManager(),this.panning=this.hook.createPanningManager(),this.size=this.hook.createSizeManager()}get container(){return this.view.container}get[Symbol.toStringTag](){return Graph.toStringTag}isNode(t){return t.isNode()}isEdge(t){return t.isEdge()}resetCells(t,e={}){return this.model.resetCells(t,e),this}clearCells(t={}){return this.model.clear(t),this}toJSON(t={}){return this.model.toJSON(t)}parseJSON(t){return this.model.parseJSON(t)}fromJSON(t,e={}){return this.model.fromJSON(t,e),this}getCellById(t){return this.model.getCell(t)}addNode(t,e={}){return this.model.addNode(t,e)}addNodes(t,e={}){return this.addCell(t.map((t=>Node$1.isNode(t)?t:this.createNode(t))),e)}createNode(t){return this.model.createNode(t)}removeNode(t,e={}){return this.model.removeCell(t,e)}addEdge(t,e={}){return this.model.addEdge(t,e)}addEdges(t,e={}){return this.addCell(t.map((t=>Edge$1.isEdge(t)?t:this.createEdge(t))),e)}removeEdge(t,e={}){return this.model.removeCell(t,e)}createEdge(t){return this.model.createEdge(t)}addCell(t,e={}){return this.model.addCell(t,e),this}removeCell(t,e={}){return this.model.removeCell(t,e)}removeCells(t,e={}){return this.model.removeCells(t,e)}removeConnectedEdges(t,e={}){return this.model.removeConnectedEdges(t,e)}disconnectConnectedEdges(t,e={}){return this.model.disconnectConnectedEdges(t,e),this}hasCell(t){return this.model.has(t)}getCell(t){return this.model.getCell(t)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(t){return this.model.getOutgoingEdges(t)}getIncomingEdges(t){return this.model.getIncomingEdges(t)}getConnectedEdges(t,e={}){return this.model.getConnectedEdges(t,e)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(t){return this.model.isRoot(t)}isLeafNode(t){return this.model.isLeaf(t)}getNeighbors(t,e={}){return this.model.getNeighbors(t,e)}isNeighbor(t,e,n={}){return this.model.isNeighbor(t,e,n)}getSuccessors(t,e={}){return this.model.getSuccessors(t,e)}isSuccessor(t,e,n={}){return this.model.isSuccessor(t,e,n)}getPredecessors(t,e={}){return this.model.getPredecessors(t,e)}isPredecessor(t,e,n={}){return this.model.isPredecessor(t,e,n)}getCommonAncestor(...t){return this.model.getCommonAncestor(...t)}getSubGraph(t,e={}){return this.model.getSubGraph(t,e)}cloneSubGraph(t,e={}){return this.model.cloneSubGraph(t,e)}cloneCells(t){return this.model.cloneCells(t)}getNodesFromPoint(t,e){return this.model.getNodesFromPoint(t,e)}getNodesInArea(t,e,n,r,i){return this.model.getNodesInArea(t,e,n,r,i)}getNodesUnderNode(t,e={}){return this.model.getNodesUnderNode(t,e)}searchCell(t,e,n={}){return this.model.search(t,e,n),this}getShortestPath(t,e,n={}){return this.model.getShortestPath(t,e,n)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(t,e={}){return this.model.getCellsBBox(t,e)}startBatch(t,e={}){this.model.startBatch(t,e)}stopBatch(t,e={}){this.model.stopBatch(t,e)}batchUpdate(t,e,n){const r="string"==typeof t?t:"update",i="string"==typeof t?e:t,o="function"==typeof e?n:e;this.startBatch(r,o);const s=i();return this.stopBatch(r,o),s}updateCellId(t,e){return this.model.updateCellId(t,e)}isFrozen(){return this.renderer.isFrozen()}freeze(t={}){return this.renderer.freeze(t),this}unfreeze(t={}){return this.renderer.unfreeze(t),this}isAsync(){return this.renderer.isAsync()}setAsync(t){return this.renderer.setAsync(t),this}findView(t){return Cell.isCell(t)?this.findViewByCell(t):this.findViewByElem(t)}findViews(t){return Rectangle.isRectangleLike(t)?this.findViewsInArea(t):Point.isPointLike(t)?this.findViewsFromPoint(t):[]}findViewByCell(t){return this.renderer.findViewByCell(t)}findViewByElem(t){return this.renderer.findViewByElem(t)}findViewsFromPoint(t,e){return this.renderer.findViewsFromPoint("number"==typeof t?{x:t,y:e}:t)}findViewsInArea(t,e,n,r,i){return this.renderer.findViewsInArea("number"==typeof t?{x:t,y:e,width:n,height:r}:t,"number"==typeof t?i:e)}isViewMounted(t){return this.renderer.isViewMounted(t)}getMountedViews(){return this.renderer.getMountedViews()}getUnmountedViews(){return this.renderer.getUnmountedViews()}matrix(t){return void 0===t?this.transform.getMatrix():(this.transform.setMatrix(t),this)}resize(t,e){return this.size.resize(t,e),this}resizeGraph(t,e){return this.size.resizeGraph(t,e),this}resizeScroller(t,e){return this.size.resizeScroller(t,e),this}resizePage(t,e){return this.size.resizePage(t,e),this}scale(t,e=t,n=0,r=0){return void 0===t?this.transform.getScale():(this.transform.scale(t,e,n,r),this)}zoom(t,e){const n=this.scroller.widget;if(n){if(void 0===t)return n.zoom();n.zoom(t,e)}else{if(void 0===t)return this.transform.getZoom();this.transform.zoom(t,e)}return this}zoomTo(t,e={}){const n=this.scroller.widget;return n?n.zoom(t,Object.assign(Object.assign({},e),{absolute:!0})):this.transform.zoom(t,Object.assign(Object.assign({},e),{absolute:!0})),this}zoomToRect(t,e={}){const n=this.scroller.widget;return n?n.zoomToRect(t,e):this.transform.zoomToRect(t,e),this}zoomToFit(t={}){const e=this.scroller.widget;return e?e.zoomToFit(t):this.transform.zoomToFit(t),this}rotate(t,e,n){return void 0===t?this.transform.getRotation():(this.transform.rotate(t,e,n),this)}translate(t,e){return void 0===t?this.transform.getTranslation():(this.transform.translate(t,e),this)}translateBy(t,e){const n=this.translate();return this.translate(n.tx+t,n.ty+e)}getArea(){return this.transform.getGraphArea()}getGraphArea(){return this.transform.getGraphArea()}getContentArea(t={}){return this.transform.getContentArea(t)}getContentBBox(t={}){return this.transform.getContentBBox(t)}fitToContent(t,e,n,r){return this.transform.fitToContent(t,e,n,r)}scaleContentToFit(t={}){return this.transform.scaleContentToFit(t),this}center(t){return this.centerPoint(t)}centerPoint(t,e,n){const r=this.scroller.widget;return r?r.centerPoint(t,e,n):this.transform.centerPoint(t,e),this}centerContent(t){const e=this.scroller.widget;return e?e.centerContent(t):this.transform.centerContent(t),this}centerCell(t,e){const n=this.scroller.widget;return n?n.centerCell(t,e):this.transform.centerCell(t),this}positionPoint(t,e,n,r={}){const i=this.scroller.widget;return i?i.positionPoint(t,e,n,r):this.transform.positionPoint(t,e,n),this}positionRect(t,e,n){const r=this.scroller.widget;return r?r.positionRect(t,e,n):this.transform.positionRect(t,e),this}positionCell(t,e,n){const r=this.scroller.widget;return r?r.positionCell(t,e,n):this.transform.positionCell(t,e),this}positionContent(t,e){const n=this.scroller.widget;return n?n.positionContent(t,e):this.transform.positionContent(t,e),this}getClientMatrix(){return this.coord.getClientMatrix()}getClientOffset(){return this.coord.getClientOffset()}getPageOffset(){return this.coord.getPageOffset()}snapToGrid(t,e){return this.coord.snapToGrid(t,e)}pageToLocal(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.pageToLocalRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.pageToLocalRect(t,e,n,r):this.coord.pageToLocalPoint(t,e)}localToPage(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.localToPageRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.localToPageRect(t,e,n,r):this.coord.localToPagePoint(t,e)}clientToLocal(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.clientToLocalRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.clientToLocalRect(t,e,n,r):this.coord.clientToLocalPoint(t,e)}localToClient(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.localToClientRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.localToClientRect(t,e,n,r):this.coord.localToClientPoint(t,e)}localToGraph(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.localToGraphRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.localToGraphRect(t,e,n,r):this.coord.localToGraphPoint(t,e)}graphToLocal(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.graphToLocalRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.graphToLocalRect(t,e,n,r):this.coord.graphToLocalPoint(t,e)}clientToGraph(t,e,n,r){return Rectangle.isRectangleLike(t)?this.coord.clientToGraphRect(t):"number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r?this.coord.clientToGraphRect(t,e,n,r):this.coord.clientToGraphPoint(t,e)}defineFilter(t){return this.defs.filter(t)}defineGradient(t){return this.defs.gradient(t)}defineMarker(t){return this.defs.marker(t)}getGridSize(){return this.grid.getGridSize()}setGridSize(t){return this.grid.setGridSize(t),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(t){return this.grid.draw(t),this}updateBackground(){return this.background.update(),this}drawBackground(t,e){const n=this.scroller.widget;return null==n||null!=this.options.background&&e?this.background.draw(t):n.backgroundManager.draw(t),this}clearBackground(t){const e=this.scroller.widget;return null==e||null!=this.options.background&&t?this.background.clear():e.backgroundManager.clear(),this}isClipboardEnabled(){return!this.clipboard.disabled}enableClipboard(){return this.clipboard.enable(),this}disableClipboard(){return this.clipboard.disable(),this}toggleClipboard(t){return null!=t?t!==this.isClipboardEnabled()&&(t?this.enableClipboard():this.disableClipboard()):this.isClipboardEnabled()?this.disableClipboard():this.enableClipboard(),this}isClipboardEmpty(){return this.clipboard.isEmpty()}getCellsInClipboard(){return this.clipboard.cells}cleanClipboard(){return this.clipboard.clean(),this}copy(t,e={}){return this.clipboard.copy(t,e),this}cut(t,e={}){return this.clipboard.cut(t,e),this}paste(t={},e=this){return this.clipboard.paste(t,e)}isHistoryEnabled(){return!this.history.disabled}enableHistory(){return this.history.enable(),this}disableHistory(){return this.history.disable(),this}toggleHistory(t){return null!=t?t!==this.isHistoryEnabled()&&(t?this.enableHistory():this.disableHistory()):this.isHistoryEnabled()?this.disableHistory():this.enableHistory(),this}undo(t={}){return this.history.undo(t),this}undoAndCancel(t={}){return this.history.cancel(t),this}redo(t={}){return this.history.redo(t),this}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}cleanHistory(t={}){this.history.clean(t)}isKeyboardEnabled(){return!this.keyboard.disabled}enableKeyboard(){return this.keyboard.enable(),this}disableKeyboard(){return this.keyboard.disable(),this}toggleKeyboard(t){return null!=t?t!==this.isKeyboardEnabled()&&(t?this.enableKeyboard():this.disableKeyboard()):this.isKeyboardEnabled()?this.disableKeyboard():this.enableKeyboard(),this}bindKey(t,e,n){return this.keyboard.on(t,e,n),this}unbindKey(t,e){return this.keyboard.off(t,e),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(t){return null==t?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():t?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){return this.scroller.widget?this.scroller.pannable:this.panning.pannable}enablePanning(){return this.scroller.widget?this.scroller.enablePanning():this.panning.enablePanning(),this}disablePanning(){return this.scroller.widget?this.scroller.disablePanning():this.panning.disablePanning(),this}togglePanning(t){return null==t?this.isPannable()?this.disablePanning():this.enablePanning():t!==this.isPannable()&&(t?this.enablePanning():this.disablePanning()),this}lockScroller(){var t;null===(t=this.scroller.widget)||void 0===t||t.lock()}unlockScroller(){var t;null===(t=this.scroller.widget)||void 0===t||t.unlock()}updateScroller(){var t;null===(t=this.scroller.widget)||void 0===t||t.update()}getScrollbarPosition(){return this.scroller.widget.scrollbarPosition()}setScrollbarPosition(t,e,n){return this.scroller.widget.scrollbarPosition(t,e,n),this}scrollToPoint(t,e,n){return this.scroller.widget.scrollToPoint(t,e,n),this}scrollToContent(t){return this.scroller.widget.scrollToContent(t),this}scrollToCell(t,e){return this.scroller.widget.scrollToCell(t,e),this}transitionToPoint(t,e,n){return this.scroller.widget.transitionToPoint(t,e,n),this}transitionToRect(t,e={}){return this.scroller.widget.transitionToRect(t,e),this}isSelectionEnabled(){return!this.selection.disabled}enableSelection(){return this.selection.enable(),this}disableSelection(){return this.selection.disable(),this}toggleSelection(t){return null!=t?t!==this.isSelectionEnabled()&&(t?this.enableSelection():this.disableSelection()):this.isSelectionEnabled()?this.disableSelection():this.enableSelection(),this}isMultipleSelection(){return this.selection.isMultiple()}enableMultipleSelection(){return this.selection.enableMultiple(),this}disableMultipleSelection(){return this.selection.disableMultiple(),this}toggleMultipleSelection(t){return null!=t?t!==this.isMultipleSelection()&&(t?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return!1!==this.selection.widget.options.movable}enableSelectionMovable(){return this.selection.widget.options.movable=!0,this}disableSelectionMovable(){return this.selection.widget.options.movable=!1,this}toggleSelectionMovable(t){return null!=t?t!==this.isSelectionMovable()&&(t?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.selection.rubberbandDisabled}enableRubberband(){return this.selection.enableRubberband(),this}disableRubberband(){return this.selection.disableRubberband(),this}toggleRubberband(t){return null!=t?t!==this.isRubberbandEnabled()&&(t?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return!0===this.selection.widget.options.strict}enableStrictRubberband(){return this.selection.widget.options.strict=!0,this}disableStrictRubberband(){return this.selection.widget.options.strict=!1,this}toggleStrictRubberband(t){return null!=t?t!==this.isStrictRubberband()&&(t?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(t){this.selection.setModifiers(t)}setSelectionFilter(t){return this.selection.setFilter(t),this}setSelectionDisplayContent(t){return this.selection.setContent(t),this}isSelectionEmpty(){return this.selection.isEmpty()}cleanSelection(t){return this.selection.clean(t),this}resetSelection(t,e){return this.selection.reset(t,e),this}getSelectedCells(){return this.selection.cells}getSelectedCellCount(){return this.selection.length}isSelected(t){return this.selection.isSelected(t)}select(t,e){return this.selection.select(t,e),this}unselect(t,e){return this.selection.unselect(t,e),this}isSnaplineEnabled(){return!this.snapline.widget.disabled}enableSnapline(){return this.snapline.widget.enable(),this}disableSnapline(){return this.snapline.widget.disable(),this}toggleSnapline(t){if(null==t)return this.isSnaplineEnabled()?this.disableSnapline():this.enableSnapline(),this;t!==this.isSnaplineEnabled()&&(t?this.enableSnapline():this.disableSnapline())}hideSnapline(){return this.snapline.widget.hide(),this}setSnaplineFilter(t){return this.snapline.widget.setFilter(t),this}isSnaplineOnResizingEnabled(){return!0===this.snapline.widget.options.resizing}enableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!0,this}disableSnaplineOnResizing(){return this.snapline.widget.options.resizing=!1,this}toggleSnaplineOnResizing(t){return null!=t?t!==this.isSnaplineOnResizingEnabled()&&(t?this.enableSnaplineOnResizing():this.disableSnaplineOnResizing()):this.isSnaplineOnResizingEnabled()?this.disableSnaplineOnResizing():this.enableSnaplineOnResizing(),this}isSharpSnapline(){return!0===this.snapline.widget.options.sharp}enableSharpSnapline(){return this.snapline.widget.options.sharp=!0,this}disableSharpSnapline(){return this.snapline.widget.options.sharp=!1,this}toggleSharpSnapline(t){return null!=t?t!==this.isSharpSnapline()&&(t?this.enableSharpSnapline():this.disableSharpSnapline()):this.isSharpSnapline()?this.disableSharpSnapline():this.enableSharpSnapline(),this}getSnaplineTolerance(){return this.snapline.widget.options.tolerance}setSnaplineTolerance(t){return this.snapline.widget.options.tolerance=t,this}removeTools(){return this.emit("tools:remove"),this}hideTools(){return this.emit("tools:hide"),this}showTools(){return this.emit("tools:show"),this}toSVG(t,e={}){this.format.toSVG(t,e)}toDataURL(t,e){this.format.toDataURL(t,e)}toPNG(t,e={}){this.format.toPNG(t,e)}toJPEG(t,e={}){this.format.toJPEG(t,e)}printPreview(t){this.print.show(t)}dispose(){this.clearCells(),this.off(),this.css.dispose(),this.hook.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.knob.dispose(),this.highlight.dispose(),this.background.dispose(),this.clipboard.dispose(),this.snapline.dispose(),this.selection.dispose(),this.history.dispose(),this.keyboard.dispose(),this.mousewheel.dispose(),this.print.dispose(),this.format.dispose(),this.minimap.dispose(),this.panning.dispose(),this.scroller.dispose(),this.view.dispose(),this.renderer.dispose(),this.size.dispose()}}__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"lockScroller",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"unlockScroller",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"updateScroller",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"getScrollbarPosition",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"setScrollbarPosition",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"scrollToPoint",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"scrollToContent",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"scrollToCell",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"transitionToPoint",null),__decorate$1([Decorator$1.checkScroller()],Graph.prototype,"transitionToRect",null),__decorate$1([Basecoat.dispose()],Graph.prototype,"dispose",null),function(t){t.View=GraphView,t.Hook=Hook,t.Renderer=Renderer,t.Keyboard=Keyboard,t.MouseWheel=MouseWheel,t.BaseManager=Base,t.DefsManager=DefsManager,t.GridManager=GridManager,t.CoordManager=CoordManager,t.PrintManager=PrintManager,t.FormatManager=FormatManager,t.MiniMapManager=MiniMapManager,t.HistoryManager=HistoryManager,t.SnaplineManager=SnaplineManager,t.ScrollerManager=ScrollerManager,t.ClipboardManager=ClipboardManager,t.TransformManager=TransformManager,t.HighlightManager=HighlightManager,t.BackgroundManager=BackgroundManager,t.SelectionManager=SelectionManager}(Graph||(Graph={})),function(t){t.toStringTag=`X6.${t.name}`,t.isGraph=function(e){if(null==e)return!1;if(e instanceof t)return!0;const n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&null!=e.hook&&null!=e.view&&null!=e.model}}(Graph||(Graph={})),function(t){t.render=function(e,n){const r=e instanceof HTMLElement?new t({container:e}):new t(e);return null!=n&&r.fromJSON(n),r}}(Graph||(Graph={})),function(t){t.registerNode=Node$1.registry.register,t.registerEdge=Edge$1.registry.register,t.registerView=CellView.registry.register,t.registerAttr=Attr.registry.register,t.registerGrid=Grid.registry.register,t.registerFilter=Filter.registry.register,t.registerNodeTool=NodeTool.registry.register,t.registerEdgeTool=EdgeTool.registry.register,t.registerBackground=Background.registry.register,t.registerHighlighter=Highlighter.registry.register,t.registerPortLayout=PortLayout.registry.register,t.registerPortLabelLayout=PortLabelLayout.registry.register,t.registerMarker=Marker.registry.register,t.registerRouter=Router.registry.register,t.registerConnector=Connector.registry.register,t.registerAnchor=NodeAnchor.registry.register,t.registerEdgeAnchor=EdgeAnchor.registry.register,t.registerConnectionPoint=ConnectionPoint.registry.register,t.registerConnectionStrategy=ConnectionStrategy.registry.register,t.registerHTMLComponent=HTML.componentRegistry.register}(Graph||(Graph={})),function(t){t.unregisterNode=Node$1.registry.unregister,t.unregisterEdge=Edge$1.registry.unregister,t.unregisterView=CellView.registry.unregister,t.unregisterAttr=Attr.registry.unregister,t.unregisterGrid=Grid.registry.unregister,t.unregisterFilter=Filter.registry.unregister,t.unregisterNodeTool=NodeTool.registry.unregister,t.unregisterEdgeTool=EdgeTool.registry.unregister,t.unregisterBackground=Background.registry.unregister,t.unregisterHighlighter=Highlighter.registry.unregister,t.unregisterPortLayout=PortLayout.registry.unregister,t.unregisterPortLabelLayout=PortLabelLayout.registry.unregister,t.unregisterMarker=Marker.registry.unregister,t.unregisterRouter=Router.registry.unregister,t.unregisterConnector=Connector.registry.unregister,t.unregisterAnchor=NodeAnchor.registry.unregister,t.unregisterEdgeAnchor=EdgeAnchor.registry.unregister,t.unregisterConnectionPoint=ConnectionPoint.registry.unregister,t.unregisterConnectionStrategy=ConnectionStrategy.registry.unregister,t.unregisterHTMLComponent=HTML.componentRegistry.unregister}(Graph||(Graph={}));class Clipboard{constructor(){this.cells=[]}copy(t,e,n={}){this.options=Object.assign({},n);const r=(Model.isModel(e)?e:e.model).cloneSubGraph(t,n);this.cells=sortBy(Object.keys(r).map((t=>r[t])),(t=>t.isEdge()?2:1)),this.serialize(n)}cut(t,e,n={}){this.copy(t,e,n),(Graph.isGraph(e)?e.model:e).batchUpdate("cut",(()=>{t.forEach((t=>t.remove()))}))}paste(t,e={}){const n=Object.assign(Object.assign({},this.options),e),{offset:r,edgeProps:i,nodeProps:o}=n;let s=20,a=20;r&&(s="number"==typeof r?r:r.dx,a="number"==typeof r?r:r.dy),this.deserialize(n);const l=this.cells;l.forEach((t=>{t.model=null,t.removeProp("zIndex"),(s||a)&&t.translate(s,a),o&&t.isNode()&&t.prop(o),i&&t.isEdge()&&t.prop(i)}));const c=Graph.isGraph(t)?t.model:t;return c.batchUpdate("paste",(()=>{c.addCells(this.cells)})),this.copy(l,t,e),l}serialize(t){!1!==t.useLocalStorage&&Storage.save(this.cells)}deserialize(t){if(t.useLocalStorage){const t=Storage.fetch();t&&(this.cells=t)}}isEmpty(){return this.cells.length<=0}clean(){this.options={},this.cells=[],Storage.clean()}}!function(t){const e=`${Config.prefixCls}.clipboard.cells`;t.save=function(t){if(window.localStorage){const n=t.map((t=>t.toJSON()));localStorage.setItem(e,JSON.stringify(n))}},t.fetch=function(){if(window.localStorage){const t=localStorage.getItem(e),n=t?JSON.parse(t):[];if(n)return Model.fromJSON(n)}},t.clean=function(){window.localStorage&&localStorage.removeItem(e)}}(Storage||(Storage={}));class NodePreset{constructor(t){this.halo=t}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get node(){return this.cell}getPresets(){return{className:"type-node",handles:[{name:"remove",position:"nw",events:{mousedown:this.removeCell.bind(this)},icon:null},{name:"resize",position:"se",events:{mousedown:this.startResize.bind(this),mousemove:this.doResize.bind(this),mouseup:this.stopResize.bind(this)},icon:null},{name:"clone",position:"n",events:{mousedown:this.startClone.bind(this),mousemove:this.doClone.bind(this),mouseup:this.stopClone.bind(this)},icon:null},{name:"link",position:"e",events:{mousedown:this.startLink.bind(this),mousemove:this.doLink.bind(this),mouseup:this.stopLink.bind(this)},icon:null},{name:"fork",position:"ne",events:{mousedown:this.startFork.bind(this),mousemove:this.doFork.bind(this),mouseup:this.stopFork.bind(this)},icon:null},{name:"unlink",position:"w",events:{mousedown:this.unlink.bind(this)},icon:null},{name:"rotate",position:"sw",events:{mousedown:this.startRotate.bind(this),mousemove:this.doRotate.bind(this),mouseup:this.stopRotate.bind(this)},icon:null}],bbox(t){return this.options.useCellGeometry?t.cell.getBBox():t.getBBox()},content(t){const e=template("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),n=t.cell,r=n.getBBox();return e({x:Math.floor(r.x),y:Math.floor(r.y),width:Math.floor(r.width),height:Math.floor(r.height),angle:Math.floor(n.getAngle())})},magnet:t=>t.container,tinyThreshold:40,smallThreshold:80,loopEdgePreferredSide:"top",loopEdgeWidth:40,rotateGrid:15,rotateEmbeds:!1}}removeCell(){this.model.removeConnectedEdges(this.cell),this.cell.remove()}startLink({x:t,y:e}){this.halo.startBatch();const n=this.graph,r=this.createEdgeConnectedToSource();r.setTarget({x:t,y:e}),this.model.addEdge(r,{validation:!1,halo:this.halo.cid,async:!1}),n.view.undelegateEvents(),this.edgeView=n.renderer.findViewByCell(r),this.edgeView.prepareArrowheadDragging("target",{x:t,y:e,fallbackAction:"remove"})}createEdgeConnectedToSource(){const t=this.getMagnet(this.view,"source"),e=this.getEdgeTerminal(this.view,t),n=this.graph.hook.getDefaultEdge(this.view,t);return n.setSource(e),n}getMagnet(t,e){const n=this.options.magnet;if("function"==typeof n){const r=call(n,this.halo,t,e);if(r instanceof SVGElement)return r}throw new Error("`magnet()` has to return an SVGElement")}getEdgeTerminal(t,e){const n={cell:t.cell.id};if(e!==t.container){const r=e.getAttribute("port");r?n.port=r:n.selector=t.getSelector(e)}return n}doLink({e:t,x:e,y:n}){this.edgeView&&this.edgeView.onMouseMove(t,e,n)}stopLink({e:t,x:e,y:n}){const r=this.edgeView;if(r){r.onMouseUp(t,e,n);const i=r.cell;i.hasLoop()&&this.makeLoopEdge(i),this.halo.stopBatch(),this.halo.trigger("action:edge:addde",{edge:i}),this.edgeView=null}this.graph.view.delegateEvents()}makeLoopEdge(t){let e=null,n=null;const r=this.options.loopEdgeWidth,i=this.graph.options,o=new Rectangle(0,0,i.width,i.height),s=this.graph.graphToLocal(this.view.getBBox());[this.options.loopEdgePreferredSide,"top","bottom","left","right"].some((t=>{let i=null,a=0,l=0;switch(t){case"top":i=new Point(s.x+s.width/2,s.y-r),a=r/2;break;case"bottom":i=new Point(s.x+s.width/2,s.y+s.height+r),a=r/2;break;case"left":i=new Point(s.x-r,s.y+s.height/2),l=r/2;break;case"right":i=new Point(s.x+s.width+r,s.y+s.height/2),l=r/2}return!!i&&(e=i.translate(-a,-l),n=i.translate(a,l),o.containsPoint(e)&&o.containsPoint(n))}))&&e&&n&&t.setVertices([e,n])}startResize({e:t}){this.halo.startBatch(),this.flip=[1,0,0,1,1,0,0,1][Math.floor(Angle.normalize(this.node.getAngle())/45)],this.view.addClass("node-resizing"),notify("node:resize",t,this.view)}doResize({e:t,dx:e,dy:n}){const r=this.node.getSize(),i=Math.max(r.width+(this.flip?e:n),1),o=Math.max(r.height+(this.flip?n:e),1);this.node.resize(i,o,{absolute:!0}),notify("node:resizing",t,this.view)}stopResize({e:t}){this.view.removeClass("node-resizing"),notify("node:resized",t,this.view),this.halo.stopBatch()}startClone({e:t,x:e,y:n}){this.halo.startBatch();const r=this.options.clone(this.cell,{clone:!0});if(!Cell.isCell(r))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(r,e,n),this.model.addCell(r,{halo:this.halo.cid,async:!1});const i=this.graph.renderer.findViewByCell(r);i.onMouseDown(t,e,n),this.halo.setEventData(t,{cloneView:i})}centerNodeAtCursor(t,e,n){const r=t.getBBox().getCenter();t.translate(e-r.x,n-r.y)}doClone({e:t,x:e,y:n}){const r=this.halo.getEventData(t).cloneView;r&&r.onMouseMove(t,e,n)}stopClone({e:t,x:e,y:n}){const r=this.halo.getEventData(t).cloneView;r&&r.onMouseUp(t,e,n),this.halo.stopBatch()}startFork({e:t,x:e,y:n}){this.halo.startBatch();const r=this.options.clone(this.cell,{fork:!0});if(!Cell.isCell(r))throw new Error("option 'clone()' has to return a cell");this.centerNodeAtCursor(r,e,n),this.model.addCell(r,{halo:this.halo.cid,async:!1});const i=this.createEdgeConnectedToSource(),o=this.graph.renderer.findViewByCell(r),s=this.getMagnet(o,"target"),a=this.getEdgeTerminal(o,s);i.setTarget(a),this.model.addEdge(i,{halo:this.halo.cid,async:!1}),o.onMouseDown(t,e,n),this.halo.setEventData(t,{cloneView:o})}doFork({e:t,x:e,y:n}){const r=this.halo.getEventData(t).cloneView;r&&r.onMouseMove(t,e,n)}stopFork({e:t,x:e,y:n}){const r=this.halo.getEventData(t).cloneView;r&&r.onMouseUp(t,e,n),this.halo.stopBatch()}startRotate({e:t,x:e,y:n}){this.halo.startBatch();const r=this.node.getBBox().getCenter(),i=[this.node];this.options.rotateEmbeds&&this.node.getDescendants({deep:!0}).reduce(((t,e)=>(e.isNode()&&t.push(e),t)),i),this.halo.setEventData(t,{center:r,nodes:i,rotateStartAngles:i.map((t=>t.getAngle())),clientStartAngle:new Point(e,n).theta(r)}),i.forEach((e=>{const n=this.graph.findViewByCell(e);n&&(n.addClass("node-rotating"),notify("node:rotate",t,n))}))}doRotate({e:t,x:e,y:n}){const r=this.halo.getEventData(t),i=r.clientStartAngle-new Point(e,n).theta(r.center);r.nodes.forEach(((e,n)=>{const o=Util$3.snapToGrid(r.rotateStartAngles[n]+i,this.options.rotateGrid);e.rotate(o,{absolute:!0,center:r.center,halo:this.halo.cid}),notify("node:rotating",t,this.graph.findViewByCell(e))}))}stopRotate({e:t}){this.halo.getEventData(t).nodes.forEach((e=>{const n=this.graph.findViewByCell(e);n.removeClass("node-rotating"),notify("node:rotated",t,n)})),this.halo.stopBatch()}unlink(){this.halo.startBatch(),this.model.removeConnectedEdges(this.cell),this.halo.stopBatch()}}class EdgePreset{constructor(t){this.halo=t}get options(){return this.halo.options}get graph(){return this.halo.graph}get model(){return this.halo.model}get view(){return this.halo.view}get cell(){return this.halo.cell}get edge(){return this.cell}getPresets(){return{className:"type-edge",handles:[{name:"remove",position:"nw",icon:null,events:{mousedown:this.removeEdge.bind(this)}},{name:"direction",position:"se",icon:null,events:{mousedown:this.directionSwap.bind(this)}}],content:!1,bbox:t=>t.graph.localToGraph(t.getPointAtRatio(.5)),tinyThreshold:-1,smallThreshold:-1}}removeEdge(){this.cell.remove()}directionSwap(){const t=this.edge.getSource(),e=this.edge.getTarget();this.edge.prop({source:e,target:t})}}class Halo extends Widget{get type(){return this.options.type||"surround"}get handleOptions(){return this.options}init(t){this.options=merge(Halo.defaultOptions,this.cell.isNode()?new NodePreset(this).getPresets():this.cell.isEdge()?new EdgePreset(this).getPresets():null,t),this.render(),this.initHandles(),this.update(),this.startListening()}startListening(){const t=this.model,e=this.graph;this.view.cell.on("removed",this.remove,this),t.on("reseted",this.remove,this),e.on("halo:destroy",this.remove,this),t.on("*",this.update,this),e.on("scale",this.update,this),e.on("translate",this.update,this),super.startListening()}stopListening(){const t=this.model,e=this.graph,n=this.view.cell;this.undelegateEvents(),n.off("removed",this.remove,this),t.off("reseted",this.remove,this),e.off("halo:destroy",this.remove,this),t.off("*",this.update,this),e.off("scale",this.update,this),e.off("translate",this.update,this),super.stopListening()}render(){const t=this.options,e=this.prefixClassName("widget-halo");return this.view.addClass(Private$1.NODE_CLS),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(e).attr("data-shape",this.view.cell.shape),t.className&&this.$container.addClass(t.className),this.$handleContainer=this.$("<div/>").addClass(`${e}-handles`).appendTo(this.container),this.$content=this.$("<div/>").addClass(`${e}-content`).appendTo(this.container),this.$container.appendTo(this.graph.container),this}remove(){return this.stopBatch(),this.view.removeClass(Private$1.NODE_CLS),super.remove()}update(){if(this.isRendered()){this.updateContent();const t=this.getBBox(),e=this.options.tinyThreshold||0,n=this.options.smallThreshold||0;this.$handleContainer.toggleClass(`${this.handleClassName}-tiny`,t.width<e&&t.height<e);const r=`${this.handleClassName}-small`;this.$handleContainer.toggleClass(r,!this.$handleContainer.hasClass(r)&&t.width<n&&t.height<n),this.$container.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink(),"surround"!==this.type&&"toolbar"!==this.type||this.hasHandle("fork")&&this.toggleFork()}}updateContent(){const t=this.options.content;if("function"==typeof t){const e=call(t,this,this.view,this.$content[0]);e&&this.$content.html(e)}else t?this.$content.html(t):this.$content.remove()}getBBox(){const t=this.options.bbox,e="function"==typeof t?call(t,this,this.view):t;return Rectangle.create(Object.assign({x:0,y:0,width:1,height:1},e))}removeCell(){this.cell.remove()}toggleFork(){const t=this.view.cell.clone(),e=this.graph.hook.createCellView(t),n=this.graph.hook.validateConnection(this.view,null,e,null,"target");this.$handleContainer.children(".fork").toggleClass("hidden",!n),e.remove()}toggleUnlink(){const t=this.model.getConnectedEdges(this.view.cell).length>0;this.$handleContainer.children(".unlink").toggleClass("hidden",!t)}startBatch(){this.model.startBatch("halo",{halo:this.cid})}stopBatch(){this.model.hasActiveBatch("halo")&&this.model.stopBatch("halo",{halo:this.cid})}}(Halo||(Halo={})).defaultOptions={type:"surround",clearAll:!0,clearOnBlankMouseDown:!0,useCellGeometry:!1,clone:t=>t.clone().removeZIndex()},Object.getOwnPropertyNames(Handle.prototype).forEach((t=>{"constructor"!==t&&Object.defineProperty(Halo.prototype,t,Object.getOwnPropertyDescriptor(Handle.prototype,t))})),(Private$1||(Private$1={})).NODE_CLS="has-widget-halo";var __decorate=function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},GridLayout,ClassNames,Private;class Dnd extends View{constructor(t){super(),this.options=Object.assign(Object.assign({},Dnd.defaults),t),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName("widget-dnd")),this.draggingGraph=new Graph(Object.assign(Object.assign({},this.options.delegateGraphOptions),{container:document.createElement("div"),width:1,height:1})),this.$container.append(this.draggingGraph.container)}get targetScroller(){const t=this.options.target;return Graph.isGraph(t)?t.scroller.widget:t}get targetGraph(){const t=this.options.target;return Graph.isGraph(t)?t:t.graph}get targetModel(){return this.targetGraph.model}get snapline(){return this.targetGraph.snapline.widget}start(t,e){const n=e;n.preventDefault(),this.targetModel.startBatch("dnd"),this.$container.addClass("dragging").appendTo(this.options.containerParent||document.body),this.sourceNode=t,this.prepareDragging(t,n.clientX,n.clientY);const r=this.updateNodePosition(n.clientX,n.clientY);this.isSnaplineEnabled()&&(this.snapline.captureCursorOffset({e:n,node:t,cell:t,view:this.draggingView,x:r.x,y:r.y}),this.draggingNode.on("change:position",this.snap,this)),this.delegateDocumentEvents(Dnd.documentEvents,n.data)}isSnaplineEnabled(){return this.snapline&&!this.snapline.disabled}prepareDragging(t,e,n){const r=this.draggingGraph,i=r.model,o=this.options.getDragNode(t,{sourceNode:t,draggingGraph:r,targetGraph:this.targetGraph});o.position(0,0);let s=5;if(this.isSnaplineEnabled()&&(s+=this.snapline.options.tolerance||0),this.isSnaplineEnabled()||this.options.scaled){const t=this.targetGraph.transform.getScale();r.scale(t.sx,t.sy),s*=Math.max(t.sx,t.sy)}else r.scale(1,1);this.clearDragging(),this.options.animation&&this.$container.stop(!0,!0),i.resetCells([o]);const a=r.findViewByCell(o);a.undelegateEvents(),a.cell.off("changed"),r.fitToContent({padding:s,allowNewOrigin:"any"});const l=a.getBBox();this.geometryBBox=a.getBBox({useCellGeometry:!0}),this.delta=this.geometryBBox.getTopLeft().diff(l.getTopLeft()),this.draggingNode=o,this.draggingView=a,this.draggingBBox=o.getBBox(),this.padding=s,this.originOffset=this.updateGraphPosition(e,n)}updateGraphPosition(t,e){const n=document.body.scrollTop||document.documentElement.scrollTop,r=this.delta,i=this.geometryBBox,o=this.padding||5,s={left:t-r.x-i.width/2-o,top:e-r.y-i.height/2-o+n};return this.draggingGraph&&this.$container.offset(s),s}updateNodePosition(t,e){const n=this.targetGraph.clientToLocal(t,e),r=this.draggingBBox;return n.x-=r.width/2,n.y-=r.height/2,this.draggingNode.position(n.x,n.y),n}snap({cell:t,current:e,options:n}){const r=t;if(n.snapped){const t=this.draggingBBox;r.position(t.x+n.tx,t.y+n.ty,{silent:!0}),this.draggingView.translate(),r.position(e.x,e.y,{silent:!0}),this.snapOffset={x:n.tx,y:n.ty}}else this.snapOffset=null}onDragging(t){const e=this.draggingView;if(e){t.preventDefault();const n=this.normalizeEvent(t),r=n.clientX,i=n.clientY;this.updateGraphPosition(r,i);const o=this.updateNodePosition(r,i),s=this.targetGraph.options.embedding.enabled,a=(s||this.isSnaplineEnabled())&&this.isInsideValidArea({x:r,y:i});if(s){e.setEventData(n,{graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView});const t=e.getEventData(n);a?e.processEmbedding(n,t):e.clearEmbedding(t),this.candidateEmbedView=t.candidateEmbedView}this.isSnaplineEnabled()&&(a?this.snapline.snapOnMoving({e:n,view:e,x:o.x,y:o.y}):this.snapline.hide())}}onDragEnd(t){const e=this.draggingNode;if(e){const n=this.normalizeEvent(t),r=this.draggingView,i=this.draggingBBox,o=this.snapOffset;let s=i.x,a=i.y;o&&(s+=o.x,a+=o.y),e.position(s,a,{silent:!0});const l=this.drop(e,{x:n.clientX,y:n.clientY}),c=t=>{t?(this.onDropped(e),this.targetGraph.options.embedding.enabled&&r&&(r.setEventData(n,{cell:t,graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView}),r.finalizeEmbedding(n,r.getEventData(n)))):this.onDropInvalid(),this.candidateEmbedView=null,this.targetModel.stopBatch("dnd")};isAsync(l)?(this.undelegateDocumentEvents(),l.then(c)):c(l)}}clearDragging(){this.draggingNode&&(this.sourceNode=null,this.draggingNode.remove(),this.draggingNode=null,this.draggingView=null,this.delta=null,this.padding=null,this.snapOffset=null,this.originOffset=null,this.undelegateDocumentEvents())}onDropped(t){this.draggingNode===t&&(this.clearDragging(),this.$container.removeClass("dragging").remove())}onDropInvalid(){const t=this.draggingNode;if(t){const e=this.options.animation;if(e){const n="object"==typeof e&&e.duration||150,r="object"==typeof e&&e.easing||"swing";this.draggingView=null,this.$container.animate(this.originOffset,n,r,(()=>this.onDropped(t)))}else this.onDropped(t)}}isInsideValidArea(t){let e;const n=this.targetGraph,r=this.targetScroller;if(r)if(r.options.autoResize)e=this.getDropArea(r.container);else{const t=this.getDropArea(r.container);e=this.getDropArea(n.container).intersectsWithRect(t)}else e=this.getDropArea(n.container);return e&&e.containsPoint(t)}getDropArea(t){const e=this.$(t),n=e.offset(),r=document.body.scrollTop||document.documentElement.scrollTop,i=document.body.scrollLeft||document.documentElement.scrollLeft;return Rectangle.create({x:n.left+parseInt(e.css("border-left-width"),10)-i,y:n.top+parseInt(e.css("border-top-width"),10)-r,width:e.innerWidth(),height:e.innerHeight()})}drop(t,e){if(this.isInsideValidArea(e)){const n=this.targetGraph,r=n.model,i=n.clientToLocal(e),o=this.sourceNode,s=this.options.getDropNode(t,{sourceNode:o,draggingNode:t,targetGraph:this.targetGraph,draggingGraph:this.draggingGraph}),a=s.getBBox();i.x+=a.x-a.width/2,i.y+=a.y-a.height/2;const l=this.snapOffset?1:n.getGridSize();s.position(Util$3.snapToGrid(i.x,l),Util$3.snapToGrid(i.y,l)),s.removeZIndex();const c=this.options.validateNode,u=!c||c(s,{sourceNode:o,draggingNode:t,droppingNode:s,targetGraph:n,draggingGraph:this.draggingGraph});return"boolean"==typeof u?u?(r.addCell(s,{stencil:this.cid}),s):null:toDeferredBoolean(u).then((t=>t?(r.addCell(s,{stencil:this.cid}),s):null))}return null}onRemove(){this.draggingGraph&&(this.draggingGraph.view.remove(),this.draggingGraph.dispose())}dispose(){this.remove()}}function grid(t,e={}){const n=Model.isModel(t)?t:(new Model).resetCells(t,{sort:!1,dryrun:!0}),r=n.getNodes(),i=e.columns||1,o=Math.ceil(r.length/i),s=e.dx||0,a=e.dy||0,l=!1!==e.center,c=!0===e.resizeToFit,u=e.marginX||0,h=e.marginY||0,d=[];let f=e.columnWidth;if("compact"===f)for(let t=0;t<i;t+=1){const e=GridLayout.getNodesInColumn(r,t,i);d.push(GridLayout.getMaxDim(e,"width")+s)}else{null!=f&&"auto"!==f||(f=GridLayout.getMaxDim(r,"width")+s);for(let t=0;t<i;t+=1)d.push(f)}const p=GridLayout.accumulate(d,u),g=[];let m=e.rowHeight;if("compact"===m)for(let t=0;t<o;t+=1){const e=GridLayout.getNodesInRow(r,t,i);g.push(GridLayout.getMaxDim(e,"height")+a)}else{null!=m&&"auto"!==m||(m=GridLayout.getMaxDim(r,"height")+a);for(let t=0;t<o;t+=1)g.push(m)}const A=GridLayout.accumulate(g,h);n.startBatch("layout"),r.forEach(((t,n)=>{const r=n%i,o=Math.floor(n/i),u=d[r],h=g[o];let f=0,m=0,y=t.getSize();if(c){let n=u-2*s,r=h-2*a;const i=y.height*(y.width?n/y.width:1),o=y.width*(y.height?r/y.height:1);h<i?n=o:r=i,y={width:n,height:r},t.setSize(y,e)}l&&(f=(u-y.width)/2,m=(h-y.height)/2),t.position(p[r]+s+f,A[o]+a+m,e)})),n.stopBatch("layout")}__decorate([View.dispose()],Dnd.prototype,"dispose",null),function(t){t.defaults={animation:!1,getDragNode:t=>t.clone(),getDropNode:t=>t.clone()},t.documentEvents={mousemove:"onDragging",touchmove:"onDragging",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"}}(Dnd||(Dnd={})),function(t){t.getMaxDim=function(t,e){return t.reduce(((t,n)=>Math.max(n.getSize()[e],t)),0)},t.getNodesInRow=function(t,e,n){const r=[];for(let i=n*e,o=i+n;i<o;i+=1)r.push(t[i]);return r},t.getNodesInColumn=function(t,e,n){const r=[];for(let i=e,o=t.length;i<o;i+=n)r.push(t[i]);return r},t.accumulate=function(t,e){return t.reduce(((t,e,n)=>(t.push(t[n]+e),t)),[e||0])}}(GridLayout||(GridLayout={}));class Stencil extends View{constructor(t){super(),this.graphs={},this.$groups={},this.options=Object.assign(Object.assign({},Stencil.defaultOptions),t),this.dnd=new Dnd(this.options),this.onSearch=debounce$1(this.onSearch,200),this.container=document.createElement("div"),this.$container=this.$(this.container).addClass(this.prefixClassName(ClassNames.base)).attr("data-not-found-text",this.options.notFoundText||"No matches found"),this.options.collapsable=t.collapsable&&t.groups&&t.groups.some((t=>!1!==t.collapsable)),this.options.collapsable&&(this.$container.addClass("collapsable"),t.groups&&t.groups.every((t=>t.collapsed||!1===t.collapsable))&&this.$container.addClass("collapsed")),this.$("<div/>").addClass(this.prefixClassName(ClassNames.title)).html(this.options.title).appendTo(this.$container),t.search&&this.$container.addClass("searchable").append(this.renderSearch()),this.$content=this.$("<div/>").addClass(this.prefixClassName(ClassNames.content)).appendTo(this.$container);const e=t.stencilGraphOptions||{};if(t.groups&&t.groups.length)t.groups.forEach((n=>{const r=this.$("<div/>").addClass(this.prefixClassName(ClassNames.group)).attr("data-name",n.name);(null==n.collapsable&&t.collapsable||!1!==n.collapsable)&&r.addClass("collapsable"),r.toggleClass("collapsed",!0===n.collapsed);const i=this.$("<h3/>").addClass(this.prefixClassName(ClassNames.groupTitle)).html(n.title||n.name),o=this.$("<div/>").addClass(this.prefixClassName(ClassNames.groupContent)),s=n.graphOptions,a=new Graph(Object.assign(Object.assign(Object.assign({},e),s),{container:document.createElement("div"),model:e.model||new Model,width:n.graphWidth||t.stencilGraphWidth,height:n.graphHeight||t.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));o.append(a.container),r.append(i,o).appendTo(this.$content),this.$groups[n.name]=r,this.graphs[n.name]=a}));else{const n=new Graph(Object.assign(Object.assign({},e),{container:document.createElement("div"),model:e.model||new Model,width:t.stencilGraphWidth,height:t.stencilGraphHeight,interacting:!1,preventDefaultBlankAction:!1}));this.$content.append(n.container),this.graphs[Private.defaultGroupName]=n}return this.startListening(),this}get targetScroller(){const t=this.options.target;return Graph.isGraph(t)?t.scroller.widget:t}get targetGraph(){const t=this.options.target;return Graph.isGraph(t)?t:t.graph}get targetModel(){return this.targetGraph.model}renderSearch(){return this.$("<div/>").addClass(this.prefixClassName(ClassNames.search)).append(this.$("<input/>").attr({type:"search",placeholder:this.options.placeholder||"Search"}).addClass(this.prefixClassName(ClassNames.searchText)))}startListening(){const t=this.prefixClassName(ClassNames.title),e=this.prefixClassName(ClassNames.searchText),n=this.prefixClassName(ClassNames.groupTitle);this.delegateEvents({[`click .${t}`]:"onTitleClick",[`touchstart .${t}`]:"onTitleClick",[`click .${n}`]:"onGroupTitleClick",[`touchstart .${n}`]:"onGroupTitleClick",[`input .${e}`]:"onSearch",[`focusin .${e}`]:"onSearchFocusIn",[`focusout .${e}`]:"onSearchFocusOut"}),Object.keys(this.graphs).forEach((t=>{this.graphs[t].on("cell:mousedown",this.onDragStart,this)}))}stopListening(){this.undelegateEvents(),Object.keys(this.graphs).forEach((t=>{this.graphs[t].off("cell:mousedown",this.onDragStart,this)}))}load(t,e){return Array.isArray(t)?this.loadGroup(t,e):this.options.groups&&Object.keys(this.options.groups).forEach((e=>{t[e]&&this.loadGroup(t[e],e)})),this}loadGroup(t,e){const n=this.getModel(e);if(n){const e=t.map((t=>Node$1.isNode(t)?t:Node$1.create(t)));n.resetCells(e)}const r=this.getGroup(e);let i=this.options.stencilGraphHeight;r&&null!=r.graphHeight&&(i=r.graphHeight);const o=r&&r.layout||this.options.layout;if(o&&n&&call(o,this,n,r),!i){const t=this.getGraph(e);t.fitToContent({minWidth:t.options.width,gridHeight:1,padding:r&&r.graphPadding||this.options.stencilGraphPadding||10})}return this}onDragStart(t){const{e,node:n}=t;this.dnd.start(n,e)}filter(t,e){const n=Object.keys(this.graphs).reduce(((n,r)=>{const i=this.graphs[r],o=r===Private.defaultGroupName?null:r,s=i.model.getNodes().filter((n=>{let r=!1;r="function"==typeof e?call(e,this,n,t,o,this):"boolean"==typeof e?e:this.isCellMatched(n,t,e,t.toLowerCase()!==t);const s=i.renderer.findViewByCell(n);return s&&s.$(s.container).toggleClass("unmatched",!r),r})),a=s.length>0,l=this.options,c=new Model;return c.resetCells(s),l.layout&&call(l.layout,this,c,this.getGroup(r)),this.$groups[r]&&this.$groups[r].toggleClass("unmatched",!a),i.fitToContent({gridWidth:1,gridHeight:1,padding:l.stencilGraphPadding||10}),n||a}),!1);this.$container.toggleClass("not-found",!n)}isCellMatched(t,e,n,r){return!e||!n||Object.keys(n).some((i=>{if("*"===i||t.shape===i){const o=n[i];return"boolean"==typeof o?o:(Array.isArray(o)?o:[o]).some((n=>{let i=t.getPropByPath(n);return null!=i&&(i=`${i}`,r||(i=i.toLowerCase()),i.indexOf(e)>=0)}))}return!1}))}onSearch(t){this.filter(t.target.value,this.options.search)}onSearchFocusIn(){this.$container.addClass("is-focused")}onSearchFocusOut(){this.$container.removeClass("is-focused")}onTitleClick(){this.options.collapsable&&(this.$container.toggleClass("collapsed"),this.$container.hasClass("collapsed")?this.collapseGroups():this.expandGroups())}onGroupTitleClick(t){const e=this.$(t.target).closest(`.${this.prefixClassName(ClassNames.group)}`);this.toggleGroup(e.attr("data-name")||"");const n=Object.keys(this.$groups).every((t=>{const e=this.getGroup(t);return e&&!1===e.collapsable||this.$groups[t].hasClass("collapsed")}));this.$container.toggleClass("collapsed",n)}getModel(t){const e=this.getGraph(t);return e?e.model:null}getGraph(t){return this.graphs[t||Private.defaultGroupName]}getGroup(t){const e=this.options.groups;return null!=t&&e&&e.length?e.find((e=>e.name===t)):null}toggleGroup(t){return this.isGroupCollapsed(t)?this.expandGroup(t):this.collapseGroup(t),this}collapseGroup(t){if(this.isGroupCollapsable(t)){const e=this.$groups[t];e&&!this.isGroupCollapsed(t)&&(this.trigger("group:collapse",{name:t}),e.addClass("collapsed"))}return this}expandGroup(t){if(this.isGroupCollapsable(t)){const e=this.$groups[t];e&&this.isGroupCollapsed(t)&&(this.trigger("group:expand",{name:t}),e.removeClass("collapsed"))}return this}isGroupCollapsable(t){return this.$groups[t].hasClass("collapsable")}isGroupCollapsed(t){const e=this.$groups[t];return e&&e.hasClass("collapsed")}collapseGroups(){return Object.keys(this.$groups).forEach((t=>this.collapseGroup(t))),this}expandGroups(){return Object.keys(this.$groups).forEach((t=>this.expandGroup(t))),this}resizeGroup(t,e){const n=this.graphs[t];return n&&n.resize(e.width,e.height),this}onRemove(){Object.keys(this.graphs).forEach((t=>{this.graphs[t].view.remove(),delete this.graphs[t]})),this.dnd.remove(),this.stopListening(),this.undelegateDocumentEvents()}}function track(){if(Config.trackable){const t="https://kcart.alipay.com/web/bi.do",e=new Image,n=Object.assign(Object.assign({},Config.trackInfo),{version,pg:document.URL,r:(new Date).getTime(),x6:!0,page_type:"syslog"}),r=encodeURIComponent(JSON.stringify([n]));e.src=`${t}?BIProfile=merge&d=${r}`}}(Stencil||(Stencil={})).defaultOptions=Object.assign({stencilGraphWidth:200,stencilGraphHeight:800,title:"Stencil",collapsable:!1,placeholder:"Search",notFoundText:"No matches found",layout(t,e){grid(t,Object.assign(Object.assign(Object.assign({},{columnWidth:this.options.stencilGraphWidth/2-10,columns:2,rowHeight:80,resizeToFit:!1,dx:10,dy:10}),this.options.layoutOptions),e?e.layoutOptions:{}))}},Dnd.defaults),function(t){t.base="widget-stencil",t.title=`${t.base}-title`,t.search=`${t.base}-search`,t.searchText=`${t.search}-text`,t.content=`${t.base}-content`,t.group=`${t.base}-group`,t.groupTitle=`${t.group}-title`,t.groupContent=`${t.group}-content`}(ClassNames||(ClassNames={})),(Private||(Private={})).defaultGroupName="__default__",Config.trackable&&setTimeout(track,3e3);var platform=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Platform=void 0;var n=navigator.userAgent;!function(t){t.IS_MAC=navigator.appVersion.indexOf("Mac")>0,t.IS_IOS=!!n.match(/(iPad|iPhone|iPod)/g),t.IS_WINDOWS=navigator.appVersion.indexOf("Win")>0,t.IS_IE=n.indexOf("MSIE")>=0,t.IS_IE11=!!n.match(/Trident\/7\./),t.IS_EDGE=!!n.match(/Edge\//),t.IS_NETSCAPE=n.indexOf("Mozilla/")>=0&&n.indexOf("MSIE")<0&&n.indexOf("Edge/")<0,t.IS_CHROME_APP=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,t.IS_CHROME=n.indexOf("Chrome/")>=0&&n.indexOf("Edge/")<0,t.IS_OPERA=n.indexOf("Opera/")>=0||n.indexOf("OPR/")>=0,t.IS_FIREFOX=n.indexOf("Firefox/")>=0,t.IS_SAFARI=n.indexOf("AppleWebKit/")>=0&&n.indexOf("Chrome/")<0&&n.indexOf("Edge/")<0,t.SUPPORT_TOUCH="ontouchstart"in document.documentElement,t.SUPPORT_POINTER=null!=window.PointerEvent&&!t.IS_MAC,t.SUPPORT_PASSIVE=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t.SUPPORT_PASSIVE=!0}}),r=document.createElement("div");r.addEventListener&&r.addEventListener("click",(function(){}),e)}catch(t){}t.NO_FOREIGNOBJECT=!document.createElementNS||""+document.createElementNS("http://www.w3.org/2000/svg","foreignObject")!="[object SVGForeignObjectElement]"||n.indexOf("Opera/")>=0,t.SUPPORT_FOREIGNOBJECT=!t.NO_FOREIGNOBJECT}(e.Platform||(e.Platform={})),function(t){function e(){var t=window.module;return null!=t&&null!=t.hot&&null!=t.hot.status?t.hot.status():"unkonwn"}t.getHMRStatus=e,t.isApplyingHMR=function(){return"apply"===e()};var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};t.isEventSupported=function(t){var e=document.createElement(n[t]||"div"),r="on"+t,i=r in e;return i||(e.setAttribute(r,"return;"),i="function"==typeof e[r]),i}}(e.Platform||(e.Platform={}))}));createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var r=n(jquery);if(platform.Platform.SUPPORT_PASSIVE){r.default.event.special.touchstart={setup:function(t,e,n){if(!this.addEventListener)return!1;this.addEventListener("touchstart",n,{passive:!0})}};var i=r.default.event.special.mousewheel;if(i){var o=i.setup;i.setup=function(){var t=this,e=this.addEventListener;if(!e)return!1;this.addEventListener=function(n,r){e.call(t,n,r,{passive:!0})},o.call(this),this.addEventListener=e}}}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(t){Object.prototype.hasOwnProperty.call(t,"append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=document.createDocumentFragment();t.forEach((function(t){var e=t instanceof Node;n.appendChild(e?t:document.createTextNode(String(t)))})),this.appendChild(n)}})}))}));const lodash_es_1=getAugmentedNamespace(lodash);var lang$1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isNumeric=e.isWindow=e.isFunction=e.isArrayLike=e.isArray=e.isObject=e.isBoolean=e.isNumber=e.isString=e.isUndefined=e.isNil=e.isNull=void 0,Object.defineProperty(e,"isNull",{enumerable:!0,get:function(){return lodash_es_1.isNull}}),Object.defineProperty(e,"isNil",{enumerable:!0,get:function(){return lodash_es_1.isNil}}),Object.defineProperty(e,"isUndefined",{enumerable:!0,get:function(){return lodash_es_1.isUndefined}}),Object.defineProperty(e,"isString",{enumerable:!0,get:function(){return lodash_es_1.isString}}),Object.defineProperty(e,"isNumber",{enumerable:!0,get:function(){return lodash_es_1.isNumber}}),Object.defineProperty(e,"isBoolean",{enumerable:!0,get:function(){return lodash_es_1.isBoolean}}),Object.defineProperty(e,"isObject",{enumerable:!0,get:function(){return lodash_es_1.isObject}}),Object.defineProperty(e,"isArray",{enumerable:!0,get:function(){return lodash_es_1.isArray}}),Object.defineProperty(e,"isArrayLike",{enumerable:!0,get:function(){return lodash_es_1.isArrayLike}}),Object.defineProperty(e,"isFunction",{enumerable:!0,get:function(){return lodash_es_1.isFunction}}),e.isWindow=function(t){return t&&t===t.window},e.isNumeric=function(t){return!Array.isArray(t)&&t-parseFloat(t)+1>=0}})),lang=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Lang=void 0;var o=i(lang$1);e.Lang=o})),diff_1=createCommonjsModule((function(t,e){function n(t,e){for(var n={},r=[],i=0,o=t.length;i<o;i+=1){var s=t[i],a=s[e];a?n[a]=i:r.push(s)}return{keyIndex:n,free:r}}Object.defineProperty(e,"__esModule",{value:!0}),e.diff=void 0,e.diff=function(t,e,r){for(var i,o,s=n(t,r),a=n(e,r),l=a.free,c=s.keyIndex,u=a.keyIndex,h=[],d=[],f=0,p=0;f<t.length;)(o=(i=t[f])[r])?u.hasOwnProperty(o)?d.push(e[u[o]]):d.push(null):d.push(l[p+=1]||null),f+=1;var g=d.slice(0);for(f=0;f<g.length;)null===g[f]?(b(f),w(f)):f+=1;for(var m=f=0;f<e.length;){o=(i=e[f])[r];var A=g[m];if(A)if(o===A[r])m+=1;else if(c.hasOwnProperty(o)){var y=g[m+1];y&&(y[r]===o?(b(f),w(m),m+=1):x(f,i))}else x(f,i);else x(f,i);f+=1}for(var v=g.length-m;(m+=1)<g.length;)b((v-=1)+f);function b(t){h.push({index:t,type:0,item:null})}function x(t,e){h.push({index:t,item:e,type:1})}function w(t){g.splice(t,1)}return{moves:h}}})),array$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.max=e.difference=e.groupBy=e.sortBy=e.sortedIndexBy=e.sortedIndex=e.union=e.uniq=e.isArrayLike=e.isArray=void 0,Object.defineProperty(e,"isArray",{enumerable:!0,get:function(){return lodash_es_1.isArray}}),Object.defineProperty(e,"isArrayLike",{enumerable:!0,get:function(){return lodash_es_1.isArrayLike}}),Object.defineProperty(e,"uniq",{enumerable:!0,get:function(){return lodash_es_1.uniq}}),Object.defineProperty(e,"union",{enumerable:!0,get:function(){return lodash_es_1.union}}),Object.defineProperty(e,"sortedIndex",{enumerable:!0,get:function(){return lodash_es_1.sortedIndex}}),Object.defineProperty(e,"sortedIndexBy",{enumerable:!0,get:function(){return lodash_es_1.sortedIndexBy}}),Object.defineProperty(e,"sortBy",{enumerable:!0,get:function(){return lodash_es_1.sortBy}}),Object.defineProperty(e,"groupBy",{enumerable:!0,get:function(){return lodash_es_1.groupBy}}),Object.defineProperty(e,"difference",{enumerable:!0,get:function(){return lodash_es_1.difference}}),Object.defineProperty(e,"max",{enumerable:!0,get:function(){return lodash_es_1.max}}),r(diff_1,e)})),array=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayExt=void 0;var o=i(array$1);e.ArrayExt=o})),mixins=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.applyMixins=void 0,e.applyMixins=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(n){"constructor"!==n&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))}))}))}})),inherit_1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.createClass=e.inherit=void 0;var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}e.inherit=i;var o=/^\s*class\s+/.test(""+function(){})||/^\s*class\s*\{/.test(""+function(){});e.createClass=function(t,e){var r;return o?r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(e):i(r=function(){return e.apply(this,arguments)},e),Object.defineProperty(r,"name",{value:t}),r}})),object$2=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};function i(t,e){return null!=t?t:e}function o(t){return"__proto__"===t}function s(t,e,n){var r;void 0===n&&(n="/");var i=Array.isArray(e)?e:e.split(n);if(i.length)for(r=t;i.length;){var o=i.shift();if(Object(r)!==r||!o||!(o in r))return;r=r[o]}return r}Object.defineProperty(e,"__esModule",{value:!0}),e.flatten=e.unsetByPath=e.setByPath=e.getByPath=e.isMaliciousProp=e.getBoolean=e.getNumber=e.getValue=e.ensure=e.defaultsDeep=e.defaults=e.cloneDeep=e.clone=e.isPlainObject=e.isObject=e.isEmpty=e.isEqual=e.extend=e.merge=e.forIn=e.pick=e.has=void 0,Object.defineProperty(e,"has",{enumerable:!0,get:function(){return lodash_es_1.has}}),Object.defineProperty(e,"pick",{enumerable:!0,get:function(){return lodash_es_1.pick}}),Object.defineProperty(e,"forIn",{enumerable:!0,get:function(){return lodash_es_1.forIn}}),Object.defineProperty(e,"merge",{enumerable:!0,get:function(){return lodash_es_1.merge}}),Object.defineProperty(e,"extend",{enumerable:!0,get:function(){return lodash_es_1.extend}}),Object.defineProperty(e,"isEqual",{enumerable:!0,get:function(){return lodash_es_1.isEqual}}),Object.defineProperty(e,"isEmpty",{enumerable:!0,get:function(){return lodash_es_1.isEmpty}}),Object.defineProperty(e,"isObject",{enumerable:!0,get:function(){return lodash_es_1.isObject}}),Object.defineProperty(e,"isPlainObject",{enumerable:!0,get:function(){return lodash_es_1.isPlainObject}}),Object.defineProperty(e,"clone",{enumerable:!0,get:function(){return lodash_es_1.clone}}),Object.defineProperty(e,"cloneDeep",{enumerable:!0,get:function(){return lodash_es_1.cloneDeep}}),Object.defineProperty(e,"defaults",{enumerable:!0,get:function(){return lodash_es_1.defaults}}),Object.defineProperty(e,"defaultsDeep",{enumerable:!0,get:function(){return lodash_es_1.defaultsDeep}}),r(mixins,e),r(inherit_1,e),e.ensure=i,e.getValue=function(t,e,n){var r=null!=t?t[e]:null;return void 0!==n?i(r,n):r},e.getNumber=function(t,e,n){var r=null!=t?t[e]:null;return null==r?n:(r=+r,Number.isNaN(r)||!Number.isFinite(r)?n:r)},e.getBoolean=function(t,e,n){var r=null!=t?t[e]:null;return null==r?n:!!r},e.isMaliciousProp=o,e.getByPath=s,e.setByPath=function(t,e,n,r){void 0===r&&(r="/");var i=Array.isArray(e)?e:e.split(r),s=i.pop();if(s&&!o(s)){var a=t;i.forEach((function(t){o(t)||(null==a[t]&&(a[t]={}),a=a[t])})),a[s]=n}return t},e.unsetByPath=function(t,e,n){void 0===n&&(n="/");var r=Array.isArray(e)?e.slice():e.split(n),i=r.pop();if(i)if(r.length>0){var o=s(t,r);o&&delete o[i]}else delete t[i];return t},e.flatten=function t(e,n,r){void 0===n&&(n="/");var i={};for(var o in Object.keys(e).forEach((function(o){var s=e[o],a="object"==typeof s||Array.isArray(s);if(a&&r&&r(s)&&(a=!1),a){var l=t(s,n,r);Object.keys(l).forEach((function(t){i[o+n+t]=l[t]}))}else i[o]=s})),e)Object.prototype.hasOwnProperty.call(e,o);return i}})),object$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectExt=void 0;var o=i(object$2);e.ObjectExt=o})),_eval=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.exec=void 0,e.exec=function(t){var e=null;try{e=window.eval(t)}catch(t){}return e}})),format=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.titleCase=e.sentenceCase=e.pathCase=e.dotCase=e.constantCase=e.pascalCase=e.kebabCase=e.camelCase=e.upperFirst=e.lowerFirst=void 0;var n=lodash_es_1;Object.defineProperty(e,"lowerFirst",{enumerable:!0,get:function(){return n.lowerFirst}}),Object.defineProperty(e,"upperFirst",{enumerable:!0,get:function(){return n.upperFirst}}),Object.defineProperty(e,"camelCase",{enumerable:!0,get:function(){return n.camelCase}});var r=function(t){var e=Object.create(null);return function(n){return e[n]||(e[n]=t(n))}};e.kebabCase=r((function(t){return t.replace(/\B([A-Z])/g,"-$1").toLowerCase()})),e.pascalCase=r((function(t){return(0,lodash_es_1.startCase)((0,lodash_es_1.camelCase)(t)).replace(/ /g,"")})),e.constantCase=r((function(t){return(0,lodash_es_1.upperCase)(t).replace(/ /g,"_")})),e.dotCase=r((function(t){return(0,lodash_es_1.lowerCase)(t).replace(/ /g,".")})),e.pathCase=r((function(t){return(0,lodash_es_1.lowerCase)(t).replace(/ /g,"/")})),e.sentenceCase=r((function(t){return(0,lodash_es_1.upperFirst)((0,lodash_es_1.lowerCase)(t))})),e.titleCase=r((function(t){return(0,lodash_es_1.startCase)((0,lodash_es_1.camelCase)(t))}))})),hashcode_1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.hashcode=void 0,e.hashcode=function(t){for(var e=2166136261,n=!1,r=t,i=0,o=r.length;i<o;i+=1){var s=r.charCodeAt(i);s>127&&!n&&(s=(r=unescape(encodeURIComponent(r))).charCodeAt(i),n=!0),e^=s,e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}return e>>>0}})),uuid_1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.uuid=void 0,e.uuid=function(){for(var t="",e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n=0,r=e.length;n<r;n+=1){var i=e[n],o=16*Math.random()|0;t+=("x"===i?o:"y"===i?3&o|8:i).toString(16)}return t}})),html=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.sanitizeHTML=void 0;var r=n(jquery);e.sanitizeHTML=function(t,e){void 0===e&&(e={});var n=r.default.parseHTML(t,null,!1);return n.forEach((function(t){var e=t;if(e){var n=e.attributes;if(n)for(var r=0,i=n.length;r<i;r+=1){var o=n.item(r);if(o){var s=o.value.toLowerCase(),a=o.name.toLowerCase();(a.startsWith("on")||s.startsWith("javascript:")||s.startsWith("data:")||s.startsWith("vbscript:"))&&e.removeAttribute(a)}}}})),e.raw?n:(0,r.default)("<div/>").append(n).html()}})),suggestion=createCommonjsModule((function(t,e){function n(t,e,n){for(var r=new Array(e.length+1),i=new Array(e.length+1),o=n+1,s=0;s<=e.length;s+=1)r[s]=s;for(s=1;s<=t.length;s+=1){var a=t.charCodeAt(s-1),l=s>n?s-n:1,c=e.length>n+s?n+s:e.length;i[0]=s;for(var u=s,h=1;h<l;h+=1)i[h]=o;for(h=l;h<=c;h+=1){var d=a===e.charCodeAt(h-1)?r[h-1]:Math.min(r[h]+1,i[h-1]+1,r[h-1]+2);i[h]=d,u=Math.min(u,d)}for(h=c+1;h<=e.length;h+=1)i[h]=o;if(u>n)return;var f=r;r=i,i=f}var p=r[e.length];return p>n?void 0:p}Object.defineProperty(e,"__esModule",{value:!0}),e.getSpellingSuggestion=void 0,e.getSpellingSuggestion=function(t,e,r){for(var i,o=Math.min(2,Math.floor(.34*t.length)),s=Math.floor(.4*t.length)+1,a=!1,l=t.toLowerCase(),c=0,u=e;c<u.length;c++){var h=u[c],d=r(h);if(void 0!==d&&Math.abs(d.length-l.length)<=o){var f=d.toLowerCase();if(f===l){if(d===t)continue;return h}if(a)continue;if(d.length<3)continue;var p=n(l,f,s-1);if(void 0===p)continue;p<3?(a=!0,i=h):(s=p,i=h)}}return i}})),string$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.eval=e.uniqueId=e.template=e.truncate=e.padStart=e.padEnd=e.pad=e.repeat=e.split=e.endsWith=e.startsWith=e.unescape=e.escape=e.toString=e.isString=void 0,Object.defineProperty(e,"isString",{enumerable:!0,get:function(){return lodash_es_1.isString}}),Object.defineProperty(e,"toString",{enumerable:!0,get:function(){return lodash_es_1.toString}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return lodash_es_1.escape}}),Object.defineProperty(e,"unescape",{enumerable:!0,get:function(){return lodash_es_1.unescape}}),Object.defineProperty(e,"startsWith",{enumerable:!0,get:function(){return lodash_es_1.startsWith}}),Object.defineProperty(e,"endsWith",{enumerable:!0,get:function(){return lodash_es_1.endsWith}}),Object.defineProperty(e,"split",{enumerable:!0,get:function(){return lodash_es_1.split}}),Object.defineProperty(e,"repeat",{enumerable:!0,get:function(){return lodash_es_1.repeat}}),Object.defineProperty(e,"pad",{enumerable:!0,get:function(){return lodash_es_1.pad}}),Object.defineProperty(e,"padEnd",{enumerable:!0,get:function(){return lodash_es_1.padEnd}}),Object.defineProperty(e,"padStart",{enumerable:!0,get:function(){return lodash_es_1.padStart}}),Object.defineProperty(e,"truncate",{enumerable:!0,get:function(){return lodash_es_1.truncate}}),Object.defineProperty(e,"template",{enumerable:!0,get:function(){return lodash_es_1.template}}),Object.defineProperty(e,"uniqueId",{enumerable:!0,get:function(){return lodash_es_1.uniqueId}}),Object.defineProperty(e,"eval",{enumerable:!0,get:function(){return _eval.exec}}),r(format,e),r(hashcode_1,e),r(uuid_1,e),r(html,e),r(suggestion,e)})),string=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StringExt=void 0;var o=i(string$1);e.StringExt=o})),number$1=createCommonjsModule((function(t,e){function n(t){return"string"==typeof t&&"%"===t.slice(-1)}Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeSides=e.parseCssNumeric=e.normalizePercentage=e.isPercentage=e.random=e.mod=e.isNumeric=e.parseInt=e.toSafeInteger=e.toInteger=e.toNumber=e.toFinite=e.inRange=e.clamp=e.isSafeInteger=e.isInteger=e.isFinite=e.isNumber=e.isNaN=void 0,Object.defineProperty(e,"isNaN",{enumerable:!0,get:function(){return lodash_es_1.isNaN}}),Object.defineProperty(e,"isNumber",{enumerable:!0,get:function(){return lodash_es_1.isNumber}}),Object.defineProperty(e,"isFinite",{enumerable:!0,get:function(){return lodash_es_1.isFinite}}),Object.defineProperty(e,"isInteger",{enumerable:!0,get:function(){return lodash_es_1.isInteger}}),Object.defineProperty(e,"isSafeInteger",{enumerable:!0,get:function(){return lodash_es_1.isSafeInteger}}),Object.defineProperty(e,"clamp",{enumerable:!0,get:function(){return lodash_es_1.clamp}}),Object.defineProperty(e,"inRange",{enumerable:!0,get:function(){return lodash_es_1.inRange}}),Object.defineProperty(e,"toFinite",{enumerable:!0,get:function(){return lodash_es_1.toFinite}}),Object.defineProperty(e,"toNumber",{enumerable:!0,get:function(){return lodash_es_1.toNumber}}),Object.defineProperty(e,"toInteger",{enumerable:!0,get:function(){return lodash_es_1.toInteger}}),Object.defineProperty(e,"toSafeInteger",{enumerable:!0,get:function(){return lodash_es_1.toSafeInteger}}),Object.defineProperty(e,"parseInt",{enumerable:!0,get:function(){return lodash_es_1.parseInt}}),Object.defineProperty(e,"isNumeric",{enumerable:!0,get:function(){return lang$1.isNumeric}}),e.mod=function(t,e){return(t%e+e)%e},e.random=function(t,e){if(null==e)e=null==t?1:t,t=0;else if(e<t){var n=t;t=e,e=n}return Math.floor(Math.random()*(e-t+1)+t)},e.isPercentage=n,e.normalizePercentage=function(t,e){if(null==t)return 0;var r;if("string"==typeof t){if(r=parseFloat(t),n(t)&&(r/=100,Number.isFinite(r)))return r*e}else r=t;return Number.isFinite(r)?r>0&&r<1?r*e:r:0},e.parseCssNumeric=function(t,e){var n,r=parseFloat(t);if(Number.isNaN(r))return null;if(null==e)n="[A-Za-z]*";else if(Array.isArray(e)){if(0===e.length)return null;n=e.join("|")}else"string"==typeof e&&(n=e);var i=function(e){var n=new RegExp("(?:\\d+(?:\\.\\d+)*)("+e+")$").exec(t);return n?n[1]:null}(n);return null===i?null:{unit:i,value:r}},e.normalizeSides=function(t){if("object"==typeof t){var e=0,n=0,r=0,i=0;return null!=t.vertical&&Number.isFinite(t.vertical)&&(n=i=t.vertical),null!=t.horizontal&&Number.isFinite(t.horizontal)&&(r=e=t.horizontal),null!=t.left&&Number.isFinite(t.left)&&(e=t.left),null!=t.top&&Number.isFinite(t.top)&&(n=t.top),null!=t.right&&Number.isFinite(t.right)&&(r=t.right),null!=t.bottom&&Number.isFinite(t.bottom)&&(i=t.bottom),{top:n,right:r,bottom:i,left:e}}var o=0;return null!=t&&Number.isFinite(t)&&(o=t),{top:o,right:o,bottom:o,left:o}}})),number=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.NumberExt=void 0;var o=i(number$1);e.NumberExt=o})),_function$1=createCommonjsModule((function(t,e){function n(t,e,n){if(n)switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4]);case 6:return t.call(e,n[0],n[1],n[2],n[3],n[4],n[5]);default:return t.apply(e,n)}return t.call(e)}function r(t,e){for(var n=0,r=t.length;n<r;n+=1)if(t[n]===e)return t.push(t.splice(n,1)[0])}Object.defineProperty(e,"__esModule",{value:!0}),e.cacher=e.call=e.apply=e.defer=e.debounce=e.noop=e.once=e.isFunction=void 0,Object.defineProperty(e,"isFunction",{enumerable:!0,get:function(){return lodash_es_1.isFunction}}),Object.defineProperty(e,"once",{enumerable:!0,get:function(){return lodash_es_1.once}}),Object.defineProperty(e,"noop",{enumerable:!0,get:function(){return lodash_es_1.noop}}),Object.defineProperty(e,"debounce",{enumerable:!0,get:function(){return lodash_es_1.debounce}}),Object.defineProperty(e,"defer",{enumerable:!0,get:function(){return lodash_es_1.defer}}),e.apply=n,e.call=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n(t,e,r)},e.cacher=function(t,e,i){var o=[],s={};return function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];var c=!1,u=a.join("");return u in s?(c=!0,r(o,u)):(o.length>=1e3&&delete s[o.shift()],o.push(u),s[u]=n(t,e||null,a)),i?i(s[u],c):s[u]}}})),async=createCommonjsModule((function(t,e){function n(t){return"object"==typeof t&&t.then&&"function"==typeof t.then}function r(t){return null!=t&&(t instanceof Promise||n(t))}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=[];t.forEach((function(t){Array.isArray(t)?n.push.apply(n,t):n.push(t)}));var i=n.some((function(t){return r(t)}));if(i){var o=n.map((function(t){return r(t)?t:Promise.resolve(!1!==t)}));return Promise.all(o).then((function(t){return t.reduce((function(t,e){return!1!==e&&t}),!0)}))}return n.every((function(t){return!1!==t}))}Object.defineProperty(e,"__esModule",{value:!0}),e.toDeferredBoolean=e.toAsyncBoolean=e.isAsync=e.isAsyncLike=void 0,e.isAsyncLike=n,e.isAsync=r,e.toAsyncBoolean=i,e.toDeferredBoolean=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=i(t);return"boolean"==typeof n?Promise.resolve(n):n}})),main$2=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(_function$1,e),r(async,e)})),_function=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.FunctionExt=void 0;var o=i(main$2);e.FunctionExt=o})),_class=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.toggleClass=e.removeClass=e.addClass=e.hasClass=e.getClass=void 0;var n=/[\t\r\n\f]/g,r=/\S+/g,i=function(t){return" "+t+" "};function o(t){return t&&t.getAttribute&&t.getAttribute("class")||""}function s(t,e){if(null==t||null==e)return!1;var r=i(o(t)),s=i(e);return 1===t.nodeType&&r.replace(n," ").includes(s)}function a(t,e){if(null!=t&&null!=e){if("function"==typeof e)return a(t,e(o(t)));if("string"==typeof e&&1===t.nodeType){var s=e.match(r)||[],l=i(o(t)).replace(n," "),c=s.reduce((function(t,e){return t.indexOf(i(e))<0?""+t+e+" ":t}),l);l!==(c=c.trim())&&t.setAttribute("class",c)}}}function l(t,e){if(null!=t){if("function"==typeof e)return l(t,e(o(t)));if((!e||"string"==typeof e)&&1===t.nodeType){var s=(e||"").match(r)||[],a=i(o(t)).replace(n," "),c=s.reduce((function(t,e){var n=i(e);return t.indexOf(n)>-1?t.replace(n," "):t}),a);a!==(c=e?c.trim():"")&&t.setAttribute("class",c)}}}e.getClass=o,e.hasClass=s,e.addClass=a,e.removeClass=l,e.toggleClass=function t(e,n,i){if(null!=e&&null!=n)if(null==i||"string"!=typeof n){if("function"==typeof n)return t(e,n(o(e),i),i);"string"==typeof n&&(n.match(r)||[]).forEach((function(t){s(e,t)?l(e,t):a(e,t)}))}else i?a(e,n):l(e,n)}})),elem=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isHTMLElement=e.appendTo=e.before=e.prepend=e.append=e.empty=e.remove=e.contains=e.findParentByClass=e.findOne=e.find=e.index=e.tagName=e.parseXML=e.createSvgDocument=e.createSvgElement=e.createElementNS=e.createElement=e.svgVersion=e.ns=e.isSVGGraphicsElement=e.ensureId=e.uniqueId=void 0;var n=0;function r(){return"v"+(n+=1)}function i(t,n,r){return void 0===n&&(n=e.ns.xhtml),void 0===r&&(r=document),r.createElementNS(n,t)}function o(t,e){var n;void 0===e&&(e={});try{var r=new DOMParser;null!=e.async&&(r.async=e.async),n=r.parseFromString(t,e.mimeType||"text/xml")}catch(t){n=void 0}if(!n||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return n}function s(t,e){(Array.isArray(e)?e:[e]).forEach((function(e){null!=e&&t.appendChild(e)}))}function a(t,e){var n=t.parentNode;n&&(Array.isArray(e)?e:[e]).forEach((function(e){null!=e&&n.insertBefore(e,t)}))}e.uniqueId=r,e.ensureId=function(t){return null!=t.id&&""!==t.id||(t.id=r()),t.id},e.isSVGGraphicsElement=function(t){return null!=t&&"function"==typeof t.getScreenCTM&&t instanceof SVGElement},e.ns={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},e.svgVersion="1.1",e.createElement=function(t,e){return void 0===e&&(e=document),e.createElement(t)},e.createElementNS=i,e.createSvgElement=function(t,n){return void 0===n&&(n=document),i(t,e.ns.svg,n)},e.createSvgDocument=function(t){if(t)return o('<svg xmlns="'+e.ns.svg+'" xmlns:xlink="'+e.ns.xlink+'" version="'+e.svgVersion+'">'+t+"</svg>",{async:!1}).documentElement;var n=document.createElementNS(e.ns.svg,"svg");return n.setAttributeNS(e.ns.xmlns,"xmlns:xlink",e.ns.xlink),n.setAttribute("version",e.svgVersion),n},e.parseXML=o,e.tagName=function(t,e){void 0===e&&(e=!0);var n=t.nodeName;return e?n.toLowerCase():n.toUpperCase()},e.index=function(t){for(var e=0,n=t.previousSibling;n;)1===n.nodeType&&(e+=1),n=n.previousSibling;return e},e.find=function(t,e){return t.querySelectorAll(e)},e.findOne=function(t,e){return t.querySelector(e)},e.findParentByClass=function(t,e,n){for(var r=t.ownerSVGElement,i=t.parentNode;i&&i!==n&&i!==r;){if((0,_class.hasClass)(i,e))return i;i=i.parentNode}return null},e.contains=function(t,e){var n=e&&e.parentNode;return t===n||!!(n&&1===n.nodeType&&16&t.compareDocumentPosition(n))},e.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)},e.empty=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},e.append=s,e.prepend=function(t,e){var n=t.firstChild;return n?a(n,e):s(t,e)},e.before=a,e.appendTo=function(t,e){null!=e&&e.appendChild(t)},e.isHTMLElement=function(t){try{return t instanceof HTMLElement}catch(e){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}}})),attr_1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.mergeAttrs=e.styleToObject=e.kebablizeAttrs=e.qualifyAttr=e.attr=e.setAttributes=e.setAttribute=e.removeAttribute=e.getAttribute=void 0;var n=["viewBox","attributeName","attributeType","repeatCount"];function r(t,e){var n=s(e);n.ns?t.hasAttributeNS(n.ns,n.local)&&t.removeAttributeNS(n.ns,n.local):t.hasAttribute(e)&&t.removeAttribute(e)}function i(t,e,n){if(null==n)return r(t,e);var i=s(e);i.ns&&"string"==typeof n?t.setAttributeNS(i.ns,e,n):"id"===e?t.id=""+n:t.setAttribute(e,""+n)}function o(t,e){Object.keys(e).forEach((function(n){i(t,n,e[n])}))}function s(t){if(-1!==t.indexOf(":")){var e=t.split(":");return{ns:elem.ns[e[0]],local:e[1]}}return{ns:null,local:t}}function a(t){var e={};return t.split(";").forEach((function(t){var n=t.trim();if(n){var r=n.split("=");r.length&&(e[r[0].trim()]=r[1]?r[1].trim():"")}})),e}e.getAttribute=function(t,e){return t.getAttribute(e)},e.removeAttribute=r,e.setAttribute=i,e.setAttributes=o,e.attr=function(t,e,n){if(null==e){for(var r=t.attributes,s={},a=0;a<r.length;a+=1)s[r[a].name]=r[a].value;return s}if("string"==typeof e&&void 0===n)return t.getAttribute(e);"object"==typeof e?o(t,e):i(t,e,n)},e.qualifyAttr=s,e.kebablizeAttrs=function(t){var e={};return Object.keys(t).forEach((function(r){var i=n.includes(r)?r:(0,format.kebabCase)(r);e[i]=t[r]})),e},e.styleToObject=a,e.mergeAttrs=function t(e,n){return Object.keys(n).forEach((function(r){if("class"===r)e[r]=e[r]?e[r]+" "+n[r]:n[r];else if("style"===r){var i="object"==typeof e[r],o="object"==typeof n[r],s=void 0,l=void 0;i&&o?(s=e[r],l=n[r]):i?(s=e[r],l=a(n[r])):o?(s=a(e[r]),l=n[r]):(s=a(e[r]),l=a(n[r])),e[r]=t(s,l)}else e[r]=n[r]})),e}})),annotate_1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.shiftAnnotations=e.findAnnotationsBetweenIndexes=e.findAnnotationsAtIndex=e.annotate=void 0,e.annotate=function(t,e,n){void 0===n&&(n={});for(var r,i,o=n.offset||0,s=[],a=[],l=null,c=0;c<t.length;c+=1){r=a[c]=t[c];for(var u=0,h=e.length;u<h;u+=1){var d=e[u];c>=d.start+o&&c<d.end+o&&("string"==typeof r?r=a[c]={t:t[c],attrs:d.attrs}:r.attrs=(0,attr_1.mergeAttrs)((0,attr_1.mergeAttrs)({},r.attrs),d.attrs),n.includeAnnotationIndices&&(null==r.annotations&&(r.annotations=[]),r.annotations.push(u)))}(i=a[c-1])?object$1.ObjectExt.isObject(r)&&object$1.ObjectExt.isObject(i)?(l=l,JSON.stringify(r.attrs)===JSON.stringify(i.attrs)?l.t+=r.t:(s.push(l),l=r)):object$1.ObjectExt.isObject(r)||object$1.ObjectExt.isObject(i)?(s.push(l=l),l=r):l=(l||"")+r:l=r}return null!=l&&s.push(l),s},e.findAnnotationsAtIndex=function(t,e){return t?t.filter((function(t){return t.start<e&&e<=t.end})):[]},e.findAnnotationsBetweenIndexes=function(t,e,n){return t?t.filter((function(t){return e>=t.start&&e<t.end||n>t.start&&n<=t.end||t.start>=e&&t.end<n})):[]},e.shiftAnnotations=function(t,e,n){return t&&t.forEach((function(t){t.start<e&&t.end>=e?t.end+=n:t.start>=e&&(t.start+=n,t.end+=n)})),t}})),sanitize_1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.sanitize=void 0,e.sanitize=function(t){return t.replace(/ /g,"")}})),main$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(annotate_1,e),r(sanitize_1,e)})),text=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Text=void 0;var o=i(main$1);e.Text=o})),json=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.JSONExt=void 0,function(t){function e(t){return null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t}function n(t){return Array.isArray(t)}t.emptyObject=Object.freeze({}),t.emptyArray=Object.freeze([]),t.isPrimitive=e,t.isArray=n,t.isObject=function(t){return!e(t)&&!n(t)},t.deepEqual=function t(r,i){if(r===i)return!0;if(e(r)||e(i))return!1;var o=n(r),s=n(i);return o===s&&(o&&s?function(e,n){if(e===n)return!0;if(e.length!==n.length)return!1;for(var r=0,i=e.length;r<i;r+=1)if(!t(e[r],n[r]))return!1;return!0}(r,i):function(e,n){if(e===n)return!0;for(var r in e)if(!(r in n))return!1;for(var r in n)if(!(r in e))return!1;for(var r in e)if(!t(e[r],n[r]))return!1;return!0}(r,i))},t.deepCopy=function t(r){return e(r)?r:n(r)?function(e){for(var n=new Array(e.length),r=0,i=e.length;r<i;r+=1)n[r]=t(e[r]);return n}(r):function(e){var n={};return Object.keys(e).forEach((function(r){n[r]=t(e[r])})),n}(r)}}(e.JSONExt||(e.JSONExt={}))})),datauri=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.DataUri=void 0,function(t){function e(t){var e="data:";return t.substr(0,e.length)===e}function n(t){var e,n=t.replace(/\s/g,""),r=(n=decodeURIComponent(n)).indexOf(","),i=n.slice(0,r),o=i.split(":")[1].split(";")[0],s=n.slice(r+1);e=i.indexOf("base64")>=0?atob(s):unescape(encodeURIComponent(s));for(var a=new Uint8Array(e.length),l=0;l<e.length;l+=1)a[l]=e.charCodeAt(l);return new Blob([a],{type:o})}function r(t,e){var n=window.navigator.msSaveBlob;if(n)n(t,e);else{var r=window.URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)}}function i(t){var e=parseFloat(t);return Number.isNaN(e)?null:e}t.isDataUrl=e,t.imageToDataUri=function(t,n){if(t&&!e(t)){var r=function(){n(new Error("Failed to load image: "+t))},i=window.FileReader?function(t){if(200===t.status){var e=new FileReader;e.onload=function(t){n(null,t.target.result)},e.onerror=r,e.readAsDataURL(t.response)}else r()}:function(e){if(200===e.status){var i=t.split(".").pop()||"png";"svg"===i&&(i="svg+xml");var o="data:image/"+i+";base64,",s=new Uint8Array(e.response),a=o+btoa(function(t){for(var e=[],n=0;n<t.length;n+=32768)e.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return e.join("")}(s));n(null,a)}else r()},o=new XMLHttpRequest;o.responseType=window.FileReader?"blob":"arraybuffer",o.open("GET",t,!0),o.addEventListener("error",r),o.addEventListener("load",(function(){return i(o)})),o.send()}else setTimeout((function(){return n(null,t)}))},t.dataUriToBlob=n,t.downloadBlob=r,t.downloadDataUri=function(t,e){r(n(t),e)},t.svgToDataUrl=function(t,e){void 0===e&&(e={});var n=null,r=function(e){return null==n&&(n=function(t){var e=t.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return e&&e[2]?e[2].replace(/\s+/," ").split(" "):null}(t)),null!=n?i(n[e]):null},o=function(e){var n=t.match(e);return n&&n[2]?i(n[2]):null},s=e.width;if(null==s&&(s=o(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==s&&(s=r(2)),null==s)throw new Error("Can not parse width from svg string");var a=e.height;if(null==a&&(a=o(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==a&&(a=r(3)),null==a)throw new Error("Can not parse height from svg string");return"data:image/svg+xml,"+encodeURIComponent(t).replace(/'/g,"%27").replace(/"/g,"%22")}}(e.DataUri||(e.DataUri={}))})),unit=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Unit=void 0;var r,i=n(jquery),o={px:function(t){return t},mm:function(t){return r*t},cm:function(t){return r*t*10},in:function(t){return r*t*25.4},pt:function(t){return r*(25.4*t/72)},pc:function(t){return r*(25.4*t/6)}};!function(t){function e(t,e,n){var r=(0,i.default)("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+(n||""),height:e+(n||"")}).appendTo(document.body),o={width:r.width()||0,height:r.height()||0};return r.remove(),o}t.measure=e,t.toPx=function(t,n){null==r&&(r=e("1","1","mm").width);var i=n?o[n]:null;return i?i(t):t}}(e.Unit||(e.Unit={}))})),af=createCommonjsModule((function(t,e){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.cancelAnimationFrame=e.requestAnimationFrame=void 0,e.requestAnimationFrame=function(){var t,e=window;if(null!=e&&null!=(t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame)&&(t=t.bind(e)),null==t){var n=0;t=function(t){var e=(new Date).getTime(),r=Math.max(0,16-(e-n)),i=setTimeout((function(){t(e+r)}),r);return n=e+r,i}}return t}(),e.cancelAnimationFrame=(null!=(r=window)&&(n=r.cancelAnimationFrame||r.webkitCancelAnimationFrame||r.webkitCancelRequestAnimationFrame||r.msCancelAnimationFrame||r.msCancelRequestAnimationFrame||r.oCancelAnimationFrame||r.oCancelRequestAnimationFrame||r.mozCancelAnimationFrame||r.mozCancelRequestAnimationFrame)&&(n=n.bind(r)),null==n&&(n=clearTimeout),n)})),prefix=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getVendorPrefixedName=void 0;var n=/-(.)/g,r={},i=["Webkit","ms","Moz","O"],o=document?document.createElement("div").style:{};e.getVendorPrefixedName=function(t){var e=t.replace(n,(function(t,e){return e.toUpperCase()}));if(null==r[e]){var s=e.charAt(0).toUpperCase()+e.slice(1);r[e]=e in o?e:function(t){for(var e=0;e<i.length;e+=1){var n=i[e]+t;if(n in o)return n}return null}(s)}return r[e]}})),style=createCommonjsModule((function(t,e){function n(t,e){var n=t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):window.getComputedStyle(t,null);return n&&e?n.getPropertyValue(e)||n[e]:n}Object.defineProperty(e,"__esModule",{value:!0}),e.hasScrollbars=e.getComputedStyle=e.setPrefixedStyle=void 0,e.setPrefixedStyle=function(t,e,n){var r=(0,prefix.getVendorPrefixedName)(e);null!=r&&(t[r]=n),t[e]=n},e.getComputedStyle=n,e.hasScrollbars=function(t){var e=n(t);return null!=e&&("scroll"===e.overflow||"auto"===e.overflow)}})),selection=createCommonjsModule((function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.clearSelection=void 0,e.clearSelection=(n=document).selection?function(){n.selection.empty()}:window.getSelection?function(){var t=window.getSelection();t&&(t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges())}:function(){}})),angle=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Angle=void 0,function(t){t.toDeg=function(t){return 180*t/Math.PI%360},t.toRad=function(t,e){return void 0===e&&(e=!1),(e?t:t%360)*Math.PI/180},t.normalize=function(t){return t%360+(t<0?360:0)}}(e.Angle||(e.Angle={}))})),util$4=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.squaredLength=e.containsPoint=e.snapToGrid=e.clamp=e.random=e.round=void 0,e.round=function(t,e){return void 0===e&&(e=0),Number.isInteger(t)?t:+t.toFixed(e)},e.random=function(t,e){var n,r;if(null==e?(r=null==t?1:t,n=0):(r=e,n=null==t?0:t),r<n){var i=n;n=r,r=i}return Math.floor(Math.random()*(r-n+1)+n)},e.clamp=function(t,e,n){return Number.isNaN(t)?NaN:Number.isNaN(e)||Number.isNaN(n)?0:e<n?t<e?e:t>n?n:t:t<n?n:t>e?e:t},e.snapToGrid=function(t,e){return e*Math.round(t/e)},e.containsPoint=function(t,e){return null!=e&&null!=t&&e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height},e.squaredLength=function(t,e){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r}})),geometry$1=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Geometry=void 0;var n=function(){function t(){}return t.prototype.valueOf=function(){return this.toJSON()},t.prototype.toString=function(){return JSON.stringify(this.toJSON())},t}();e.Geometry=n})),point=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;var s=o(util$4),a=function(t){function e(e,n){var r=t.call(this)||this;return r.x=null==e?0:e,r.y=null==n?0:n,r}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),e.prototype.round=function(t){return void 0===t&&(t=0),this.x=s.round(this.x,t),this.y=s.round(this.y,t),this},e.prototype.add=function(t,n){var r=e.create(t,n);return this.x+=r.x,this.y+=r.y,this},e.prototype.update=function(t,n){var r=e.create(t,n);return this.x=r.x,this.y=r.y,this},e.prototype.translate=function(t,n){var r=e.create(t,n);return this.x+=r.x,this.y+=r.y,this},e.prototype.rotate=function(t,n){var r=e.rotate(this,t,n);return this.x=r.x,this.y=r.y,this},e.prototype.scale=function(t,n,r){void 0===r&&(r=new e);var i=e.create(r);return this.x=i.x+t*(this.x-i.x),this.y=i.y+n*(this.y-i.y),this},e.prototype.closest=function(t){var n=this;if(1===t.length)return e.create(t[0]);var r=null,i=1/0;return t.forEach((function(t){var e=n.squaredDistance(t);e<i&&(r=t,i=e)})),r?e.create(r):null},e.prototype.distance=function(t){return Math.sqrt(this.squaredDistance(t))},e.prototype.squaredDistance=function(t){var n=e.create(t),r=this.x-n.x,i=this.y-n.y;return r*r+i*i},e.prototype.manhattanDistance=function(t){var n=e.create(t);return Math.abs(n.x-this.x)+Math.abs(n.y-this.y)},e.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01},e.prototype.theta=function(t){void 0===t&&(t=new e);var n=e.create(t),r=Math.atan2(-(n.y-this.y),n.x-this.x);return r<0&&(r=2*Math.PI+r),180*r/Math.PI},e.prototype.angleBetween=function(t,e){if(this.equals(t)||this.equals(e))return NaN;var n=this.theta(e)-this.theta(t);return n<0&&(n+=360),n},e.prototype.vectorAngle=function(t){return new e(0,0).angleBetween(this,t)},e.prototype.toPolar=function(t){return this.update(e.toPolar(this,t)),this},e.prototype.changeInAngle=function(t,n,r){return void 0===r&&(r=new e),this.clone().translate(-t,-n).theta(r)-this.theta(r)},e.prototype.adhereToRect=function(t){return s.containsPoint(t,this)||(this.x=Math.min(Math.max(this.x,t.x),t.x+t.width),this.y=Math.min(Math.max(this.y,t.y),t.y+t.height)),this},e.prototype.bearing=function(t){var n=e.create(t),r=angle.Angle.toRad(this.y),i=angle.Angle.toRad(n.y),o=angle.Angle.toRad(n.x-this.x),s=Math.sin(o)*Math.cos(i),a=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(o),l=angle.Angle.toDeg(Math.atan2(s,a))-22.5;return l<0&&(l+=360),["NE","E","SE","S","SW","W","NW","N"][l=parseInt(l/45,10)]},e.prototype.cross=function(t,n){if(null!=t&&null!=n){var r=e.create(t),i=e.create(n);return(i.x-this.x)*(r.y-this.y)-(i.y-this.y)*(r.x-this.x)}return NaN},e.prototype.dot=function(t){var n=e.create(t);return this.x*n.x+this.y*n.y},e.prototype.diff=function(t,n){if("number"==typeof t)return new e(this.x-t,this.y-n);var r=e.create(t);return new e(this.x-r.x,this.y-r.y)},e.prototype.lerp=function(t,n){var r=e.create(t);return new e((1-n)*this.x+n*r.x,(1-n)*this.y+n*r.y)},e.prototype.normalize=function(t){void 0===t&&(t=1);var e=t/this.magnitude();return this.scale(e,e)},e.prototype.move=function(t,n){var r=e.create(t),i=angle.Angle.toRad(r.theta(this));return this.translate(Math.cos(i)*n,-Math.sin(i)*n)},e.prototype.reflection=function(t){return e.create(t).move(this,this.distance(t))},e.prototype.snapToGrid=function(t,e){return this.x=s.snapToGrid(this.x,t),this.y=s.snapToGrid(this.y,null==e?t:e),this},e.prototype.equals=function(t){var n=e.create(t);return null!=n&&n.x===this.x&&n.y===this.y},e.prototype.clone=function(){return e.clone(this)},e.prototype.toJSON=function(){return e.toJSON(this)},e.prototype.serialize=function(){return this.x+" "+this.y},e}(geometry$1.Geometry);e.Point=a,function(t){t.toStringTag="X6.Geometry."+t.name,t.isPoint=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"number"==typeof e.x&&"number"==typeof e.y&&"function"==typeof e.toPolar}}(a=e.Point||(e.Point={})),e.Point=a,function(t){t.isPointLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y},t.isPointData=function(t){return null!=t&&Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}}(a=e.Point||(e.Point={})),e.Point=a,function(t){function e(e){return t.isPoint(e)?new t(e.x,e.y):Array.isArray(e)?new t(e[0],e[1]):new t(e.x,e.y)}function n(t,e){return t===e||null!=t&&null!=e&&t.x===e.x&&t.y===e.y}function r(n,r,i,o){void 0===o&&(o=new t);var s=e(n),a=e(o),l=s.x-a.x,c=s.y-a.y;return new t(l*r-c*i+a.x,c*r+l*i+a.y)}t.create=function(n,r){return null==n||"number"==typeof n?new t(n,r):e(n)},t.clone=e,t.toJSON=function(e){return t.isPoint(e)?{x:e.x,y:e.y}:Array.isArray(e)?{x:e[0],y:e[1]}:{x:e.x,y:e.y}},t.fromPolar=function(n,r,i){void 0===i&&(i=new t);var o=Math.abs(n*Math.cos(r)),s=Math.abs(n*Math.sin(r)),a=e(i),l=angle.Angle.normalize(angle.Angle.toDeg(r));return l<90?s=-s:l<180?(o=-o,s=-s):l<270&&(o=-o),new t(a.x+o,a.y+s)},t.toPolar=function(n,r){void 0===r&&(r=new t);var i=e(n),o=e(r),s=i.x-o.x,a=i.y-o.y;return new t(Math.sqrt(s*s+a*a),angle.Angle.toRad(o.theta(i)))},t.equals=n,t.equalPoints=function(t,e){if(null==t&&null!=e||null!=t&&null==e||null!=t&&null!=e&&t.length!==e.length)return!1;if(null!=t&&null!=e)for(var r=0,i=t.length;r<i;r+=1)if(!n(t[r],e[r]))return!1;return!0},t.random=function(e,n,r,i){return new t(s.random(e,n),s.random(r,i))},t.rotate=function(t,e,n){var i=angle.Angle.toRad(angle.Angle.normalize(-e)),o=Math.sin(i);return r(t,Math.cos(i),o,n)},t.rotateEx=r}(a=e.Point||(e.Point={})),e.Point=a})),rectangle=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=void 0;var s=o(util$4),a=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.x=null==e?0:e,o.y=null==n?0:n,o.width=null==r?0:r,o.height=null==i?0:i,o}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return new point.Point(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new point.Point(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topCenter",{get:function(){return new point.Point(this.x+this.width/2,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new point.Point(this.x+this.width,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return new point.Point(this.x+this.width/2,this.y+this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new point.Point(this.x,this.y+this.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomCenter",{get:function(){return new point.Point(this.x+this.width/2,this.y+this.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new point.Point(this.x+this.width,this.y+this.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"corner",{get:function(){return new point.Point(this.x+this.width,this.y+this.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightMiddle",{get:function(){return new point.Point(this.x+this.width,this.y+this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftMiddle",{get:function(){return new point.Point(this.x,this.y+this.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topLine",{get:function(){return new line.Line(this.topLeft,this.topRight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightLine",{get:function(){return new line.Line(this.topRight,this.bottomRight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomLine",{get:function(){return new line.Line(this.bottomLeft,this.bottomRight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftLine",{get:function(){return new line.Line(this.topLeft,this.bottomLeft)},enumerable:!1,configurable:!0}),e.prototype.getOrigin=function(){return this.origin},e.prototype.getTopLeft=function(){return this.topLeft},e.prototype.getTopCenter=function(){return this.topCenter},e.prototype.getTopRight=function(){return this.topRight},e.prototype.getCenter=function(){return this.center},e.prototype.getCenterX=function(){return this.x+this.width/2},e.prototype.getCenterY=function(){return this.y+this.height/2},e.prototype.getBottomLeft=function(){return this.bottomLeft},e.prototype.getBottomCenter=function(){return this.bottomCenter},e.prototype.getBottomRight=function(){return this.bottomRight},e.prototype.getCorner=function(){return this.corner},e.prototype.getRightMiddle=function(){return this.rightMiddle},e.prototype.getLeftMiddle=function(){return this.leftMiddle},e.prototype.getTopLine=function(){return this.topLine},e.prototype.getRightLine=function(){return this.rightLine},e.prototype.getBottomLine=function(){return this.bottomLine},e.prototype.getLeftLine=function(){return this.leftLine},e.prototype.bbox=function(t){if(!t)return this.clone();var n=angle.Angle.toRad(t),r=Math.abs(Math.sin(n)),i=Math.abs(Math.cos(n)),o=this.width*i+this.height*r,s=this.width*r+this.height*i;return new e(this.x+(this.width-o)/2,this.y+(this.height-s)/2,o,s)},e.prototype.round=function(t){return void 0===t&&(t=0),this.x=s.round(this.x,t),this.y=s.round(this.y,t),this.width=s.round(this.width,t),this.height=s.round(this.height,t),this},e.prototype.add=function(t,n,r,i){var o=e.create(t,n,r,i),s=Math.min(this.x,o.x),a=Math.min(this.y,o.y),l=Math.max(this.x+this.width,o.x+o.width),c=Math.max(this.y+this.height,o.y+o.height);return this.x=s,this.y=a,this.width=l-s,this.height=c-a,this},e.prototype.update=function(t,n,r,i){var o=e.create(t,n,r,i);return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this},e.prototype.inflate=function(t,e){var n=t,r=null!=e?e:t;return this.x-=n,this.y-=r,this.width+=2*n,this.height+=2*r,this},e.prototype.snapToGrid=function(t,e){var n=this.origin.snapToGrid(t,e),r=this.corner.snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=r.x-n.x,this.height=r.y-n.y,this},e.prototype.translate=function(t,e){var n=point.Point.create(t,e);return this.x+=n.x,this.y+=n.y,this},e.prototype.scale=function(t,e,n){void 0===n&&(n=new point.Point);var r=this.origin.scale(t,e,n);return this.x=r.x,this.y=r.y,this.width*=t,this.height*=e,this},e.prototype.rotate=function(t,n){if(void 0===n&&(n=this.getCenter()),0!==t){var r=angle.Angle.toRad(t),i=Math.cos(r),o=Math.sin(r),s=this.getOrigin(),a=this.getTopRight(),l=this.getBottomRight(),c=this.getBottomLeft();s=point.Point.rotateEx(s,i,o,n),a=point.Point.rotateEx(a,i,o,n),l=point.Point.rotateEx(l,i,o,n),c=point.Point.rotateEx(c,i,o,n);var u=new e(s.x,s.y,0,0);u.add(a.x,a.y,0,0),u.add(l.x,l.y,0,0),u.add(c.x,c.y,0,0),this.update(u)}return this},e.prototype.rotate90=function(){var t=(this.width-this.height)/2;this.x+=t,this.y-=t;var e=this.width;return this.width=this.height,this.height=e,this},e.prototype.moveAndExpand=function(t){var n=e.clone(t);return this.x+=n.x||0,this.y+=n.y||0,this.width+=n.width||0,this.height+=n.height||0,this},e.prototype.getMaxScaleToFit=function(t,n){void 0===n&&(n=this.center);var r=e.clone(t),i=n.x,o=n.y,s=1/0,a=1/0,l=1/0,c=1/0,u=1/0,h=1/0,d=1/0,f=1/0,p=r.topLeft;p.x<i&&(s=(this.x-i)/(p.x-i)),p.y<o&&(u=(this.y-o)/(p.y-o));var g=r.bottomRight;g.x>i&&(a=(this.x+this.width-i)/(g.x-i)),g.y>o&&(h=(this.y+this.height-o)/(g.y-o));var m=r.topRight;m.x>i&&(l=(this.x+this.width-i)/(m.x-i)),m.y<o&&(d=(this.y-o)/(m.y-o));var A=r.bottomLeft;return A.x<i&&(c=(this.x-i)/(A.x-i)),A.y>o&&(f=(this.y+this.height-o)/(A.y-o)),{sx:Math.min(s,a,l,c),sy:Math.min(u,h,d,f)}},e.prototype.getMaxUniformScaleToFit=function(t,e){void 0===e&&(e=this.center);var n=this.getMaxScaleToFit(t,e);return Math.min(n.sx,n.sy)},e.prototype.containsPoint=function(t,e){return s.containsPoint(this,point.Point.create(t,e))},e.prototype.containsRect=function(t,n,r,i){var o=e.create(t,n,r,i),s=this.x,a=this.y,l=this.width,c=this.height,u=o.x,h=o.y,d=o.width,f=o.height;return 0!==l&&0!==c&&0!==d&&0!==f&&u>=s&&h>=a&&u+d<=s+l&&h+f<=a+c},e.prototype.intersectsWithLine=function(t){var e=[],n=[];return[this.topLine,this.rightLine,this.bottomLine,this.leftLine].forEach((function(r){var i=t.intersectsWithLine(r);null!==i&&n.indexOf(i.toString())<0&&(e.push(i),n.push(i.toString()))})),e.length>0?e:null},e.prototype.intersectsWithLineFromCenterToPoint=function(t,e){var n=point.Point.clone(t),r=this.center,i=null;null!=e&&0!==e&&n.rotate(e,r);for(var o=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],s=new line.Line(r,n),a=o.length-1;a>=0;a-=1){var l=o[a].intersectsWithLine(s);if(null!==l){i=l;break}}return i&&null!=e&&0!==e&&i.rotate(-e,r),i},e.prototype.intersectsWithRect=function(t,n,r,i){var o=e.create(t,n,r,i);if(!this.isIntersectWithRect(o))return null;var s=this.origin,a=this.corner,l=o.origin,c=o.corner,u=Math.max(s.x,l.x),h=Math.max(s.y,l.y);return new e(u,h,Math.min(a.x,c.x)-u,Math.min(a.y,c.y)-h)},e.prototype.isIntersectWithRect=function(t,n,r,i){var o=e.create(t,n,r,i),s=this.origin,a=this.corner,l=o.origin,c=o.corner;return!(c.x<=s.x||c.y<=s.y||l.x>=a.x||l.y>=a.y)},e.prototype.normalize=function(){var t=this.x,e=this.y,n=this.width,r=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,r=-this.height),this.x=t,this.y=e,this.width=n,this.height=r,this},e.prototype.union=function(t){var n=e.clone(t),r=this.origin,i=this.corner,o=n.origin,s=n.corner,a=Math.min(r.x,o.x),l=Math.min(r.y,o.y);return new e(a,l,Math.max(i.x,s.x)-a,Math.max(i.y,s.y)-l)},e.prototype.getNearestSideToPoint=function(t){var e=point.Point.clone(t),n=this.x+this.width-e.x,r=e.y-this.y,i=e.x-this.x,o="left";return n<i&&(i=n,o="right"),r<i&&(i=r,o="top"),this.y+this.height-e.y<i&&(o="bottom"),o},e.prototype.getNearestPointToPoint=function(t){var e=point.Point.clone(t);if(this.containsPoint(e))switch(this.getNearestSideToPoint(e)){case"right":return new point.Point(this.x+this.width,e.y);case"left":return new point.Point(this.x,e.y);case"bottom":return new point.Point(e.x,this.y+this.height);case"top":return new point.Point(e.x,this.y)}return e.adhereToRect(this)},e.prototype.equals=function(t){return null!=t&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.serialize=function(){return this.x+" "+this.y+" "+this.width+" "+this.height},e}(geometry$1.Geometry);e.Rectangle=a,function(t){t.toStringTag="X6.Geometry."+t.name,t.isRectangle=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.width&&"number"==typeof e.height&&"function"==typeof e.inflate&&"function"==typeof e.moveAndExpand}}(a=e.Rectangle||(e.Rectangle={})),e.Rectangle=a,function(t){t.isRectangleLike=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.width&&"number"==typeof t.height}}(a=e.Rectangle||(e.Rectangle={})),e.Rectangle=a,function(t){function e(e){return t.isRectangle(e)?e.clone():Array.isArray(e)?new t(e[0],e[1],e[2],e[3]):new t(e.x,e.y,e.width,e.height)}t.create=function(n,r,i,o){return null==n||"number"==typeof n?new t(n,r,i,o):e(n)},t.clone=e,t.fromSize=function(e){return new t(0,0,e.width,e.height)},t.fromPositionAndSize=function(e,n){return new t(e.x,e.y,n.width,n.height)},t.fromEllipse=function(e){return new t(e.x-e.a,e.y-e.b,2*e.a,2*e.b)}}(a=e.Rectangle||(e.Rectangle={})),e.Rectangle=a})),line=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Line=void 0;var r=function(t){function e(e,n,r,i){var o=t.call(this)||this;return"number"==typeof e&&"number"==typeof n?(o.start=new point.Point(e,n),o.end=new point.Point(r,i)):(o.start=point.Point.create(e),o.end=point.Point.create(n)),o}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return new point.Point((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},enumerable:!1,configurable:!0}),e.prototype.getCenter=function(){return this.center},e.prototype.round=function(t){return void 0===t&&(t=0),this.start.round(t),this.end.round(t),this},e.prototype.translate=function(t,e){return"number"==typeof t?(this.start.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.end.translate(t)),this},e.prototype.rotate=function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},e.prototype.scale=function(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this},e.prototype.length=function(){return Math.sqrt(this.squaredLength())},e.prototype.squaredLength=function(){var t=this.start.x-this.end.x,e=this.start.y-this.end.y;return t*t+e*e},e.prototype.setLength=function(t){var e=this.length();if(!e)return this;var n=t/e;return this.scale(n,n,this.start)},e.prototype.parallel=function(t){var e=this.clone();if(!e.isDifferentiable())return e;var n=e.start,r=e.end,i=n.clone().rotate(270,r),o=r.clone().rotate(90,n);return n.move(o,t),r.move(i,t),e},e.prototype.vector=function(){return new point.Point(this.end.x-this.start.x,this.end.y-this.start.y)},e.prototype.angle=function(){var t=new point.Point(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},e.prototype.bbox=function(){var t=Math.min(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),r=Math.max(this.start.y,this.end.y);return new rectangle.Rectangle(t,e,n-t,r-e)},e.prototype.bearing=function(){return this.start.bearing(this.end)},e.prototype.closestPoint=function(t){return this.pointAt(this.closestPointNormalizedLength(t))},e.prototype.closestPointLength=function(t){return this.closestPointNormalizedLength(t)*this.length()},e.prototype.closestPointTangent=function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},e.prototype.closestPointNormalizedLength=function(t){var n=this.vector().dot(new e(this.start,t).vector()),r=Math.min(1,Math.max(0,n/this.squaredLength()));return Number.isNaN(r)?0:r},e.prototype.pointAt=function(t){var e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)},e.prototype.pointAtLength=function(t){var e=this.start,n=this.end,r=!0;t<0&&(r=!1,t=-t);var i=this.length();return t>=i?r?n.clone():e.clone():this.pointAt((r?t:i-t)/i)},e.prototype.divideAt=function(t){var n=this.pointAt(t);return[new e(this.start,n),new e(n,this.end)]},e.prototype.divideAtLength=function(t){var n=this.pointAtLength(t);return[new e(this.start,n),new e(n,this.end)]},e.prototype.containsPoint=function(t){var n=this.start,r=this.end;if(0!==n.cross(t,r))return!1;var i=this.length();return!(new e(n,t).length()>i||new e(t,r).length()>i)},e.prototype.intersect=function(t,e){var n=t.intersectsWithLine(this,e);return n?Array.isArray(n)?n:[n]:null},e.prototype.intersectsWithLine=function(t){var e=new point.Point(this.end.x-this.start.x,this.end.y-this.start.y),n=new point.Point(t.end.x-t.start.x,t.end.y-t.start.y),r=e.x*n.y-e.y*n.x,i=new point.Point(t.start.x-this.start.x,t.start.y-this.start.y),o=i.x*n.y-i.y*n.x,s=i.x*e.y-i.y*e.x;if(0===r||o*r<0||s*r<0)return null;if(r>0){if(o>r||s>r)return null}else if(o<r||s<r)return null;return new point.Point(this.start.x+o*e.x/r,this.start.y+o*e.y/r)},e.prototype.isDifferentiable=function(){return!this.start.equals(this.end)},e.prototype.pointOffset=function(t){var e=point.Point.clone(t),n=this.start,r=this.end;return((r.x-n.x)*(e.y-n.y)-(r.y-n.y)*(e.x-n.x))/this.length()},e.prototype.pointSquaredDistance=function(t,e){var n=point.Point.create(t,e);return this.closestPoint(n).squaredDistance(n)},e.prototype.pointDistance=function(t,e){var n=point.Point.create(t,e);return this.closestPoint(n).distance(n)},e.prototype.tangentAt=function(t){if(!this.isDifferentiable())return null;var n=this.start,r=this.end,i=this.pointAt(t),o=new e(n,r);return o.translate(i.x-n.x,i.y-n.y),o},e.prototype.tangentAtLength=function(t){if(!this.isDifferentiable())return null;var n=this.start,r=this.end,i=this.pointAtLength(t),o=new e(n,r);return o.translate(i.x-n.x,i.y-n.y),o},e.prototype.relativeCcw=function(t,e){var n=point.Point.create(t,e),r=n.x-this.start.x,i=n.y-this.start.y,o=this.end.x-this.start.x,s=this.end.y-this.start.y,a=r*s-i*o;return 0===a&&(a=r*o+i*s)>0&&(a=(r-=o)*o+(i-=s)*s)<0&&(a=0),a<0?-1:a>0?1:0},e.prototype.equals=function(t){return null!=t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},e.prototype.clone=function(){return new e(this.start,this.end)},e.prototype.toJSON=function(){return{start:this.start.toJSON(),end:this.end.toJSON()}},e.prototype.serialize=function(){return[this.start.serialize(),this.end.serialize()].join(" ")},e}(geometry$1.Geometry);e.Line=r,function(t){t.toStringTag="X6.Geometry."+t.name,t.isLine=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag],r=e;try{if((null==n||n===t.toStringTag)&&point.Point.isPoint(r.start)&&point.Point.isPoint(r.end)&&"function"==typeof r.vector&&"function"==typeof r.bearing&&"function"==typeof r.parallel&&"function"==typeof r.intersect)return!0}catch(t){return!1}return!1}}(r=e.Line||(e.Line={})),e.Line=r})),ellipse=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Ellipse=void 0;var r=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.x=null==e?0:e,o.y=null==n?0:n,o.a=null==r?0:r,o.b=null==i?0:i,o}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return new point.Point(this.x,this.y)},enumerable:!1,configurable:!0}),e.prototype.bbox=function(){return rectangle.Rectangle.fromEllipse(this)},e.prototype.getCenter=function(){return this.center},e.prototype.inflate=function(t,e){var n=null!=e?e:t;return this.a+=2*t,this.b+=2*n,this},e.prototype.normalizedDistance=function(t,e){var n=point.Point.create(t,e),r=n.x-this.x,i=n.y-this.y,o=this.a,s=this.b;return r*r/(o*o)+i*i/(s*s)},e.prototype.containsPoint=function(t,e){return this.normalizedDistance(t,e)<=1},e.prototype.intersectsWithLine=function(t){var e=[],n=this.a,r=this.b,i=t.start,o=t.end,s=t.vector(),a=i.diff(new point.Point(this.x,this.y)),l=new point.Point(s.x/(n*n),s.y/(r*r)),c=new point.Point(a.x/(n*n),a.y/(r*r)),u=s.dot(l),h=s.dot(c),d=h*h-u*(a.dot(c)-1);if(d<0)return null;if(d>0){var f=Math.sqrt(d),p=(-h-f)/u,g=(-h+f)/u;if((p<0||p>1)&&(g<0||g>1))return null;p>=0&&p<=1&&e.push(i.lerp(o,p)),g>=0&&g<=1&&e.push(i.lerp(o,g))}else{var m=-h/u;if(!(m>=0&&m<=1))return null;e.push(i.lerp(o,m))}return e},e.prototype.intersectsWithLineFromCenterToPoint=function(t,e){void 0===e&&(e=0);var n=point.Point.clone(t);e&&n.rotate(e,this.getCenter());var r,i=n.x-this.x,o=n.y-this.y;if(0===i)return r=this.bbox().getNearestPointToPoint(n),e?r.rotate(-e,this.getCenter()):r;var s=o/i,a=Math.sqrt(1/(1/(this.a*this.a)+s*s/(this.b*this.b)));return r=new point.Point(this.x+(a=i<0?-a:a),this.y+s*a),e?r.rotate(-e,this.getCenter()):r},e.prototype.tangentTheta=function(t){var e,n,r=point.Point.clone(t),i=r.x,o=r.y,s=this.a,a=this.b,l=this.bbox().center,c=l.x,u=l.y;return i>l.x+s/2||i<l.x-s/2?e=s*s/(i-c)-s*s*(o-u)*((n=i>l.x?o-30:o+30)-u)/(a*a*(i-c))+c:n=a*a/(o-u)-a*a*(i-c)*((e=o>l.y?i+30:i-30)-c)/(s*s*(o-u))+u,new point.Point(e,n).theta(r)},e.prototype.scale=function(t,e){return this.a*=t,this.b*=e,this},e.prototype.rotate=function(t,n){var r=rectangle.Rectangle.fromEllipse(this);r.rotate(t,n);var i=e.fromRect(r);return this.a=i.a,this.b=i.b,this.x=i.x,this.y=i.y,this},e.prototype.translate=function(t,e){var n=point.Point.create(t,e);return this.x+=n.x,this.y+=n.y,this},e.prototype.equals=function(t){return null!=t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},e.prototype.clone=function(){return new e(this.x,this.y,this.a,this.b)},e.prototype.toJSON=function(){return{x:this.x,y:this.y,a:this.a,b:this.b}},e.prototype.serialize=function(){return this.x+" "+this.y+" "+this.a+" "+this.b},e}(geometry$1.Geometry);e.Ellipse=r,function(t){t.toStringTag="X6.Geometry."+t.name,t.isEllipse=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.a&&"number"==typeof e.b&&"function"==typeof e.inflate&&"function"==typeof e.normalizedDistance}}(r=e.Ellipse||(e.Ellipse={})),e.Ellipse=r,function(t){function e(e){return t.isEllipse(e)?e.clone():Array.isArray(e)?new t(e[0],e[1],e[2],e[3]):new t(e.x,e.y,e.a,e.b)}t.create=function(n,r,i,o){return null==n||"number"==typeof n?new t(n,r,i,o):e(n)},t.parse=e,t.fromRect=function(e){var n=e.center;return new t(n.x,n.y,e.width/2,e.height/2)}}(r=e.Ellipse||(e.Ellipse={})),e.Ellipse=r})),polyline=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Polyline=void 0;var r=function(t){function e(n){var r=t.call(this)||this;if(null!=n){if("string"==typeof n)return e.parse(n);r.points=n.map((function(t){return point.Point.create(t)}))}else r.points=[];return r}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return 0===this.points.length?null:this.points[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return 0===this.points.length?null:this.points[this.points.length-1]},enumerable:!1,configurable:!0}),e.prototype.scale=function(t,e,n){return void 0===n&&(n=new point.Point),this.points.forEach((function(r){return r.scale(t,e,n)})),this},e.prototype.rotate=function(t,e){return this.points.forEach((function(n){return n.rotate(t,e)})),this},e.prototype.translate=function(t,e){var n=point.Point.create(t,e);return this.points.forEach((function(t){return t.translate(n.x,n.y)})),this},e.prototype.bbox=function(){if(0===this.points.length)return new rectangle.Rectangle;for(var t=1/0,e=-1/0,n=1/0,r=-1/0,i=this.points,o=0,s=i.length;o<s;o+=1){var a=i[o],l=a.x,c=a.y;l<t&&(t=l),l>e&&(e=l),c<n&&(n=c),c>r&&(r=c)}return new rectangle.Rectangle(t,n,e-t,r-n)},e.prototype.closestPoint=function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},e.prototype.closestPointLength=function(t){var e=this.points,n=e.length;if(0===n||1===n)return 0;for(var r=0,i=0,o=1/0,s=0,a=n-1;s<a;s+=1){var l=new line.Line(e[s],e[s+1]),c=l.length(),u=l.closestPointNormalizedLength(t),h=l.pointAt(u).squaredDistance(t);h<o&&(o=h,i=r+u*c),r+=c}return i},e.prototype.closestPointNormalizedLength=function(t){var e=this.closestPointLength(t);if(0===e)return 0;var n=this.length();return 0===n?0:e/n},e.prototype.closestPointTangent=function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},e.prototype.containsPoint=function(t){if(0===this.points.length)return!1;for(var e=point.Point.clone(t),n=e.x,r=e.y,i=this.points,o=i.length,s=o-1,a=0,l=0;l<o;l+=1){var c=i[s],u=i[l];if(e.equals(c))return!0;var h=new line.Line(c,u);if(h.containsPoint(t))return!0;if(r<=c.y&&r>u.y||r>c.y&&r<=u.y){var d=c.x-n>u.x-n?c.x-n:u.x-n;if(d>=0){var f=new point.Point(n+d,r),p=new line.Line(t,f);h.intersectsWithLine(p)&&(a+=1)}}s=l}return a%2==1},e.prototype.intersectsWithLine=function(t){for(var e=[],n=0,r=this.points.length-1;n<r;n+=1){var i=t.intersectsWithLine(new line.Line(this.points[n],this.points[n+1]));i&&e.push(i)}return e.length>0?e:null},e.prototype.isDifferentiable=function(){for(var t=0,e=this.points.length-1;t<e;t+=1)if(new line.Line(this.points[t],this.points[t+1]).isDifferentiable())return!0;return!1},e.prototype.length=function(){for(var t=0,e=0,n=this.points.length-1;e<n;e+=1)t+=this.points[e].distance(this.points[e+1]);return t},e.prototype.pointAt=function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();if(t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();var r=this.length();return this.pointAtLength(r*t)},e.prototype.pointAtLength=function(t){var e=this.points,n=e.length;if(0===n)return null;if(1===n)return e[0].clone();var r=!0;t<0&&(r=!1,t=-t);for(var i=0,o=0,s=n-1;o<s;o+=1){var a=r?o:s-1-o,l=e[a],c=e[a+1],u=new line.Line(l,c),h=l.distance(c);if(t<=i+h)return u.pointAtLength((r?1:-1)*(t-i));i+=h}return(r?e[n-1]:e[0]).clone()},e.prototype.tangentAt=function(t){var e=this.points.length;if(0===e||1===e)return null;t<0&&(t=0),t>1&&(t=1);var n=this.length();return this.tangentAtLength(n*t)},e.prototype.tangentAtLength=function(t){var e=this.points,n=e.length;if(0===n||1===n)return null;var r,i=!0;t<0&&(i=!1,t=-t);for(var o=0,s=0,a=n-1;s<a;s+=1){var l=i?s:a-1-s,c=e[l],u=e[l+1],h=new line.Line(c,u),d=c.distance(u);if(h.isDifferentiable()){if(t<=o+d)return h.tangentAtLength((i?1:-1)*(t-o));r=h}o+=d}return r?r.tangentAt(i?1:0):null},e.prototype.simplify=function(t){void 0===t&&(t={});var e=this.points;if(e.length<3)return this;for(var n=t.threshold||0,r=0;e[r+2];){var i=r+1,o=e[i];new line.Line(e[r],e[r+2]).closestPoint(o).distance(o)<=n?e.splice(i,1):r+=1}return this},e.prototype.toHull=function(){var t=this.points,n=t.length;if(0===n)return new e;for(var r=t[0],i=1;i<n;i+=1)(t[i].y<r.y||t[i].y===r.y&&t[i].x>r.x)&&(r=t[i]);var o=[];for(i=0;i<n;i+=1){var s=r.theta(t[i]);0===s&&(s=360),o.push([t[i],i,s])}o.sort((function(t,e){var n=t[2]-e[2];return 0===n&&(n=e[1]-t[1]),n})),o.length>2&&o.unshift(o[o.length-1]);for(var a,l={},c=[],u=function(t){return t[0].toString()+"@"+t[1]};0!==o.length;){var h=o.pop(),d=h[0];if(!l[u(h)])for(var f=!1;!f;)if(c.length<2)c.push(h),f=!0;else{var p=c.pop(),g=p[0],m=c.pop(),A=m[0],y=A.cross(g,d);if(y<0)c.push(m),c.push(p),c.push(h),f=!0;else if(0===y){var v=g.angleBetween(A,d);Math.abs(v-180)<1e-10||g.equals(d)||A.equals(g)?(l[u(p)]=g,c.push(m)):Math.abs((v+1)%360-1)<1e-10&&(c.push(m),o.push(p))}else l[u(p)]=g,c.push(m)}}c.length>2&&c.pop();for(var b=-1,x=(i=0,c.length);i<x;i+=1){var w=c[i][1];(void 0===a||w<a)&&(a=w,b=i)}var C=[];if(b>0){var $=c.slice(b),_=c.slice(0,b);C=$.concat(_)}else C=c;var P=[];for(i=0,x=C.length;i<x;i+=1)P.push(C[i][0]);return new e(P)},e.prototype.equals=function(t){var e=this;return null!=t&&t.points.length===this.points.length&&t.points.every((function(t,n){return t.equals(e.points[n])}))},e.prototype.clone=function(){return new e(this.points.map((function(t){return t.clone()})))},e.prototype.toJSON=function(){return this.points.map((function(t){return t.toJSON()}))},e.prototype.serialize=function(){return this.points.map((function(t){return t.x+", "+t.y})).join(" ")},e}(geometry$1.Geometry);e.Polyline=r,function(t){t.toStringTag="X6.Geometry."+t.name,t.isPolyline=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&"function"==typeof e.toHull&&"function"==typeof e.simplify}}(r=e.Polyline||(e.Polyline={})),e.Polyline=r,function(t){t.parse=function(e){var n=e.trim();if(""===n)return new t;for(var r=[],i=n.split(/\s*,\s*|\s+/),o=0,s=i.length;o<s;o+=2)r.push({x:+i[o],y:+i[o+1]});return new t(r)}}(r=e.Polyline||(e.Polyline={})),e.Polyline=r})),curve=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Curve=void 0;var r=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.PRECISION=3,o.start=point.Point.create(e),o.controlPoint1=point.Point.create(n),o.controlPoint2=point.Point.create(r),o.end=point.Point.create(i),o}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),e.prototype.bbox=function(){for(var t,e,n,r,i,o,s,a,l,c,u,h=this.start,d=this.controlPoint1,f=this.controlPoint2,p=this.end,g=h.x,m=h.y,A=d.x,y=d.y,v=f.x,b=f.y,x=p.x,w=p.y,C=[],$=[],_=[[],[]],P=0;P<2;P+=1)if(0===P?(e=6*g-12*A+6*v,t=-3*g+9*A-9*v+3*x,n=3*A-3*g):(e=6*m-12*y+6*b,t=-3*m+9*y-9*b+3*w,n=3*y-3*m),Math.abs(t)<1e-12){if(Math.abs(e)<1e-12)continue;(r=-n/e)>0&&r<1&&$.push(r)}else s=e*e-4*n*t,a=Math.sqrt(s),s<0||((i=(-e+a)/(2*t))>0&&i<1&&$.push(i),(o=(-e-a)/(2*t))>0&&o<1&&$.push(o));for(var S=$.length,M=S;S;)_[0][S-=1]=l=(u=1-(r=$[S]))*u*u*g+3*u*u*r*A+3*u*r*r*v+r*r*r*x,_[1][S]=c=u*u*u*m+3*u*u*r*y+3*u*r*r*b+r*r*r*w,C[S]={X:l,Y:c};$[M]=0,$[M+1]=1,C[M]={X:g,Y:m},C[M+1]={X:x,Y:w},_[0][M]=g,_[1][M]=m,_[0][M+1]=x,_[1][M+1]=w,$.length=M+2,_[0].length=M+2,_[1].length=M+2,C.length=M+2;var E=Math.min.apply(null,_[0]),T=Math.min.apply(null,_[1]),k=Math.max.apply(null,_[0]),O=Math.max.apply(null,_[1]);return new rectangle.Rectangle(E,T,k-E,O-T)},e.prototype.closestPoint=function(t,e){return void 0===e&&(e={}),this.pointAtT(this.closestPointT(t,e))},e.prototype.closestPointLength=function(t,e){void 0===e&&(e={});var n=this.getOptions(e);return this.lengthAtT(this.closestPointT(t,n),n)},e.prototype.closestPointNormalizedLength=function(t,e){void 0===e&&(e={});var n=this.getOptions(e),r=this.closestPointLength(t,n);if(!r)return 0;var i=this.length(n);return 0===i?0:r/i},e.prototype.closestPointT=function(t,e){void 0===e&&(e={});var n=this.getPrecision(e),r=this.getDivisions(e),i=Math.pow(10,-n),o=null,s=0,a=0,l=0,c=0,u=0,h=null,d=r.length,f=d>0?1/d:0;for(r.forEach((function(e,n){var r=e.start.distance(t),i=e.end.distance(t),d=r+i;(null==h||d<h)&&(o=e,s=n*f,a=(n+1)*f,l=r,c=i,h=d,u=e.endpointDistance())}));;){var p=l?Math.abs(l-c)/l:0,g=null!=c?Math.abs(l-c)/c:0;if(p<i||g<i||!l||l<u*i||!c||c<u*i)return l<=c?s:a;var m=o.divide(.5);f/=2;var A=m[0].start.distance(t),y=m[0].end.distance(t),v=A+y,b=m[1].start.distance(t),x=m[1].end.distance(t);v<=b+x?(o=m[0],a-=f,l=A,c=y):(o=m[1],s+=f,l=b,c=x)}},e.prototype.closestPointTangent=function(t,e){return void 0===e&&(e={}),this.tangentAtT(this.closestPointT(t,e))},e.prototype.containsPoint=function(t,e){return void 0===e&&(e={}),this.toPolyline(e).containsPoint(t)},e.prototype.divideAt=function(t,e){if(void 0===e&&(e={}),t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);var n=this.tAt(t,e);return this.divideAtT(n)},e.prototype.divideAtLength=function(t,e){void 0===e&&(e={});var n=this.tAtLength(t,e);return this.divideAtT(n)},e.prototype.divide=function(t){return this.divideAtT(t)},e.prototype.divideAtT=function(t){var n=this.start,r=this.controlPoint1,i=this.controlPoint2,o=this.end;if(t<=0)return[new e(n,n,n,n),new e(n,r,i,o)];if(t>=1)return[new e(n,r,i,o),new e(o,o,o,o)];var s=this.getSkeletonPoints(t),a=s.divider,l=s.dividerControlPoint1,c=s.dividerControlPoint2;return[new e(n,s.startControlPoint1,s.startControlPoint2,a),new e(a,l,c,o)]},e.prototype.endpointDistance=function(){return this.start.distance(this.end)},e.prototype.getSkeletonPoints=function(t){var e=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:r.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:r.clone(),divider:i.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:i.clone()};var o=new line.Line(e,n).pointAt(t),s=new line.Line(n,r).pointAt(t),a=new line.Line(r,i).pointAt(t),l=new line.Line(o,s).pointAt(t),c=new line.Line(s,a).pointAt(t);return{startControlPoint1:o,startControlPoint2:l,divider:new line.Line(l,c).pointAt(t),dividerControlPoint1:c,dividerControlPoint2:a}},e.prototype.getSubdivisions=function(t){void 0===t&&(t={});var n=this.getPrecision(t),r=[new e(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===n)return r;for(var i=this.endpointDistance(),o=Math.pow(10,-n),s=0,a=function(){s+=1;var t=[];r.forEach((function(e){var n=e.divide(.5);t.push(n[0],n[1])}));var e=t.reduce((function(t,e){return t+e.endpointDistance()}),0);if(s>1&&(0!==e?(e-i)/e:0)<o)return{value:t};r=t,i=e};;){var l=a();if("object"==typeof l)return l.value}},e.prototype.length=function(t){return void 0===t&&(t={}),this.getDivisions(t).reduce((function(t,e){return t+e.endpointDistance()}),0)},e.prototype.lengthAtT=function(t,e){if(void 0===e&&(e={}),t<=0)return 0;var n=void 0===e.precision?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:n})},e.prototype.pointAt=function(t,e){if(void 0===e&&(e={}),t<=0)return this.start.clone();if(t>=1)return this.end.clone();var n=this.tAt(t,e);return this.pointAtT(n)},e.prototype.pointAtLength=function(t,e){void 0===e&&(e={});var n=this.tAtLength(t,e);return this.pointAtT(n)},e.prototype.pointAtT=function(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider},e.prototype.isDifferentiable=function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return!(this.start.equals(t)&&t.equals(e)&&e.equals(n))},e.prototype.tangentAt=function(t,e){if(void 0===e&&(e={}),!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var n=this.tAt(t,e);return this.tangentAtT(n)},e.prototype.tangentAtLength=function(t,e){if(void 0===e&&(e={}),!this.isDifferentiable())return null;var n=this.tAtLength(t,e);return this.tangentAtT(n)},e.prototype.tangentAtT=function(t){if(!this.isDifferentiable())return null;t<0&&(t=0),t>1&&(t=1);var e=this.getSkeletonPoints(t),n=e.startControlPoint2,r=e.divider,i=new line.Line(n,e.dividerControlPoint1);return i.translate(r.x-n.x,r.y-n.y),i},e.prototype.getPrecision=function(t){return void 0===t&&(t={}),null==t.precision?this.PRECISION:t.precision},e.prototype.getDivisions=function(t){if(void 0===t&&(t={}),null!=t.subdivisions)return t.subdivisions;var e=this.getPrecision(t);return this.getSubdivisions({precision:e})},e.prototype.getOptions=function(t){return void 0===t&&(t={}),{precision:this.getPrecision(t),subdivisions:this.getDivisions(t)}},e.prototype.tAt=function(t,e){if(void 0===e&&(e={}),t<=0)return 0;if(t>=1)return 1;var n=this.getOptions(e),r=this.length(n);return this.tAtLength(r*t,n)},e.prototype.tAtLength=function(t,e){void 0===e&&(e={});var n=!0;t<0&&(n=!1,t=-t);for(var r,i,o=this.getPrecision(e),s=this.getDivisions(e),a={precision:o,subdivisions:s},l=null,c=0,u=0,h=0,d=s.length,f=d>0?1/d:0,p=0;p<d;p+=1){var g=n?p:d-1-p,m=s[p],A=m.endpointDistance();if(t<=h+A){l=m,r=g*f,i=(g+1)*f,c=n?t-h:A+h-t,u=n?A+h-t:t-h;break}h+=A}if(null==l)return n?1:0;for(var y=this.length(a),v=Math.pow(10,-o);;){if((0!==y?c/y:0)<v)return r;if((0!==y?u/y:0)<v)return i;var b=void 0,x=void 0,w=l.divide(.5);f/=2;var C=w[0].endpointDistance(),$=w[1].endpointDistance();c<=C?(l=w[0],i-=f,x=C-(b=c)):(l=w[1],r+=f,x=$-(b=c-C)),c=b,u=x}},e.prototype.toPoints=function(t){void 0===t&&(t={});var e=this.getDivisions(t),n=[e[0].start.clone()];return e.forEach((function(t){return n.push(t.end.clone())})),n},e.prototype.toPolyline=function(t){return void 0===t&&(t={}),new polyline.Polyline(this.toPoints(t))},e.prototype.scale=function(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},e.prototype.rotate=function(t,e){return this.start.rotate(t,e),this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this},e.prototype.translate=function(t,e){return"number"==typeof t?(this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this},e.prototype.equals=function(t){return null!=t&&this.start.equals(t.start)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)&&this.end.equals(t.end)},e.prototype.clone=function(){return new e(this.start,this.controlPoint1,this.controlPoint2,this.end)},e.prototype.toJSON=function(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}},e.prototype.serialize=function(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")},e}(geometry$1.Geometry);e.Curve=r,function(t){t.toStringTag="X6.Geometry."+t.name,t.isCurve=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag],r=e;try{if((null==n||n===t.toStringTag)&&point.Point.isPoint(r.start)&&point.Point.isPoint(r.controlPoint1)&&point.Point.isPoint(r.controlPoint2)&&point.Point.isPoint(r.end)&&"function"==typeof r.toPoints&&"function"==typeof r.toPolyline)return!0}catch(t){return!1}return!1}}(r=e.Curve||(e.Curve={})),e.Curve=r,function(t){function e(t){var e=t.length,n=[],r=[],i=2;n[0]=t[0]/i;for(var o=1;o<e;o+=1)r[o]=1/i,n[o]=(t[o]-n[o-1])/(i=(o<e-1?4:3.5)-r[o]);for(o=1;o<e;o+=1)n[e-o-1]-=r[e-o]*n[e-o];return n}t.throughPoints=function(n){if(null==n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var r=function(t){var n=t.map((function(t){return point.Point.clone(t)})),r=[],i=[],o=n.length-1;if(1===o)return r[0]=new point.Point((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),i[0]=new point.Point(2*r[0].x-n[0].x,2*r[0].y-n[0].y),[r,i];for(var s=[],a=1;a<o-1;a+=1)s[a]=4*n[a].x+2*n[a+1].x;s[0]=n[0].x+2*n[1].x,s[o-1]=(8*n[o-1].x+n[o].x)/2;var l=e(s);for(a=1;a<o-1;a+=1)s[a]=4*n[a].y+2*n[a+1].y;s[0]=n[0].y+2*n[1].y,s[o-1]=(8*n[o-1].y+n[o].y)/2;var c=e(s);for(a=0;a<o;a+=1)r.push(new point.Point(l[a],c[a])),i.push(a<o-1?new point.Point(2*n[a+1].x-l[a+1],2*n[a+1].y-c[a+1]):new point.Point((n[o].x+l[o-1])/2,(n[o].y+c[o-1])/2));return[r,i]}(n),i=[],o=0,s=r[0].length;o<s;o+=1){var a=new point.Point(r[0][o].x,r[0][o].y),l=new point.Point(r[1][o].x,r[1][o].y);i.push(new t(n[o],a,l,n[o+1]))}return i}}(r=e.Curve||(e.Curve={})),e.Curve=r})),segment=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Segment=void 0;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isVisible=!0,e.isSegment=!0,e.isSubpathStart=!1,e}return n(e,t),Object.defineProperty(e.prototype,"end",{get:function(){return this.endPoint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end},enumerable:!1,configurable:!0}),e.prototype.closestPointT=function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")},e.prototype.lengthAtT=function(t){if(t<=0)return 0;var e=this.length();return t>=1?e:e*t},e.prototype.divideAtT=function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")},e.prototype.pointAtT=function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")},e.prototype.tangentAtT=function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")},e}(geometry$1.Geometry);e.Segment=r})),lineto=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.LineTo=void 0;var r=function(t){function e(e,n){var r=t.call(this)||this;return r.endPoint=line.Line.isLine(e)?e.end.clone().round(2):point.Point.create(e,n).round(2),r}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"L"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return new line.Line(this.start,this.end)},enumerable:!1,configurable:!0}),e.prototype.bbox=function(){return this.line.bbox()},e.prototype.closestPoint=function(t){return this.line.closestPoint(t)},e.prototype.closestPointLength=function(t){return this.line.closestPointLength(t)},e.prototype.closestPointNormalizedLength=function(t){return this.line.closestPointNormalizedLength(t)},e.prototype.closestPointTangent=function(t){return this.line.closestPointTangent(t)},e.prototype.length=function(){return this.line.length()},e.prototype.divideAt=function(t){var n=this.line.divideAt(t);return[new e(n[0]),new e(n[1])]},e.prototype.divideAtLength=function(t){var n=this.line.divideAtLength(t);return[new e(n[0]),new e(n[1])]},e.prototype.getSubdivisions=function(){return[]},e.prototype.pointAt=function(t){return this.line.pointAt(t)},e.prototype.pointAtLength=function(t){return this.line.pointAtLength(t)},e.prototype.tangentAt=function(t){return this.line.tangentAt(t)},e.prototype.tangentAtLength=function(t){return this.line.tangentAtLength(t)},e.prototype.isDifferentiable=function(){return null!=this.previousSegment&&!this.start.equals(this.end)},e.prototype.clone=function(){return new e(this.end)},e.prototype.scale=function(t,e,n){return this.end.scale(t,e,n),this},e.prototype.rotate=function(t,e){return this.end.rotate(t,e),this},e.prototype.translate=function(t,e){return"number"==typeof t?this.end.translate(t,e):this.end.translate(t),this},e.prototype.equals=function(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)},e.prototype.toJSON=function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}},e.prototype.serialize=function(){var t=this.end;return this.type+" "+t.x+" "+t.y},e}(segment.Segment);e.LineTo=r,function(t){t.create=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length,i=e[0];if(line.Line.isLine(i))return new t(i);if(point.Point.isPointLike(i))return 1===r?new t(i):e.map((function(e){return new t(e)}));if(2===r)return new t(+e[0],+e[1]);for(var o=[],s=0;s<r;s+=2){var a=+e[s],l=+e[s+1];o.push(new t(a,l))}return o}}(r=e.LineTo||(e.LineTo={})),e.LineTo=r})),close=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Close=void 0;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"end",{get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"Z"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return new line.Line(this.start,this.end)},enumerable:!1,configurable:!0}),e.prototype.bbox=function(){return this.line.bbox()},e.prototype.closestPoint=function(t){return this.line.closestPoint(t)},e.prototype.closestPointLength=function(t){return this.line.closestPointLength(t)},e.prototype.closestPointNormalizedLength=function(t){return this.line.closestPointNormalizedLength(t)},e.prototype.closestPointTangent=function(t){return this.line.closestPointTangent(t)},e.prototype.length=function(){return this.line.length()},e.prototype.divideAt=function(t){var e=this.line.divideAt(t);return[e[1].isDifferentiable()?new lineto.LineTo(e[0]):this.clone(),new lineto.LineTo(e[1])]},e.prototype.divideAtLength=function(t){var e=this.line.divideAtLength(t);return[e[1].isDifferentiable()?new lineto.LineTo(e[0]):this.clone(),new lineto.LineTo(e[1])]},e.prototype.getSubdivisions=function(){return[]},e.prototype.pointAt=function(t){return this.line.pointAt(t)},e.prototype.pointAtLength=function(t){return this.line.pointAtLength(t)},e.prototype.tangentAt=function(t){return this.line.tangentAt(t)},e.prototype.tangentAtLength=function(t){return this.line.tangentAtLength(t)},e.prototype.isDifferentiable=function(){return!(!this.previousSegment||!this.subpathStartSegment||this.start.equals(this.end))},e.prototype.scale=function(){return this},e.prototype.rotate=function(){return this},e.prototype.translate=function(){return this},e.prototype.equals=function(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)},e.prototype.clone=function(){return new e},e.prototype.toJSON=function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}},e.prototype.serialize=function(){return this.type},e}(segment.Segment);e.Close=r,function(t){t.create=function(){return new t}}(r=e.Close||(e.Close={})),e.Close=r})),moveto=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MoveTo=void 0;var r=function(t){function e(e,n){var r=t.call(this)||this;return r.isVisible=!1,r.isSubpathStart=!0,r.endPoint=line.Line.isLine(e)||curve.Curve.isCurve(e)?e.end.clone().round(2):point.Point.create(e,n).round(2),r}return n(e,t),Object.defineProperty(e.prototype,"start",{get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return"M"},enumerable:!1,configurable:!0}),e.prototype.bbox=function(){return null},e.prototype.closestPoint=function(){return this.end.clone()},e.prototype.closestPointLength=function(){return 0},e.prototype.closestPointNormalizedLength=function(){return 0},e.prototype.closestPointT=function(){return 1},e.prototype.closestPointTangent=function(){return null},e.prototype.length=function(){return 0},e.prototype.lengthAtT=function(){return 0},e.prototype.divideAt=function(){return[this.clone(),this.clone()]},e.prototype.divideAtLength=function(){return[this.clone(),this.clone()]},e.prototype.getSubdivisions=function(){return[]},e.prototype.pointAt=function(){return this.end.clone()},e.prototype.pointAtLength=function(){return this.end.clone()},e.prototype.pointAtT=function(){return this.end.clone()},e.prototype.tangentAt=function(){return null},e.prototype.tangentAtLength=function(){return null},e.prototype.tangentAtT=function(){return null},e.prototype.isDifferentiable=function(){return!1},e.prototype.scale=function(t,e,n){return this.end.scale(t,e,n),this},e.prototype.rotate=function(t,e){return this.end.rotate(t,e),this},e.prototype.translate=function(t,e){return"number"==typeof t?this.end.translate(t,e):this.end.translate(t),this},e.prototype.clone=function(){return new e(this.end)},e.prototype.equals=function(t){return this.type===t.type&&this.end.equals(t.end)},e.prototype.toJSON=function(){return{type:this.type,end:this.end.toJSON()}},e.prototype.serialize=function(){var t=this.end;return this.type+" "+t.x+" "+t.y},e}(segment.Segment);e.MoveTo=r,function(t){t.create=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length,i=e[0];if(line.Line.isLine(i))return new t(i);if(curve.Curve.isCurve(i))return new t(i);if(point.Point.isPointLike(i)){if(1===r)return new t(i);for(var o=[],s=0;s<r;s+=1)o.push(0===s?new t(e[s]):new lineto.LineTo(e[s]));return o}if(2===r)return new t(+e[0],+e[1]);var a=[];for(s=0;s<r;s+=2){var l=+e[s],c=+e[s+1];a.push(0===s?new t(l,c):new lineto.LineTo(l,c))}return a}}(r=e.MoveTo||(e.MoveTo={})),e.MoveTo=r})),curveto=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CurveTo=void 0;var r=function(t){function e(e,n,r,i,o,s){var a=t.call(this)||this;return curve.Curve.isCurve(e)?(a.controlPoint1=e.controlPoint1.clone().round(2),a.controlPoint2=e.controlPoint2.clone().round(2),a.endPoint=e.end.clone().round(2)):"number"==typeof e?(a.controlPoint1=new point.Point(e,n).round(2),a.controlPoint2=new point.Point(r,i).round(2),a.endPoint=new point.Point(o,s).round(2)):(a.controlPoint1=point.Point.create(e).round(2),a.controlPoint2=point.Point.create(n).round(2),a.endPoint=point.Point.create(r).round(2)),a}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"C"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curve",{get:function(){return new curve.Curve(this.start,this.controlPoint1,this.controlPoint2,this.end)},enumerable:!1,configurable:!0}),e.prototype.bbox=function(){return this.curve.bbox()},e.prototype.closestPoint=function(t){return this.curve.closestPoint(t)},e.prototype.closestPointLength=function(t){return this.curve.closestPointLength(t)},e.prototype.closestPointNormalizedLength=function(t){return this.curve.closestPointNormalizedLength(t)},e.prototype.closestPointTangent=function(t){return this.curve.closestPointTangent(t)},e.prototype.length=function(){return this.curve.length()},e.prototype.divideAt=function(t,n){void 0===n&&(n={});var r=this.curve.divideAt(t,n);return[new e(r[0]),new e(r[1])]},e.prototype.divideAtLength=function(t,n){void 0===n&&(n={});var r=this.curve.divideAtLength(t,n);return[new e(r[0]),new e(r[1])]},e.prototype.divideAtT=function(t){var n=this.curve.divideAtT(t);return[new e(n[0]),new e(n[1])]},e.prototype.getSubdivisions=function(){return[]},e.prototype.pointAt=function(t){return this.curve.pointAt(t)},e.prototype.pointAtLength=function(t){return this.curve.pointAtLength(t)},e.prototype.tangentAt=function(t){return this.curve.tangentAt(t)},e.prototype.tangentAtLength=function(t){return this.curve.tangentAtLength(t)},e.prototype.isDifferentiable=function(){if(!this.previousSegment)return!1;var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return!(this.start.equals(t)&&t.equals(e)&&e.equals(n))},e.prototype.scale=function(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},e.prototype.rotate=function(t,e){return this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this},e.prototype.translate=function(t,e){return"number"==typeof t?(this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this},e.prototype.equals=function(t){return this.start.equals(t.start)&&this.end.equals(t.end)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)},e.prototype.clone=function(){return new e(this.controlPoint1,this.controlPoint2,this.end)},e.prototype.toJSON=function(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}},e.prototype.serialize=function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return[this.type,t.x,t.y,e.x,e.y,n.x,n.y].join(" ")},e}(segment.Segment);e.CurveTo=r,function(t){t.create=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length,i=e[0];if(curve.Curve.isCurve(i))return new t(i);if(point.Point.isPointLike(i)){if(3===r)return new t(e[0],e[1],e[2]);for(var o=[],s=0;s<r;s+=3)o.push(new t(e[s],e[s+1],e[s+2]));return o}if(6===r)return new t(e[0],e[1],e[2],e[3],e[4],e[5]);var a=[];for(s=0;s<r;s+=6)a.push(new t(e[s],e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]));return a}}(r=e.CurveTo||(e.CurveTo={})),e.CurveTo=r})),normalize_1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))};function r(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function i(t,e,n,r,i,o){var s=1/3,a=2/3;return[s*t+a*n,s*e+a*r,s*i+a*n,s*o+a*r,i,o]}function o(t,e,n,i,s,a,l,c,u,h){var d,f,p,g,m,A=120*Math.PI/180,y=Math.PI/180*(+s||0),v=[];if(h)f=h[0],p=h[1],g=h[2],m=h[3];else{e=(d=r(t,e,-y)).y;var b=((t=d.x)-(c=(d=r(c,u,-y)).x))/2,x=(e-(u=d.y))/2,w=b*b/(n*n)+x*x/(i*i);w>1&&(n*=w=Math.sqrt(w),i*=w);var C=n*n,$=i*i,_=(a===l?-1:1)*Math.sqrt(Math.abs((C*$-C*x*x-$*b*b)/(C*x*x+$*b*b)));g=_*n*x/i+(t+c)/2,m=_*-i*b/n+(e+u)/2,f=Math.asin((e-m)/i),p=Math.asin((u-m)/i),f=t<g?Math.PI-f:f,p=c<g?Math.PI-p:p,f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),l&&f>p&&(f-=2*Math.PI),!l&&p>f&&(p-=2*Math.PI)}var P=p-f;if(Math.abs(P)>A){var S=p,M=c,E=u;p=f+A*(l&&p>f?1:-1),v=o(c=g+n*Math.cos(p),u=m+i*Math.sin(p),n,i,s,0,l,M,E,[p,S,g,m])}P=p-f;var T=Math.cos(f),k=Math.sin(f),O=Math.cos(p),N=Math.sin(p),R=Math.tan(P/4),L=4/3*(n*R),D=4/3*(i*R),j=[t,e],I=[t+L*k,e-D*T],F=[c+L*N,u-D*O],B=[c,u];if(I[0]=2*j[0]-I[0],I[1]=2*j[1]-I[1],h)return[I,F,B].concat(v);for(var z=[],G=(v=[I,F,B].concat(v).join().split(",")).length,V=0;V<G;V+=1)z[V]=V%2?r(+v[V-1],+v[V],y).y:r(+v[V],+v[V+1],y).x;return z}Object.defineProperty(e,"__esModule",{value:!0}),e.normalizePathData=void 0,e.normalizePathData=function(t){return function(t){var e=function(t){var e=function(t){if(!t)return null;var e="\t\n\v\f\r \u2028\u2029",r=new RegExp("([a-z])["+e+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+e+"]*,?["+e+"]*)+)","ig"),i=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+e+"]*,?["+e+"]*","ig"),o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=[];return t.replace(r,(function(t,e,r){var a=[],l=e.toLowerCase();r.replace(i,(function(t,e){return e&&a.push(+e),t})),"m"===l&&a.length>2&&(s.push(n([e],a.splice(0,2),!0)),l="l",e="m"===e?"l":"L");for(var c=o[l];a.length>=c&&(s.push(n([e],a.splice(0,c),!0)),c););return t})),s}(t);if(!e||!e.length)return[["M",0,0]];for(var r=0,i=0,o=0,s=0,a=[],l=0,c=e.length;l<c;l+=1){var u=[];a.push(u);var h=e[l],d=h[0];if(d!==d.toUpperCase())switch(u[0]=d.toUpperCase(),u[0]){case"A":u[1]=h[1],u[2]=h[2],u[3]=h[3],u[4]=h[4],u[5]=h[5],u[6]=+h[6]+r,u[7]=+h[7]+i;break;case"V":u[1]=+h[1]+i;break;case"H":u[1]=+h[1]+r;break;case"M":o=+h[1]+r,s=+h[2]+i;for(var f=1,p=h.length;f<p;f+=1)u[f]=+h[f]+(f%2?r:i);break;default:for(f=1,p=h.length;f<p;f+=1)u[f]=+h[f]+(f%2?r:i)}else for(f=0,p=h.length;f<p;f+=1)u[f]=h[f];switch(u[0]){case"Z":r=+o,i=+s;break;case"H":r=u[1];break;case"V":i=u[1];break;case"M":o=u[u.length-2],s=u[u.length-1],r=u[u.length-2],i=u[u.length-1];break;default:r=u[u.length-2],i=u[u.length-1]}}return a}(t),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function s(t,e,n){var r,s;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in{T:1,Q:1}||(e.qx=null,e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":return 0===parseFloat(t[1])||0===parseFloat(t[2])?["L",t[6],t[7]]:["C"].concat(o.apply(0,[e.x,e.y].concat(t.slice(1))));case"S":return"C"===n||"S"===n?(r=2*e.x-e.bx,s=2*e.y-e.by):(r=e.x,s=e.y),["C",r,s].concat(t.slice(1));case"T":return"Q"===n||"T"===n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),["C"].concat(i(e.x,e.y,e.qx,e.qy,t[1],t[2]));case"Q":return e.qx=t[1],e.qy=t[2],["C"].concat(i(e.x,e.y,t[1],t[2],t[3],t[4]));case"H":return["L"].concat(t[1],e.y);case"V":return["L"].concat(e.x,t[1])}return t}function a(t,n){if(t[n].length>7){t[n].shift();for(var r=t[n];r.length;)l[n]="A",t.splice(n+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1),u=e.length}}for(var l=[],c="",u=e.length,h=0;h<u;h+=1){var d="";e[h]&&(d=e[h][0]),"C"!==d&&(l[h]=d,h>0&&(c=l[h-1])),e[h]=s(e[h],r,c),"A"!==l[h]&&"C"===d&&(l[h]="C"),a(e,h);var f=e[h],p=f.length;r.x=f[p-2],r.y=f[p-1],r.bx=parseFloat(f[p-4])||r.x,r.by=parseFloat(f[p-3])||r.y}return e[0][0]&&"M"===e[0][0]||e.unshift(["M",0,0]),e}(t).map((function(t){return t.map((function(t){return"string"==typeof t?t:(0,util$4.round)(t,2)}))})).join(",").split(",").join(" ")}})),util$3=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.drawArc=e.arcToCurves=e.drawPoints=e.isValid=void 0;var n=new RegExp("^[\\s\\dLMCZz,.]*$");function r(t,e){return(t%e+e)%e}function i(t,e,n,r,i,o,s,a,l){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),0===n||0===r)return[];a-=t,l-=e,n=Math.abs(n),r=Math.abs(r);var c,u=-a/2,h=-l/2,d=Math.cos(i*Math.PI/180),f=Math.sin(i*Math.PI/180),p=d*u+f*h,g=-1*f*u+d*h,m=p*p,A=g*g,y=n*n,v=r*r,b=m/y+A/v;if(b>1)n=Math.sqrt(b)*n,r=Math.sqrt(b)*r,c=0;else{var x=1;o===s&&(x=-1),c=x*Math.sqrt((y*v-y*A-v*m)/(y*A+v*m))}var w=c*n*g/r,C=-1*c*r*p/n,$=d*w-f*C+a/2,_=f*w+d*C+l/2,P=Math.atan2((g-C)/r,(p-w)/n)-Math.atan2(0,1),S=P>=0?P:2*Math.PI+P,M=(P=Math.atan2((-g-C)/r,(-p-w)/n)-Math.atan2((g-C)/r,(p-w)/n))>=0?P:2*Math.PI+P;0===s&&M>0?M-=2*Math.PI:0!==s&&M<0&&(M+=2*Math.PI);for(var E=2*M/Math.PI,T=Math.ceil(E<0?-1*E:E),k=M/T,O=8/3*Math.sin(k/4)*Math.sin(k/4)/Math.sin(k/2),N=d*n,R=d*r,L=f*n,D=f*r,j=Math.cos(S),I=Math.sin(S),F=-O*(N*I+D*j),B=-O*(L*I-R*j),z=0,G=0,V=[],W=0;W<T;W+=1){S+=k,z=N*(j=Math.cos(S))-D*(I=Math.sin(S))+$,G=L*j+R*I+_;var H=-O*(N*I+D*j),U=-O*(L*I-R*j),q=6*W;V[q]=Number(F+t),V[q+1]=Number(B+e),V[q+2]=Number(z-H+t),V[q+3]=Number(G-U+e),V[q+4]=Number(z+t),V[q+5]=Number(G+e),F=z+H,B=G+U}return V.map((function(t){return+t.toFixed(2)}))}e.isValid=function(t){return"string"==typeof t&&n.test(t)},e.drawPoints=function(t,e){void 0===e&&(e={});var n=[];return t&&t.length&&t.forEach((function(t){Array.isArray(t)?n.push({x:t[0],y:t[1]}):n.push({x:t.x,y:t.y})})),function(t,e,n,i,o){var s=[],a=t[t.length-1],l=null!=e&&e>0,c=e||0;if(i&&l){var u=(t=t.slice())[0],h=new point.Point(a.x+(u.x-a.x)/2,a.y+(u.y-a.y)/2);t.splice(0,0,h)}var d=t[0],f=1;for(s.push(n?"M":"L",d.x,d.y);f<(i?t.length:t.length-1);){var p=t[r(f,t.length)],g=d.x-p.x,m=d.y-p.y;if(l&&(0!==g||0!==m)&&(null==o||o.indexOf(f-1)<0)){var A=Math.sqrt(g*g+m*m),y=g*Math.min(c,A/2)/A,v=m*Math.min(c,A/2)/A;s.push("L",p.x+y,p.y+v);for(var b=t[r(f+1,t.length)];f<t.length-2&&0===Math.round(b.x-p.x)&&0===Math.round(b.y-p.y);)b=t[r(f+2,t.length)],f+=1;g=b.x-p.x,m=b.y-p.y,A=Math.max(1,Math.sqrt(g*g+m*m));var x=g*Math.min(c,A/2)/A,w=m*Math.min(c,A/2)/A,C=p.x+x,$=p.y+w;s.push("Q",p.x,p.y,C,$),p=new point.Point(C,$)}else s.push("L",p.x,p.y);d=p,f+=1}return i?s.push("Z"):s.push("L",a.x,a.y),s.map((function(t){return"string"==typeof t?t:+t.toFixed(3)})).join(" ")}(n,e.round,null==e.initialMove||e.initialMove,e.close,e.exclude)},e.arcToCurves=i,e.drawArc=function(t,e,n,r,o,s,a,l,c){void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0);var u=[],h=i(t,e,n,r,o,s,a,l,c);if(null!=h)for(var d=0,f=h.length;d<f;d+=6)u.push("C",h[d],h[d+1],h[d+2],h[d+3],h[d+4],h[d+5]);return u.join(" ")}})),path$2=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=commonjsGlobal&&commonjsGlobal.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;var a=o(util$3),l=function(t){function e(n){var r=t.call(this)||this;if(r.PRECISION=3,r.segments=[],Array.isArray(n))if(line.Line.isLine(n[0])||curve.Curve.isCurve(n[0])){var i=null;n.forEach((function(t,n){0===n&&r.appendSegment(e.createSegment("M",t.start)),null==i||i.end.equals(t.start)||r.appendSegment(e.createSegment("M",t.start)),line.Line.isLine(t)?r.appendSegment(e.createSegment("L",t.end)):curve.Curve.isCurve(t)&&r.appendSegment(e.createSegment("C",t.controlPoint1,t.controlPoint2,t.end)),i=t}))}else n.forEach((function(t){t.isSegment&&r.appendSegment(t)}));else null!=n&&(line.Line.isLine(n)?(r.appendSegment(e.createSegment("M",n.start)),r.appendSegment(e.createSegment("L",n.end))):curve.Curve.isCurve(n)?(r.appendSegment(e.createSegment("M",n.start)),r.appendSegment(e.createSegment("C",n.controlPoint1,n.controlPoint2,n.end))):polyline.Polyline.isPolyline(n)?n.points&&n.points.length&&n.points.forEach((function(t,n){var i=e.createSegment(0===n?"M":"L",t);r.appendSegment(i)})):n.isSegment&&r.appendSegment(n));return r}return n(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return e.toStringTag},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var n=0;n<e;n+=1){var r=t[n];if(r.isVisible)return r.start}return t[e-1].end},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){var t=this.segments,e=t.length;if(0===e)return null;for(var n=e-1;n>=0;n-=1){var r=t[n];if(r.isVisible)return r.end}return t[e-1].end},enumerable:!1,configurable:!0}),e.prototype.moveTo=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.appendSegment((t=moveto.MoveTo.create).call.apply(t,s([null],e,!1)))},e.prototype.lineTo=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.appendSegment((t=lineto.LineTo.create).call.apply(t,s([null],e,!1)))},e.prototype.curveTo=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.appendSegment((t=curveto.CurveTo.create).call.apply(t,s([null],e,!1)))},e.prototype.arcTo=function(t,e,n,r,i,o,s){var l=this.end||new point.Point,c="number"==typeof o?a.arcToCurves(l.x,l.y,t,e,n,r,i,o,s):a.arcToCurves(l.x,l.y,t,e,n,r,i,o.x,o.y);if(null!=c)for(var u=0,h=c.length;u<h;u+=6)this.curveTo(c[u],c[u+1],c[u+2],c[u+3],c[u+4],c[u+5]);return this},e.prototype.quadTo=function(t,n,r,i){var o=this.end||new point.Point,s=["M",o.x,o.y];"number"==typeof t?s.push("Q",t,n,r,i):s.push("Q",t.x,t.y,n.x,n.y);var a=e.parse(s.join(" "));return this.appendSegment(a.segments.slice(1)),this},e.prototype.close=function(){return this.appendSegment(close.Close.create())},e.prototype.drawPoints=function(t,n){void 0===n&&(n={});var r=a.drawPoints(t,n),i=e.parse(r);i&&i.segments&&this.appendSegment(i.segments)},e.prototype.bbox=function(){var t,e=this.segments,n=e.length;if(0===n)return null;for(var r=0;r<n;r+=1){var i=e[r];if(i.isVisible){var o=i.bbox();null!=o&&(t=t?t.union(o):o)}}if(null!=t)return t;var s=e[n-1];return new rectangle.Rectangle(s.end.x,s.end.y,0,0)},e.prototype.appendSegment=function(t){var e,n=this.segments.length,r=0!==n?this.segments[n-1]:null;if(Array.isArray(t))for(var i=0,o=t.length;i<o;i+=1)e=this.prepareSegment(t[i],r,null),this.segments.push(e),r=e;else null!=t&&t.isSegment&&(e=this.prepareSegment(t,r,null),this.segments.push(e));return this},e.prototype.insertSegment=function(t,e){var n,r=this.segments.length;if(t<0&&(t=r+t+1),t>r||t<0)throw new Error("Index out of range.");var i=null,o=null;if(0!==r&&(t>=1?o=(i=this.segments[t-1]).nextSegment:(i=null,o=this.segments[0])),Array.isArray(e))for(var s=0,a=e.length;s<a;s+=1)n=this.prepareSegment(e[s],i,o),this.segments.splice(t+s,0,n),i=n;else n=this.prepareSegment(e,i,o),this.segments.splice(t,0,n);return this},e.prototype.removeSegment=function(t){var e=this.fixIndex(t),n=this.segments.splice(e,1)[0],r=n.previousSegment,i=n.nextSegment;return r&&(r.nextSegment=i),i&&(i.previousSegment=r),n.isSubpathStart&&i&&this.updateSubpathStartSegment(i),n},e.prototype.replaceSegment=function(t,e){var n,r=this.fixIndex(t),i=this.segments[r],o=i.previousSegment,s=i.nextSegment,a=i.isSubpathStart;if(Array.isArray(e)){this.segments.splice(t,1);for(var l=0,c=e.length;l<c;l+=1)n=this.prepareSegment(e[l],o,s),this.segments.splice(t+l,0,n),o=n,a&&n.isSubpathStart&&(a=!1)}else n=this.prepareSegment(e,o,s),this.segments.splice(r,1,n),a&&n.isSubpathStart&&(a=!1);a&&s&&this.updateSubpathStartSegment(s)},e.prototype.getSegment=function(t){var e=this.fixIndex(t);return this.segments[e]},e.prototype.fixIndex=function(t){var e=this.segments.length;if(0===e)throw new Error("Path has no segments.");for(var n=t;n<0;)n=e+n;if(n>=e||n<0)throw new Error("Index out of range.");return n},e.prototype.segmentAt=function(t,e){void 0===e&&(e={});var n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null},e.prototype.segmentAtLength=function(t,e){void 0===e&&(e={});var n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null},e.prototype.segmentIndexAt=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;var n=(0,util$4.clamp)(t,0,1),r=this.getOptions(e),i=this.length(r);return this.segmentIndexAtLength(i*n,r)},e.prototype.segmentIndexAtLength=function(t,e){void 0===e&&(e={});var n=this.segments.length;if(0===n)return null;var r=!0;t<0&&(r=!1,t=-t);for(var i=this.getPrecision(e),o=this.getSubdivisions(e),s=0,a=null,l=0;l<n;l+=1){var c=r?l:n-1-l,u=this.segments[c],h=u.length({precision:i,subdivisions:o[c]});if(u.isVisible){if(t<=s+h)return c;a=c}s+=h}return a},e.prototype.getSegmentSubdivisions=function(t){void 0===t&&(t={});for(var e=this.getPrecision(t),n=[],r=0,i=this.segments.length;r<i;r+=1){var o=this.segments[r].getSubdivisions({precision:e});n.push(o)}return n},e.prototype.updateSubpathStartSegment=function(t){for(var e=t.previousSegment,n=t;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=e?e.subpathStartSegment:null,e=n,n=n.nextSegment},e.prototype.prepareSegment=function(t,e,n){t.previousSegment=e,t.nextSegment=n,null!=e&&(e.nextSegment=t),null!=n&&(n.previousSegment=t);var r=t;return t.isSubpathStart&&(t.subpathStartSegment=t,r=n),null!=r&&this.updateSubpathStartSegment(r),t},e.prototype.closestPoint=function(t,e){void 0===e&&(e={});var n=this.closestPointT(t,e);return n?this.pointAtT(n):null},e.prototype.closestPointLength=function(t,e){void 0===e&&(e={});var n=this.getOptions(e),r=this.closestPointT(t,n);return r?this.lengthAtT(r,n):0},e.prototype.closestPointNormalizedLength=function(t,e){void 0===e&&(e={});var n=this.getOptions(e),r=this.closestPointLength(t,n);if(0===r)return 0;var i=this.length(n);return 0===i?0:r/i},e.prototype.closestPointT=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;for(var n,r=this.getPrecision(e),i=this.getSubdivisions(e),o=1/0,s=0,a=this.segments.length;s<a;s+=1){var l=this.segments[s];if(l.isVisible){var c=l.closestPointT(t,{precision:r,subdivisions:i[s]}),u=l.pointAtT(c),h=(0,util$4.squaredLength)(u,t);h<o&&(n={segmentIndex:s,value:c},o=h)}}return n||{segmentIndex:this.segments.length-1,value:1}},e.prototype.closestPointTangent=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;for(var n,r=this.getPrecision(e),i=this.getSubdivisions(e),o=1/0,s=0,a=this.segments.length;s<a;s+=1){var l=this.segments[s],c=i[s];if(l.isDifferentiable()){var u=l.closestPointT(t,{precision:r,subdivisions:c}),h=l.pointAtT(u),d=(0,util$4.squaredLength)(h,t);d<o&&(n=l.tangentAtT(u),o=d)}}return n||null},e.prototype.containsPoint=function(t,e){void 0===e&&(e={});var n=this.toPolylines(e);if(!n)return!1;for(var r=0,i=0,o=n.length;i<o;i+=1)n[i].containsPoint(t)&&(r+=1);return r%2==1},e.prototype.pointAt=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();var n=this.getOptions(e),r=this.length(n);return this.pointAtLength(r*t,n)},e.prototype.pointAtLength=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;if(0===t)return this.start.clone();var n=!0;t<0&&(n=!1,t=-t);for(var r,i=this.getPrecision(e),o=this.getSubdivisions(e),s=0,a=0,l=this.segments.length;a<l;a+=1){var c=n?a:l-1-a,u=this.segments[c],h=o[c],d=u.length({precision:i,subdivisions:h});if(u.isVisible){if(t<=s+d)return u.pointAtLength((n?1:-1)*(t-s),{precision:i,subdivisions:h});r=u}s+=d}return r?n?r.end:r.start:this.segments[this.segments.length-1].end.clone()},e.prototype.pointAtT=function(t){var e=this.segments,n=e.length;if(0===n)return null;var r=t.segmentIndex;if(r<0)return e[0].pointAtT(0);if(r>=n)return e[n-1].pointAtT(1);var i=(0,util$4.clamp)(t.value,0,1);return e[r].pointAtT(i)},e.prototype.divideAt=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;var n=(0,util$4.clamp)(t,0,1),r=this.getOptions(e),i=this.length(r);return this.divideAtLength(i*n,r)},e.prototype.divideAtLength=function(t,n){if(void 0===n&&(n={}),0===this.segments.length)return null;var r=!0;t<0&&(r=!1,t=-t);for(var i,o,s,a,l=this.getPrecision(n),c=this.getSubdivisions(n),u=0,h=0,d=this.segments.length;h<d;h+=1){var f=r?h:d-1-h,p=this.getSegment(f),g={precision:l,subdivisions:c[f]},m=p.length(g);if(p.isDifferentiable()&&(s=p,a=f,t<=u+m)){o=f,i=p.divideAtLength((r?1:-1)*(t-u),g);break}u+=m}if(!s)return null;i||(o=a,i=s.divideAtT(r?1:0));var A=this.clone(),y=o;A.replaceSegment(y,i);var v=y,b=y+1,x=y+2;i[0].isDifferentiable()||(A.removeSegment(v),b-=1,x-=1);var w=A.getSegment(b).start;A.insertSegment(b,e.createSegment("M",w)),x+=1,i[1].isDifferentiable()||(A.removeSegment(x-1),x-=1);var C=x-v-1;for(h=x,d=A.segments.length;h<d;h+=1){var $=this.getSegment(h-C);if("Z"===(p=A.getSegment(h)).type&&!$.subpathStartSegment.end.equals(p.subpathStartSegment.end)){var _=e.createSegment("L",$.end);A.replaceSegment(h,_)}}return[new e(A.segments.slice(0,b)),new e(A.segments.slice(b))]},e.prototype.intersectsWithLine=function(t,e){void 0===e&&(e={});var n=this.toPolylines(e);if(null==n)return null;for(var r=null,i=0,o=n.length;i<o;i+=1){var s=t.intersect(n[i]);s&&(null==r&&(r=[]),Array.isArray(s)?r.push.apply(r,s):r.push(s))}return r},e.prototype.isDifferentiable=function(){for(var t=0,e=this.segments.length;t<e;t+=1)if(this.segments[t].isDifferentiable())return!0;return!1},e.prototype.isValid=function(){var t=this.segments;return 0===t.length||"M"===t[0].type},e.prototype.length=function(t){if(void 0===t&&(t={}),0===this.segments.length)return 0;for(var e=this.getSubdivisions(t),n=0,r=0,i=this.segments.length;r<i;r+=1)n+=this.segments[r].length({subdivisions:e[r]});return n},e.prototype.lengthAtT=function(t,e){void 0===e&&(e={});var n=this.segments.length;if(0===n)return 0;var r=t.segmentIndex;if(r<0)return 0;var i=(0,util$4.clamp)(t.value,0,1);r>=n&&(r=n-1,i=1);for(var o=this.getPrecision(e),s=this.getSubdivisions(e),a=0,l=0;l<r;l+=1)a+=this.segments[l].length({precision:o,subdivisions:s[l]});return a+this.segments[r].lengthAtT(i,{precision:o,subdivisions:s[r]})},e.prototype.tangentAt=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;var n=(0,util$4.clamp)(t,0,1),r=this.getOptions(e),i=this.length(r);return this.tangentAtLength(i*n,r)},e.prototype.tangentAtLength=function(t,e){if(void 0===e&&(e={}),0===this.segments.length)return null;var n=!0;t<0&&(n=!1,t=-t);for(var r,i=this.getPrecision(e),o=this.getSubdivisions(e),s=0,a=0,l=this.segments.length;a<l;a+=1){var c=n?a:l-1-a,u=this.segments[c],h=o[c],d=u.length({precision:i,subdivisions:h});if(u.isDifferentiable()){if(t<=s+d)return u.tangentAtLength((n?1:-1)*(t-s),{precision:i,subdivisions:h});r=u}s+=d}return r?r.tangentAtT(n?1:0):null},e.prototype.tangentAtT=function(t){var e=this.segments.length;if(0===e)return null;var n=t.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=e)return this.segments[e-1].tangentAtT(1);var r=(0,util$4.clamp)(t.value,0,1);return this.segments[n].tangentAtT(r)},e.prototype.getPrecision=function(t){return void 0===t&&(t={}),null==t.precision?this.PRECISION:t.precision},e.prototype.getSubdivisions=function(t){if(void 0===t&&(t={}),null==t.segmentSubdivisions){var e=this.getPrecision(t);return this.getSegmentSubdivisions({precision:e})}return t.segmentSubdivisions},e.prototype.getOptions=function(t){return void 0===t&&(t={}),{precision:this.getPrecision(t),segmentSubdivisions:this.getSubdivisions(t)}},e.prototype.toPoints=function(t){void 0===t&&(t={});var e=this.segments,n=e.length;if(0===n)return null;for(var r=this.getSubdivisions(t),i=[],o=[],s=0;s<n;s+=1){var a=e[s];if(a.isVisible){var l=r[s];l.length>0?l.forEach((function(t){return o.push(t.start)})):o.push(a.start)}else o.length>0&&(o.push(e[s-1].end),i.push(o),o=[])}return o.length>0&&(o.push(this.end),i.push(o)),i},e.prototype.toPolylines=function(t){void 0===t&&(t={});var e=this.toPoints(t);return e?e.map((function(t){return new polyline.Polyline(t)})):null},e.prototype.scale=function(t,e,n){return this.segments.forEach((function(r){return r.scale(t,e,n)})),this},e.prototype.rotate=function(t,e){return this.segments.forEach((function(n){return n.rotate(t,e)})),this},e.prototype.translate=function(t,e){return this.segments.forEach("number"==typeof t?function(n){return n.translate(t,e)}:function(e){return e.translate(t)}),this},e.prototype.clone=function(){var t=new e;return this.segments.forEach((function(e){return t.appendSegment(e.clone())})),t},e.prototype.equals=function(t){if(null==t)return!1;var e=this.segments,n=t.segments,r=e.length;if(n.length!==r)return!1;for(var i=0;i<r;i+=1){var o=e[i],s=n[i];if(o.type!==s.type||!o.equals(s))return!1}return!0},e.prototype.toJSON=function(){return this.segments.map((function(t){return t.toJSON()}))},e.prototype.serialize=function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((function(t){return t.serialize()})).join(" ")},e.prototype.toString=function(){return this.serialize()},e}(geometry$1.Geometry);e.Path=l,function(t){t.toStringTag="X6.Geometry."+t.name,t.isPath=function(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag],r=e;return!(null!=n&&n!==t.toStringTag||!Array.isArray(r.segments)||"function"!=typeof r.moveTo||"function"!=typeof r.lineTo||"function"!=typeof r.curveTo)}}(l=e.Path||(e.Path={})),e.Path=l,function(t){function e(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if("M"===t)return(e=moveto.MoveTo.create).call.apply(e,s([null],i,!1));if("L"===t)return(n=lineto.LineTo.create).call.apply(n,s([null],i,!1));if("C"===t)return(r=curveto.CurveTo.create).call.apply(r,s([null],i,!1));if("z"===t||"Z"===t)return close.Close.create();throw new Error('Invalid path segment type "'+t+'"')}t.parse=function(n){if(!n)return new t;var r=new t,i=t.normalize(n).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=i)for(var o=0,a=i.length;o<a;o+=1){var l=i[o].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g);if(null!=l){var c=l[0],u=l.slice(1).map((function(t){return+t})),h=e.call.apply(e,s([null,c],u,!1));r.appendSegment(h)}}return r},t.createSegment=e}(l=e.Path||(e.Path={})),e.Path=l,function(t){t.normalize=normalize_1.normalizePathData,t.isValid=a.isValid,t.drawArc=a.drawArc,t.drawPoints=a.drawPoints,t.arcToCurves=a.arcToCurves}(l=e.Path||(e.Path={})),e.Path=l})),path$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(path$2,e),r(segment,e)})),geometry=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(angle,e),r(point,e),r(line,e),r(ellipse,e),r(rectangle,e),r(path$1,e),r(curve,e),r(polyline,e)})),vector$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=void 0;var o=i(core),s=function(){function t(e,n,r){if(!e)throw new TypeError("Invalid element to create vector");var i;if(t.isVector(e))i=e.node;else if("string"==typeof e)if("svg"===e.toLowerCase())i=o.createSvgDocument();else if("<"===e[0]){var s=o.createSvgDocument(e);i=document.importNode(s.firstChild,!0)}else i=document.createElementNS(o.ns.svg,e);else i=e;this.node=i,n&&this.setAttributes(n),r&&this.append(r)}return Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return t.toStringTag},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.node.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.node.id},set:function(t){this.node.id=t},enumerable:!1,configurable:!0}),t.prototype.transform=function(t,e){return null==t?o.transform(this.node):(o.transform(this.node,t,e),this)},t.prototype.translate=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n={}),null==t?o.translate(this.node):(o.translate(this.node,t,e,n),this)},t.prototype.rotate=function(t,e,n,r){return void 0===r&&(r={}),null==t?o.rotate(this.node):(o.rotate(this.node,t,e,n,r),this)},t.prototype.scale=function(t,e){return null==t?o.scale(this.node):(o.scale(this.node,t,e),this)},t.prototype.getTransformToElement=function(e){var n=t.toNode(e);return o.getTransformToElement(this.node,n)},t.prototype.removeAttribute=function(t){return o.removeAttribute(this.node,t),this},t.prototype.getAttribute=function(t){return o.getAttribute(this.node,t)},t.prototype.setAttribute=function(t,e){return o.setAttribute(this.node,t,e),this},t.prototype.setAttributes=function(t){return o.setAttributes(this.node,t),this},t.prototype.attr=function(t,e){return null==t?o.attr(this.node):"string"==typeof t&&void 0===e?o.attr(this.node,t):("object"==typeof t?o.attr(this.node,t):o.attr(this.node,t,e),this)},t.prototype.svg=function(){return this.node instanceof SVGSVGElement?this:t.create(this.node.ownerSVGElement)},t.prototype.defs=function(){var e=this.svg()||this,n=e.node.getElementsByTagName("defs")[0];return n?t.create(n):t.create("defs").appendTo(e)},t.prototype.text=function(t,e){return void 0===e&&(e={}),o.text(this.node,t,e),this},t.prototype.tagName=function(){return o.tagName(this.node)},t.prototype.clone=function(){return t.create(this.node.cloneNode(!0))},t.prototype.remove=function(){return o.remove(this.node),this},t.prototype.empty=function(){return o.empty(this.node),this},t.prototype.append=function(e){return o.append(this.node,t.toNodes(e)),this},t.prototype.appendTo=function(e){return o.appendTo(this.node,t.isVector(e)?e.node:e),this},t.prototype.prepend=function(e){return o.prepend(this.node,t.toNodes(e)),this},t.prototype.before=function(e){return o.before(this.node,t.toNodes(e)),this},t.prototype.replace=function(e){return this.node.parentNode&&this.node.parentNode.replaceChild(t.toNode(e),this.node),t.create(e)},t.prototype.first=function(){return this.node.firstChild?t.create(this.node.firstChild):null},t.prototype.last=function(){return this.node.lastChild?t.create(this.node.lastChild):null},t.prototype.get=function(e){var n=this.node.childNodes[e];return n?t.create(n):null},t.prototype.indexOf=function(e){return Array.prototype.slice.call(this.node.childNodes).indexOf(t.toNode(e))},t.prototype.find=function(e){var n=[],r=o.find(this.node,e);if(r)for(var i=0,s=r.length;i<s;i+=1)n.push(t.create(r[i]));return n},t.prototype.findOne=function(e){var n=o.findOne(this.node,e);return n?t.create(n):null},t.prototype.findParentByClass=function(e,n){var r=o.findParentByClass(this.node,e,n);return r?t.create(r):null},t.prototype.matches=function(t){var e=this.node,n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return n&&n.call(e,t)},t.prototype.contains=function(e){return o.contains(this.node,t.isVector(e)?e.node:e)},t.prototype.wrap=function(e){var n=t.create(e),r=this.node.parentNode;return null!=r&&r.insertBefore(n.node,this.node),n.append(this)},t.prototype.parent=function(e){var n=this;if(null==n.node.parentNode)return null;if(n=t.create(n.node.parentNode),null==e)return n;do{if("string"==typeof e?n.matches(e):n instanceof e)return n}while(n=t.create(n.node.parentNode));return n},t.prototype.children=function(){for(var e=this.node.childNodes,n=[],r=0;r<e.length;r+=1)1===e[r].nodeType&&n.push(t.create(e[r]));return n},t.prototype.eachChild=function(t,e){for(var n=this.children(),r=0,i=n.length;r<i;r+=1)t.call(n[r],n[r],r,n),e&&n[r].eachChild(t,e);return this},t.prototype.index=function(){return o.index(this.node)},t.prototype.hasClass=function(t){return o.hasClass(this.node,t)},t.prototype.addClass=function(t){return o.addClass(this.node,t),this},t.prototype.removeClass=function(t){return o.removeClass(this.node,t),this},t.prototype.toggleClass=function(t,e){return o.toggleClass(this.node,t,e),this},t.prototype.toLocalPoint=function(t,e){return o.toLocalPoint(this.node,t,e)},t.prototype.toGeometryShape=function(){return o.toGeometryShape(this.node)},t.prototype.translateCenterToPoint=function(t){var e=this.getBBox({target:this.svg()}).getCenter();return this.translate(t.x-e.x,t.y-e.y),this},t.prototype.translateAndAutoOrient=function(t,e,n){return o.translateAndAutoOrient(this.node,t,e,n),this},t.prototype.animate=function(t){return o.animate(this.node,t)},t.prototype.animateTransform=function(t){return o.animateTransform(this.node,t)},t.prototype.animateAlongPath=function(t,e){return o.animateAlongPath(this.node,t,e)},t.prototype.normalizePath=function(){return"path"===this.tagName()&&this.attr("d",geometry.Path.normalize(this.attr("d"))),this},t.prototype.bbox=function(t,e){return o.bbox(this.node,t,e)},t.prototype.getBBox=function(e){return void 0===e&&(e={}),o.getBBox(this.node,{recursive:e.recursive,target:e.target?t.toNode(e.target):null})},t.prototype.sample=function(t){return void 0===t&&(t=1),this.node instanceof SVGPathElement?o.sample(this.node,t):[]},t.prototype.toPath=function(){return t.create(o.toPath(this.node))},t.prototype.toPathData=function(){return o.toPathData(this.node)},t}();e.Vector=s,function(t){function e(e){if(null==e)return!1;if(e instanceof t)return!0;var n=e[Symbol.toStringTag];return(null==n||n===t.toStringTag)&&e.node instanceof SVGElement&&"function"==typeof e.animate&&"function"==typeof e.sample&&"function"==typeof e.normalizePath&&"function"==typeof e.toPath}function n(e,n,r){return new t(e,n,r)}function r(t){return e(t)?t.node:t}t.toStringTag="X6."+t.name,t.isVector=e,t.create=n,t.createVectors=function(t){if("<"===t[0]){for(var e=o.createSvgDocument(t),r=[],i=0,s=e.childNodes.length;i<s;i+=1)r.push(n(document.importNode(e.childNodes[i],!0)));return r}return[n(t)]},t.toNode=r,t.toNodes=function(t){return Array.isArray(t)?t.map((function(t){return r(t)})):[r(t)]}}(s=e.Vector||(e.Vector={})),e.Vector=s})),text_2=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))};function r(t,e,n){for(var r,i=n.eol,o=n.baseSize,s=n.lineHeight,a=0,l={},c=e.length-1,u=0;u<=c;u+=1){var h=e[u],d=null;if("object"==typeof h){var f=h.attrs,p=vector$1.Vector.create("tspan",f),g=h.t;i&&u===c&&(g+=i),(r=p.node).textContent=g;var m=f.class;m&&p.addClass(m),n.includeAnnotationIndices&&p.attr("annotations",h.annotations.join(",")),void 0===(d=parseFloat(f["font-size"]))&&(d=o),d&&d>a&&(a=d)}else i&&u===c&&(h+=i),r=document.createTextNode(h||" "),o&&o>a&&(a=o);t.appendChild(r)}return a&&(l.maxFontSize=a),s?l.lineHeight=s:a&&(l.lineHeight=1.2*a),l}Object.defineProperty(e,"__esModule",{value:!0}),e.breakText=e.text=void 0;var i=/em$/;function o(t,e){var n=parseFloat(t);return i.test(t)?n*e:n}e.text=function(t,e,n){void 0===n&&(n={}),e=text.Text.sanitize(e);var s=n.eol,a=n.textPath,l=n.textVerticalAnchor,c="middle"===l||"bottom"===l||"top"===l,u=n.x;void 0===u&&(u=t.getAttribute("x")||0);var h=n.includeAnnotationIndices,d=n.annotations;d&&!Array.isArray(d)&&(d=[d]);var f=n.lineHeight,p="auto"===f,g=p?"1.5em":f||"1em";(0,elem.empty)(t),(0,attr_1.attr)(t,{"xml:space":"preserve",display:e||n.displayEmpty?null:"none"});var m,A,y=(0,attr_1.attr)(t,"font-size"),v=parseFloat(y);v||(v=16,!c&&!d||y||(0,attr_1.attr)(t,"font-size",""+v)),a?("string"==typeof a&&(a={d:a}),m=function(t,e){var n=vector$1.Vector.create(e),r=vector$1.Vector.create("textPath"),i=t.d;if(i&&void 0===t["xlink:href"]){var o=vector$1.Vector.create("path").attr("d",i).appendTo(n.defs());r.attr("xlink:href","#"+o.id)}return"object"==typeof t&&r.attr(t),r.node}(a,t)):m=document.createDocumentFragment();for(var b,x=0,w=e.split("\n"),C=[],$=w.length-1,_=0;_<=$;_+=1){A=g;var P="v-line",S=(0,elem.createSvgElement)("tspan"),M=void 0,E=w[_];if(E)if(d){var T=(M=r(S,text.Text.annotate(E,d,{offset:-x,includeAnnotationIndices:h}),{eol:_!==$&&s,baseSize:v,lineHeight:p?null:g,includeAnnotationIndices:h})).lineHeight;T&&p&&0!==_&&(A=T),0===_&&(b=.8*M.maxFontSize)}else s&&_!==$&&(E+=s),S.textContent=E;else{S.textContent="-",P+=" v-empty-line";var k=S.style;k.fillOpacity=0,k.strokeOpacity=0,d&&(M={})}M&&C.push(M),_>0&&S.setAttribute("dy",A),(_>0||a)&&S.setAttribute("x",u),S.className.baseVal=P,m.appendChild(S),x+=E.length+1}if(c)if(d)A=function(t,e,n,r){if(!Array.isArray(e))return 0;var i=e.length;if(!i)return 0;for(var s=e[0],a=o(s.maxFontSize,n)||n,l=0,c=o(r,n),u=1;u<i;u+=1)l+=o((s=e[u]).lineHeight,n)||c;var h,d=o(s.maxFontSize,n)||n;switch(t){case"middle":h=a/2-.15*d-l/2;break;case"bottom":h=-.25*d-l;break;default:h=.8*a}return h}(l,C,v,g);else if("top"===l)A="0.8em";else{var O=void 0;switch($>0?(O=parseFloat(g)||1,O*=$,i.test(g)||(O/=v)):O=0,l){case"middle":A=.3-O/2+"em";break;case"bottom":A=-O-.3+"em"}}else 0===l?A="0em":l?A=l:(A=0,null==t.getAttribute("y")&&t.setAttribute("y",""+(b||"0.8em")));m.firstChild.setAttribute("dy",A),t.appendChild(m)},e.breakText=function(t,e,r,i){void 0===r&&(r={}),void 0===i&&(i={});var o=e.width,s=e.height,a=i.svgDocument||(0,elem.createSvgElement)("svg"),l=(0,elem.createSvgElement)("text"),c=(0,elem.createSvgElement)("tspan"),u=document.createTextNode("");(0,attr_1.attr)(l,r),l.appendChild(c),l.style.opacity="0",l.style.display="block",c.style.display="block",c.appendChild(u),a.appendChild(l);var h=null==a.parentNode;h&&document.body.appendChild(a);for(var d,f,p,g=i.eol||"\n",m=i.separator||" ",A=i.hyphen?new RegExp(i.hyphen):/[^\w\d]/,y=!1!==i.breakWord,v=[],b={},x=[],w=function(t,e,r,i){var o=[],s=[];if(null!=e){var a=t.split(e);if(o.push.apply(o,a),"string"==typeof e)for(var l=0,c=a.length-1;l<c;l+=1)s.push(e);else{var u=t.match(new RegExp(e,"g"));for(l=0,c=a.length-1;l<c;l+=1)s.push(u?u[l]:"")}}else{var h="";for(l=0,c=t.length;l<c;l+=1){var d=t[l];" "===d?(o.push(h),s.push(" "),h=""):d.match(/[^\x00-\xff]/)?(h.length&&(o.push(h),s.push("")),o.push(d),s.push(""),h=""):h+=d}h.length&&o.push(h)}for(l=0;l<o.length;l+=1)if((h=o[l]).indexOf(r)>=0&&h.length>1){for(var f=0,p=(a=h.split(r)).length-1;f<p;f+=1)a.splice(2*f+1,0,r);var g=a.filter((function(t){return""!==t}));o.splice.apply(o,n([l,1],g,!1)),(u=g.map((function(){return""}))).pop(),s.splice.apply(s,n([l,0],u,!1))}for(l=0;l<o.length;l+=1){var m=(h=o[l]).search(i);m>0&&m<h.length-1&&(o.splice(l,1,h.substring(0,m+1),h.substring(m+1)),s.splice(l,0,""))}return{words:o,separators:s}}(t,i.separator,g,A),C=w.words,$=w.separators,_=0,P=0,S=C.length;_<S;_+=1){var M=C[_];if(M)if(M!==g){if(u.data=null!=x[P]?""+x[P]+(p=$[_-1]||"")+M:M,c.getComputedTextLength()<=o)x[P]=u.data,b[P]=$[_],d&&(v[P]=!0,P+=1,d=0);else{if(y){if(!x[P]||d){var E=!!d,T=1===M.length;if(d=M.length-1,E||T){if(T){if(!x[P]){x=[];break}C.splice(_,2,M+C[_+1]),$.splice(_+1,1),v[P]=!0,P+=1,S-=1,_-=1;continue}C[_]=M.substring(0,d),C[_+1]=M.substring(d)+C[_+1]}else C.splice(_,1,M.substring(0,d),M.substring(d)),$.splice(_,0,""),S+=1,P&&!v[P-1]&&(P-=1);_-=1;continue}}else if(!x[P]){x[P]=M,v[P]=!0,P+=1;continue}P+=1,_-=1}var k;if(null!=s)if(null==f&&(f=(k="auto"===r.lineHeight?{value:1.5,unit:"em"}:number.NumberExt.parseCssNumeric(r.lineHeight,["em"])||{value:1,unit:"em"}).value,"em"===k.unit&&(f*=platform.Platform.IS_FIREFOX?c.getBBox().height:l.getBBox().height)),f*x.length>s){var O=Math.floor(s/f)-1,N=x[O],R=x[O+1];if(x.splice(O+1),null==N)break;var L=i.ellipsis;if(!L)break;"string"!=typeof L&&(L="");var D=N;R&&y&&(D+=p+R);var j=D.length,I=void 0,F=void 0;do{if(F=D[j],I=D.substring(0,j),F?F.match(m)&&(I+=F):I+=b[O],u.data=I+=L,c.getComputedTextLength()<=o){x[O]=I;break}j-=1}while(j>=0);break}}else v[P]=!0,x[P+=1]=""}return(0,elem.remove)(h?a:l),x.join(g)}})),path=createCommonjsModule((function(t,e){function n(t,e,n){void 0===n&&(n=NaN);var r=t.getAttribute(e);if(null==r)return n;var i=parseFloat(r);return Number.isNaN(i)?n:i}function r(t){return["M",n(t,"x1"),n(t,"y1"),"L",n(t,"x2"),n(t,"y2")].join(" ")}function i(t){var e=a(t);return 0===e.length?null:s(e)+" Z"}function o(t){var e=a(t);return 0===e.length?null:s(e)}function s(t){return"M "+t.map((function(t){return t.x+" "+t.y})).join(" L")}function a(t){var e=[],n=t.points;if(n)for(var r=0,i=n.numberOfItems;r<i;r+=1)e.push(n.getItem(r));return e}function l(t){var r=n(t,"cx",0),i=n(t,"cy",0),o=n(t,"r"),s=o*e.KAPPA;return["M",r,i-o,"C",r+s,i-o,r+o,i-s,r+o,i,"C",r+o,i+s,r+s,i+o,r,i+o,"C",r-s,i+o,r-o,i+s,r-o,i,"C",r-o,i-s,r-s,i-o,r,i-o,"Z"].join(" ")}function c(t){var r=n(t,"cx",0),i=n(t,"cy",0),o=n(t,"rx"),s=n(t,"ry")||o,a=o*e.KAPPA,l=s*e.KAPPA;return["M",r,i-s,"C",r+a,i-s,r+o,i-l,r+o,i,"C",r+o,i+l,r+a,i+s,r,i+s,"C",r-a,i+s,r-o,i+l,r-o,i,"C",r-o,i-l,r-a,i-s,r,i-s,"Z"].join(" ")}function u(t){return h({x:n(t,"x",0),y:n(t,"y",0),width:n(t,"width",0),height:n(t,"height",0),rx:n(t,"rx",0),ry:n(t,"ry",0)})}function h(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=Math.min(t.rx||t["top-rx"]||0,r/2),s=Math.min(t.rx||t["bottom-rx"]||0,r/2),a=Math.min(t.ry||t["top-ry"]||0,i/2),l=Math.min(t.ry||t["bottom-ry"]||0,i/2);return(o||s||a||l?["M",e,n+a,"v",i-a-l,"a",s,l,0,0,0,s,l,"h",r-2*s,"a",s,l,0,0,0,s,-l,"v",-(i-l-a),"a",o,a,0,0,0,-o,-a,"h",-(r-2*o),"a",o,a,0,0,0,-o,a,"Z"]:["M",e,n,"H",e+r,"V",n+i,"H",e,"V",n,"Z"]).join(" ")}function d(t){var e=t.tagName.toLowerCase();switch(e){case"path":return t.getAttribute("d");case"line":return r(t);case"polygon":return i(t);case"polyline":return o(t);case"ellipse":return c(t);case"circle":return l(t);case"rect":return u(t)}throw new Error('"'+e+'" cannot be converted to svg path element.')}Object.defineProperty(e,"__esModule",{value:!0}),e.createSlicePathData=e.toPathData=e.toPath=e.rectToPathData=e.rectangleToPathData=e.ellipseToPathData=e.circleToPathData=e.getPointsFromSvgElement=e.polylineToPathData=e.polygonToPathData=e.lineToPathData=e.sample=e.KAPPA=void 0,e.KAPPA=.551784,e.sample=function(t,e){void 0===e&&(e=1);for(var n,r=t.getTotalLength(),i=[],o=0;o<r;)n=t.getPointAtLength(o),i.push({distance:o,x:n.x,y:n.y}),o+=e;return i},e.lineToPathData=r,e.polygonToPathData=i,e.polylineToPathData=o,e.getPointsFromSvgElement=a,e.circleToPathData=l,e.ellipseToPathData=c,e.rectangleToPathData=u,e.rectToPathData=h,e.toPath=function(t){var e=(0,elem.createSvgElement)("path");(0,attr_1.attr)(e,(0,attr_1.attr)(t));var n=d(t);return n&&e.setAttribute("d",n),e},e.toPathData=d,e.createSlicePathData=function(t,e,n,r){var i=2*Math.PI-1e-6,o=t,s=e,a=n,l=r;if(l<a){var c=a;a=l,l=c}var u=l-a,h=u<Math.PI?"0":"1",d=Math.cos(a),f=Math.sin(a),p=Math.cos(l),g=Math.sin(l);return u>=i?o?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+o+"A"+o+","+o+" 0 1,0 0,"+-o+"A"+o+","+o+" 0 1,0 0,"+o+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":o?"M"+s*d+","+s*f+"A"+s+","+s+" 0 "+h+",1 "+s*p+","+s*g+"L"+o*p+","+o*g+"A"+o+","+o+" 0 "+h+",0 "+o*d+","+o*f+"Z":"M"+s*d+","+s*f+"A"+s+","+s+" 0 "+h+",1 "+s*p+","+s*g+"L0,0Z"}})),matrix=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.transformRectangle=e.transformPolyline=e.transformLine=e.transformPoint=e.matrixToTranslation=e.matrixToRotation=e.matrixToScale=e.decomposeMatrix=e.parseTransformString=e.matrixToTransformString=e.transformStringToMatrix=e.createSVGTransform=e.createSVGMatrix=e.createSVGPoint=void 0;var n=(0,elem.createSvgElement)("svg"),r=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,i=/[ ,]+/,o=/^(\w+)\((.*)\)/;function s(t,e){var r=n.createSVGPoint();return r.x=t,r.y=e,r}function a(t){var e=n.createSVGMatrix();if(null!=t){var r=t,i=e;for(var o in r)i[o]=r[o]}return e}function l(t){var e=a(),n=null!=t&&t.match(r);if(!n)return e;for(var s=0,l=n.length;s<l;s+=1){var c=n[s].match(o);if(c){var u=void 0,h=void 0,d=void 0,f=void 0,p=void 0,g=a(),m=c[2].split(i);switch(c[1].toLowerCase()){case"scale":u=parseFloat(m[0]),h=void 0===m[1]?u:parseFloat(m[1]),g=g.scaleNonUniform(u,h);break;case"translate":d=parseFloat(m[0]),f=parseFloat(m[1]),g=g.translate(d,f);break;case"rotate":p=parseFloat(m[0]),d=parseFloat(m[1])||0,f=parseFloat(m[2])||0,g=0!==d||0!==f?g.translate(d,f).rotate(p).translate(-d,-f):g.rotate(p);break;case"skewx":p=parseFloat(m[0]),g=g.skewX(p);break;case"skewy":p=parseFloat(m[0]),g=g.skewY(p);break;case"matrix":g.a=parseFloat(m[0]),g.b=parseFloat(m[1]),g.c=parseFloat(m[2]),g.d=parseFloat(m[3]),g.e=parseFloat(m[4]),g.f=parseFloat(m[5]);break;default:continue}e=e.multiply(g)}}return e}function c(t,e){return{x:e.x*t.a+e.y*t.c+0,y:e.x*t.b+e.y*t.d+0}}function u(t){var e=c(t,{x:0,y:1}),n=c(t,{x:1,y:0}),r=180/Math.PI*Math.atan2(e.y,e.x)-90;return{skewX:r,skewY:180/Math.PI*Math.atan2(n.y,n.x),translateX:t.e,translateY:t.f,scaleX:Math.sqrt(t.a*t.a+t.b*t.b),scaleY:Math.sqrt(t.c*t.c+t.d*t.d),rotation:r}}function h(t,e){var n=s(t.x,t.y).matrixTransform(e);return new geometry.Point(n.x,n.y)}e.createSVGPoint=s,e.createSVGMatrix=a,e.createSVGTransform=function(t){return null!=t?(t instanceof DOMMatrix||(t=a(t)),n.createSVGTransformFromMatrix(t)):n.createSVGTransform()},e.transformStringToMatrix=l,e.matrixToTransformString=function(t){var e=t||{};return"matrix("+(null!=e.a?e.a:1)+","+(null!=e.b?e.b:0)+","+(null!=e.c?e.c:0)+","+(null!=e.d?e.d:1)+","+(null!=e.e?e.e:0)+","+(null!=e.f?e.f:0)+")"},e.parseTransformString=function(t){var e,n,r;if(t){var o=i;if(t.trim().indexOf("matrix")>=0){var s=u(l(t));n=[s.rotation],r=[s.scaleX,s.scaleY];var a=[];0===(e=[s.translateX,s.translateY])[0]&&0===e[1]||a.push("translate("+e.join(",")+")"),1===r[0]&&1===r[1]||a.push("scale("+r.join(",")+")"),0!==n[0]&&a.push("rotate("+n[0]+")"),t=a.join(" ")}else{var c=t.match(/translate\((.*?)\)/);c&&(e=c[1].split(o));var h=t.match(/rotate\((.*?)\)/);h&&(n=h[1].split(o));var d=t.match(/scale\((.*?)\)/);d&&(r=d[1].split(o))}}var f=r&&r[0]?parseFloat(r[0]):1;return{raw:t||"",translation:{tx:e&&e[0]?parseInt(e[0],10):0,ty:e&&e[1]?parseInt(e[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:f,sy:r&&r[1]?parseFloat(r[1]):f}}},e.decomposeMatrix=u,e.matrixToScale=function(t){var e,n,r,i;return t?(e=null==t.a?1:t.a,i=null==t.d?1:t.d,n=t.b,r=t.c):e=i=1,{sx:n?Math.sqrt(e*e+n*n):e,sy:r?Math.sqrt(r*r+i*i):i}},e.matrixToRotation=function(t){var e={x:0,y:1};return t&&(e=c(t,e)),{angle:geometry.Angle.normalize(geometry.Angle.toDeg(Math.atan2(e.y,e.x))-90)}},e.matrixToTranslation=function(t){return{tx:t&&t.e||0,ty:t&&t.f||0}},e.transformPoint=h,e.transformLine=function(t,e){return new geometry.Line(h(t.start,e),h(t.end,e))},e.transformPolyline=function(t,e){var n=t instanceof geometry.Polyline?t.points:t;return Array.isArray(n)||(n=[]),new geometry.Polyline(n.map((function(t){return h(t,e)})))},e.transformRectangle=function(t,e){var r=n.createSVGPoint();r.x=t.x,r.y=t.y;var i=r.matrixTransform(e);r.x=t.x+t.width,r.y=t.y;var o=r.matrixTransform(e);r.x=t.x+t.width,r.y=t.y+t.height;var s=r.matrixTransform(e);r.x=t.x,r.y=t.y+t.height;var a=r.matrixTransform(e),l=Math.min(i.x,o.x,s.x,a.x),c=Math.max(i.x,o.x,s.x,a.x),u=Math.min(i.y,o.y,s.y,a.y),h=Math.max(i.y,o.y,s.y,a.y);return new geometry.Rectangle(l,u,c-l,h-u)}})),geom=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function r(t,e){var n;if(void 0===e&&(e={}),!t.ownerSVGElement||!(0,elem.isSVGGraphicsElement)(t)){if((0,elem.isHTMLElement)(t)){var o=a(t);return new geometry.Rectangle(o.left,o.top,o.width,o.height)}return new geometry.Rectangle(0,0,0,0)}var s=e.target;if(!e.recursive){try{n=t.getBBox()}catch(e){n={x:t.clientLeft,y:t.clientTop,width:t.clientWidth,height:t.clientHeight}}if(!s)return geometry.Rectangle.create(n);var l=i(t,s);return(0,matrix.transformRectangle)(n,l)}var c=t.childNodes,u=c.length;if(0===u)return r(t,{target:s});s||(s=t);for(var h=0;h<u;h+=1){var d,f=c[h];d=r(f,0===f.childNodes.length?{target:s}:{target:s,recursive:!0}),n=n?n.union(d):d}return n}function i(t,e){if((0,elem.isSVGGraphicsElement)(e)&&(0,elem.isSVGGraphicsElement)(t)){var n=e.getScreenCTM(),r=t.getScreenCTM();if(n&&r)return n.inverse().multiply(r)}return(0,matrix.createSVGMatrix)()}function o(t,e,n){var r=(0,elem.createSvgElement)(n);t.appendChild(r);try{return s(r,e)}catch(t){}return function(){}}function s(t,e){var r=e.start,i=e.complete,o=e.repeat,s=n(e,["start","complete","repeat"]);(0,attr_1.attr)(t,s),r&&t.addEventListener("beginEvent",r),i&&t.addEventListener("endEvent",i),o&&t.addEventListener("repeatEvent",o);var a=t;return a.beginElement(),function(){return a.endElement()}}function a(t){var e=0,n=0,r=0,i=0;if(t){for(var o=t;o;)e+=o.offsetLeft,n+=o.offsetTop,(o=o.offsetParent)&&(e+=parseInt((0,style.getComputedStyle)(o,"borderLeft"),10),n+=parseInt((0,style.getComputedStyle)(o,"borderTop"),10));r=t.offsetWidth,i=t.offsetHeight}return{left:e,top:n,width:r,height:i}}Object.defineProperty(e,"__esModule",{value:!0}),e.getBoundingOffsetRect=e.animateAlongPath=e.animateTransform=e.animate=e.getIntersection=e.toGeometryShape=e.toLocalPoint=e.getTransformToElement=e.getMatrixByElementAttr=e.getBBoxByElementAttr=e.getBBox=e.bbox=void 0,e.bbox=function(t,e,n){var r,o=t.ownerSVGElement;if(!o)return new geometry.Rectangle(0,0,0,0);try{r=t.getBBox()}catch(e){r={x:t.clientLeft,y:t.clientTop,width:t.clientWidth,height:t.clientHeight}}if(e)return geometry.Rectangle.create(r);var s=i(t,n||o);return(0,matrix.transformRectangle)(r,s)},e.getBBox=r,e.getBBoxByElementAttr=function(t){for(var e=t,n=e?e.tagName.toLowerCase():"";"g"===n;)n=(e=e.firstElementChild)?e.tagName.toLowerCase():"";var r,i,o=function(t){var n=e.getAttribute(t),r=n?parseFloat(n):0;return Number.isNaN(r)?0:r};switch(n){case"rect":i=new geometry.Rectangle(o("x"),o("y"),o("width"),o("height"));break;case"circle":r=o("r"),i=new geometry.Rectangle(o("cx")-r,o("cy")-r,2*r,2*r)}return i},e.getMatrixByElementAttr=function(t,e){var n=(0,matrix.createSVGMatrix)();if((0,elem.isSVGGraphicsElement)(e)&&(0,elem.isSVGGraphicsElement)(t)){for(var r=t,i=[];r&&r!==e;){var o=r.getAttribute("transform")||null,s=(0,matrix.transformStringToMatrix)(o);i.push(s),r=r.parentNode}i.reverse().forEach((function(t){n=n.multiply(t)}))}return n},e.getTransformToElement=i,e.toLocalPoint=function(t,e,n){var r=t instanceof SVGSVGElement?t:t.ownerSVGElement,o=r.createSVGPoint();o.x=e,o.y=n;try{var s=r.getScreenCTM(),a=o.matrixTransform(s.inverse()),l=i(t,r).inverse();return a.matrixTransform(l)}catch(t){return o}},e.toGeometryShape=function(t){var e=function(e){var n=t.getAttribute(e),r=n?parseFloat(n):0;return Number.isNaN(r)?0:r};switch(t instanceof SVGElement&&t.nodeName.toLowerCase()){case"rect":return new geometry.Rectangle(e("x"),e("y"),e("width"),e("height"));case"circle":return new geometry.Ellipse(e("cx"),e("cy"),e("r"),e("r"));case"ellipse":return new geometry.Ellipse(e("cx"),e("cy"),e("rx"),e("ry"));case"polyline":var n=(0,path.getPointsFromSvgElement)(t);return new geometry.Polyline(n);case"polygon":return(n=(0,path.getPointsFromSvgElement)(t)).length>1&&n.push(n[0]),new geometry.Polyline(n);case"path":var i=t.getAttribute("d");return geometry.Path.isValid(i)||(i=geometry.Path.normalize(i)),geometry.Path.parse(i);case"line":return new geometry.Line(e("x1"),e("y1"),e("x2"),e("y2"))}return r(t)},e.getIntersection=function(t,e,n){var o=t instanceof SVGSVGElement?t:t.ownerSVGElement,s=r(n=n||o),a=s.getCenter();if(!s.intersectsWithLineFromCenterToPoint(e))return null;var l=null,c=t.tagName.toLowerCase();if("rect"===c){var u=new geometry.Rectangle(parseFloat(t.getAttribute("x")||"0"),parseFloat(t.getAttribute("y")||"0"),parseFloat(t.getAttribute("width")||"0"),parseFloat(t.getAttribute("height")||"0")),h=i(t,n),d=(0,matrix.decomposeMatrix)(h),f=o.createSVGTransform();f.setRotate(-d.rotation,a.x,a.y);var p=(0,matrix.transformRectangle)(u,f.matrix.multiply(h));l=geometry.Rectangle.create(p).intersectsWithLineFromCenterToPoint(e,d.rotation)}else if("path"===c||"polygon"===c||"polyline"===c||"circle"===c||"ellipse"===c){for(var g="path"===c?t:(0,path.toPath)(t),m=(0,path.sample)(g),A=1/0,y=[],v=0,b=m.length;v<b;v+=1){var x=m[v],w=(0,matrix.createSVGPoint)(x.x,x.y);w=w.matrixTransform(i(t,n));var C=geometry.Point.create(w),$=C.distance(a),_=1.1*C.distance(e),P=$+_;P<A?(A=P,y=[{sample:x,refDistance:_}]):P<A+1&&y.push({sample:x,refDistance:_})}y.sort((function(t,e){return t.refDistance-e.refDistance})),y[0]&&(l=geometry.Point.create(y[0].sample))}return l},e.animate=function(t,e){return o(t,e,"animate")},e.animateTransform=function(t,e){return o(t,e,"animateTransform")},e.animateAlongPath=function(t,e,n){var r=(0,elem.ensureId)(n),i=(0,elem.createSvgElement)("animateMotion"),o=(0,elem.createSvgElement)("mpath");(0,attr_1.attr)(o,{"xlink:href":"#"+r}),i.appendChild(o),t.appendChild(i);try{return s(i,e)}catch(t){if("fake"===document.documentElement.getAttribute("smiling")){var a=i;a.animators=[];var l=window,c=a.getAttribute("id");c&&(l.id2anim[c]=a);for(var u=l.getTargets(a),h=0,d=u.length;h<d;h+=1){var f=new l.Animator(a,u[h],h);l.animators.push(f),a.animators[h]=f,f.register()}}}return function(){}},e.getBoundingOffsetRect=a})),transform_1=createCommonjsModule((function(t,e){function n(t,e,n){var r=(0,attr_1.attr)(t,"transform"),i=(0,matrix.parseTransformString)(r);if(null==e)return i.scale;n=null==n?e:n,r=(r=i.raw).replace(/scale\([^)]*\)/g,"").trim(),t.setAttribute("transform",(r+" scale("+e+","+n+")").trim())}Object.defineProperty(e,"__esModule",{value:!0}),e.translateAndAutoOrient=e.scale=e.rotate=e.translate=e.transform=void 0,e.transform=function(t,e,n){if(void 0===n&&(n={}),null==e)return(0,matrix.transformStringToMatrix)((0,attr_1.attr)(t,"transform"));if(n.absolute)t.setAttribute("transform",(0,matrix.matrixToTransformString)(e));else{var r=t.transform,i=(0,matrix.createSVGTransform)(e);r.baseVal.appendItem(i)}},e.translate=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r={});var i=(0,attr_1.attr)(t,"transform"),o=(0,matrix.parseTransformString)(i);if(null==e)return o.translation;i=(i=o.raw).replace(/translate\([^)]*\)/g,"").trim(),t.setAttribute("transform",("translate("+(r.absolute?e:o.translation.tx+e)+","+(r.absolute?n:o.translation.ty+n)+") "+i).trim())},e.rotate=function(t,e,n,r,i){void 0===i&&(i={});var o=(0,attr_1.attr)(t,"transform"),s=(0,matrix.parseTransformString)(o);if(null==e)return s.rotation;o=(o=s.raw).replace(/rotate\([^)]*\)/g,"").trim(),e%=360,t.setAttribute("transform",(o+" rotate("+(i.absolute?e:s.rotation.angle+e)+(null!=n&&null!=r?","+n+","+r:"")+")").trim())},e.scale=n,e.translateAndAutoOrient=function(t,e,r,i){var o=geometry.Point.create(e),s=geometry.Point.create(r);i||(i=t instanceof SVGSVGElement?t:t.ownerSVGElement);var a=n(t);t.setAttribute("transform","");var l=(0,geom.getBBox)(t,{target:i}).scale(a.sx,a.sy),c=(0,matrix.createSVGTransform)();c.setTranslate(-l.x-l.width/2,-l.y-l.height/2);var u=(0,matrix.createSVGTransform)(),h=o.angleBetween(s,o.clone().translate(1,0));h&&u.setRotate(h,0,0);var d=(0,matrix.createSVGTransform)(),f=o.clone().move(s,l.width/2);d.setTranslate(2*o.x-f.x,2*o.y-f.y);var p=(0,geom.getTransformToElement)(t,i),g=(0,matrix.createSVGTransform)();g.setMatrix(d.matrix.multiply(u.matrix.multiply(c.matrix.multiply(p.scale(a.sx,a.sy))))),t.setAttribute("transform",(0,matrix.matrixToTransformString)(g.matrix))}})),mousewheel=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MouseWheelHandle=void 0;var r=n(jquery),i=function(){function t(t,e,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=platform.Platform.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=e,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}return t.prototype.enable=function(){platform.Platform.SUPPORT_PASSIVE?this.target.addEventListener(this.eventName,this.onWheel,{passive:!1}):(0,r.default)(this.target).on("mousewheel",this.onWheel)},t.prototype.disable=function(){platform.Platform.SUPPORT_PASSIVE?this.target.removeEventListener(this.eventName,this.onWheel):(0,r.default)(this.target).off("mousewheel")},t.prototype.onWheel=function(t){var e,n=this;(null==this.onWheelGuard||this.onWheelGuard(t))&&(this.deltaX+=t.deltaX,this.deltaY+=t.deltaY,t.preventDefault(),0===this.deltaX&&0===this.deltaY||(t.stopPropagation(),e=!0),!0===e&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((function(){n.didWheel(t)}))))},t.prototype.didWheel=function(t){this.animationFrameId=0,this.onWheelCallback(t,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0},t}();e.MouseWheelHandle=i})),core=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(af,e),r(attr_1,e),r(elem,e),r(_class,e),r(style,e),r(prefix,e),r(selection,e),r(text_2,e),r(path,e),r(geom,e),r(matrix,e),r(transform_1,e),r(mousewheel,e)})),vector=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createVectors=e.createVector=e.isVector=void 0,e.isVector=vector$1.Vector.isVector,e.createVector=vector$1.Vector.create,e.createVectors=vector$1.Vector.createVectors})),main=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),r(core,e),r(vector,e)})),dom=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=commonjsGlobal&&commonjsGlobal.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Dom=void 0;var o=i(main);e.Dom=o})),util$2=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.debounce=void 0,e.debounce=function(t,e){var n=this;void 0===e&&(e=60);var r=null;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];r&&clearTimeout(r),r=window.setTimeout((function(){t.apply(n,i)}),e)}}})),object=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createSensor=void 0,e.createSensor=function(t){var e=null,n=[],r=(0,util$2.debounce)((function(){n.forEach((function(e){return e(t)}))})),i=function(){e&&e.parentNode&&(e.contentDocument&&e.contentDocument.defaultView.removeEventListener("resize",r),e.parentNode.removeChild(e),e=null,n=[])};return{element:t,bind:function(i){e||(e=function(){"static"===getComputedStyle(t).position&&(t.style.position="relative");var e=document.createElement("object");return e.onload=function(){e.contentDocument.defaultView.addEventListener("resize",r),r()},e.style.display="block",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.height="100%",e.style.width="100%",e.style.overflow="hidden",e.style.pointerEvents="none",e.style.zIndex="-1",e.style.opacity="0",e.setAttribute("tabindex","-1"),e.type="text/html",t.appendChild(e),e.data="about:blank",e}()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:function(t){var r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&e&&i()}}}})),observer=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createSensor=void 0,e.createSensor=function(t){var e=null,n=[],r=(0,util$2.debounce)((function(){n.forEach((function(e){e(t)}))})),i=function(){e&&(e.disconnect(),n=[],e=null)};return{element:t,bind:function(i){e||(e=function(){var e=new ResizeObserver(r);return e.observe(t),r(),e}()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:function(t){var r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&e&&i()}}}})),sensors=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.createSensor=void 0,e.createSensor="undefined"!=typeof ResizeObserver?observer.createSensor:object.createSensor})),sizeSensor=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.SizeSensor=void 0,function(t){var e=new WeakMap;function n(t){var n=e.get(t);return n||(n=(0,sensors.createSensor)(t),e.set(t,n),n)}t.bind=function(t,e){var r=n(t);return r.bind(e),function(){return r.unbind(e)}},t.clear=function(t){var r;(r=n(t)).destroy(),e.delete(r.element)}}(e.SizeSensor||(e.SizeSensor={}))})),scheduler=createCommonjsModule((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Scheduler=void 0,function(t){var e=[],n=[],r=0,i=function(){return performance.now()},o=function(t){return t[0]},s=function(t){return 1===n.push(t)&&a()},a=function(){var t=function(){return n.splice(0,n.length).forEach((function(t){return t()}))};if("undefined"!=typeof MessageChannel){var e=new MessageChannel,r=e.port2;return e.port1.onmessage=t,function(){return r.postMessage(null)}}return function(){return setTimeout(t)}}(),l=function(){r=i()+16.666666666666668;for(var n=o(e);n&&!t.shouldYield();){var a=n.callback,c=n.data;n.callback=null;var u=a&&a(c);u?n.callback=u:e.shift(),n=o(e)}n&&s(l)};t.scheduleTask=function(t,n){e.push({callback:t,data:n}),s(l)},t.shouldYield=function(){var t,e;return(null===(e=null===(t=navigator)||void 0===t?void 0:t.scheduling)||void 0===e?void 0:e.isInputPending())||i()>=r}}(e.Scheduler||(e.Scheduler={}))})),util$1=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),r=commonjsGlobal&&commonjsGlobal.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)},i=commonjsGlobal&&commonjsGlobal.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.JQuery=void 0;var o=i(jquery);e.JQuery=o.default,r(lang,e),r(array,e),r(object$1,e),r(string,e),r(number,e),r(_function,e),r(platform,e),r(text,e),r(json,e),r(datauri,e),r(unit,e),r(dom,e),r(vector$1,e),r(sizeSensor,e),r(scheduler,e)})),util=createCommonjsModule((function(t,e){var n=commonjsGlobal&&commonjsGlobal.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.toResult=e.normalizePoint=void 0,e.normalizePoint=function(t,e){return void 0===e&&(e={}),new geometry.Point(util$1.NumberExt.normalizePercentage(e.x,t.width),util$1.NumberExt.normalizePercentage(e.y,t.height))},e.toResult=function(t,e,r){return n({angle:e,position:t.toJSON()},r)}}));Graph.registerPortLayout("dynamicOut",((t,e)=>t.map(((n,r)=>{const i=t.length,o=(r+.5)/i,s=i<=3?e.getTopRight():e.getBottomLeft(),a=e.getBottomRight(),l=new Line(s,a).pointAt(o);return util.toResult(l.round(),0,{})})))),Graph.registerPortLayout("dynamicIn",((t,e)=>t.map(((n,r)=>{const i=t.length,o=(r+.5)/i,s=e.getTopLeft(),a=i<=3?e.getBottomLeft():e.getTopRight(),l=new Line(s,a).pointAt(o);return util.toResult(l.round(),0,{})})))),Graph.registerConnector("elsa-connector",((t,e)=>{const n=Math.abs(e.y-t.y),r=Math.floor(n/3*2);return Path$1.normalize(`M ${t.x} ${t.y}\n       L ${t.x} ${t.y+0}\n       C ${t.x} ${t.y+0+r} ${e.x} ${e.y-0-r} ${e.x} ${e.y-0}\n       L ${e.x} ${e.y}\n      `)}),!0),Graph.registerEdge("elsa-edge",{inherit:"edge",attrs:{line:{stroke:"#C2C8D5",strokeWidth:1,targetMarker:null}}},!0);class ActivityNodeShape extends HTML{get component(){return this.store.get("component")}set component(t){this.store.set("component",t)}set activity(t){this.store.set("activity",t)}get activity(){return this.store.get("activity")}get activityDescriptor(){return this.store.get("activityDescriptor")}set activityDescriptor(t){this.store.set("activityDescriptor",t)}get displayContext(){return this.store.get("displayContext")}set displayContext(t){this.store.set("displayContext",t)}init(){super.init(),this.updateSize()}setup(){const t=this;super.setup(),this.on("change:component",this.updateSize,this),this.on("change:activity",this.updateSize,this),this.html={render:()=>t.createHtml(),shouldComponentUpdate:t=>t.hasChanged("component")||t.hasChanged("activity")}}updateSize(){const t=document.createElement("div");t.className="w-full flex items-center pl-10 pr-2 py-2 absolute",t.style.left="-1000px",t.style.top="-1000px",t.innerHTML=this.createHtml(),document.body.append(t);const e=()=>{const n=t.getElementsByTagName("elsa-default-activity-template")[0].getBoundingClientRect();if(0==n.width||0==n.height)return void window.requestAnimationFrame(e);const r=t.firstElementChild.getBoundingClientRect();this.prop({size:{width:r.width,height:r.height}}),t.remove()};e()}createHtml(){return`<elsa-default-activity-template\n       class="activity elsa-inline-block elsa-rounded elsa-bg-white elsa-text-left elsa-text-black elsa-text-lg elsa-select-none elsa-max-w-md elsa-shadow-sm elsa-relative">\n        ${this.component}</elsa-default-activity-template>`}}ActivityNodeShape.config({ports:{items:[{group:"out"},{group:"in"}],groups:{in:{position:"dynamicIn",attrs:{circle:{r:6,magnet:!0,stroke:"#3c82f6",strokeWidth:2,fill:"#fff"},text:{fontSize:12,fill:"#888"}},label:{position:{name:"outside"}}},out:{position:"dynamicOut",attrs:{circle:{r:6,magnet:!0,stroke:"#fff",strokeWidth:2,fill:"#3c82f6"},text:{fontSize:12,fill:"#888"}},label:{position:{name:"outside"}}}}},portMarkup:[{tagName:"circle",selector:"portBody"}]}),Graph.registerNode("activity",ActivityNodeShape,!0);let _cursorX=0,_cursorY=0;function createGraph(t,e,n,r,i=!1){const o=new Graph({container:t,interacting:e,embedding:{enabled:!1},grid:{type:"mesh",size:20,visible:!0,args:{color:"#e0e0e0"}},height:5e3,width:5e3,async:!1,autoResize:!0,keyboard:{enabled:!0,global:!1},clipboard:{enabled:!0,useLocalStorage:!0},selecting:{enabled:!0,showNodeSelectionBox:!1,rubberband:!i},scroller:{enabled:!0,pannable:!0,pageVisible:!0,pageBreak:!1,padding:0,modifiers:["ctrl","meta"]},connecting:{allowBlank:!1,allowMulti:!i,allowLoop:!i,allowNode:!i,allowEdge:!1,allowPort:!i,highlight:!i,router:{name:"manhattan",args:{padding:10,startDirections:["right","bottom"],endDirections:["left"]}},connector:{name:"rounded",args:{radius:10}},snap:{radius:10},validateMagnet:({magnet:t})=>"in"!==t.getAttribute("port-group"),validateConnection({sourceView:t,sourceMagnet:e,targetMagnet:n}){if(!n||"in"!==n.getAttribute("port-group"))return!1;const r=e.getAttribute("port"),i=t.cell.getPort(r);return!(i&&i.connected)},createEdge:()=>o.createEdge({shape:"elsa-edge",zIndex:-1})},onPortRendered(t){},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},mousewheel:{enabled:!0,modifiers:["ctrl","meta"],zoomAtMousePosition:!0,minScale:.5,maxScale:3},history:{enabled:!i,beforeAddCommand:(t,e)=>"tools"!=e.key&&["cell:added","cell:removed","cell:change:*","edge:change:*"].indexOf(t)>=0}});return addGraphEvents(o,n,r,i),o}function addGraphEvents(t,e,n,r){if(!r){function i(t,e){e.length&&t.copy(e);const n=localStorage.getItem("x6.clipboard.cells");navigator.clipboard.writeText(n)}t.on("node:mousedown",(({node:t})=>{t.toFront()})),t.on("edge:mouseenter",(({edge:t})=>{t.addTools(["source-arrowhead","target-arrowhead",{name:"button-remove",args:{distance:-30}}])})),t.on("edge:mouseleave",(({edge:t})=>{t.removeTools()})),t.on("edge:removed",(({})=>{})),t.bindKey(["meta+c","ctrl+c"],(()=>{const e=t.getSelectedCells();return i(t,e),!1})),t.bindKey(["meta+x","ctrl+x"],(()=>{const e=t.getSelectedCells();e.length&&t.cut(e);const n=localStorage.getItem("x6.clipboard.cells");return navigator.clipboard.writeText(n),!1})),t.bindKey(["meta+v","ctrl+v"],(async()=>{var r=await navigator.clipboard.readText();if(r){e();let s=[];try{if(s=Model.fromJSON(JSON.parse(r)),!(null==s?void 0:s.length))return void console.log("No cells to paste");s.forEach((t=>{t.model=null,t.removeProp("zIndex"),t.translate(0,0)})),t.addCell(s),i(t,s);var o=s.filter((t=>!!t.activity)).reduce((function(t,e){return t[e.activity.activityId]=e.id,t}),{});const e=s.filter((t=>!!t.activity)).map((t=>t.position({relative:!1}))),n=Math.min(...e.map((t=>t.x))),a=Math.min(...e.map((t=>t.y)));t.disableHistory();for(const e of s)if(e.activity){e.activity.activityId=e.id;const r=e.position({relative:!1}),i=t.pageToLocal(_cursorX,_cursorY),o=i.x+r.x-n,s=i.y+r.y-a;e.position(o,s),e.activity.x=Math.round(o),e.activity.y=Math.round(s)}else e.data&&(e.data.sourceId=o[e.data.sourceId]||e.data.sourceId,e.data.targetId=o[e.data.targetId]||e.data.targetId)}catch(t){console.error(t)}t.enableHistory(),await n(!0),t.cleanSelection(),s.length&&t.select(s)}return!1})),t.bindKey(["meta+z","ctrl+z"],(()=>(t.history.canUndo()&&t.history.undo(),!1))),t.bindKey(["meta+y","ctrl+y"],(()=>(t.history.canRedo()&&t.history.redo(),!1))),t.bindKey("del",(()=>{const e=t.getSelectedCells();e.length&&t.removeCells(e)}))}t.bindKey(["meta+a","ctrl+a"],(()=>{const e=t.getNodes();e&&t.select(e)})),t.bindKey(["ctrl+1","meta+1"],(()=>{t.zoom()<1.5&&t.zoom(.1)})),t.bindKey(["ctrl+2","meta+2"],(()=>{t.zoom()>.5&&t.zoom(-.1)}))}function removeGraphEvents(t){t.off("node:mousedown"),t.off("edge:mouseenter"),t.off("edge:mouseleave"),t.off("edge:removed"),t.unbindKey(["meta+c","ctrl+c"]),t.unbindKey(["meta+x","ctrl+x"]),t.unbindKey(["meta+v","ctrl+v"]),t.unbindKey(["meta+z","ctrl+z"]),t.unbindKey(["meta+y","ctrl+y"]),t.unbindKey("del"),t.unbindKey(["meta+a","ctrl+a"]),t.unbindKey(["ctrl+1","meta+1"]),t.unbindKey(["ctrl+2","meta+2"])}addEventListener("mousemove",(t=>{_cursorX=t.clientX,_cursorY=t.clientY})),Graph.registerNode("activity",ActivityNodeShape,!0);const x6DesignerCss='.workflow-canvas{box-sizing:border-box;height:calc(100vh - 64px);width:100%}.outcome,.workflow-canvas{background-color:#fbfbfb}.start-btn{display:flex;justify-content:center;pointer-events:none;top:1rem;width:100%}.start-btn>*{pointer-events:auto}.layout-btn{bottom:2rem;display:flex;left:1rem}.elsa-workflow-wrapper{height:calc(100vh - 64px);overflow:hidden;width:100%}.workflow-canvas .x6-graph-scroller{height:100%!important;position:relative;width:100%!important}.x6-port-out .x6-port-label{opacity:0;transition:opacity .2s ease-in}.x6-port-out:hover .x6-port-label{opacity:1}.context-menu-button-container button{position:relative}.context-menu-button-container button:before{content:"";cursor:pointer;height:44px;position:absolute;width:44px}.x6-node-selected elsa-default-activity-template:after{border:2px dashed #feb663;content:"";height:calc(100% + 8px);left:-4px;position:absolute;top:-4px;width:calc(100% + 8px)}';let ElsaWorkflowDesigner=class{constructor(hostRef){registerInstance(this,hostRef),this.workflowChanged=createEvent(this,"workflow-changed",7),this.activitySelected=createEvent(this,"activitySelected",7),this.activityDeselected=createEvent(this,"activityDeselected",7),this.activityContextMenuButtonClicked=createEvent(this,"activityContextMenuButtonClicked",7),this.connectionContextMenuButtonClicked=createEvent(this,"connectionContextMenuButtonClicked",7),this.activityContextMenuButtonTestClicked=createEvent(this,"activityContextMenuButtonTestClicked",7),this.activityDeleted=createEvent(this,"activityDeleted",7),this.addingActivity=!1,this.selectedActivities={},this.ignoreCopyPasteActivities=!1,this.silent=!1,this.ignoreNextNodeSelect=!1,this.activityDisplayContexts=null,this.workflowSaveTimer=null,this.edgeUpdateTimer=null,this.model={activities:[],connections:[],persistenceBehavior:WorkflowPersistenceBehavior.WorkflowBurst},this.selectedActivityIds=[],this.mode=WorkflowDesignerMode.Edit,this.layoutDirection=LayoutDirection.TopBottom,this.activityContextMenuState={shown:!1,x:0,y:0,activity:null,selectedActivities:{}},this.connectionContextMenuState={shown:!1,x:0,y:0,activity:null},this.activityContextMenuTestState={shown:!1,x:0,y:0,activity:null},this.createAndInitializeGraph=async()=>{const t=this.graph=createGraph(this.container,{},this.disableEvents,this.enableEvents,this.mode!==WorkflowDesignerMode.Edit);t.on("blank:click",this.onGraphClick),t.on("node:selected",this.onNodeSelected),t.on("node:unselected",this.onNodeUnselected),t.on("node:contextmenu",this.onNodeContextMenu),t.on("edge:connected",this.onEdgeConnected),t.on("node:moved",this.onNodeMoved),t.on("node:removed",this.updateModelFromGraph),t.on("node:change:*",this.updateModelFromGraph),t.on("node:added",this.updateModelFromGraph),t.on("edge:added",this.updateModelFromGraph),t.on("edge:removed",this.updateModelFromGraph),t.on("edge:connected",this.updateModelFromGraph),await this.updateLayout()},this.disableEvents=()=>this.silent=!0,this.enableEvents=t=>{this.silent=!1,!0===t&&this.updateModelFromGraph()},this.getOutcomes=(activity,definition)=>{let outcomes=[];const displayContext=this.activityDisplayContexts[activity.activityId];if(definition){const lambda=displayContext.outcomes||definition.outcomes;if(lambda instanceof Array)outcomes=lambda;else{const value=eval(lambda);if(value instanceof Array)outcomes=value;else if(value instanceof Function)try{outcomes=value({activity,definition,state:activity.state})}catch(t){console.warn(t),outcomes=[]}}}return outcomes||[]},this.onNodeMoved=async t=>{const e=t.node,n=e.activity,r=e.position({relative:!1});n.x=Math.round(r.x),n.y=Math.round(r.y),e.id!==n.activityId&&(n.activityId=e.id),this.updateActivityInternal(n)},this.onNodeSelected=async t=>{if(this.ignoreNextNodeSelect)return void(this.ignoreNextNodeSelect=!1);const e=t.node.activity;this.selectedActivities[e.activityId]=e,this.activitySelected.emit(e)},this.onNodeUnselected=async t=>{const e=t.node.activity;this.selectedActivities[e.activityId]&&(this.activityDeselected.emit(this.selectedActivities[e.activityId]),delete this.selectedActivities[e.activityId])},this.onNodeContextMenu=t=>{t.e.preventDefault(),this.mode!=WorkflowDesignerMode.Edit&&this.mode!=WorkflowDesignerMode.Instance||this.handleContextMenuChange({x:t.e.clientX,y:t.e.clientY,shown:!0,activity:t.node.activity,selectedActivities:this.selectedActivities})},this.onGraphClick=async()=>{for(const t in this.selectedActivities)this.activityDeselected.emit(this.selectedActivities[t]);this.selectedActivities={}},this.onEdgeConnected=async t=>{const e=t.edge;let n=Object.assign({},this.workflowModel);const r=e.getSourceNode(),i=e.getTargetCellId(),o=e.getSourcePortId();if(e.data=this.addConnection(r.id,i,o),!this.enableMultipleConnectionsFromSingleSource&&!n.connections.find((t=>t.sourceId===r.id&&t.targetId==i))){const t={sourceId:r.id,targetId:i,outcome:o};e.data=t,e.insertLabel(o),n.connections=[...n.connections,t],this.updateWorkflowModel(n)}},this.createGraphNode=t=>{const e=state.activityDescriptors.find((e=>e.type==t.type)),n=this.mode===WorkflowDesignerMode.Blueprint?t.outcomes:this.getOutcomes(t,e);let r=[{group:"in",id:v4(),attrs:{}}];return n.forEach((t=>r.push({id:t,group:"out",attrs:{text:{text:t}}}))),{id:t.activityId,shape:"activity",x:t.x||0,y:t.y||0,type:t.type,activity:t,ports:{items:r},component:this.renderActivity(t)}},this.getEdgeStep=(t,e)=>{const n=this.workflowModel.activities.find((t=>t.activityId===e)),r=this.workflowModel.connections.filter((e=>e.sourceId===t)).map((t=>this.workflowModel.activities.find((e=>e.activityId===t.targetId)))).filter((t=>!!t));let i=10,o=10;if(n){const t=r.filter((t=>Math.abs(t.y-n.y)<20)).sort(((t,e)=>t.x>e.x?1:-1)),e=r.filter((t=>Math.abs(t.x-n.x)<20)).sort(((t,e)=>t.y>e.y?1:-1));t.length>1&&(o+=32*t.findIndex((t=>t.activityId==n.activityId))),e.length>1&&(i+=32*e.findIndex((t=>t.activityId==n.activityId)))}return Math.max(i,o)},this.createEdge=t=>({shape:"elsa-edge",zIndex:-1,data:t,source:t.sourceId,sourcePort:t.outcome,target:t.targetId,targetPort:t.targetPort,outcome:t.outcome,router:this.createEdgeRouter(t.sourceId,t.targetId),labels:[{attrs:{label:{text:t.outcome}}}]}),this.createEdgeRouter=(t,e)=>{const n=this.activityDisplayContexts[t];return{name:"manhattan",args:{padding:10,step:this.getEdgeStep(t,e),startDirections:(null==n?void 0:n.outcomes.length)>3?["bottom"]:["right"],endDirections:["left"]}}},this.updateModelFromGraph=t=>{if(this.silent)return;this.updateGraphEdgeViews();const e=this.graph.toJSON(),n=e.cells.filter((t=>"activity"==t.shape)).map((t=>t.activity)),r=e.cells.map((e=>(null==t?void 0:t.edge)&&t.edge.data&&e.id==t.edge.id?this.createEdge(t.edge.data):e)).filter((t=>"elsa-edge"==t.shape&&!!t.data)).map((t=>t.data));this.updateWorkflowModel({activities:n,connections:r,persistenceBehavior:WorkflowPersistenceBehavior.WorkflowBurst})},this.updateGraphEdgeViews=()=>{this.disableEvents(),this.edgeUpdateTimer&&clearTimeout(this.edgeUpdateTimer),this.edgeUpdateTimer=setTimeout((()=>{this.edgeUpdateTimer=null,this.graph.disableHistory();const t=this.graph.getCells().filter((t=>"elsa-edge"==t.shape));for(const e of t)e.router=this.createEdgeRouter(e.source.cell,e.target.cell),this.graph.findViewByCell(e.id).update();this.graph.enableHistory()}),10),this.enableEvents(!1)},this.updateGraph=async()=>{const t=this.workflowModel.activities,e=this.workflowModel.connections,n=[];for(const e of t)this.activityDisplayContexts[e.activityId]=await this.getActivityDisplayContext(e);const r=t.map((t=>this.createGraphNode(t)));for(const t of e){const e=this.createEdge(t);n.push(e)}const i={nodes:r,edges:n};this.graph.freeze(),this.graph.fromJSON(i,{silent:!1}),this.graph.unfreeze()},this.findActivityById=t=>this.workflowModel.activities.find((e=>e.activityId===t)),this.onWorkflowImported=t=>{this.workflowModel=t,this.updateGraph(),this.isAutoLayoutRequired&&setTimeout((()=>{this.applyAutoLayout()}),1),this.graph.scrollToContent()},this.onActivityPicked=async t=>{const e=this.newActivity(t),n=!this.parentActivityOutcome||""==this.parentActivityOutcome;this.addActivity(e,n?null:this.parentActivityId,n?this.parentActivityId:null,this.parentActivityOutcome)},this.onUpdateActivityExternal=t=>{const e=t;if(this.addingActivity){console.debug(`adding activity with ID ${e.activityId}`);const t=!this.parentActivityOutcome||""==this.parentActivityOutcome;this.addActivity(e,t?null:this.parentActivityId,t?this.parentActivityId:null,this.parentActivityOutcome),this.addingActivity=!1}else console.debug(`updating activity with ID ${e.activityId}`),this.updateActivityExternal(e)}}handleActivityContextMenuChanged(t){this.activityContextMenuState=t}handleConnectionContextMenuChanged(t){this.connectionContextMenuState=t}handleActivityContextMenuTestChanged(t){this.activityContextMenuTestState=t}handleActivityContextMenuButtonChanged(t){this.mode!==WorkflowDesignerMode.Edit?(this.graph.resetSelection(),this.graph.disableRubberband(),this.graph.disableHistory(),removeGraphEvents(this.graph)):(this.graph.enableRubberband(),this.graph.enableHistory(),addGraphEvents(this.graph,this.disableEvents,this.enableEvents,!1)),setTimeout((()=>this.updateGraph()),1)}handleModelChanged(t){this.model!==t&&(this.updateWorkflowModel(t,!1),setTimeout((()=>this.updateGraph()),1))}async removeActivity(t){const e=this.graph.getCells().find((e=>e.id===t.activityId));e&&this.graph.removeCell(e)}async removeSelectedActivities(){const t=this.graph.getCells().filter((t=>this.selectedActivityIds.includes(t.id)));this.graph.removeCells(t)}async showActivityEditor(t,e){await this.showActivityEditorInternal(t,e)}async updateLayout(){this.graph.resize(this.el.clientWidth,this.el.clientHeight),this.graph.updateBackground()}async componentDidLoad(){await this.createAndInitializeGraph();const t=new ResizeObserver((()=>{this.container.clientHeight>0&&(this.onContainerLoaded(),t.unobserve(this.container))}));t.observe(this.container)}onContainerLoaded(){this.isAutoLayoutRequired&&setTimeout((()=>this.applyAutoLayout()),100),this.updateGraph(),this.workflowModel.activities.length&&setTimeout((()=>this.graph.scrollToContent()),10)}applyAutoLayout(){const t=new dagre$1.graphlib.Graph;t.setGraph({rankdir:"TB",nodesep:30,ranksep:180}),t.setDefaultEdgeLabel((()=>({}))),this.workflowModel.activities.forEach((e=>{const n=document.querySelectorAll('g[data-cell-id="'+e.activityId+'"]')[0].getBoundingClientRect();t.setNode(e.activityId,{label:e.activityId,width:Math.max(220,n.width),height:Math.max(64,n.height)})})),this.workflowModel.connections.forEach((e=>{t.setEdge(e.sourceId,e.targetId)})),dagre$1.layout(t),this.disableEvents(),this.graph.batchUpdate((()=>{this.workflowModel.activities.forEach((e=>{const n=t.node(e.activityId),r=this.graph.getCellById(e.activityId);r.setProp("position",{x:n.x,y:n.y}),e.x=Math.round(n.x),e.y=Math.round(n.y),r.activity=e}))})),this.graph.scrollToContent(),this.enableEvents(!0),setTimeout((()=>this.updateGraphEdgeViews()),100),console.log("Auto-layout applied")}connectedCallback(){eventBus.on(EventTypes.WorkflowImported,this.onWorkflowImported),eventBus.on(EventTypes.ActivityPicked,this.onActivityPicked),eventBus.on(EventTypes.UpdateActivity,this.onUpdateActivityExternal),eventBus.on(EventTypes.TestActivityMessageReceived,this.updateGraph)}disconnectedCallback(){eventBus.detach(EventTypes.WorkflowImported,this.onWorkflowImported),eventBus.detach(EventTypes.ActivityPicked,this.onActivityPicked),eventBus.detach(EventTypes.UpdateActivity,this.onUpdateActivityExternal),eventBus.detach(EventTypes.TestActivityMessageReceived,this.updateGraph)}componentWillLoad(){this.workflowModel=this.model}async componentWillRender(){if(this.activityDisplayContexts)return;const t=this.workflowModel.activities,e={};for(const n of t)e[n.activityId]=await this.getActivityDisplayContext(n);this.activityDisplayContexts=e}get isAutoLayoutRequired(){return!(this.workflowModel.activities.length<2)&&-1===this.workflowModel.activities.findIndex((t=>!!t.x||!!t.y))}handleContextMenuChange(t){this.ignoreCopyPasteActivities=!0,this.activityContextMenuState=t,this.activityContextMenuButtonClicked.emit(t)}handleConnectionContextMenuChange(t){this.connectionContextMenuState=t,this.connectionContextMenuButtonClicked.emit(t)}handleContextMenuTestChange(t){this.ignoreCopyPasteActivities=!0,this.activityContextMenuTestState=t,this.activityContextMenuButtonTestClicked.emit(t)}async onAddActivity(t){t.preventDefault(),this.mode!==WorkflowDesignerMode.Test&&await this.showActivityPicker()}async getActivityDisplayContext(t){let e=state.activityDescriptors.find((e=>e.type==t.type));e||(e=this.createNotFoundActivityDescriptor(t));const n={activityModel:t,activityDescriptor:e,outcomes:[...t.outcomes]};return await eventBus.emit(EventTypes.ActivityDesignDisplaying,this,n),n.outcomes=n.outcomes.filter((function(t,e){return n.outcomes.indexOf(t)==e})),n}createNotFoundActivityDescriptor(t){return{outcomes:["Done"],inputProperties:[],type:`(Not Found) ${t.type}`,outputProperties:[],displayName:`(Not Found) ${t.displayName||t.name||t.type}`,traits:ActivityTraits.Action,description:`(Not Found) ${t.description}`,category:"Not Found",browsable:!1,customAttributes:{}}}async showActivityEditorInternal(t,e){await eventBus.emit(EventTypes.ActivityEditor.Show,this,t,e)}updateWorkflowModel(t,e=!0){e&&this.mode!==WorkflowDesignerMode.Edit?this.updateGraph():(this.workflowModel=t,e&&(this.workflowSaveTimer&&clearTimeout(this.workflowSaveTimer),this.workflowSaveTimer=setTimeout((()=>{this.workflowChanged.emit(this.workflowModel)}),200)))}removeActivityInternal(t,e){let n=e||Object.assign({},this.workflowModel);const r=getInboundConnections(n,t.activityId),i=getOutboundConnections(n,t.activityId);if(n=removeActivity(n,t.activityId),i.length>0&&r.length>0)for(const t of r){const e=findActivity(n,t.sourceId);let r=i.find((e=>e.outcome===t.outcome));r||(r=i[0]),r&&(n=addConnection(n,{sourceId:e.activityId,targetId:r.targetId,outcome:t.outcome}))}return delete this.selectedActivities[t.activityId],e||this.updateWorkflowModel(n),n}newActivity(t){const e=this.el.getBoundingClientRect(),n=this.graph.pageToLocal(e.left+64,e.top+64),r={activityId:v4(),type:t.type,outcomes:t.outcomes,displayName:t.displayName,properties:[],propertyStorageProviders:{},x:Math.round(n.x),y:Math.round(n.y)};for(const e of t.inputProperties)r.properties[e.name]={syntax:"",expression:""};return r}async addActivity(t,e,n,r){r=r||"Done";const i=Object.assign(Object.assign({},this.workflowModel),{activities:[...this.workflowModel.activities,t]});if(n){const e=i.connections.find((t=>t.targetId==n&&t.outcome==r));if(e){i.connections=i.connections.filter((t=>t!=e));const n=Object.assign(Object.assign({},e),{sourceId:t.activityId});i.connections.push(n)}else i.connections.push({sourceId:t.activityId,targetId:n,outcome:r})}if(null!=e){const n=i.connections.find((t=>t.sourceId==e&&t.outcome==r));null!=n?(i.connections=i.connections.filter((t=>t!=n)),i.connections.push({sourceId:n.sourceId,targetId:t.activityId,outcome:n.outcome}),i.connections.push({sourceId:t.activityId,targetId:n.targetId,outcome:t.outcomes[0]})):i.connections.push({sourceId:e,targetId:t.activityId,outcome:r})}this.activityDisplayContexts[t.activityId]=await this.getActivityDisplayContext(t),this.updateWorkflowModel(i);var o=this.createGraphNode(t);this.graph.addNode(o,{merge:!0}),this.parentActivityId=null,this.parentActivityOutcome=null,this.selectActivityNode(t)}selectActivityNode(t){this.graph.resetSelection();const e=this.graph.getCells().find((e=>e.id===t.activityId));this.graph.select(e);for(const t in this.selectedActivities)this.activityDeselected.emit(this.selectedActivities[t]);this.selectedActivities={},this.selectedActivities[t.activityId]=t,this.activitySelected.emit(t),this.handleContextMenuChange({x:t.x,y:t.y,shown:!0,activity:t,selectedActivities:this.selectedActivities})}addConnection(t,e,n){const r=Object.assign({},this.workflowModel),i={sourceId:t,targetId:e,outcome:n};let o=r.connections;return this.enableMultipleConnectionsFromSingleSource||(o=[...r.connections.filter((e=>!(e.sourceId===t&&e.outcome===n)))]),r.connections=[...o,i],this.updateWorkflowModel(r),this.parentActivityId=null,this.parentActivityOutcome=null,i}updateActivityInternal(t){let e=Object.assign({},this.workflowModel);const n=[...e.activities],r=n.findIndex((e=>e.activityId===t.activityId));n[r]=t,this.updateWorkflowModel(Object.assign(Object.assign({},e),{activities:n}))}async updateActivityExternal(t){var e=this.findActivityById(t.activityId);t.x=e.x,t.y=e.y,this.graph.cleanHistory(),this.updateActivityInternal(t),this.updateGraph()}async showActivityPicker(){await eventBus.emit(EventTypes.ShowActivityPicker)}handleActivityStatsClick(t){this.mode===WorkflowDesignerMode.Test&&setTimeout((()=>{const e=this.container.querySelectorAll(`div[stats-activity-id="${t.activityId}"] button`)[0];null==e||e.addEventListener("click",(e=>{this.ignoreNextNodeSelect=!0,e.stopPropagation(),this.activityContextMenuButtonTestClicked.emit({x:e.clientX,y:e.clientY,shown:!0,activity:t})}))}),1),this.mode===WorkflowDesignerMode.Instance&&setTimeout((()=>{const e=this.container.querySelectorAll(`div[stats-activity-id="${t.activityId}"] button`)[0];null==e||e.addEventListener("click",(e=>{this.ignoreNextNodeSelect=!0,e.stopPropagation(),this.handleContextMenuChange({x:e.clientX,y:e.clientY,shown:!0,activity:t,selectedActivities:this.selectedActivities})}))}),1)}renderActivity(t){const e=this.activityBorderColor?this.activityBorderColor(t):"gray",n=`elsa-border-${e}-200 hover:elsa-border-${this.activityBorderColor?e:"blue"}-600`,r=t.type;let i=this.activityContextMenuButton?this.activityContextMenuButton(t):"",o=state.activityDescriptors.find((e=>e.type==t.type));o||(o=this.createNotFoundActivityDescriptor(t));const s=o?t.displayName:`(Not Found) ${t.displayName}`,a=(o.traits&=ActivityTraits.Trigger)==ActivityTraits.Trigger?"rose":"sky",l=h(ActivityIcon,{color:a});return this.handleActivityStatsClick(t),`<div class="elsa-border-2 elsa-border-solid ${n}">\n      <div class="elsa-p-2" style="padding-right: 2.6rem">\n        <div class="elsa-flex elsa-justify-between elsa-space-x-4 mr-4">\n          <div class="elsa-flex-shrink-0">\n            ${l}\n          </div>\n          <div class="elsa-flex-1 elsa-font-medium elsa-leading-8 elsa-overflow-hidden">\n            <p class="elsa-overflow-ellipsis elsa-text-base">${s}</p>\n            ${r!==s?`<p class="elsa-text-gray-400 elsa-text-sm">${r}</p>`:""}\n          </div>\n          <div class="context-menu-button-container elsa-absolute elsa-z-1" stats-activity-id="${t.activityId}" style="right: 0.5rem">\n            ${i}\n          </div>\n        </div>\n      </div>\n    </div>`}render(){return h(Host,null,h("div",{class:"workflow-canvas elsa-flex-1 elsa-flex"},h("div",{ref:t=>this.container=t})),this.mode==WorkflowDesignerMode.Edit&&h("div",{class:"start-btn elsa-absolute elsa-z-1"},h("button",{type:"button",onClick:t=>this.onAddActivity(t),class:"elsa-h-12 elsa-px-6 elsa-mx-3 elsa-border elsa-border-transparent elsa-text-base elsa-font-medium elsa-rounded-md elsa-text-white elsa-bg-green-600 hover:elsa-bg-green-500 focus:elsa-outline-none focus:elsa-border-green-700 focus:elsa-shadow-outline-green active:elsa-bg-green-700 elsa-transition elsa-ease-in-out elsa-duration-150 elsa-top-8"},"Add activity")),this.mode!==WorkflowDesignerMode.Test&&h("div",{class:"layout-btn elsa-absolute elsa-z-1"},h("button",{type:"button",onClick:()=>this.applyAutoLayout(),class:"elsa-h-12 elsa-px-6 elsa-mx-3 elsa-border elsa-border-transparent elsa-text-base elsa-font-medium elsa-rounded-md elsa-text-white elsa-bg-yellow-600 hover:elsa-bg-yellow-500 focus:elsa-outline-none focus:elsa-border-yellow-50 focus:elsa-shadow-outline-green active:elsa-bg-yellow-500 elsa-transition elsa-ease-in-out elsa-duration-150 elsa-top-8"},"Auto-layout")),this.mode==WorkflowDesignerMode.Test?h("div",null,h("div",{id:"left",style:{border:"4px solid orange",position:"absolute",height:"calc(100vh - 64px)",width:"4px",top:"0",bottom:"0",left:"0"}}),h("div",{id:"right",style:{border:"4px solid orange",position:"absolute",height:"calc(100vh - 64px)",width:"4px",top:"0",bottom:"0",right:"0"}}),h("div",{id:"top",style:{border:"4px solid orange",position:"absolute",height:"4px",left:"0",right:"0",top:"0"}}),h("div",{id:"bottom",style:{border:"4px solid orange",position:"absolute",height:"4px",left:"0",right:"0",bottom:"0"}})):void 0)}static get assetsDirs(){return["assets"]}get el(){return getElement(this)}static get watchers(){return{activityContextMenu:["handleActivityContextMenuChanged"],connectionContextMenu:["handleConnectionContextMenuChanged"],activityContextTestMenu:["handleActivityContextMenuTestChanged"],mode:["handleActivityContextMenuButtonChanged"],model:["handleModelChanged"]}}};ElsaWorkflowDesigner.style=x6DesignerCss;export{ElsaCopyButton as elsa_copy_button,ElsaWorkflowDesigner$1 as elsa_designer_tree,ElsaWorkflowEditorNotifications as elsa_workflow_definition_editor_notifications,ElsaWorkflowFaultInformation as elsa_workflow_fault_information,ElsaWorkflowPerformanceInformation as elsa_workflow_performance_information,ElsaWorkflowDesigner as x6_designer};