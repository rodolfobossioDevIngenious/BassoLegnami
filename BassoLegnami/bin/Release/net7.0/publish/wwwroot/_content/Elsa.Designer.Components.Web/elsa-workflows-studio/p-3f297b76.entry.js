import{r as t,h as s}from"./p-ee0b9025.js";import{S as e}from"./p-c74b54ba.js";import{T as i}from"./p-37df3757.js";import{g as o}from"./p-8f8bc806.js";import{b as n}from"./p-971980b1.js";import"./p-83f217d4.js";import"./p-ccd51ea4.js";import"./p-e0c1fede.js";import"./p-f1ec68ec.js";import"./p-a3b5bd35.js";import"./p-80de33dc.js";import"./p-93cac3a6.js";import"./p-d88cb309.js";import"./p-82db2ff5.js";import"./p-949334ec.js";let r=class{constructor(e){t(this,e),this.selectList={items:[],isFlagsEnum:!1},this.reloadSelectListFromDeps=async t=>{const e={};for(const t of this.propertyDescriptor.options.context.dependsOnValue){const s=this.activityModel.properties.find((e=>e.name==t));e[t]=s.expressions.Literal}const s=t.currentTarget;e[s.id]=s.value;let r={context:Object.assign(Object.assign({},this.propertyDescriptor.options.context),{depValues:e}),runtimeSelectListProviderType:this.propertyDescriptor.options.runtimeSelectListProviderType};this.selectList=await o(this.serverUrl,{options:r});let i=await n("#"+this.propertyDescriptor.name);const p=this.propertyDescriptor.defaultValue;if(p)this.currentValue=p;else{const t=this.selectList.items[0];t&&(this.currentValue="object"==typeof t?t.value:t.toString())}requestAnimationFrame((()=>{i.dispatchEvent(new Event("change"))}))}}async componentWillLoad(){var t,s;const r=this.propertyDescriptor.defaultSyntax||e.Literal;this.currentValue=this.propertyModel.expressions[r]||void 0;const i=null===(s=null===(t=this.propertyDescriptor.options)||void 0===t?void 0:t.context)||void 0===s?void 0:s.dependsOnEvent;if(i){const t={};for(const e of i){for(const e of this.activityModel.properties)t[e.name]=e.expressions.Literal;const s=await n("#"+e);s.addEventListener("change",this.reloadSelectListFromDeps),t[e]=s.value}const e={context:Object.assign(Object.assign({},this.propertyDescriptor.options.context),{depValues:t}),runtimeSelectListProviderType:this.propertyDescriptor.options.runtimeSelectListProviderType};if(this.selectList=await o(this.serverUrl,{options:e}),null==this.currentValue){const t=this.propertyDescriptor.defaultValue;if(t)this.currentValue=t;else{const t=this.selectList.items[0];t&&(this.currentValue="object"==typeof t?t.value:t.toString())}}}else if(this.selectList=await o(this.serverUrl,this.propertyDescriptor),null==this.currentValue){const t=this.propertyDescriptor.defaultValue;if(t)this.currentValue=t;else{const t=this.selectList.items[0];t&&(this.currentValue="object"==typeof t?t.value:t.toString())}}null!=this.currentValue&&(this.propertyModel.expressions[r]=this.currentValue)}onChange(t){this.propertyModel.expressions[this.propertyDescriptor.defaultSyntax||e.Literal]=this.currentValue=t.target.value}onDefaultSyntaxValueChanged(t){this.currentValue=t.detail}render(){const t=this.propertyDescriptor,e=this.propertyModel,r=t.name,i=r,o=r;let n=this.currentValue;const{items:p}=this.selectList;if(null==n){const t=this.propertyDescriptor.defaultValue;n=t?t.toString():void 0}return s("elsa-property-editor",{activityModel:this.activityModel,propertyDescriptor:t,propertyModel:e,onDefaultSyntaxValueChanged:t=>this.onDefaultSyntaxValueChanged(t),"single-line":!0},s("select",{id:i,name:o,onChange:t=>this.onChange(t),class:"elsa-mt-1 elsa-block focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-w-full elsa-shadow-sm sm:elsa-max-w-xs sm:elsa-text-sm elsa-border-gray-300 elsa-rounded-md"},p.map((t=>{const e="object"==typeof t,r=e?t.value:t.toString(),i=e?t.text:t.toString();return s("option",{value:r,selected:r===n},i)}))))}};i.injectProps(r,["serverUrl"]);export{r as elsa_dropdown_property};