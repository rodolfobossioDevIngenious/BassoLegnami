import{e as t}from"./p-93cac3a6.js";import{S as s}from"./p-c74b54ba.js";import{E as e}from"./p-d88cb309.js";import"./p-f1ec68ec.js";import"./p-a3b5bd35.js";import{h as i,g as n,s as o,p as r}from"./p-971980b1.js";import{d as a,A as c}from"./p-82db2ff5.js";import{c as p}from"./p-949334ec.js";import{h as l}from"./p-ee0b9025.js";import{p as y}from"./p-aae56f4d.js";import{a as d}from"./p-7462b7bd.js";class h{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("If"!==e.type)return;const s=(e.properties||[]).find((t=>"Condition"==t.name))||{name:"Condition",expressions:{Literal:""},syntax:"Literal"},n=e.description,o=i(n&&n.length>0?n:s.expressions[s.syntax]||"");t.bodyDisplay=`<p>${o}</p>`}}class u{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDisplaying),t.on(e.ActivityPluginUpdated,this.onActivityUpdated),t.on(e.ActivityPluginValidating,this.onActivityValidating),t.on(e.ComponentLoadingCustomButton,this.onComponentLoadingCustomButton),t.on(e.ComponentCustomButtonClick,this.onComponentCustomButtonClick)}onActivityDisplaying(t){const e=t.activityModel;if("HttpEndpoint"!==e.type)return;const n=(e.properties||[]).find((t=>"Path"==t.name))||{name:"Path",expressions:{Literal:"",syntax:s.Literal}},o=i(n.expressions[n.syntax||s.Literal]);t.bodyDisplay=`<p>${o}</p>`}onComponentLoadingCustomButton(t){if("HttpEndpoint"===t.activityType){if("elsa-script-property"===t.component){if("Schema"!==t.prop)return;t.data={label:"Convert to Json Schema"}}"elsa-workflow-definition-editor-screen"===t.component&&(t.data={label:"Use as Schema"})}}onComponentCustomButtonClick(i){var s;if("HttpEndpoint"===i.activityType){if("elsa-script-property"===i.component){if("Schema"!==i.prop)return;window.open("https://www.convertsimple.com/convert-json-to-json-schema/")}if("elsa-workflow-definition-editor-screen"===i.component){const n={activityModel:i.params[0],data:JSON.stringify(a.convert(null===(s=i.params[1])||void 0===s?void 0:s.Body),null,1)};t.emit(e.ActivityPluginUpdated,this,n)}}}onActivityUpdated(i){const n=i.activityModel;if("HttpEndpoint"!==n.type)return;const o=(n.properties||[]).find((t=>"Schema"==t.name))||{name:"Schema",expressions:{Literal:"",syntax:s.Literal}};o.expressions[s.Literal]=i.data,t.emit(e.UpdateActivity,this,o)}onActivityValidating(t){if("HttpEndpoint"!==t.activityType||"Schema"!==t.prop)return;const i=t.value;let e=!0;if(""==i)return;const s=new c;let n;try{n=JSON.parse(i)}catch(t){e=!1}if(null!=n)try{null!=s.compile(n).errors&&(e=!1)}catch(t){e=!1}t.isValidated=!0,t.isValid=e,t.data=e?"Json is valid":"Json is invalid"}}class m{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("Timer"!==e.type)return;const s=(e.properties||[]).find((t=>"Timeout"==t.name))||{name:"Timeout",expressions:{Literal:""},syntax:"Literal"},n=i(s.expressions[s.syntax]||"");t.bodyDisplay=`<p>${n}</p>`}}class f{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("WriteLine"!==e.type)return;const n=(e.properties||[]).find((t=>"Text"==t.name))||{name:"Text",expressions:{Literal:""},syntax:s.Literal};t.bodyDisplay=`<p>${i(n.expressions[n.syntax||"Literal"]||"")}</p>`}}class g{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("SendEmail"!==e.type)return;const n=(e.properties||[]).find((t=>"To"==t.name))||{expressions:{Json:""},syntax:s.Json},o=e.description,r=i(o&&o.length>0?o:n.expressions[n.syntax||s.Json]||"");t.bodyDisplay=`<p>To: ${r}</p>`}}class w{display(t,i){const e=n(t,i.name);return l("elsa-check-list-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class D{display(t,i){const e=n(t,i.name);return l("elsa-checkbox-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class v{display(t,i){const e=n(t,i.name),s=i.options||{},o=this.getEditorHeight(s);return l("elsa-script-property",{activityModel:t,propertyDescriptor:i,propertyModel:e,"editor-height":o,syntax:s.syntax})}update(t,i,e){const s=e.get(i.name);o(t,i.name,s,"Literal")}getEditorHeight(t){return"Large"===(t.editorHeight||"Default")?"20em":"8em"}}class x{display(t,i){const e=n(t,i.name);return l("elsa-dropdown-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class S{display(t,i){const e=n(t,i.name);return l("elsa-json-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class M{display(t,i,e){const s=n(t,i.name);return l("elsa-multi-text-property",{activityModel:t,propertyDescriptor:i,propertyModel:s,onValueChange:e})}update(t,i,e){}}class C{display(t,i){const e=n(t,i.name);return l("elsa-multi-line-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class L{display(t,i){const e=n(t,i.name);return l("elsa-radio-list-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class A{display(t,i){const e=n(t,i.name);return l("elsa-single-line-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}}class b{display(t,i){const e=n(t,i.name);return l("elsa-switch-cases-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class j{display(t,i){const e=n(t,i.name);return l("elsa-dictionary-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class E{display(t,i){const e=n(t,i.name);return l("elsa-cron-expression-property",{activityModel:t,propertyDescriptor:i,propertyModel:e})}update(t,i,e){}}class T{constructor(){this.addDriver("single-line",(()=>new A)),this.addDriver("multi-line",(()=>new C)),this.addDriver("json",(()=>new S)),this.addDriver("check-list",(()=>new w)),this.addDriver("radio-list",(()=>new L)),this.addDriver("checkbox",(()=>new D)),this.addDriver("dropdown",(()=>new x)),this.addDriver("multi-text",(()=>new M)),this.addDriver("code-editor",(()=>new v)),this.addDriver("switch-case-builder",(()=>new b)),this.addDriver("dictionary",(()=>new j)),this.addDriver("cron-expression",(()=>new E))}addDriver(t,i){y.addDriver(t,i)}}class P{constructor(){t.on(e.ActivityDescriptorDisplaying,this.onActivityDescriptorDisplaying),t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDescriptorDisplaying(t){const i=d.getIcon(t.activityDescriptor.type);i&&(t.activityIcon=i)}onActivityDesignDisplaying(t){const i=d.getIcon(t.activityModel.type);i&&(t.activityIcon=i)}}class R{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const i=t.activityModel,e=t.activityDescriptor.inputProperties.filter((t=>"switch-case-builder"==t.uiHint));if(0==e.length)return;let s={};for(const t of e){const e=((i.properties||[]).find((i=>i.name==t.name))||{expressions:{Switch:""},syntax:"Switch"}).expressions.Switch||[],n=e.$values?e.$values:Array.isArray(e)?e:r(e)||[];for(const t of n)s[t.name]=!0}const n=Object.keys(s);t.outcomes=[...n,"Default","Done"]}}class ${constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("While"!==e.type)return;const s=(e.properties||[]).find((t=>"Condition"==t.name))||{name:"Condition",expressions:{Literal:""},syntax:"Literal"},n=e.description,o=i(n&&n.length>0?n:s.expressions[s.syntax]||"");t.bodyDisplay=`<p>${o}</p>`}}class H{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("StartAt"!==e.type)return;const s=(e.properties||[]).find((t=>"Instant"==t.name))||{name:"Instant",expressions:{Literal:""},syntax:"Literal"},n=i(s.expressions[s.syntax]||"");t.bodyDisplay=`<p>${n}</p>`}}class N{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("Cron"!==e.type)return;const n=(e.properties||[]).find((t=>"CronExpression"==t.name))||{name:"CronExpression",expressions:{Literal:""},syntax:s.Literal},o=i(n.expressions[n.syntax||"Literal"]||""),r=p.toString(o,{throwExceptionOnParseError:!1});t.bodyDisplay=`<p style="overflow: hidden;text-overflow: ellipsis;" title="${r}">${r}</p>`}}class k{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDisplaying)}onActivityDisplaying(t){const e=t.activityModel;if("SignalReceived"!==e.type)return;const n=(e.properties||[]).find((t=>"Signal"==t.name))||{name:"Signal",expressions:{Literal:"",syntax:s.Literal}},o=i(n.expressions[n.syntax||s.Literal]);t.bodyDisplay=`<p>${o}</p>`}}class J{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDisplaying)}onActivityDisplaying(t){const e=t.activityModel;if("SendSignal"!==e.type)return;const n=(e.properties||[]).find((t=>"Signal"==t.name))||{name:"Signal",expressions:{Literal:"",syntax:s.Literal}},o=i(n.expressions[n.syntax||s.Literal]);t.bodyDisplay=`<p>${o}</p>`}}class O{constructor(){t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}onActivityDesignDisplaying(t){const e=t.activityModel;if("State"!==e.type)return;const n=(e.properties||[]).find((t=>"StateName"==t.name))||{name:"Text",expressions:{Literal:""},syntax:s.Literal};t.displayName=i(n.expressions[n.syntax||"Literal"]||"State")}}class I{constructor(){this.onActivityEditorAppearing=t=>{"SendHttpRequest"==t.activityDescriptor.type&&(document.querySelector("#ReadContent").addEventListener("change",this.updateUI),document.querySelector("#ResponseContentParserName").addEventListener("change",this.updateUI),this.updateUI())},this.onActivityEditorDisappearing=t=>{"SendHttpRequest"==t.activityDescriptor.type&&(document.querySelector("#ReadContent").removeEventListener("change",this.updateUI),document.querySelector("#ResponseContentParserName").removeEventListener("change",this.updateUI))},this.updateUI=()=>{const t=document.querySelector("#ReadContent"),i=document.querySelector("#ResponseContentParserName"),e=document.querySelector("#ResponseContentParserNameControl"),s=document.querySelector("#ResponseContentTargetTypeControl"),n=i.value;e.classList.toggle("hidden",!t.checked),s.classList.toggle("hidden",!t.checked||".NET Type"!=n)},t.on(e.ActivityEditor.Appearing,this.onActivityEditorAppearing),t.on(e.ActivityEditor.Disappearing,this.onActivityEditorDisappearing)}}class q{constructor(){this.onActivityDesignDisplaying=t=>{const i=t.activityDescriptor.inputProperties.filter((t=>t.considerValuesAsOutcomes));if(i.length>0){const e=s.Json;let n=[];(t.activityModel.properties||[]).filter((t=>null!=i.find((i=>i.name==t.name)))).forEach((t=>{const i=t.expressions[e]||[],s=i.$values?i.$values:Array.isArray(i)?i:r(i)||[];n=[...n,...s]})),t.outcomes=[...n,...t.outcomes]}},t.on(e.ActivityDesignDisplaying,this.onActivityDesignDisplaying)}}class B{constructor(){this.pluginFactories=[],this.createPlugin=t=>t(this.elsaStudio),this.pluginFactories=[()=>new T,()=>new P,()=>new h,()=>new $,()=>new R,()=>new u,()=>new I,()=>new m,()=>new H,()=>new N,()=>new k,()=>new J,()=>new f,()=>new O,()=>new g,()=>new q]}initialize(t){if(!this.initialized){this.elsaStudio=t;for(const t of this.pluginFactories)this.createPlugin(t);this.initialized=!0}}registerPlugins(t){for(const i of t)this.registerPlugin(i)}registerPlugin(t){this.registerPluginFactory((()=>new t(this.elsaStudio)))}registerPluginFactory(t){this.pluginFactories.push(t),this.initialized&&this.createPlugin(t)}}const U=new B;export{B as P,U as p};