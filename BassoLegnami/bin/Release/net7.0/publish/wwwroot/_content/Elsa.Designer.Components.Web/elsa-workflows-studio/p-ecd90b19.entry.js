import{r as s,h as e}from"./p-ee0b9025.js";import{S as t}from"./p-c74b54ba.js";import{T as l}from"./p-37df3757.js";import{i as a,I as o,a as i}from"./p-76935ab4.js";import"./p-83f217d4.js";let r=class{constructor(e){s(this,e),this.jsonToDictionary=e=>{if(!e)return[["",""]];const t=JSON.parse(e);return Object.keys(t).map((e=>[e,t[e]]))},this.dictionaryToJson=e=>{const t=this.removeInvalidKeys(e);return 0===t.length?null:JSON.stringify(Object.fromEntries(t))},this.removeInvalidKeys=e=>{const t=[];return e.forEach((e=>{const s=e[0].trim();""===s||t.some((e=>e[0].trim()===s))||t.push(e)})),t},this.onRowAdded=()=>{this.currentValue=[...this.currentValue,["",""]]},this.onRowDeleted=e=>{const s=this.currentValue.filter(((t,s)=>s!==e));0===s.length&&s.push(["",""]),this.currentValue=s,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(s)}}async componentWillLoad(){this.currentValue=this.jsonToDictionary(this.propertyModel.expressions[t.Json]||null),0===this.currentValue.length&&(this.currentValue=[["",""]])}onDefaultSyntaxValueChanged(e){this.currentValue=this.jsonToDictionary(e.detail)}onKeyChanged(e,s){this.currentValue[s][0]=e.currentTarget.value,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(this.currentValue)}onValueChanged(e,s){this.currentValue[s][1]=e.currentTarget.value,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(this.currentValue)}render(){const t=this.propertyDescriptor,s=t.name,r=this.currentValue;return e("elsa-property-editor",{propertyDescriptor:t,propertyModel:this.propertyModel,activityModel:this.activityModel,onDefaultSyntaxValueChanged:e=>this.onDefaultSyntaxValueChanged(e),"single-line":!0},r.map(((t,l)=>{const n=`${s}_${l}_key}`,u=`${s}_${l}_value}`,[c,d]=t,h=l===r.length-1;return e("div",{class:"elsa-flex elsa-flex-row elsa-justify-between elsa-mb-2"},e("input",{id:n,type:"text",value:c,onChange:e=>this.onKeyChanged(e,l),placeholder:"Name",class:"disabled:elsa-opacity-50 disabled:elsa-cursor-not-allowed focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-border-gray-300 sm:elsa-text-sm elsa-rounded-md elsa-w-5/12"}),e("input",{id:u,type:"text",value:d,onChange:e=>this.onValueChanged(e,l),placeholder:"Value",class:"disabled:elsa-opacity-50 disabled:elsa-cursor-not-allowed focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-border-gray-300 sm:elsa-text-sm elsa-rounded-md elsa-w-5/12"}),e("div",{class:"elsa-flex elsa-flex-row elsa-justify-between elsa-w-24"},e("button",{type:"button",onClick:()=>this.onRowDeleted(l)},a.getIcon(o.TrashBinOutline,{color:i.Gray,hoverColor:i.Red})),h&&e("button",{type:"button",onClick:this.onRowAdded},a.getIcon(o.Plus,{color:i.Gray,hoverColor:i.Green}))))})))}};l.injectProps(r,["serverUrl"]);export{r as elsa_dictionary_property};