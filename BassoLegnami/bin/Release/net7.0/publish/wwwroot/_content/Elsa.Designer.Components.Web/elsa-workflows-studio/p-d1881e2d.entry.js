import{r as s,c as e,h as t}from"./p-ee0b9025.js";import{S as i}from"./p-c74b54ba.js";import{a}from"./p-ccd51ea4.js";import{m as l}from"./p-971980b1.js";import"./p-82db2ff5.js";import"./p-949334ec.js";import{m as n}from"./p-1b40b0d1.js";import{T as o}from"./p-37df3757.js";import{i as r,I as h}from"./p-76935ab4.js";import{t as d,e as c,l as p}from"./p-fd4270fe.js";import"./p-e0c1fede.js";import"./p-f1ec68ec.js";import"./p-a3b5bd35.js";import"./p-80de33dc.js";import"./p-93cac3a6.js";import"./p-d88cb309.js";import"./p-83f217d4.js";let u=class{constructor(t){s(this,t),this.expressionChanged=e(this,"expressionChanged",7),this.opensModal=!1,this.editorHeight="6em",this.singleLineMode=!1,this.onEditorClick=e=>{e.preventDefault(),n.show(this.language,this.currentExpression,(e=>this.setExpression(e)))}}expressionChangedHandler(e){this.currentExpression=e}async setExpression(e){await this.monacoEditor.setValue(e)}async componentWillLoad(){this.currentExpression=this.expression}async componentDidLoad(){const e=await a(this.serverUrl),t=await e.scriptingApi.getJavaScriptTypeDefinitions(this.workflowDefinitionId,this.context),s="defaultLib:lib.es6.d.ts";await this.monacoEditor.addJavaScriptLib(t,s),n.monacoEditor&&n.monacoEditor.addJavaScriptLib(t,s)}async onMonacoValueChanged(e){this.currentExpression=e.value,await this.expressionChanged.emit(e.value)}render(){return t("elsa-monaco",{value:this.currentExpression,language:this.language,"editor-height":this.editorHeight,"single-line":this.singleLineMode,padding:this.padding,onValueChanged:e=>this.onMonacoValueChanged(e.detail),ref:e=>this.monacoEditor=e},this.opensModal&&t("button",{class:"elsa-absolute elsa-z-10",style:{left:"0.25rem",top:"0.35rem"},onClick:this.onEditorClick},r.getIcon(h.OpenInDialog)))}static get watchers(){return{expression:["expressionChangedHandler"]}}};o.injectProps(u,["serverUrl","workflowDefinitionId"]);let m=class{constructor(t){s(this,t),this.syntaxChanged=e(this,"syntaxChanged",7),this.expressionChanged=e(this,"expressionChanged",7),this.defaultSyntax=i.Literal,this.expressions={},this.supportedSyntaxes=[],this.editorHeight="10em",this.singleLineMode=!1}async componentWillLoad(){this.selectedSyntax=this.syntax,this.currentValue=this.expressions[this.selectedSyntax?this.selectedSyntax:this.defaultSyntax]}onWindowClicked(e){this.contextMenuWidget&&this.contextMenuWidget.contains(e.target)||this.closeContextMenu()}toggleContextMenu(){d(this.contextMenu)}openContextMenu(){c(this.contextMenu)}closeContextMenu(){this.contextMenu&&p(this.contextMenu)}selectDefaultEditor(e){e.preventDefault(),this.selectedSyntax=void 0,this.closeContextMenu()}async selectSyntax(e,t){e.preventDefault(),this.selectedSyntax=t,this.syntaxChanged.emit(t),this.currentValue=this.expressions[t||this.defaultSyntax||i.Literal],this.currentValue&&await this.expressionEditor.setExpression(this.currentValue),this.closeContextMenu()}onSettingsClick(e){this.toggleContextMenu()}onExpressionChanged(e){const t=e.detail;t&&(this.expressions[this.selectedSyntax||this.defaultSyntax]=t,this.expressionChanged.emit(t))}render(){return t("div",null,t("div",{class:"elsa-mb-1"},t("div",{class:"elsa-flex"},t("div",{class:"elsa-flex-1"},this.renderLabel()),this.renderContextMenuWidget())),this.renderEditor())}renderLabel(){if(!this.label)return;const e=this.fieldName;return t("label",{htmlFor:e,class:"elsa-block elsa-text-sm elsa-font-medium elsa-text-gray-700"},this.label||e)}renderContextMenuWidget(){if(0==this.supportedSyntaxes.length)return;const e=this.selectedSyntax;return t("div",{class:"elsa-relative",ref:e=>this.contextMenuWidget=e},t("button",{type:"button",class:"elsa-border-0 focus:elsa-outline-none elsa-text-sm "+(e?"elsa-text-blue-500":"elsa-text-gray-300"),onClick:e=>this.onSettingsClick(e)},this.isReadOnly?"":this.renderContextMenuButton()),t("div",null,t("div",{ref:e=>this.contextMenu=e,"data-transition-enter":"elsa-transition elsa-ease-out elsa-duration-100","data-transition-enter-start":"elsa-transform elsa-opacity-0 elsa-scale-95","data-transition-enter-end":"elsa-transform elsa-opacity-100 elsa-scale-100","data-transition-leave":"elsa-transition elsa-ease-in elsa-duration-75","data-transition-leave-start":"elsa-transform elsa-opacity-100 elsa-scale-100","data-transition-leave-end":"elsa-transform elsa-opacity-0 elsa-scale-95",class:"hidden elsa-origin-top-right elsa-absolute elsa-right-1 elsa-mt-1 elsa-w-56 elsa-rounded-md elsa-shadow-lg elsa-bg-white elsa-ring-1 elsa-ring-black elsa-ring-opacity-5 elsa-divide-y elsa-divide-gray-100 focus:elsa-outline-none elsa-z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"options-menu"},t("div",{class:"elsa-py-1",role:"none"},t("a",{onClick:e=>this.selectSyntax(e,null),href:"#",class:"elsa-block elsa-px-4 elsa-py-2 elsa-text-sm hover:elsa-bg-gray-100 hover:elsa-text-gray-900 "+(e?"elsa-text-gray-700":"elsa-text-blue-700"),role:"menuitem"},"Default")),t("div",{class:"elsa-py-1",role:"none"},this.supportedSyntaxes.map((s=>t("a",{onClick:e=>this.selectSyntax(e,s),href:"#",class:"elsa-block elsa-px-4 elsa-py-2 elsa-text-sm hover:elsa-bg-gray-100 hover:elsa-text-gray-900 "+(e==s?"elsa-text-blue-700":"elsa-text-gray-700"),role:"menuitem"},s)))))))}renderContextMenuButton(){return this.selectedSyntax?t("span",null,this.selectedSyntax):t("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-400",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("circle",{cx:"12",cy:"12",r:"9"}),t("line",{x1:"8",y1:"12",x2:"8",y2:"12.01"}),t("line",{x1:"12",y1:"12",x2:"12",y2:"12.01"}),t("line",{x1:"16",y1:"12",x2:"16",y2:"12.01"}))}renderEditor(){const e=this.selectedSyntax,s=l(e),i=e?"hidden":"block";return t("div",null,t("div",{class:e?"block":"hidden"},t("elsa-expression-editor",{ref:e=>this.expressionEditor=e,onExpressionChanged:e=>this.onExpressionChanged(e),expression:this.currentValue,language:s,editorHeight:this.editorHeight,singleLineMode:this.singleLineMode,context:this.context})),t("div",{class:i},t("slot",null)))}},x=class{constructor(t){s(this,t),this.defaultSyntaxValueChanged=e(this,"defaultSyntaxValueChanged",7),this.editorHeight="10em",this.singleLineMode=!1,this.showLabel=!0}onSyntaxChanged(e){this.propertyModel.syntax=e.detail}onExpressionChanged(e){const t=this.propertyDescriptor.defaultSyntax||i.Literal,s=this.propertyModel.syntax||t;this.propertyModel.expressions[s]=e.detail,s==t&&this.defaultSyntaxValueChanged.emit(e.detail)}render(){const e=this.propertyDescriptor,s=this.propertyModel,i=e.hint;return t("div",null,t("elsa-multi-expression-editor",{onSyntaxChanged:e=>this.onSyntaxChanged(e),onExpressionChanged:e=>this.onExpressionChanged(e),fieldName:e.name,label:this.showLabel?e.label:null,syntax:s.syntax,defaultSyntax:e.defaultSyntax,isReadOnly:e.isReadOnly,expressions:s.expressions,supportedSyntaxes:e.supportedSyntaxes,"editor-height":this.editorHeight,context:{propertyName:e.name,activityTypeName:this.activityModel.type}},t("slot",null)),i?t("p",{class:"elsa-mt-2 elsa-text-sm elsa-text-gray-500"},i):void 0)}};x.style="";export{u as elsa_expression_editor,m as elsa_multi_expression_editor,x as elsa_property_editor};