import{r as e,h as s}from"./p-ee0b9025.js";import"./p-c74b54ba.js";import{a}from"./p-ccd51ea4.js";import{c as l}from"./p-971980b1.js";import"./p-82db2ff5.js";import"./p-949334ec.js";import{i as t}from"./p-273970f1.js";import{l as i}from"./p-6137089a.js";import{G as r}from"./p-f7bc98b6.js";import{T as n}from"./p-821a7518.js";import"./p-e0c1fede.js";import"./p-f1ec68ec.js";import"./p-a3b5bd35.js";import"./p-80de33dc.js";import"./p-93cac3a6.js";import"./p-d88cb309.js";import"./p-1b1f9628.js";import"./p-83f217d4.js";import"./p-fe704386.js";const o={en:{default:{Name:"Name",Instances:"Instances",LatestVersion:"Latest Version",PublishedVersion:"Published Version",Edit:"Edit",Delete:"Delete",DeleteConfirmationModel:{Title:"Delete Workflow Definition",Message:"Are you sure you wish to permanently delete this workflow, including all of its workflow instances?"}}},"zh-CN":{default:{Name:"名称",Instances:"实例",LatestVersion:"最新版本",PublishedVersion:"发布版本",Edit:"编辑",Delete:"删除",DeleteConfirmationModel:{Title:"删除工作流程定义",Message:"你确定要永久删除这个工作流程，包括它的所有工作流程实例？"}}},"nl-NL":{default:{Name:"Naam",Instances:"Instanties",LatestVersion:"Laatste Versie",PublishedVersion:"Gepubliceerde Versie",Edit:"Bewerken",Delete:"Verwijderen",DeleteConfirmationModel:{Title:"Verwijder Workflow Definitie",Message:"Weet je zeker dat je deze workflow permanent wilt verwijderen, inclusief alle bijbehorende workflow instanties?"}}},"fa-IR":{default:{Name:"نام",Instances:"جریانها",LatestVersion:"جدیدترین ویرایش",PublishedVersion:"ویرایش منتشر شده",Edit:"ویرایش",Delete:"حذف",DeleteConfirmationModel:{Title:"حذف تعریف فرآیند",Message:"آیا از حذف این فرآیند و همه جریانهای آن اطمینان دارید?"}}},"de-DE":{default:{Name:"Name",Instances:"Instanzen",LatestVersion:"Neuste Version",PublishedVersion:"Veröffentlichte Version",Edit:"Bearbeiten",Delete:"Entfernen",DeleteConfirmationModel:{Title:"Ablaufdefinition entfernen",Message:"Sind Sie sicher, dass sie die Definition und die dazugehörigen Instanzen unwiderruflich löschen wollen?"}}}};let d=class{constructor(s){e(this,s),this.workflowDefinitions={items:[],page:1,pageSize:50,totalCount:0},this.currentPage=0,this.currentPageSize=d.DEFAULT_PAGE_SIZE,this.t=(e,s)=>this.i18next.t(e,s),this.onPaged=async e=>{this.currentPage=e.detail.page,await this.loadWorkflowDefinitions()}}connectedCallback(){this.history&&(this.clearRouteChangedListeners=this.history.listen((e=>this.routeChanged(e))))}disconnectedCallback(){this.clearRouteChangedListeners&&this.clearRouteChangedListeners()}async componentWillLoad(){this.i18next=await i(this.culture,o),this.history&&this.applyQueryString(this.history.location.search),await this.loadWorkflowDefinitions()}async onSearch(e){e.preventDefault();const s=new FormData(e.currentTarget).get("searchTerm");this.currentSearchTerm=s.toString(),await this.loadWorkflowDefinitions()}applyQueryString(e){const s=l(e);this.currentPage=s.page?parseInt(s.page):0,this.currentPage=isNaN(this.currentPage)?d.START_PAGE:this.currentPage,this.currentPageSize=s.pageSize?parseInt(s.pageSize):d.DEFAULT_PAGE_SIZE,this.currentPageSize=isNaN(this.currentPageSize)?d.DEFAULT_PAGE_SIZE:this.currentPageSize,this.currentPageSize=Math.max(Math.min(this.currentPageSize,d.MAX_PAGE_SIZE),d.MIN_PAGE_SIZE)}async onPublishClick(e,s){const t=await this.createClient();await t.workflowDefinitionsApi.publish(s.definitionId),await this.loadWorkflowDefinitions()}async onUnPublishClick(e,s){const t=await this.createClient();await t.workflowDefinitionsApi.retract(s.definitionId),await this.loadWorkflowDefinitions()}async onDeleteClick(e,s){const t=e=>this.i18next.t(e);if(!await this.confirmDialog.show(t("DeleteConfirmationModel.Title"),t("DeleteConfirmationModel.Message")))return;const a=await this.createClient();await a.workflowDefinitionsApi.delete(s.definitionId,{allVersions:!0}),await this.loadWorkflowDefinitions()}async routeChanged(e){e.pathname.toLowerCase().endsWith("workflow-definitions")&&(this.applyQueryString(e.search),await this.loadWorkflowDefinitions())}async loadWorkflowDefinitions(){const e=await this.createClient(),s=this.currentPage,t=this.currentPageSize;this.workflowDefinitions=await e.workflowDefinitionsApi.list(s,t,{isLatestOrPublished:!0},this.currentSearchTerm)}createClient(){return a(this.serverUrl)}render(){const e=this.workflowDefinitions.items,t=e.filter((e=>e.isLatest)),a=e.filter((e=>e.isPublished)),l=this.workflowDefinitions.totalCount,i=this.i18next,n=r(i),o=this.basePath,d=this.t;return s("div",null,s("div",{class:"elsa-relative elsa-z-10 elsa-flex-shrink-0 elsa-flex elsa-h-16 elsa-bg-white elsa-border-b elsa-border-gray-200"},s("div",{class:"elsa-flex-1 elsa-px-4 elsa-flex elsa-justify-between sm:elsa-px-6 lg:elsa-px-8"},s("div",{class:"elsa-flex-1 elsa-flex"},s("form",{class:"elsa-w-full elsa-flex md:ml-0",onSubmit:e=>this.onSearch(e)},s("label",{htmlFor:"search_field",class:"elsa-sr-only"},"Search"),s("div",{class:"elsa-relative elsa-w-full elsa-text-gray-400 focus-within:elsa-text-gray-600"},s("div",{class:"elsa-absolute elsa-inset-y-0 elsa-left-0 elsa-flex elsa-items-center elsa-pointer-events-none"},s("svg",{class:"elsa-h-5 elsa-w-5",fill:"currentColor",viewBox:"0 0 20 20"},s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"}))),s("input",{name:"searchTerm",class:"elsa-block elsa-w-full elsa-h-full elsa-pl-8 elsa-pr-3 elsa-py-2 elsa-rounded-md elsa-text-gray-900 elsa-placeholder-gray-500 focus:elsa-placeholder-gray-400 sm:elsa-text-sm elsa-border-0 focus:elsa-outline-none focus:elsa-ring-0",placeholder:d("Search"),type:"search"})))))),s("div",{class:"elsa-align-middle elsa-inline-block elsa-min-w-full elsa-border-b elsa-border-gray-200"},s("table",{class:"elsa-min-w-full"},s("thead",null,s("tr",{class:"elsa-border-t elsa-border-gray-200"},s("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},s("span",{class:"lg:elsa-pl-2"},s(n,{label:"Name"}))),s("th",{class:"elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-left elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},s(n,{label:"Instances"})),s("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-right elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},s(n,{label:"LatestVersion"})),s("th",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-right elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"},s(n,{label:"PublishedVersion"})),s("th",{class:"elsa-pr-6 elsa-py-3 elsa-border-b elsa-border-gray-200 elsa-bg-gray-50 elsa-text-right elsa-text-xs elsa-leading-4 elsa-font-medium elsa-text-gray-500 elsa-uppercase elsa-tracking-wider"}))),s("tbody",{class:"elsa-bg-white elsa-divide-y elsa-divide-gray-100"},t.map((e=>{const t=e.version,{isPublished:l}=e,r=l?e:a.find((s=>s.definitionId==e.definitionId)),d=r?r.version:"-";let c=e.displayName;c&&0!=c.trim().length||(c=e.name),c&&0!=c.trim().length||(c="Untitled");const h=`${o}/workflow-definitions/${e.definitionId}`,f=`${o}/workflow-instances?workflow=${e.definitionId}`,p=s("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},s("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),s("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})),u=s("svg",{class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},s("path",{stroke:"none",d:"M0 0h24v24H0z"}),s("line",{x1:"4",y1:"7",x2:"20",y2:"7"}),s("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),s("line",{x1:"14",y1:"11",x2:"14",y2:"17"}),s("path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"}),s("path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"})),g=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})),w=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"elsa-h-5 elsa-w-5 elsa-text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"}));return s("tr",null,s("td",{class:"elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-font-medium elsa-text-gray-900"},s("div",{class:"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2"},s("stencil-route-link",{url:h,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},s("span",null,c)))),s("td",{class:"elsa-px-6 elsa-py-3 elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-font-medium"},s("div",{class:"elsa-flex elsa-items-center elsa-space-x-3 lg:elsa-pl-2"},s("stencil-route-link",{url:f,anchorClass:"elsa-truncate hover:elsa-text-gray-600"},s(n,{label:"Instances"})))),s("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right"},t),s("td",{class:"hidden md:elsa-table-cell elsa-px-6 elsa-py-3 elsa-whitespace-no-wrap elsa-text-sm elsa-leading-5 elsa-text-gray-500 elsa-text-right"},d),s("td",{class:"elsa-pr-6"},s("elsa-context-menu",{history:this.history,menuItems:[{text:i.t("Edit"),anchorUrl:h,icon:p},l?{text:i.t("Unpublish"),clickHandler:s=>this.onUnPublishClick(s,e),icon:w}:{text:i.t("Publish"),clickHandler:s=>this.onPublishClick(s,e),icon:g},{text:i.t("Delete"),clickHandler:s=>this.onDeleteClick(s,e),icon:u}]})))})))),s("elsa-pager",{page:this.currentPage,pageSize:this.currentPageSize,totalCount:l,history:this.history,onPaged:this.onPaged,culture:this.culture})),s("elsa-confirm-dialog",{ref:e=>this.confirmDialog=e,culture:this.culture}))}};d.DEFAULT_PAGE_SIZE=15,d.MIN_PAGE_SIZE=5,d.MAX_PAGE_SIZE=100,d.START_PAGE=0,n.injectProps(d,["serverUrl","culture","basePath"]),t(d);export{d as elsa_workflow_definitions_list_screen};