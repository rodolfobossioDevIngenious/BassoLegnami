import{r as e,c as t,h as s,H as i}from"./p-ee0b9025.js";import{i as a,E as o}from"./p-e0a11db6.js";import{a as n}from"./p-e77aabd2.js";let l=class{constructor(a){e(this,a),this.valueChanged=t(this,"valueChanged",7),this.editorHeight="5em",this.singleLineMode=!1}languageChangeHandler(e){if(!this.editor)return;const t=this.editor.getModel();this.monaco.editor.setModelLanguage(t,this.language)}async setValue(e){this.editor&&this.editor.getModel().setValue(e||"")}async addJavaScriptLib(e,t){const a=this.monaco;a.languages.typescript.javascriptDefaults.setExtraLibs([{filePath:"lib.es5.d.ts"},{content:e,filePath:t}]);const i=a.editor.getModel(t);i&&i.dispose(),a.editor.createModel(e,"typescript",a.Uri.parse(t));const s=e.matchAll(/declare const (\w+): (string|number)/g);o.splice(0,o.length);for(const e of s)o.push({variableName:e[1],type:e[2]})}async componentWillLoad(){var e;const t=null!==(e=this.monacoLibPath)&&void 0!==e?e:n.monacoLibPath;this.monaco=await a(t)}componentDidLoad(){const e=this.monaco,t=this.language;e.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1}),e.languages.typescript.javascriptDefaults.setCompilerOptions({target:e.languages.typescript.ScriptTarget.ES2020,lib:[],allowNonTsExtensions:!0}),e.languages.typescript.javascriptDefaults.setEagerModelSync(!0);const a={value:this.value,language:t,fontFamily:"Roboto Mono, monospace",renderLineHighlight:"none",minimap:{enabled:!1},automaticLayout:!0,lineNumbers:"on",theme:"vs",roundedSelection:!0,scrollBeyondLastLine:!1,readOnly:!1,overviewRulerLanes:0,overviewRulerBorder:!1,lineDecorationsWidth:0,hideCursorInOverviewRuler:!0,glyphMargin:!1};let o=a;this.singleLineMode&&(o=Object.assign(Object.assign({},a),{wordWrap:"off",lineNumbers:"off",lineNumbersMinChars:0,folding:!1,scrollBeyondLastColumn:0,scrollbar:{horizontal:"hidden",vertical:"hidden"},find:{addExtraSpaceOnTop:!1,autoFindInSelection:"never",seedSearchStringFromSelection:!1}})),this.editor=e.editor.create(this.container,o),this.editor.onDidChangeModelContent((()=>{const a=this.editor.getValue(),o=e.editor.getModelMarkers({owner:t});this.valueChanged.emit({value:a,markers:o})})),this.singleLineMode&&(this.editor.onKeyDown((t=>{t.keyCode==e.KeyCode.Enter&&0==this.editor.getContribution("editor.contrib.suggestController").model.state&&t.preventDefault()})),this.editor.onDidPaste((e=>{if(e.range.endLineNumber>1){let e="";const t=this.editor.getModel();let a=t.getLineCount();for(let o=0;o<a;o++)e+=t.getLineContent(o+1);t.setValue(e)}})))}disconnectedCallback(){const e=this.editor;e&&e.dispose()}render(){return s(i,{class:"elsa-monaco-editor-host elsa-border focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-block elsa-w-full elsa-min-w-0 elsa-rounded-md sm:elsa-text-sm elsa-border-gray-300 elsa-p-4",style:{"min-height":this.editorHeight}},s("div",{ref:e=>this.container=e,class:`elsa-monaco-editor-container ${this.padding||"elsa-pt-1.5 elsa-pl-1"}`}))}static get watchers(){return{language:["languageChangeHandler"]}}};l.style=".elsa-monaco-editor-host{display:block;min-height:6em;position:relative}.elsa-monaco-editor-container{height:100%;left:0;margin:0;max-height:100%!important;padding:0;position:absolute;top:0;width:100%}";export{l as elsa_monaco};